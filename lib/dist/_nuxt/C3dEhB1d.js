const __vite__fileDeps=["./CUOLQtTg.js","./DZZ6t_j4.js","./entry.DIDWwc7m.css","./DfeSAprs.js","./DNgdBwTe.js","./eX8_g88K.js","./vll-Pnjv.js","./Checkbox.M_COpns0.css","./vK-WmZ7a.js","./Bdv7ru7D.js","./DeleteModal.SEMJ_gSK.css","./C3jLTHF4.js","./DKN1hQ6S.js","./BQuyMdA-.js","./BQQOEPN4.js","./B5RRVMt5.js","./DGj1ycqW.js","./DyDFI6NE.js","./CxrpBWdD.js","./DA0VIM8P.js","./BYINaHrJ.js","./dfem9Uc_.js","./BCJFTkwv.js","./D9tFZoTQ.js","./0azk-b-q.js","./BO2leIU3.js","./CmWcz5yS.js","./CB1aB6F1.js","./QuickImport.CAFUap-4.css","./CMQKmrr6.js","./CMIIcM5i.js","./ByvYYClF.js","./DuvRsGDb.js","./BT-ahe-O.js","./TableCreate.BHMZ8BQz.css","./CynerQ2m.js","./DCjuPxLb.js","./CY3l82lI.js","./Table.flBPdmEH.css","./DgixBgIx.js","./C3XbZq4f.js","./CyRMlOXW.js","./By7kEk8u.js","./PageHeader.Cs_HHWy1.css","./DnwRMKX3.js","./UserIcon.DEVmGavY.css","./B6xrG0q8.js","./B89oU1M4.js","./Badge.D0-UrqG9.css","./D_MsYLkT.js","./YRNmwX8m.js","./2FgppHLC.js","./Ck-cgwga.js","./Tabs.DaLSLYpn.css","./BpclqUFq.js","./DuJHisTB.js","./oyD85nwD.js","./DnSVh-oD.js","./Select.C8Fy0-eI.css","./TJfB7GlU.js","./Divider.DqtSqZhb.css","./B4Lj1XSi.js","./boyBAVNN.js","./CwK0k4WN.js","./toggleHighContrast.wojAGmRG.css","./Editor.6PWXOFSt.css","./0QUe8GCE.js","./Overlay.BGbSKdGB.css","./GMLocJHP.js","./C00NHga8.js","./G4Pt-Lbf.js","./C3wAmqC5.js","./CbjHV4v2.js","./CDWovrGB.js","./EditOrAdd.VCbmoGc0.css","./sz1d3zjm.js","./MenuItem.C7h59s4s.css","./BLgccLvp.js","./Menu.CQ8GNWeI.css","./BqKQ8afS.js","./CXD-Dj4T.js","./DS_HXCWn.js","./BVrX6sNU.js","./Dg0-TbNo.js","./t0mbNaqp.js","./InviteDlg.BFj7jV5W.css","./zlXHHIY7.js","./EditBase.Dt0oGUjV.css","./DwrbIntl.js","./B4q_iKR5.js","./View.B2EG4bUV.css","./DP9Lt6o9.js","./Cz_1GoV3.js","./DLDZbX8i.js","./B8iX-Tu_.js","./BXkAG49i.js","./CFvUUxCy.js","./BaseAudit.MBpv011d.css","./C_tK5p5w.js","./CfitfHee.js","./gcvYoU2K.js","./CvNj_pzL.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{_ as _a,a as Nt}from"./CxrpBWdD.js";import{e as ye,ak as vt,cb as Je,aQ as Pt,b as a,am as _t,aP as ot,ae as ma,an as Ot,c9 as va,a_ as fa,bD as ba,al as xt,aa as $t,aZ as ga,a5 as Ge,ab as qe,o as l,Q as A,w as s,a as t,t as i,N as e,O as re,Y as Me,r as B,y as Ae,_ as Ue,ax as fe,cP as lt,ay as et,cL as Ze,J as tt,ag as ft,f as ie,M as Rt,c as C,R as T,P as nt,d as V,S as ve,$ as Pe,ao as me,cq as ya,aL as jt,X as Ee,a4 as Be,ad as ha,V as st,at as Qe,gb as kt,aN as wa,gc as xa,bL as bt,gd as At,ge as Mt,gf as Re,g as Et,gg as ut,ah as ge,ai as Ne,ar as $a,F as we,T as it,U as gt,gh as He,dq as ka,Z as yt,as as Sa,cS as Bt,gi as Ca,ap as Ia,fy as X,gj as Da,a$ as St,gk as Ta,ga as Lt,a7 as je,cm as Ut,a8 as zt,W as Fe,aJ as Wt,gl as Ct,gm as Na,c_ as It,gn as Pa,go as Oa,gp as Ra,dD as ja,dp as Aa,gq as Te,gr as pt,aF as Ma,fU as Vt,aw as Ea,u as Ba,L as Gt,gs as La,dc as Ua,aM as za,fV as Wa,gt as Va,d1 as Ga}from"./DZZ6t_j4.js";import{_ as Fa}from"./CMQKmrr6.js";import{_ as Qa}from"./ByvYYClF.js";import{_ as Ka}from"./DuvRsGDb.js";import{_ as qa}from"./CynerQ2m.js";import{_ as Ft}from"./DCjuPxLb.js";import{_ as Qt}from"./CY3l82lI.js";import{_ as Ya}from"./DgixBgIx.js";import{u as rt}from"./C3XbZq4f.js";import{_ as Ha}from"./CyRMlOXW.js";import{_ as Ja}from"./By7kEk8u.js";import{_ as Za}from"./DfeSAprs.js";import{_ as Xa}from"./DnwRMKX3.js";import{_ as Kt}from"./B6xrG0q8.js";import{D as es,S as qt,_ as ts}from"./D_MsYLkT.js";import{u as as}from"./YRNmwX8m.js";import{p as ss,t as os}from"./2FgppHLC.js";import"./DKN1hQ6S.js";import{I as ht}from"./BQuyMdA-.js";import{_ as ls}from"./Ck-cgwga.js";import{_ as Yt}from"./Bdv7ru7D.js";import{u as ns,_ as is,a as rs,b as cs,v as ds,c as us}from"./BpclqUFq.js";import{_ as ps}from"./DnSVh-oD.js";import{_ as Ht}from"./CDWovrGB.js";import{_ as Jt}from"./dfem9Uc_.js";import{_ as _s}from"./0QUe8GCE.js";import{_ as Zt}from"./TJfB7GlU.js";import{f as at,b as ms,e as vs}from"./C3jLTHF4.js";import{F as Dt}from"./BYINaHrJ.js";import{_ as fs,C as bs}from"./CbjHV4v2.js";import{_ as gs}from"./0azk-b-q.js";import{_ as ys}from"./B89oU1M4.js";import{_ as hs}from"./sz1d3zjm.js";import{_ as ws}from"./BLgccLvp.js";import{_ as xs}from"./vK-WmZ7a.js";import{_ as $s}from"./BqKQ8afS.js";import{u as Xt}from"./DS_HXCWn.js";import{_ as ks}from"./BVrX6sNU.js";import{D as Ss}from"./Dg0-TbNo.js";import{u as Cs}from"./BT-ahe-O.js";var Is=["class","style"],Ds=function(){return{prefixCls:String,href:String,separator:ot.any,overlay:ot.any,onClick:Function}};const Xe=ye({compatConfig:{MODE:3},name:"ABreadcrumbItem",inheritAttrs:!1,__ANT_BREADCRUMB_ITEM:!0,props:Ds(),slots:["separator","overlay"],setup:function(g,I){var D=I.slots,f=I.attrs,x=vt("breadcrumb",g),k=x.prefixCls,L=function(W,y){var m=Je(D,g,"overlay");return m?a(ma,{overlay:m,placement:"bottom"},{default:function(){return[a("span",{class:"".concat(y,"-overlay-link")},[W,a(es,null,null)])]}}):W};return function(){var J,W=(J=Je(D,g,"separator"))!==null&&J!==void 0?J:"/",y=Je(D,g),m=f.class,_=f.style,$=Pt(f,Is),P;return g.href!==void 0?P=a("a",_t({class:"".concat(k.value,"-link"),onClick:g.onClick},$),[y]):P=a("span",_t({class:"".concat(k.value,"-link"),onClick:g.onClick},$),[y]),P=L(P,k.value),y?a("span",{class:m,style:_},[P,W&&a("span",{class:"".concat(k.value,"-separator")},[W])]):null}}});var Ts=function(){return{prefixCls:String,routes:{type:Array},params:ot.any,separator:ot.any,itemRender:{type:Function}}};function Ns(v,g){if(!v.breadcrumbName)return null;var I=Object.keys(g).join("|"),D=v.breadcrumbName.replace(new RegExp(":(".concat(I,")"),"g"),function(f,x){return g[x]||f});return D}function Tt(v){var g=v.route,I=v.params,D=v.routes,f=v.paths,x=D.indexOf(g)===D.length-1,k=Ns(g,I);return x?a("span",null,[k]):a("a",{href:"#/".concat(f.join("/"))},[k])}const Ke=ye({compatConfig:{MODE:3},name:"ABreadcrumb",props:Ts(),slots:["separator","itemRender"],setup:function(g,I){var D=I.slots,f=vt("breadcrumb",g),x=f.prefixCls,k=f.direction,L=function(m,_){return m=(m||"").replace(/^\//,""),Object.keys(_).forEach(function($){m=m.replace(":".concat($),_[$])}),m},J=function(m,_,$){var P=ga(m),q=L(_||"",$);return q&&P.push(q),P},W=function(m){var _=m.routes,$=_===void 0?[]:_,P=m.params,q=P===void 0?{}:P,w=m.separator,O=m.itemRender,d=O===void 0?Tt:O,Y=[];return $.map(function(G){var H=L(G.path,q);H&&Y.push(H);var N=[].concat(Y),ce=null;return G.children&&G.children.length&&(ce=a($t,null,{default:function(){return[G.children.map(function(U){return a($t.Item,{key:U.path||U.breadcrumbName},{default:function(){return[d({route:U,params:q,routes:$,paths:J(N,U.path,q)})]}})})]}})),a(Xe,{overlay:ce,separator:w,key:H||G.breadcrumbName},{default:function(){return[d({route:G,params:q,routes:$,paths:N})]}})})};return function(){var y,m,_,$=g.routes,P=g.params,q=P===void 0?{}:P,w=Ot(Je(D,g)),O=(y=Je(D,g,"separator"))!==null&&y!==void 0?y:"/",d=g.itemRender||D.itemRender||Tt;$&&$.length>0?_=W({routes:$,params:q,separator:O,itemRender:d}):w.length&&(_=w.map(function(G,H){return va(fa(G.type)==="object"&&(G.type.__ANT_BREADCRUMB_ITEM||G.type.__ANT_BREADCRUMB_SEPARATOR),"Breadcrumb","Only accepts Breadcrumb.Item and Breadcrumb.Separator as it's children"),ba(G,{separator:O,key:H})}));var Y=(m={},xt(m,x.value,!0),xt(m,"".concat(x.value,"-rtl"),k.value==="rtl"),m);return a("div",{class:Y},[_])}}});var Ps=["separator","class"],Os=function(){return{prefixCls:String}};const mt=ye({compatConfig:{MODE:3},name:"ABreadcrumbSeparator",__ANT_BREADCRUMB_SEPARATOR:!0,inheritAttrs:!1,props:Os(),setup:function(g,I){var D=I.slots,f=I.attrs,x=vt("breadcrumb",g),k=x.prefixCls;return function(){var L;f.separator;var J=f.class,W=Pt(f,Ps),y=Ot((L=D.default)===null||L===void 0?void 0:L.call(D));return a("span",_t({class:["".concat(k.value,"-separator"),J]},W),[y.length>0?y:"/"])}}});Ke.Item=Xe;Ke.Separator=mt;Ke.install=function(v){return v.component(Ke.name,Ke),v.component(Xe.name,Xe),v.component(mt.name,mt),v};const Rs={class:"flex flex-col px-8 pt-6 pb-9"},js={class:"flex items-center gap-3 mb-6"},As={class:"text-base font-weight-700"},Ms={class:"row mb-10"},Es={class:"label"},Bs={class:"label"},Ls={class:"row"},Us={class:"label"},zs={class:"label"},Ws=ye({__name:"ImportModal",props:{visible:{type:Boolean},source:{}},emits:["update:visible"],setup(v,{emit:g}){const I=v,D=g,f=Ge(I,"source"),x=qe(I,"visible",D),{$e:k}=Ae();function L(y,m){if(!y||!m)return;k("a:actions:import-airtable");const _=B(!0),{close:$}=rt(_a,{modelValue:_,baseId:y,sourceId:m,"onUpdate:modelValue":P});function P(){_.value=!1,$(1e3)}}function J(y){if(!f.value.id||!f.value.base_id)return;k(`a:actions:import-${y}`);const m=B(!0),{close:_}=rt(Nt,{modelValue:m,importType:y,baseId:f.value.base_id,sourceId:f.value.id,"onUpdate:modelValue":$});function $(){m.value=!1,_(1e3)}}const W=y=>{x.value=!1,y==="airtable"?L(f.value.base_id,f.value.id):J(y)};return(y,m)=>{const _=Me,$=Ya;return l(),A($,{visible:e(x),"onUpdate:visible":m[4]||(m[4]=P=>re(x)?x.value=P:null),width:"35rem"},{default:s(()=>[t("div",Rs,[t("div",js,[a(_,{icon:"download",class:"flex-none !text-orange-700 !w-4 !h-4"}),t("div",As,i(y.$t("general.import")),1)]),t("div",Ms,[t("div",{class:"nc-base-view-import-sub-btn",onClick:m[0]||(m[0]=P=>W("airtable"))},[a(_,{icon:"airtable"}),t("div",Es,i(y.$t("labels.airtable")),1)]),t("div",{class:"nc-base-view-import-sub-btn",onClick:m[1]||(m[1]=P=>W("csv"))},[a(_,{icon:"csv"}),t("div",Bs,i(y.$t("labels.csv")),1)])]),t("div",Ls,[t("div",{class:"nc-base-view-import-sub-btn",onClick:m[2]||(m[2]=P=>W("excel"))},[a(_,{icon:"excelColored"}),t("div",Us,i(y.$t("labels.excel")),1)]),t("div",{class:"nc-base-view-import-sub-btn",onClick:m[3]||(m[3]=P=>W("json"))},[a(_,{icon:"code"}),t("div",zs,i(y.$t("labels.json")),1)])])])]),_:1},8,["visible"])}}}),Vs=Ue(Ws,[["__scopeId","data-v-86647892"]]),Gs=""+new URL("table.BosIpfXe.png",import.meta.url).href,Fs=Ee(()=>Be(()=>Promise.resolve().then(()=>gl),void 0,import.meta.url).then(v=>v.default||v)),Qs={class:"nc-all-tables-view px-6 pt-6"},Ks={class:"icon-wrapper"},qs={class:"flex flex-col gap-1"},Ys={class:"label"},Hs={class:"icon-wrapper"},Js={class:"flex flex-col gap-1"},Zs={class:"label"},Xs={class:"icon-wrapper"},eo={class:"flex flex-col gap-1"},to={class:"label"},ao={key:0,class:"flex items-center justify-center text-center mt-4",style:{height:"calc(100vh - var(--topbar-height) - 15.2rem)"}},so={class:"mt-2"},oo={key:1,class:"flex mt-4",style:{height:"calc(100vh - var(--topbar-height) - 218px)"}},lo={key:0,class:"w-full flex items-center gap-3 max-w-full text-gray-800","data-testid":"proj-view-list__item-title"},no={class:"min-w-6 flex items-center justify-center"},io={key:1,class:"capitalize w-full flex items-center gap-3 max-w-full","data-testid":"proj-view-list__item-type"},ro={key:0,class:"ml-0.75"},co={key:2,class:"capitalize flex items-center gap-2 max-w-full","data-testid":"proj-view-list__item-created-at"},uo={key:2,class:"py-3 flex items-center gap-6 <lg:flex-col"},po={class:"text-center lg:text-left"},_o={class:"text-2xl text-gray-800 font-bold"},mo={class:"text-sm text-gray-700 pt-6"},vo=ye({__name:"AllTables",setup(v){const{activeTables:g}=fe(lt()),{openTable:I}=lt(),{openedProject:D,isDataSourceLimitReached:f}=fe(et()),{base:x}=fe(Ze()),k=B(!1),{isUIAllowed:L}=tt(),{$e:J}=Ae(),{t:W}=ft(),y=B(!1),m=ie(()=>{var O,d;return(d=(O=D.value)==null?void 0:O.sources)==null?void 0:d[0]}),_=ie(()=>{var d,Y;const O=new Map;return(Y=(d=D.value)==null?void 0:d.sources)==null||Y.forEach(G=>{O.set(G.id,G)}),O});function $(O){var N,ce;J("c:table:create:navdraw");const d=B(!0);let Y=(N=D.value.sources)==null?void 0:N[0].id;if(!Y||!((ce=D.value)!=null&&ce.id))return;const{close:G}=rt(Ka,{modelValue:d,sourceId:Y,baseId:D.value.id,onCreate:H,"onUpdate:modelValue":()=>H()});function H(ae){d.value=!1,ae&&(setTimeout(()=>{const U=document.querySelector(`[data-table-id="${ae.id}"]`);U&&(U==null||U.scrollIntoView({behavior:"smooth",block:"nearest"}))},1e3),G(1e3))}}const P=[{key:"tableName",title:W("objects.table"),name:"Table Name",basis:"40%",minWidth:220,padding:"0px 12px"},{key:"sourceName",title:W("general.source"),name:"View Name",basis:"25%",minWidth:220,padding:"0px 12px"},{key:"created_at",title:W("labels.createdOn"),name:"editor",minWidth:120,padding:"0px 12px"}],q=O=>({onclick:()=>{I(O)}}),w=()=>{f.value||(k.value=!0)};return(O,d)=>{var Q,ue,u,de,K,_e,se;const Y=Me,G=jt,H=qa,N=Ft,ce=Qt,ae=Vs,U=Fs,S=Rt("e");return l(),C("div",Qs,[t("div",{class:ve(["flex flex-row gap-x-6 pb-2 overflow-x-auto nc-scrollbar-thin",{"pointer-events-none":(Q=e(x))==null?void 0:Q.isLoading}])},[e(L)("tableCreate",{source:(u=(ue=e(x))==null?void 0:ue.sources)==null?void 0:u[0]})?(l(),C("div",{key:0,role:"button",class:"nc-base-view-all-table-btn","data-testid":"proj-view-btn__add-new-table",onClick:d[0]||(d[0]=Z=>$())},[t("div",Ks,[a(Y,{icon:"addOutlineBox",class:"!h-8 !w-8 !text-brand-500"})]),t("div",qs,[t("div",Ys,i(O.$t("general.create"))+" "+i(O.$t("general.new"))+" "+i(O.$t("objects.table")),1),d[4]||(d[4]=t("div",{class:"subtext"},"Start from scratch.",-1))])])):T("",!0),e(L)("tableCreate",{source:(K=(de=e(x))==null?void 0:de.sources)==null?void 0:K[0]})?nt((l(),C("div",{key:1,role:"button",class:"nc-base-view-all-table-btn","data-testid":"proj-view-btn__import-data",onClick:d[1]||(d[1]=Z=>y.value=!0)},[t("div",Hs,[a(Y,{icon:"download",class:"!h-7.5 !w-7.5 !text-orange-700"})]),t("div",Js,[t("div",Zs,i(O.$t("activity.import"))+" "+i(O.$t("general.data")),1),d[5]||(d[5]=t("div",{class:"subtext"},"From files & external sources",-1))])])),[[S,["c:table:import"]]]):T("",!0),e(L)("sourceCreate")?(l(),A(Pe,{key:2,placement:"bottom",disabled:!e(f),class:"flex-none flex"},{title:s(()=>[V(i(O.$t("tooltip.reachedSourceLimit")),1)]),default:s(()=>[nt((l(),C("div",{role:"button",class:ve(["nc-base-view-all-table-btn",{disabled:e(f)}]),"data-testid":"proj-view-btn__create-source",onClick:w},[t("div",Xs,[a(Y,{icon:"server1",class:"!h-7 !w-7 !text-green-700"})]),t("div",eo,[t("div",to,i(O.$t("labels.connectDataSource")),1),d[6]||(d[6]=t("div",{class:"subtext"},"In realtime to external databases.",-1))])],2)),[[S,["c:table:create-source"]]])]),_:1},8,["disabled"])):T("",!0)],2),(_e=e(x))!=null&&_e.isLoading?(l(),C("div",ao,[t("div",null,[a(G,{size:"xlarge"}),t("div",so,i(O.$t("general.loading")),1)])])):e(g).length?(l(),C("div",oo,[a(ce,{"is-data-loading":(se=e(x))==null?void 0:se.isLoading,columns:P,"sticky-first-column":"",data:[...e(g)].sort((Z,ee)=>Z.source_id.localeCompare(ee.source_id)*20),"custom-row":q,bordered:!1,class:"nc-base-view-all-table-list flex-1"},{bodyCell:s(({column:Z,record:ee})=>{var c;return[Z.key==="tableName"?(l(),C("div",lo,[t("div",no,[a(H,{meta:ee,class:"flex-none text-gray-600"},null,8,["meta"])]),a(Pe,{class:"truncate max-w-[calc(100%_-_28px)]","show-on-truncate-only":""},{title:s(()=>[V(i(ee==null?void 0:ee.title),1)]),default:s(()=>[V(" "+i(ee==null?void 0:ee.title),1)]),_:2},1024)])):T("",!0),Z.key==="sourceName"?(l(),C("div",io,[ee.source_id===((c=e(m))==null?void 0:c.id)?(l(),C("div",ro,"-")):(l(),C(me,{key:1},[a(N,{class:"flex-none w-4"}),a(Pe,{class:"truncate max-w-[calc(100%_-_28px)]","show-on-truncate-only":""},{title:s(()=>{var n;return[V(i((n=e(_).get(ee.source_id))==null?void 0:n.alias),1)]}),default:s(()=>{var n;return[V(" "+i((n=e(_).get(ee.source_id))==null?void 0:n.alias),1)]}),_:2},1024)],64))])):T("",!0),Z.key==="created_at"?(l(),C("div",co,i(e(ya)(ee==null?void 0:ee.created_at).fromNow()),1)):T("",!0)]}),_:1},8,["is-data-loading","data"])])):(l(),C("div",uo,[d[7]||(d[7]=t("img",{src:Gs,class:"!w-[23rem] flex-none"},null,-1)),t("div",po,[t("div",_o,i(O.$t("placeholder.createTable")),1),t("div",mo,i(O.$t("placeholder.createTableLabel")),1)])])),e(m)?(l(),A(ae,{key:3,visible:e(y),"onUpdate:visible":d[2]||(d[2]=Z=>re(y)?y.value=Z:null),source:e(m)},null,8,["visible","source"])):T("",!0),e(k)?(l(),A(U,{key:4,open:e(k),"onUpdate:open":d[3]||(d[3]=Z=>re(k)?k.value=Z:null),"is-modal":""},null,8,["open"])):T("",!0)])}}}),fo=Ue(vo,[["__scopeId","data-v-38f03b76"]]),bo={class:"flex items-center justify-between"},go={key:0,class:"text-gray-500 text-xs"},yo={class:"flex items-center justify-between"},ho={key:0,class:"text-gray-500 text-xs"},wo=ye({__name:"Selector",props:{role:{},roles:{},disabledRoles:{},onRoleChange:{},border:{type:Boolean,default:!0},description:{type:Boolean,default:!0},inherit:{},size:{default:"sm"},showInherit:{type:Boolean,default:!1}},setup(v){const g=v,I=Ge(g,"role"),D=Ge(g,"inherit"),f=Ge(g,"showInherit"),x=Ge(g,"description"),k=B(!1),L=B(null),J=Ge(g,"size");ha(L,()=>k.value=!1);function W(y){g.onRoleChange(y),k.value=!1}return(y,m)=>{const _=Kt,$=Pe,P=Me,q=qt,w=ts,O=Rt("e");return l(),C("div",{ref_key:"dropdownRef",ref:L,size:"lg",class:"nc-roles-selector relative flex items-center gap-3",onClick:m[0]||(m[0]=d=>k.value=!e(k))},[a(_,{border:!1,inherit:e(D)===y.role,role:e(I),size:e(J),clickable:"","data-testid":"roles",class:"flex-none"},null,8,["inherit","role","size"]),e(f)&&("isEeUI"in y?y.isEeUI:e(st))&&e(D)===y.role?(l(),A($,{key:0,class:"uppercase text-[10px] leading-4 text-gray-500",placement:"bottom"},{title:s(()=>[V(i(y.$t("tooltip.roleInheritedFromWorkspace")),1)]),default:s(()=>[V(" "+i(y.$t("objects.workspace")),1)]),_:1})):T("",!0),a(w,{value:e(I),open:e(k),"dropdown-match-select-width":!1,"dropdown-class-name":"!rounded-lg !h-fit max-w-[350px] nc-role-selector-dropdown",class:"py-1 !absolute top-0 left-0 w-20 h-full z-10 text-xs opacity-0",onChange:W},{default:s(()=>[(l(!0),C(me,null,Qe(g.disabledRoles||[],d=>(l(),A(q,{key:d,value:d,disabled:""},{default:s(()=>[t("div",{class:ve([{"w-full":e(x),"w-[200px]":!e(x)},"flex flex-col nc-role-select-dropdown gap-1"])},[t("div",bo,[a(_,{disabled:"",border:!1,inherit:e(D)===d,role:d},null,8,["inherit","role"]),d===e(I)?(l(),A(P,{key:0,icon:"check",class:"text-primary"})):T("",!0)]),e(x)?(l(),C("div",go,i(e(kt)[d]),1)):T("",!0)],2)]),_:2},1032,["value"]))),128)),(l(!0),C(me,null,Qe(g.roles,d=>nt((l(),A(q,{key:d,value:d},{default:s(()=>[t("div",{class:ve([{"w-full":e(x),"w-[200px]":!e(x)},"flex flex-col nc-role-select-dropdown gap-1"])},[t("div",yo,[a(_,{border:!1,class:ve(`nc-role-select-${d}`),inherit:e(D)===d,role:d},null,8,["class","inherit","role"]),d===e(I)?(l(),A(P,{key:0,icon:"check",class:"text-primary"})):T("",!0)]),e(x)?(l(),C("div",ho,i(e(kt)[d]),1)):T("",!0)],2)]),_:2},1032,["value"])),[[O,["c:workspace:settings:user-role-change"]]])),128))]),_:1},8,["value","open"])],512)}}}),xo=wa("orgStore",()=>{const v=B(),g=B(null);return{org:v,orgId:g,updateOrg:async f=>{},loadOrg:async()=>{}}}),$o=Ee(()=>Be(()=>import("./CUOLQtTg.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85]),import.meta.url).then(v=>v.default||v)),ko={key:0},So={class:"nc-breadcrumb px-2"},Co={class:"nc-breadcrumb-item"},Io={class:"nc-breadcrumb-item"},Do={class:"nc-breadcrumb-item active truncate capitalize"},To={class:"nc-page-header-icon flex justify-center items-center h-5 w-5"},No={"data-rec":"true",class:"capitalize"},Po={class:"nc-content-max-w h-full flex flex-col items-center gap-6 px-6 pt-6"},Oo={key:0,class:"w-full flex justify-between items-center max-w-350 gap-3"},Ro={class:"flex items-center gap-1"},jo={key:1,class:"w-full flex gap-3 items-center users-email-grid"},Ao={class:"flex flex-col flex-1 max-w-[calc(100%_-_44px)]"},Mo={class:"flex gap-3"},Eo={key:2},Bo={key:3},Lo=ye({__name:"AccessSettings",props:{baseId:{}},setup(v){const g=v,I=et(),{getBaseUsers:D,createProjectUser:f,updateProjectUser:x,removeProjectUser:k}=I,{activeProjectId:L,bases:J,basesUser:W}=fe(I),{orgRoles:y,baseRoles:m,loadRoles:_}=tt(),{sorts:$,sortDirection:P,loadSorts:q,handleGetSortedData:w,saveOrUpdate:O}=as("Project"),d=ie(()=>{var h;return(h=y.value)==null?void 0:h[xa.SUPER_ADMIN]}),Y=xo(),{orgId:G,org:H}=fe(Y),N=bt(At,B(!1)),{$api:ce}=Ae(),{t:ae}=ft(),U=Mt(async()=>{let h;return g.baseId?(await _(g.baseId),h=J.value.get(g.baseId),h||(h=await ce.base.read(g.baseId))):h=J.value.get(L.value),h}),S=B(!1),Q=B([]),ue=B(0),u=B(""),de=B(!1),K=B([]),_e=ie(()=>Q.value.filter(h=>{var z,j;return((j=(z=h.display_name)==null?void 0:z.toLowerCase())==null?void 0:j.includes(u.value.toLowerCase()))||h.email.toLowerCase().includes(u.value.toLowerCase())})),se=ie(()=>w(_e.value,$.value)),Z=async()=>{try{if(!U.value)return;const{users:h,totalRows:z}=await D({baseId:U.value.id,...u.value?{searchText:u.value}:{},force:!0});ue.value=z,Q.value=[...h.filter(j=>!(j!=null&&j.deleted)).map(j=>({...j,base_roles:j.roles,roles:j.roles??(j.workspace_roles?He[j.workspace_roles]??Re.NO_ACCESS:Re.NO_ACCESS)}))]}catch(h){ge.error(await Ne(h))}},ee=ie(()=>{var h,z;return((h=m.value)==null?void 0:h[Re.OWNER])||((z=m.value)==null?void 0:z[Re.CREATOR])}),c=async(h,z)=>{const j=Q.value.find(pe=>pe.id===h.id);try{!z||z===Re.NO_ACCESS&&!st?(await k(U.value.id,j),j.workspace_roles&&He[j.workspace_roles]===z&&st?j.roles=He[j.workspace_roles]:j.roles=Re.NO_ACCESS,j.base_roles=null):j.base_roles?(j.roles=z,await x(U.value.id,j)):(j.roles=z,j.base_roles=z,await f(U.value.id,j));let pe=W.value.get(U.value.id);pe!=null&&pe.length&&(pe=pe.map(xe=>(xe.id===j.id&&(xe.roles=j.roles),xe)),W.value.set(U.value.id,pe))}catch(pe){ge.error(await Ne(pe)),Z()}};Et(async()=>{de.value=!0;try{await Z();const h=ut.findIndex(z=>m.value&&Object.keys(m.value).includes(z));d.value?K.value=ut.slice(0):h!==-1&&(K.value=ut.slice(h)),q()}catch(h){ge.error(await Ne(h))}finally{de.value=!1}});const n=$a({}),R=h=>{_e.value.forEach(z=>{n[z.id]=h})},F=ie({get:()=>Object.values(n).every(h=>h)&&Object.keys(n).length>0&&Object.values(n).length===_e.value.length,set:h=>{R(h)}});we(S,()=>{S.value||Z()}),we(U,()=>{Z()});const le=ie({get:()=>P.value,set:h=>{if(Object.keys(h).length===0){O({});return}const[z,j]=Object.entries(h)[0];O({field:z,direction:j})}}),oe=[{key:"select",title:"",width:70,minWidth:70},{key:"email",title:ae("objects.users"),minWidth:220,dataIndex:"email",showOrderBy:!0},{key:"role",title:ae("general.role"),basis:"30%",minWidth:272,dataIndex:"roles",showOrderBy:!0},{key:"created_at",title:ae("title.dateJoined"),basis:"25%",minWidth:200}],$e=h=>({class:`${n[h.id]?"selected":""} user-row`}),ze=ie(()=>{var h;return((h=Q.value)==null?void 0:h.filter(z=>z.roles===Re.OWNER).length)===1}),ke=h=>!(ze.value&&h.roles===Re.OWNER);return(h,z)=>{var te,be;const j=Me,pe=Ha,xe=ka,Le=Ja,We=ht,Ve=yt,Se=Sa,Ce=Za,Ye=Xa,Oe=Pe,Ie=wo,p=Kt,o=Qt,M=$o;return l(),C("div",{class:ve(["nc-collaborator-table-container nc-access-settings-view flex flex-col",{"h-[calc(100vh_-_100px)]":!e(N)}])},[e(N)?(l(),C("div",ko,[t("div",So,[t("div",Co,i(e(H).title),1),a(j,{icon:"ncSlash1",class:"nc-breadcrumb-divider"}),a(pe,{href:`/admin/${e(G)}/bases`,class:"!hover:text-gray-800 !hover:underline-gray-600 flex items-center !text-gray-700 !underline-transparent max-w-1/4"},{default:s(()=>[t("div",Io,i(h.$t("objects.projects")),1)]),_:1},8,["href"]),a(j,{icon:"ncSlash1",class:"nc-breadcrumb-divider"}),t("div",Do,i((te=e(U))==null?void 0:te.title),1)]),a(Le,null,{icon:s(()=>[t("div",To,[a(xe,{readonly:""})])]),title:s(()=>{var r;return[t("span",No,i((r=e(U))==null?void 0:r.title),1)]}),_:1})])):T("",!0),t("div",Po,[e(N)?T("",!0):(l(),C("div",Oo,[a(We,{value:e(u),"onUpdate:value":z[0]||(z[0]=r=>re(u)?u.value=r:null),placeholder:h.$t("title.searchMembers"),disabled:e(de),"allow-clear":"",class:"nc-input-border-on-value !max-w-90 !h-8 !px-3 !py-1 !rounded-lg"},{prefix:s(()=>[a(j,{icon:"search",class:"mr-2 h-4 w-4 text-gray-500 group-hover:text-black"})]),_:1},8,["value","placeholder","disabled"]),a(Ve,{disabled:e(de),size:"small",onClick:z[1]||(z[1]=r=>S.value=!0)},{default:s(()=>[t("div",Ro,[(l(),A(it(("iconMap"in h?h.iconMap:e(gt)).plus),{class:"w-4 h-4"})),V(" "+i(h.$t("activity.addMembers")),1)])]),_:1},8,["disabled"])])),a(o,{"order-by":e(le),"onUpdate:orderBy":z[3]||(z[3]=r=>re(le)?le.value=r:null),"is-data-loading":e(de),columns:oe,data:e(se),bordered:!1,"custom-row":$e,class:"flex-1 nc-collaborators-list max-w-350"},{emptyText:s(()=>[a(Se,{description:h.$t("title.noMembersFound")},null,8,["description"])]),headerCell:s(({column:r})=>[r.key==="select"?(l(),A(Ce,{key:0,checked:e(F),"onUpdate:checked":z[2]||(z[2]=E=>re(F)?F.value=E:null),disabled:!e(se).length},null,8,["checked","disabled"])):(l(),C(me,{key:1},[V(i(r.title),1)],64))]),bodyCell:s(({column:r,record:E})=>[r.key==="select"?(l(),A(Ce,{key:0,checked:e(n)[E.id],"onUpdate:checked":ne=>e(n)[E.id]=ne},null,8,["checked","onUpdate:checked"])):T("",!0),r.key==="email"?(l(),C("div",jo,[a(Ye,{size:"base",email:E.email,class:"flex-none"},null,8,["email"]),t("div",Ao,[t("div",Mo,[a(Oe,{class:"truncate max-w-full text-gray-800 capitalize font-semibold","show-on-truncate-only":""},{title:s(()=>[V(i(E.display_name||E.email.slice(0,E.email.indexOf("@"))),1)]),default:s(()=>[V(" "+i(E.display_name||E.email.slice(0,E.email.indexOf("@"))),1)]),_:2},1024)]),a(Oe,{class:"truncate max-w-full text-xs text-gray-600","show-on-truncate-only":""},{title:s(()=>[V(i(E.email),1)]),default:s(()=>[V(" "+i(E.email),1)]),_:2},1024)])])):T("",!0),r.key==="role"?(l(),C("div",Eo,[ke(E)&&e(ee)&&e(K).includes(E.roles)?(l(),A(Ie,{key:0,role:E.roles,roles:e(K),inherit:("isEeUI"in h?h.isEeUI:e(st))&&E.workspace_roles&&e(He)[E.workspace_roles]?e(He)[E.workspace_roles]:null,"show-inherit":"",description:!1,"on-role-change":ne=>c(E,ne)},null,8,["role","roles","inherit","on-role-change"])):(l(),A(p,{key:1,border:!1,role:E.roles},null,8,["role"]))])):T("",!0),r.key==="created_at"?(l(),C("div",Bo,[a(Oe,{class:"max-w-full"},{title:s(()=>[V(i(("parseStringDateTime"in h?h.parseStringDateTime:e(ss))(E.created_at)),1)]),default:s(()=>[t("span",null,i(("timeAgo"in h?h.timeAgo:e(os))(E.created_at)),1)]),_:2},1024)])):T("",!0)]),_:1},8,["order-by","is-data-loading","data"])]),a(M,{"model-value":e(S),"onUpdate:modelValue":z[4]||(z[4]=r=>re(S)?S.value=r:null),"base-id":(be=e(U))==null?void 0:be.id,type:"base"},null,8,["model-value","base-id"])],2)}}}),Uo=Ue(Lo,[["__scopeId","data-v-3908ed56"]]),zo={class:"flex flex-col gap-1"},Wo={class:"flex items-center gap-3"},Vo={class:"ml-10 text-small leading-[18px] text-gray-500"},Go={class:"flex flex-col gap-1"},Fo={class:"flex items-center gap-3"},Qo=ye({__name:"SourceRestrictions",props:{allowMetaWrite:{type:Boolean},allowDataWrite:{type:Boolean}},emits:["update:allowMetaWrite","update:allowDataWrite"],setup(v,{emit:g}){const I=v,D=g,f=qe(I,"allowDataWrite",D),x=qe(I,"allowMetaWrite",D);return(k,L)=>{const J=Ht,W=Pe,y=Jt;return l(),C(me,null,[a(y,{class:"nc-source-restictions-card"},{default:s(()=>[t("div",zo,[t("div",Wo,[a(W,{disabled:!e(x),placement:"topLeft",class:"flex"},{title:s(()=>[V(i(k.$t("tooltip.dataWriteOptionDisabled")),1)]),default:s(()=>[a(J,{checked:e(f),"onUpdate:checked":L[0]||(L[0]=m=>re(f)?f.value=m:null),disabled:e(x),"data-testid":"nc-allow-data-write",size:"small"},null,8,["checked","disabled"])]),_:1},8,["disabled"]),t("span",{class:"cursor-pointer",onClick:L[1]||(L[1]=m=>e(x)?void 0:f.value=!e(f))},i(k.$t("labels.allowDataWrite")),1)]),t("div",Vo,i(k.$t("tooltip.allowDataWrite")),1)])]),_:1}),a(y,{class:"nc-source-restictions-card"},{default:s(()=>[t("div",Go,[t("div",Fo,[a(J,{checked:e(x),"onUpdate:checked":L[2]||(L[2]=m=>re(x)?x.value=m:null),"data-testid":"nc-allow-meta-write",class:"nc-allow-meta-write",size:"small"},null,8,["checked"]),t("span",{class:"cursor-pointer",onClick:L[3]||(L[3]=m=>x.value=!e(x))},i(k.$t("labels.allowMetaWrite")),1)]),t("div",{class:ve(["ml-10 text-small leading-[18px] text-gray-500",{"nc-allow-meta-write-help":e(x)}])},i(k.$t("labels.notRecommended"))+": "+i(k.$t("tooltip.allowMetaWrite")),3)])]),_:1})],64)}}}),Ko=Ue(Qo,[["__scopeId","data-v-b77d1107"]]),qo={class:"w-full flex flex-col gap-3"},Yo={class:"h-7 w-7 flex items-center justify-center"},Ho=["href"],Jo=ye({__name:"SupportedDocs",setup(v){const g=[{title:"Integrations",href:"https://docs.nocodb.com/category/integrations"},{title:"Create new connection",href:"https://docs.nocodb.com/integrations/create-connection"},{title:"Add new Data source",href:"https://docs.nocodb.com/data-sources/connect-to-data-source"}];return(I,D)=>{const f=Me;return l(),C("div",null,[t("div",qo,[D[0]||(D[0]=t("div",{class:"text-sm text-gray-800 font-semibold"},"Supported Docs",-1)),t("div",null,[(l(),C(me,null,Qe(g,(x,k)=>t("div",{key:k,class:"flex items-center gap-1"},[t("div",Yo,[a(f,{icon:"bookOpen",class:"flex-none w-4 h-4 text-gray-500"})]),t("a",{href:x.href,target:"_blank",rel:"noopener noreferrer",class:"!text-gray-600 text-sm !no-underline !hover:underline"},i(x.title),9,Ho)])),64))])])])}}}),Zo={class:"flex-1 flex flex-col max-h-full"},Xo={class:"px-4 py-3 w-full flex items-center gap-3 border-b-1 border-gray-200"},el={class:"h-6 self-start flex items-center"},tl={class:"flex items-center gap-3"},al={class:"h-[calc(100%_-_58px)] flex"},sl={class:"nc-add-source-left-panel nc-scrollbar-thin relative"},ol={class:"create-source bg-white relative flex flex-col gap-2 w-full max-w-[768px]"},ll={class:"nc-form-section"},nl={class:"nc-form-section-body"},il=["data-testid"],rl={class:"w-full flex items-center gap-2 px-2 py-2 rounded-md hover:bg-gray-100"},cl={class:"nc-form-section"},dl={class:"nc-form-section-body"},ul={class:"nc-form-section"},pl={class:"nc-form-section-body"},_l={class:"flex flex-col gap-4"},ml={class:"flex flex-col gap-4"},vl={class:"flex items-center justify-center h-full w-full !bg-white !bg-opacity-85 z-1000"},fl={class:"nc-add-source-right-panel"},bl=ye({__name:"CreateBase",props:{open:{type:Boolean},connectionType:{}},emits:["update:open","sourceCreated"],setup(v,{emit:g}){const I=v,D=g,f=qe(I,"open",D),{loadIntegrations:x,integrations:k,eventBus:L,pageMode:J,IntegrationsPageMode:W}=ns(),y=Ze(),{loadProject:m}=et(),{base:_}=fe(y),{loadProjectTables:$}=lt(),{refreshCommandPalette:P}=Bt(),q=bt(Ca,void 0),w=ie(()=>{var p;return(q==null?void 0:q.value)??((p=_.value)==null?void 0:p.id)}),O=Dt.useForm,d=B(!1),Y=B(!1),G=B(),{api:H}=Ia(),{$e:N}=Ae(),{t:ce}=ft(),{isUIAllowed:ae}=tt(),U=B(!1),S=B([]),Q=B(!1),u=B(((p=X.MYSQL)=>({title:"",dataSource:{...Ct(p)},inflection:{inflectionColumn:"none",inflectionTable:"none"},sslUse:Na.No,extraParameters:[],is_schema_readonly:!0,is_data_readonly:!1}))()),de=B(!1),K=B(0),_e=()=>{K.value+=1,K.value>=2&&(de.value=!0)},se=ie(()=>u.value.fk_integration_id&&k.value.find(p=>p.id===u.value.fk_integration_id)),Z=ie(()=>{var p,o,M;return(M=(o=(p=se.value)==null?void 0:p.config)==null?void 0:o.connection)==null?void 0:M.database}),ee=ie(()=>{var p,o,M;return(M=(o=(p=se.value)==null?void 0:p.config)==null?void 0:o.searchPath)==null?void 0:M[0]}),c=p=>Z.value,n=ie(()=>{let p={"dataSource.connection.database":se.value&&c()?[]:[at()]};switch(u.value.dataSource.client){case X.SQLITE:p={};break;case X.SNOWFLAKE:p={"dataSource.connection.database":[at()],"dataSource.connection.schema":[at()]};break;case X.PG:case X.MSSQL:p["dataSource.searchPath.0"]=se.value?[]:[at()];break}return{title:[{required:!0,message:ce("labels.sourceNameRequired")},ms()],fk_integration_id:[{required:!0,message:"Connection is required"}],extraParameters:[vs],...p}}),{validate:R,validateInfos:F,clearValidate:le}=O(u.value,n),oe=()=>{u.value.dataSource={...Ct(u.value.dataSource.client)}},$e=["camelize","none"];function ze(){const p=Object.fromEntries(new Map(u.value.extraParameters.filter(M=>{var te;return(te=M.key)==null?void 0:te.trim()}).map(M=>[M.key,M.value]))),o={...u.value.dataSource.connection,...p};return o.ssl=ds(o,u.value.sslUse,u.value.dataSource.client),o}const ke=()=>{var p,o,M,te,be;(be=(te=(M=(o=(p=G.value)==null?void 0:p.$el.querySelector(".ant-form-item-explain-error"))==null?void 0:o.parentNode)==null?void 0:M.parentNode)==null?void 0:te.querySelector("input"))==null||be.focus()},{$poller:h}=Ae(),z=async()=>{var p,o;try{await R()}catch{ke();return}try{if(!w.value)return;U.value=!0;const M=ze(),te={...u.value.dataSource,connection:M};se.value&&(((p=te.connection)==null?void 0:p.database)===""&&(te.connection.database=void 0),((o=te.searchPath)==null?void 0:o[0])===""&&(te.searchPath=void 0));const be=await H.source.create(w.value,{fk_integration_id:u.value.fk_integration_id,alias:u.value.title,type:u.value.dataSource.client,config:te,inflection_column:u.value.inflection.inflectionColumn,inflection_table:u.value.inflection.inflectionTable,is_schema_readonly:u.value.is_schema_readonly,is_data_readonly:u.value.is_data_readonly});h.subscribe({id:be.id},async r=>{var E,ne;r.status!=="close"&&(r.status===It.COMPLETED?(N("a:base:create:extdb"),w.value&&(await m(w.value,!0),await $(w.value,!0)),D("sourceCreated"),f.value=!1,U.value=!1):r.status===It.FAILED&&(ge.error(((ne=(E=r==null?void 0:r.data)==null?void 0:E.error)==null?void 0:ne.message)||"Failed to create base"),U.value=!1))})}catch(M){ge.error(await Ne(M)),U.value=!1}finally{P()}},j=B(),pe=async()=>{try{await R()}catch{ke();return}N("a:source:create:extdb:test-connection",[]);try{if(Y.value=!0,u.value.dataSource.client===X.SQLITE)d.value=!0;else{const p=ze();p.database=Pa(u.value.dataSource);let o=u.value.dataSource.searchPath;se.value&&(o==null?void 0:o[0])===""&&(o=void 0);const M={...u.value.dataSource,connection:p,searchPath:o,fk_integration_id:u.value.fk_integration_id},te=await H.utils.testConnection(M);te.code===0?d.value=!0:(d.value=!1,ge.error(`${ce("msg.error.dbConnectionFailed")} ${te.message}`))}}catch(p){d.value=!1,j.value=await Ne(p)}Y.value=!1};we(()=>u.value.dataSource,()=>{d.value=!1,j.value=null},{deep:!0}),Et(async()=>{var p;Q.value=!0,k.value.length||await x(!0,(p=_.value)==null?void 0:p.id),u.value.title=await Da(),St(()=>{setTimeout(()=>{var M,te;const o=(te=(M=G.value)==null?void 0:M.$el)==null?void 0:te.querySelector("input[type=text]");o==null||o.setSelectionRange(0,u.value.title.length),o==null||o.focus()},500)}),Q.value=!1});const xe=ie({get:()=>!u.value.is_schema_readonly,set:p=>{u.value.is_schema_readonly=!p,p&&(u.value.is_data_readonly=!1),N("c:source:schema-write-toggle",{allowed:!p,edit:!0})}}),Le=ie({get:()=>!u.value.is_data_readonly,set:p=>{u.value.is_data_readonly=!p,N("c:source:data-write-toggle",{allowed:!p})}}),We=(p=!1)=>{var o;u.value.fk_integration_id&&se.value?u.value.dataSource={client:se.value.sub_type,connection:{database:Z.value},searchPath:(o=se.value.config)==null?void 0:o.searchPath}:oe(),le(),p&&setTimeout(()=>{pe()},300)},Ve=()=>{J.value=W.LIST};L.on((p,o)=>{p===Ta.INTEGRATION_ADD&&(o!=null&&o.id)&&(u.value.fk_integration_id=o.id,Lt(()=>{var M;return((M=se.value)==null?void 0:M.id)===o.id}).toBeTruthy().then(()=>{We(!0)}))});const Se=p=>{p?(S.value=["1"],Ye(!0,"nc-source-advanced-options")):S.value=[]};let Ce;function Ye(p,o){Ce&&clearTimeout(Ce),St(()=>{const M=document.querySelector(`.create-source .${o}`);M&&(Ce=setTimeout(()=>{M.scrollIntoView({block:"center",behavior:"smooth"})},400))})}const Oe=p=>[Oa.DATABASE].includes(p.value),Ie=(p={})=>{switch(p.sub_type){case X.SQLITE:return{isDisabled:(p==null?void 0:p.source_count)&&p.source_count>0,msg:"Sqlite support only 1 database per connection"};default:return{isDisabled:!1,msg:""}}};return(p,o)=>{const M=Me,te=yt,be=Pe,r=ht,E=Jt,ne=Ra,De=ja,he=is,ct=qt,ta=gs,dt=ps,aa=Ko,sa=fs,oa=bs,la=Dt,na=rs,ia=cs,ra=Aa,ca=_s,da=Jo,ua=Zt,pa=Yt;return l(),A(pa,{visible:e(f),"onUpdate:visible":o[18]||(o[18]=b=>re(f)?f.value=b:null),closable:!1,"mask-closable":!e(U),keyboard:!e(U),centered:"",size:"large","wrap-class-name":"nc-modal-create-source",onKeydown:o[19]||(o[19]=Wt(b=>f.value=!1,["esc"]))},{default:s(()=>[t("div",Zo,[t("div",Xo,[t("div",el,[a(M,{icon:"server1",class:"!text-green-700 !h-4 !w-4"})]),o[21]||(o[21]=t("div",{class:"flex-1 text-base font-weight-700"},"Add Data Source",-1)),t("div",tl,[t("div",{class:"w-[15px] h-[15px] cursor-pointer",onDblclick:_e},null,32),a(be,{disabled:!e(j)},{title:s(()=>[V(i(e(j)),1)]),default:s(()=>[a(te,{type:"secondary",size:"small",class:ve(["nc-extdb-btn-test-connection",{"pointer-events-none":e(d)}]),disabled:!e(se)||e(Q),loading:e(Y),"icon-position":"right",onClick:o[0]||(o[0]=b=>pe())},{icon:s(()=>[e(d)?(l(),A(M,{key:0,icon:"circleCheckSolid",class:"!text-green-700 w-4 h-4"})):e(j)?(l(),A(M,{key:1,icon:"alertTriangleSolid",class:"!text-red-700 w-4 h-4"})):T("",!0)]),default:s(()=>[t("span",null,i(e(d)?"Test successful":"Test connection"),1)]),_:1},8,["class","disabled","loading"])]),_:1},8,["disabled"]),a(te,{size:"small",type:"primary",disabled:!e(d)||!e(se)||e(Q),loading:e(U),class:"nc-extdb-btn-submit",onClick:z},{default:s(()=>o[20]||(o[20]=[V(" Add Source ")])),_:1},8,["disabled","loading"]),a(te,{disabled:e(U),size:"small",type:"text",onClick:o[1]||(o[1]=b=>f.value=!1)},{default:s(()=>[a(M,{icon:"close",class:"text-gray-600"})]),_:1},8,["disabled"])])]),t("div",al,[t("div",sl,[t("div",ol,[a(la,{ref_key:"form",ref:G,model:e(u),"hide-required-mark":"",name:"external-base-create-form",layout:"vertical","no-style":"",class:"flex flex-col gap-5.5"},{default:s(()=>[t("div",ll,[t("div",nl,[a(De,{gutter:24},{default:s(()=>[a(ne,{span:12},{default:s(()=>[a(E,je({label:"Data Source Name"},e(F).title),{default:s(()=>[a(r,{value:e(u).title,"onUpdate:value":o[2]||(o[2]=b=>e(u).title=b)},null,8,["value"])]),_:1},16)]),_:1})]),_:1}),a(De,{gutter:24},{default:s(()=>[a(ne,{span:12},{default:s(()=>[a(E,je({label:"Select connection"},e(F).fk_integration_id),{default:s(()=>[a(dt,{value:e(u).fk_integration_id,"onUpdate:value":o[4]||(o[4]=b=>e(u).fk_integration_id=b),class:"nc-extdb-db-type nc-select-shadow","dropdown-class-name":"nc-dropdown-ext-db-type",placeholder:"Select connection","allow-clear":"","show-search":"","dropdown-match-select-width":"",onChange:o[5]||(o[5]=b=>We())},Ut({default:s(()=>[(l(!0),C(me,null,Qe(e(k),b=>(l(),A(ct,{key:b.id,value:b.id,disabled:Ie(b).isDisabled},{default:s(()=>[t("div",{class:"w-full flex gap-2 items-center","data-testid":b.title},[b!=null&&b.sub_type?(l(),A(he,{key:0,type:b.sub_type,style:zt({filter:Ie(b).isDisabled?"grayscale(100%) brightness(115%)":void 0})},null,8,["type","style"])):T("",!0),a(be,{class:"flex-1 truncate","show-on-truncate-only":!Ie(b).isDisabled},{title:s(()=>[V(i(Ie(b).isDisabled?Ie(b).msg:b.title),1)]),default:s(()=>[V(" "+i(b.title),1)]),_:2},1032,["show-on-truncate-only"]),e(u).fk_integration_id===b.id?(l(),A(it(("iconMap"in p?p.iconMap:e(gt)).check),{key:1,id:"nc-selected-item-icon",class:"text-primary w-4 h-4"})):T("",!0)],8,il)]),_:2},1032,["value","disabled"]))),128))]),_:2},[e(ae)("workspaceIntegrations")?{name:"dropdownRender",fn:s(({menuNode:b})=>[(l(),A(it(b))),a(ta,{style:{margin:"4px 0"}}),t("div",{class:"px-1.5 flex items-center text-brand-500 text-sm cursor-pointer",onMousedown:o[3]||(o[3]=Fe(()=>{},["prevent"])),onClick:Ve},[t("div",rl,[a(M,{icon:"plus",class:"flex-none"}),V(" "+i(p.$t("general.new"))+" "+i(p.$t("general.connection").toLowerCase()),1)])],32)]),key:"0"}:void 0]),1032,["value"])]),_:1},16)]),_:1})]),_:1})])]),e(se)?(l(),C(me,{key:0},[t("div",cl,[t("div",dl,[e(u).dataSource.client===e(X).SQLITE?(l(),C(me,{key:0},[],64)):e(u).dataSource.client===e(X).SNOWFLAKE?(l(),A(De,{key:1,gutter:24},{default:s(()=>[a(ne,{span:12},{default:s(()=>[a(E,je({label:p.$t("labels.database")},e(F)["dataSource.connection.database"]),{default:s(()=>[a(r,{value:e(u).dataSource.connection.database,"onUpdate:value":o[6]||(o[6]=b=>e(u).dataSource.connection.database=b),class:"nc-extdb-host-database"},null,8,["value"])]),_:1},16,["label"])]),_:1}),a(ne,{span:12},{default:s(()=>[a(E,je({label:"Schema"},e(F)["dataSource.connection.schema"]),{default:s(()=>[a(r,{value:e(u).dataSource.connection.schema,"onUpdate:value":o[7]||(o[7]=b=>e(u).dataSource.connection.schema=b),class:"nc-extdb-host-database"},null,8,["value"])]),_:1},16)]),_:1})]),_:1})):e(u).dataSource.client===e(X).DATABRICKS?(l(),A(De,{key:2,gutter:24},{default:s(()=>[a(ne,{span:12},{default:s(()=>[a(E,je({label:"Database"},e(F)["dataSource.connection.database"]),{default:s(()=>[a(r,{value:e(u).dataSource.connection.database,"onUpdate:value":o[8]||(o[8]=b=>e(u).dataSource.connection.database=b),class:"nc-extdb-host-database"},null,8,["value"])]),_:1},16)]),_:1}),a(ne,{span:12},{default:s(()=>[a(E,je({label:"Schema"},e(F)["dataSource.connection.schema"]),{default:s(()=>[a(r,{value:e(u).dataSource.connection.schema,"onUpdate:value":o[9]||(o[9]=b=>e(u).dataSource.connection.schema=b),class:"nc-extdb-host-schema"},null,8,["value"])]),_:1},16)]),_:1})]),_:1})):(l(),A(De,{key:3,gutter:24},{default:s(()=>[a(ne,{span:12},{default:s(()=>[a(E,je({label:p.$t("labels.database")},e(F)["dataSource.connection.database"]),{default:s(()=>[a(r,{value:e(u).dataSource.connection.database,"onUpdate:value":o[10]||(o[10]=b=>e(u).dataSource.connection.database=b),placeholder:p.$t("labels.dbCreateIfNotExists"),class:"nc-extdb-host-database"},null,8,["value","placeholder"])]),_:1},16,["label"])]),_:1}),a(ne,{span:12},{default:s(()=>{var b;return[([e(X).MSSQL,e(X).PG].includes(e(u).dataSource.client)||[e(X).MSSQL,e(X).PG].includes((b=e(se))==null?void 0:b.sub_type))&&e(u).dataSource.searchPath?(l(),A(E,je({key:0,label:p.$t("labels.schemaName")},e(F)["dataSource.searchPath.0"]),{default:s(()=>[a(r,{value:e(u).dataSource.searchPath[0],"onUpdate:value":o[11]||(o[11]=wt=>e(u).dataSource.searchPath[0]=wt),placeholder:e(ee)&&`${e(ee)} (default)`},null,8,["value","placeholder"])]),_:1},16,["label"])):T("",!0)]}),_:1})]),_:1}))])]),t("div",ul,[o[22]||(o[22]=t("div",{class:"nc-form-section-title"},"Permissions",-1)),t("div",pl,[a(aa,{allowMetaWrite:e(xe),"onUpdate:allowMetaWrite":o[12]||(o[12]=b=>re(xe)?xe.value=b:null),allowDataWrite:e(Le),"onUpdate:allowDataWrite":o[13]||(o[13]=b=>re(Le)?Le.value=b:null)},null,8,["allowMetaWrite","allowDataWrite"])])]),[e(X).SQLITE,e(X).SNOWFLAKE,e(X).DATABRICKS].includes(e(u).dataSource.client)?T("",!0):(l(),A(oa,{key:0,"active-key":e(S),"onUpdate:activeKey":o[17]||(o[17]=b=>re(S)?S.value=b:null),ghost:"",class:"nc-source-advanced-options !mt-4"},{expandIcon:s(({isActive:b})=>[a(te,{type:"text",size:"small",class:"!-ml-1.5",onClick:o[14]||(o[14]=wt=>Se(!e(S).length))},{default:s(()=>[o[23]||(o[23]=t("div",{class:"nc-form-section-title"},"Advanced options",-1)),a(M,{icon:"chevronDown",class:ve(["ml-2 flex-none cursor-pointer transform transition-transform duration-500",{"!rotate-180":b}])},null,8,["class"])]),_:2},1024)]),default:s(()=>[a(sa,{key:"1",collapsible:"disabled"},{header:s(()=>o[24]||(o[24]=[t("span",null,null,-1)])),default:s(()=>[t("div",_l,[t("div",ml,[a(De,{gutter:24},{default:s(()=>[a(ne,{span:12},{default:s(()=>[a(E,{label:p.$t("labels.inflection.tableName")},{default:s(()=>[a(dt,{value:e(u).inflection.inflectionTable,"onUpdate:value":o[15]||(o[15]=b=>e(u).inflection.inflectionTable=b),class:"nc-select-shadow","dropdown-class-name":"nc-dropdown-inflection-table-name"},{default:s(()=>[(l(),C(me,null,Qe($e,b=>a(ct,{key:b,value:b},{default:s(()=>[V(i(b),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"])]),_:1},8,["label"])]),_:1}),a(ne,{span:12},{default:s(()=>[a(E,{label:p.$t("labels.inflection.columnName")},{default:s(()=>[a(dt,{value:e(u).inflection.inflectionColumn,"onUpdate:value":o[16]||(o[16]=b=>e(u).inflection.inflectionColumn=b),class:"nc-select-shadow","dropdown-class-name":"nc-dropdown-inflection-column-name"},{default:s(()=>[(l(),C(me,null,Qe($e,b=>a(ct,{key:b,value:b},{default:s(()=>[V(i(b),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"])]),_:1},8,["label"])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["active-key"]))],64)):T("",!0),o[25]||(o[25]=t("div",null,null,-1))]),_:1},8,["model"]),a(na,{"is-modal":"","filter-category":Oe}),a(ia,{"load-datasource-info":"","base-id":e(w)},null,8,["base-id"])]),a(ca,{"model-value":e(Q),inline:"",transition:"",class:"!bg-opacity-15"},{default:s(()=>[t("div",vl,[a(ra,{size:"large"})])]),_:1},8,["model-value"])]),t("div",fl,[a(da),a(ua)])])])]),_:1},8,["visible","mask-closable","keyboard"])}}}),ea=Ue(bl,[["__scopeId","data-v-5e4a7b56"]]),gl=Object.freeze(Object.defineProperty({__proto__:null,default:ea},Symbol.toStringTag,{value:"Module"})),yl=Ee(()=>Be(()=>import("./zlXHHIY7.js"),__vite__mapDeps([86,54,1,2,47,48,9,10,12,13,14,6,15,16,17,55,56,8,57,49,22,27,58,59,24,60,61,62,63,64,65,66,67,68,36,11,69,70,20,21,23,71,72,73,74,18,19,4,5,25,26,28,29,30,31,32,33,34,35,37,38,39,40,41,42,43,3,7,44,45,46,50,51,52,53,75,76,77,78,79,80,81,82,83,84,87]),import.meta.url).then(v=>v.default||v)),hl=Ee(()=>Be(()=>import("./DwrbIntl.js"),__vite__mapDeps([88,89,1,2,66,67,4,5,6,90]),import.meta.url).then(v=>v.default||v)),wl=Ee(()=>Be(()=>import("./DP9Lt6o9.js"),__vite__mapDeps([91,1,2,92,93,56,49,22,14,27,15,6,94,95,4,5,96,12,13,16,17,97]),import.meta.url).then(v=>v.default||v)),xl=Ee(()=>Be(()=>import("./C_tK5p5w.js"),__vite__mapDeps([98,1,2,3,4,5,6,7,35,37,38,12,13,14,15,16,17]),import.meta.url).then(v=>v.default||v)),$l=Ee(()=>Be(()=>import("./CfitfHee.js"),__vite__mapDeps([99,35,1,2,37,38,80]),import.meta.url).then(v=>v.default||v)),kl={class:"flex flex-col h-full p-6","data-testid":"nc-settings-datasources-tab"},Sl={class:"mb-6 flex items-center justify-between gap-3"},Cl={class:"flex flex-row items-center w-full gap-x-1"},Il={class:"flex"},Dl={key:0,class:"h-full"},Tl={class:"px-4 pt-4 pb-2 flex items-center justify-between gap-3"},Nl={class:"capitalize text-base"},Pl={class:"tab","data-testid":"nc-connection-tab"},Ol={class:"h-full"},Rl={class:"tab","data-testid":"nc-erd-tab"},jl={class:"h-full p-6"},Al={class:"tab","data-testid":"nc-audit-tab"},Ml={class:"p-6 h-full"},El={class:"tab","data-testid":"nc-acl-tab"},Bl={class:"p-6 h-full"},Ll={class:"tab","data-testid":"nc-meta-sync-tab"},Ul={class:"p-6 h-full"},zl={key:1,class:"ds-table overflow-y-auto nc-scrollbar-thin relative max-h-full mb-4"},Wl={class:"ds-table-head sticky top-0 bg-white z-10"},Vl={class:"ds-table-row !border-0"},Gl={class:"ds-table-col ds-table-enabled cursor-pointer"},Fl={class:"ds-table-col ds-table-name"},Ql={class:"ds-table-col ds-table-integration-name"},Kl={class:"ds-table-col ds-table-type"},ql={class:"ds-table-col ds-table-actions"},Yl={class:"ds-table-body relative"},Hl={class:"ds-table-col ds-table-enabled"},Jl={key:0,class:"ds-table-handle"},Zl={class:"ds-table-col ds-table-name font-medium"},Xl={class:"flex items-center gap-1"},en={class:"ds-table-col ds-table-actions"},tn=["onClick"],an={class:"ds-table-col ds-table-enabled"},sn={class:"ds-table-col ds-table-name font-medium w-full"},on={key:0,class:"h-8 w-1"},ln={class:"ds-table-col ds-table-integration-name w-full"},nn={class:"ds-table-col ds-table-type"},rn={class:"flex justify-end"},cn={key:0,class:"flex-none integration-table-empty flex items-center justify-center py-8 px-6"},dn={class:"px-2 py-6 text-gray-500 flex flex-col items-center gap-6 text-center"},un={class:"flex items-center justify-center absolute left-0 top-0 w-full h-[calc(100%_-_45px)] z-10 pb-10 pointer-events-none"},pn={class:"flex flex-col justify-center items-center gap-2"},_n={class:"text-center"},mn={key:0,class:"flex flex-row items-center py-2 px-3.25 bg-gray-50 rounded-lg text-gray-700 mb-4"},vn={class:"capitalize text-ellipsis overflow-hidden select-none w-full pl-3",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},fn=ye({__name:"DataSources",props:{state:{},baseId:{},reload:{type:Boolean}},emits:["update:state","update:reload"],setup(v,{emit:g}){const I=v,D=g,f=qe(I,"state",D),x=qe(I,"reload",D),{$api:k,$e:L}=Ae(),J=et(),{loadProject:W}=J,{isDataSourceLimitReached:y,bases:m}=fe(J),_=ie(()=>m.value.get(I.baseId)??{}),{isUIAllowed:$}=tt(),{projectPageTab:P}=fe(Xt()),{refreshCommandPalette:q}=Bt(),w=B([]),O=B(""),d=B(X.MYSQL),Y=B(!1),G=B(!1),H=B(),N=B("");async function ce(){const c=new Set;let n=!1;for(const R of w.value){if(R.order===null||c.has(R.order)){n=!0;break}c.add(R.order)}if(n){w.value=w.value.sort((R,F)=>R.is_local||R.is_meta?-1:F.is_local||F.is_meta?1:(R.order??0)-(F.order??0)),w.value=w.value.map((R,F)=>({...R,order:F+1}));try{await Promise.all(w.value.map(async R=>{await k.source.update(R.base_id,R.id,{id:R.id,base_id:R.base_id,order:R.order})})),await W(_.value.id,!0)}catch(R){ge.error(await Ne(R))}}}async function ae(c){try{c&&q(),await Lt(()=>!!_.value.id).toBeTruthy(),Y.value=!0,x.value=!0;const n=await k.source.list(_.value.id);n.list&&n.list.length&&(w.value=n.list),await ce()}catch(n){console.error(n)}finally{x.value=!1,Y.value=!1}}const U=(c,n)=>{c&&(O.value=c,f.value=n||"")},S=c=>{L("c:source:delete"),G.value=!0,H.value=c},Q=async()=>{if(H.value)try{await k.source.delete(H.value.base_id,H.value.id),L("a:source:delete"),w.value.splice(w.value.indexOf(H.value),1),await W(_.value.id,!0)}catch(c){ge.error(await Ne(c))}finally{q()}},ue=async(c,n)=>{try{if(!n&&w.value.filter(R=>R.enabled).length<2){ge.info("There should be at least one enabled source!");return}c.enabled=n,await k.source.update(c.base_id,c.id,{id:c.id,base_id:c.base_id,enabled:c.enabled}),await W(_.value.id,!0)}catch(R){ge.error(await Ne(R))}finally{q()}},u=async c=>{var n,R;try{if(c.oldIndex===c.newIndex)return;const F=w.value[c.newIndex];if(F){let le;w.value.length-1===c.newIndex?le=Math.max(...w.value.map($e=>($e==null?void 0:$e.order)??0))+1:le=(parseFloat(String(((n=w.value[c.newIndex-1])==null?void 0:n.order)??0))+parseFloat(String(((R=w.value[c.newIndex+1])==null?void 0:R.order)??0)))/2;const oe=isNaN(Number(le))?c.oldIndex:le;await k.source.update(F.base_id,F.id,{id:F.id,base_id:F.base_id,order:oe})}await W(_.value.id,!0),await ae()}catch(F){ge.error(await Ne(F))}finally{await q()}};we(P,()=>{P.value==="data-source"&&ae()},{immediate:!0}),we(()=>I.reload,async c=>{c&&!Y.value&&await ae()}),we(f,async c=>{switch(w.value.length||await ae(),c){case X.MYSQL:d.value=X.MYSQL,f.value=Te.New;break;case X.PG:d.value=X.PG,f.value=Te.New;break;case X.SQLITE:d.value=X.SQLITE,f.value=Te.New;break;case X.MSSQL:d.value=X.MSSQL,f.value=Te.New;break;case X.SNOWFLAKE:d.value=X.SNOWFLAKE,f.value=Te.New;break;case Te.New:y.value&&(f.value="");break}q()},{immediate:!0});const de=ie({get:()=>[Te.New].includes(f.value),set:c=>{c||(f.value="")}}),K=B(null),_e=B("erd"),se=()=>{var c;return w.value.filter(n=>{var R,F,le;return(le=(R=n==null?void 0:n.alias)==null?void 0:R.toLowerCase())==null?void 0:le.includes((F=N.value)==null?void 0:F.toLowerCase())}).length||"default".includes((c=N.value)==null?void 0:c.toLowerCase())},Z=ie({get:()=>!!K.value,set:c=>{c||(K.value=null)}}),ee=(c,n)=>{n&&n!==_e.value&&(_e.value=n),K.value=c};return(c,n)=>{var be;const R=Me,F=ht,le=yt,oe=Xe,$e=Ke,ze=yl,ke=Vt,h=hl,z=wl,j=xl,pe=$l,xe=ls,Le=Yt,We=ea,Ve=Ht,Se=Pe,Ce=Ft,Ye=ys,Oe=hs,Ie=Zt,p=ws,o=xs,M=jt,te=$s;return l(),C("div",kl,[t("div",Sl,[a(F,{value:e(N),"onUpdate:value":n[0]||(n[0]=r=>re(N)?N.value=r:null),type:"text",class:"nc-search-data-source-input !max-w-90 nc-input-sm",placeholder:"Search data source","allow-clear":""},{prefix:s(()=>[a(R,{icon:"search",class:"mr-2 h-4 w-4 text-gray-500"})]),_:1},8,["value"]),!e(y)&&e($)("sourceCreate")?(l(),A(le,{key:0,size:"large",class:"z-10 !px-2",type:"primary",onClick:n[1]||(n[1]=r=>f.value=("DataSourcesSubTab"in c?c.DataSourcesSubTab:e(Te)).New)},{default:s(()=>[t("div",Cl,[(l(),A(it(("iconMap"in c?c.iconMap:e(gt)).plus))),t("div",Il,i(c.$t("activity.newSource")),1)])]),_:1})):T("",!0)]),t("div",{"data-testid":"nc-settings-datasources",class:"flex flex-row w-full nc-data-sources-view flex-grow min-h-0",style:zt({maxHeight:e(de)?"100%":e(K)?"calc(100% - 46px)":"calc(100% - 66px)"})},[a(Le,{visible:e(Z),"onUpdate:visible":n[8]||(n[8]=r=>re(Z)?Z.value=r:null),centered:"",size:"large","wrap-class-name":"nc-active-data-sources-view",onKeydown:n[9]||(n[9]=Wt(r=>K.value=null,["esc"]))},{default:s(()=>[e(K)?(l(),C("div",Dl,[t("div",Tl,[a($e,{separator:">",class:"flex-1 cursor-pointer font-weight-bold !ml-1"},{default:s(()=>[a(oe,{onClick:n[2]||(n[2]=r=>K.value=null)},{default:s(()=>n[19]||(n[19]=[t("a",{class:"!no-underline text-base"},"Data Sources",-1)])),_:1}),e(K)?(l(),A(oe,{key:0},{default:s(()=>[t("span",Nl,i(e(K).alias||"Default Source"),1)]),_:1})):T("",!0)]),_:1}),a(le,{size:"small",type:"text",class:"nc-close-btn",onClick:n[3]||(n[3]=r=>Z.value=!1)},{default:s(()=>[a(R,{icon:"close",class:"text-gray-600"})]),_:1})]),a(xe,{activeKey:e(_e),"onUpdate:activeKey":n[7]||(n[7]=r=>re(_e)?_e.value=r:null),class:"nc-source-tab w-full h-[calc(100%_-_58px)] max-h-[calc(100%_-_58px)]"},{default:s(()=>[!e(K).is_meta&&!e(K).is_local?(l(),A(ke,{key:"edit"},{tab:s(()=>[t("div",Pl,[t("div",null,i(c.$t("labels.connectionDetails")),1)])]),default:s(()=>[t("div",Ol,[a(ze,{"source-id":e(K).id,onSourceUpdated:n[4]||(n[4]=r=>ae(!0)),onClose:n[5]||(n[5]=r=>K.value=null)},null,8,["source-id"])])]),_:1})):T("",!0),a(ke,{key:"erd"},{tab:s(()=>[t("div",Rl,[t("div",null,i(c.$t("title.erdView")),1)])]),default:s(()=>[t("div",jl,[a(h,{class:"h-full overflow-auto","base-id":e(_).id,"source-id":e(K).id,"show-all-columns":!1},null,8,["base-id","source-id"])])]),_:1}),e(w)&&e(K)===e(w)[0]?(l(),A(ke,{key:"audit"},{tab:s(()=>[t("div",Al,[t("div",null,i(c.$t("title.auditLogs")),1)])]),default:s(()=>[t("div",Ml,[a(z,{"source-id":e(K).id},null,8,["source-id"])])]),_:1})):T("",!0),a(ke,{key:"acl"},{tab:s(()=>[t("div",El,[t("div",null,i(c.$t("labels.uiAcl")),1)])]),default:s(()=>[t("div",Bl,[a(j,{"source-id":e(K).id},null,8,["source-id"])])]),_:1}),!e(K).is_meta&&!e(K).is_local?(l(),A(ke,{key:"meta-sync"},{tab:s(()=>[t("div",Ll,[t("div",null,i(c.$t("labels.metaSync")),1)])]),default:s(()=>[t("div",Ul,[a(pe,{"source-id":e(K).id,onSourceSynced:n[6]||(n[6]=r=>ae(!0))},null,8,["source-id"])])]),_:1})):T("",!0)]),_:1},8,["activeKey"])])):T("",!0)]),_:1},8,["visible"]),t("div",{class:ve(["flex flex-col w-full",{"overflow-auto":!e(de)}])},[e(de)?(l(),A(We,{key:0,open:e(de),"onUpdate:open":n[10]||(n[10]=r=>re(de)?de.value=r:null),"connection-type":e(d),"is-modal":"",onSourceCreated:n[11]||(n[11]=r=>ae(!0))},null,8,["open","connection-type"])):(l(),C("div",zl,[t("div",Wl,[t("div",Vl,[t("div",Gl,i(c.$t("general.visibility")),1),t("div",Fl,i(c.$t("general.name")),1),t("div",Ql,i(c.$t("general.connection"))+" "+i(c.$t("general.name")),1),t("div",Kl,i(c.$t("general.type")),1),t("div",ql,i(c.$t("labels.actions")),1)])]),t("div",Yl,[a(e(Ss),{list:e(w),"item-key":"id",handle:".ds-table-handle",onEnd:u},Ut({item:s(({element:r,index:E})=>{var ne,De;return[E!==0?(l(),C("div",{key:0,class:ve(["ds-table-row border-gray-200 cursor-pointer",{"!hidden":!((De=(ne=r==null?void 0:r.alias)==null?void 0:ne.toLowerCase())!=null&&De.includes(e(N).toLowerCase()))}]),onClick:he=>ee(r,"edit")},[t("div",an,[t("div",{class:"flex items-center gap-1",onClick:n[16]||(n[16]=Fe(()=>{},["stop"]))},[e(w).length>2?(l(),A(R,{key:0,icon:"dragVertical",small:"",class:"ds-table-handle"})):T("",!0),a(Se,null,{title:s(()=>[r.enabled?(l(),C(me,{key:0},[V(i(c.$t("activity.hideInUI")),1)],64)):(l(),C(me,{key:1},[V(i(c.$t("activity.showInUI")),1)],64))]),default:s(()=>[a(Ve,{checked:!!r.enabled,class:"cursor-pointer",size:"small",onChange:he=>ue(r,he)},null,8,["checked","onChange"])]),_:2},1024)])]),t("div",sn,[r.is_meta||r.is_local?(l(),C("div",on,"-")):(l(),A(Se,{key:1,class:"truncate","show-on-truncate-only":""},{title:s(()=>[V(i(r.is_meta||r.is_local?c.$t("general.base"):r.alias),1)]),default:s(()=>[V(" "+i(r.is_meta||r.is_local?c.$t("general.base"):r.alias),1)]),_:2},1024))]),t("div",ln,[a(Se,{class:"truncate","show-on-truncate-only":""},{title:s(()=>[V(i((r==null?void 0:r.integration_title)||"-"),1)]),default:s(()=>[V(" "+i((r==null?void 0:r.integration_title)||"-"),1)]),_:2},1024)]),t("div",nn,[a(Ye,{rounded:"lg",class:"flex items-center gap-2 px-0 py-1 !h-7 truncate !border-transparent"},{default:s(()=>[a(Ce,{"source-type":r.type,class:"flex-none !w-4 !h-4"},null,8,["source-type"]),a(Se,{placement:"bottom","show-on-truncate-only":"",class:"text-sm truncate"},{title:s(()=>{var he;return[V(i(((he=("clientTypesMap"in c?c.clientTypesMap:e(pt))[r.type])==null?void 0:he.text)||r.type),1)]}),default:s(()=>{var he;return[V(" "+i(r.type&&("clientTypesMap"in c?c.clientTypesMap:e(pt))[r.type]?(he=("clientTypesMap"in c?c.clientTypesMap:e(pt))[r.type])==null?void 0:he.text:r.type),1)]}),_:2},1024)]),_:2},1024)]),t("div",{class:"ds-table-col justify-end gap-x-1 ds-table-actions",onClick:n[17]||(n[17]=Fe(()=>{},["stop"]))},[t("div",rn,[!r.is_meta&&!r.is_local?(l(),A(o,{key:0,placement:"bottomRight"},{overlay:s(()=>[a(p,null,{default:s(()=>[a(Oe,{onClick:he=>ee(r,"edit")},{default:s(()=>[a(R,{class:"text-gray-800",icon:"edit"}),t("span",null,i(c.$t("general.edit")),1)]),_:2},1032,["onClick"]),a(Ie),a(Oe,{class:"!text-red-500 !hover:bg-red-50",onClick:Fe(he=>S(r),["stop"])},{default:s(()=>[a(R,{icon:"delete"}),V(" "+i(c.$t("general.remove")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),default:s(()=>[a(le,{size:"small",type:"secondary"},{default:s(()=>[a(R,{icon:"threeDotVertical"})]),_:1})]),_:2},1024)):T("",!0)])])],10,tn)):T("",!0)]}),_:2},["default".includes(e(N).toLowerCase())?{name:"header",fn:s(()=>[e(w)[0]?(l(),C("div",{key:0,class:"ds-table-row border-gray-200 cursor-pointer",onClick:n[15]||(n[15]=r=>ee(e(w)[0],"erd"))},[t("div",Hl,[t("div",{class:"flex items-center gap-1",onClick:n[13]||(n[13]=Fe(()=>{},["stop"]))},[e(w).length>2?(l(),C("div",Jl)):T("",!0),a(Se,null,{title:s(()=>[e(w)[0].enabled?(l(),C(me,{key:0},[V(i(c.$t("activity.hideInUI")),1)],64)):(l(),C(me,{key:1},[V(i(c.$t("activity.showInUI")),1)],64))]),default:s(()=>[a(Ve,{checked:!!e(w)[0].enabled,class:"cursor-pointer",size:"small",onChange:n[12]||(n[12]=r=>ue(e(w)[0],r))},null,8,["checked"])]),_:1})])]),t("div",Zl,[t("div",Xl,i(c.$t("general.default")),1)]),n[20]||(n[20]=t("div",{class:"ds-table-col ds-table-integration-name"},[t("div",{class:"flex items-center gap-1"},"-")],-1)),n[21]||(n[21]=t("div",{class:"ds-table-col ds-table-type"},[t("div",{class:"flex items-center gap-1"},"-")],-1)),t("div",en,[!e(w)[0].is_meta&&!e(w)[0].is_local?(l(),A(le,{key:0,size:"small",class:"nc-action-btn nc-edit-base cursor-pointer outline-0 !w-8 !px-1 !rounded-lg",type:"text",onClick:n[14]||(n[14]=Fe(r=>U(e(w)[0].id,("DataSourcesSubTab"in c?c.DataSourcesSubTab:e(Te)).Edit),["stop"]))},{default:s(()=>[a(R,{icon:"edit",class:"text-gray-600"})]),_:1})):T("",!0)])])):T("",!0)]),key:"0"}:void 0]),1032,["list"]),!e(Y)&&((be=e(w))!=null&&be.length)&&!se()?(l(),C("div",cn,[t("div",dn,[n[22]||(n[22]=t("img",{src:ks,class:"!w-[164px] flex-none",alt:"No search results found"},null,-1)),V(" "+i(c.$t("title.noResultsMatchedYourSearch")),1)])])):T("",!0)]),nt(t("div",un,[t("div",pn,[a(M,{size:"xlarge"}),t("span",_n,i(c.$t("general.loading")),1)])],512),[[Ma,e(Y)]])])),a(te,{visible:e(G),"onUpdate:visible":n[18]||(n[18]=r=>re(G)?G.value=r:null),"entity-name":c.$t("general.datasource"),"on-delete":Q,"delete-label":c.$t("general.remove")},{"entity-preview":s(()=>[e(H)?(l(),C("div",mn,[a(Ce,{"source-type":e(H).type},null,8,["source-type"]),t("div",vn,i(e(H).alias),1)])):T("",!0)]),_:1},8,["visible","entity-name","delete-label"])],2)],4)])}}}),bn=Ue(fn,[["__scopeId","data-v-b7710592"]]),gn={class:"nc-icon",stroke:"currentColor",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},yn=t("path",{d:"M12.6667 2H3.33333C2.59695 2 2 2.59695 2 3.33333V12.6667C2 13.403 2.59695 14 3.33333 14H12.6667C13.403 14 14 13.403 14 12.6667V3.33333C14 2.59695 13.403 2 12.6667 2Z",stroke:"currentColor","stroke-width":"1.33333","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),hn=t("path",{d:"M6 14V6",stroke:"currentColor","stroke-width":"1.33333","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),wn=t("path",{d:"M2 6H14",stroke:"currentColor","stroke-width":"1.33333","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),xn=[yn,hn,wn];function $n(v,g){return l(),C("svg",gn,[...xn])}const kn={name:"nc-icons-layout",render:$n},Sn=Ee(()=>Be(()=>import("./gcvYoU2K.js"),__vite__mapDeps([100,1,2,101]),import.meta.url).then(v=>v.default||v)),Cn={class:"h-full nc-base-view"},In={class:"flex-1 flex flex-row items-center gap-x-3"},Dn={class:"flex flex-row items-center h-full gap-x-2 px-2"},Tn={class:"truncate"},Nn={class:"flex nc-base-view-tab",style:{height:"calc(100% - var(--topbar-height))"}},Pn={class:"tab-title","data-testid":"proj-view-tab__all-tables"},On={class:"tab-title","data-testid":"proj-view-tab__access-settings"},Rn={class:"tab-title","data-testid":"proj-view-tab__data-sources"},jn=ye({__name:"View",props:{baseId:{}},setup(v){const g=v,{integrations:I}=us(),D=et(),{openedProject:f,activeProjectId:x,basesUser:k,bases:L}=fe(D),{activeTables:J,activeTable:W}=fe(lt()),{activeWorkspace:y}=fe(Ea()),{navigateToProjectPage:m,isSharedBase:_}=Ze(),$=bt(At,B(!1)),q=Ba().currentRoute,{$e:w,$api:O}=Ae(),d=Mt(async()=>{let S;return g.baseId?(S=L.value.get(g.baseId),S||(S=await O.base.read(g.baseId))):S=f.value,S}),{isUIAllowed:Y,baseRoles:G}=tt(),{base:H}=fe(Ze()),{projectPageTab:N}=fe(Xt()),{isMobileMode:ce}=Gt(),ae=B(""),U=ie(()=>{var S,Q;return x.value?(Q=(S=k.value.get(x.value))==null?void 0:S.filter(ue=>!(ue!=null&&ue.deleted)))==null?void 0:Q.length:0});return we(()=>{var S;return(S=q.value.query)==null?void 0:S.page},(S,Q)=>{if(S&&S!==Q){S==="collaborator"?N.value="collaborator":S==="data-source"?N.value="data-source":N.value="allTable";return}$.value?N.value="collaborator":N.value="allTable"},{immediate:!0}),we(N,()=>{w(`a:project:view:tab-change:${N.value}`),N.value&&m({page:N.value})}),we(()=>{var S,Q;return[(S=d.value)==null?void 0:S.id,(Q=d.value)==null?void 0:Q.title]},()=>{var S,Q,ue;(S=W.value)!=null&&S.title||La(`${((Q=d.value)==null?void 0:Q.title)??((ue=y.value)==null?void 0:ue.title)??"NocoDB"}`)},{immediate:!0}),we(()=>{var S;return(S=d.value)==null?void 0:S.id},()=>{I.value=[]}),(S,Q)=>{var F,le;const ue=Fa,u=za,de=Pe,K=Qa,_e=Sn,se=fo,Z=Vt,ee=Me,c=Uo,n=bn,R=Wa;return l(),C("div",Cn,[e($)?T("",!0):(l(),C("div",{key:0,class:ve(["flex flex-row px-2 py-2 gap-3 justify-between w-full border-b-1 border-gray-200",{"nc-table-toolbar-mobile":e(ce),"h-[var(--topbar-height)]":!e(ce)}])},[t("div",In,[a(ue),t("div",Dn,[a(u,{color:("parseProp"in S?S.parseProp:e(Ua))((F=e(d))==null?void 0:F.meta).iconColor,type:(le=e(d))==null?void 0:le.type},null,8,["color","type"]),a(de,{class:"flex font-bold text-sm capitalize truncate max-w-150 text-gray-800","show-on-truncate-only":""},{title:s(()=>{var oe;return[V(i((oe=e(d))==null?void 0:oe.title),1)]}),default:s(()=>{var oe;return[t("span",Tn,i((oe=e(d))==null?void 0:oe.title),1)]}),_:1})])]),e(_)?T("",!0):(l(),A(K,{key:0})),a(_e)],2)),t("div",Nn,[a(R,{activeKey:e(N),"onUpdate:activeKey":Q[1]||(Q[1]=oe=>re(N)?N.value=oe:null),class:"w-full"},{leftExtra:s(()=>Q[2]||(Q[2]=[t("div",{class:"w-3"},null,-1)])),default:s(()=>[e($)?T("",!0):(l(),A(Z,{key:"allTable"},{tab:s(()=>[t("div",Pn,[a(e(kn)),t("div",null,i(S.$t("labels.allTables")),1),t("div",{class:ve(["tab-info",{"bg-primary-selected":e(N)==="allTable","bg-gray-50":e(N)!=="allTable"}])},i(e(J).length),3)])]),default:s(()=>[a(se)]),_:1})),e(Y)("newUser",{roles:e(G)})&&!e(_)?(l(),A(Z,{key:"collaborator"},{tab:s(()=>[t("div",On,[a(ee,{icon:"users",class:"!h-3.5 !w-3.5"}),t("div",null,i(S.$t("labels.members")),1),e(U)?(l(),C("div",{key:0,class:ve(["tab-info",{"bg-primary-selected":e(N)==="collaborator","bg-gray-50":e(N)!=="collaborator"}])},i(e(U)),3)):T("",!0)])]),default:s(()=>{var oe;return[a(c,{"base-id":(oe=e(d))==null?void 0:oe.id},null,8,["base-id"])]}),_:1})):T("",!0),e(Y)("sourceCreate")&&e(H).id?(l(),A(Z,{key:"data-source"},{tab:s(()=>{var oe;return[t("div",Rn,[a(ee,{icon:"database"}),t("div",null,i(S.$t("labels.dataSources")),1),(oe=e(H).sources)!=null&&oe.length?(l(),C("div",{key:0,class:ve(["tab-info",{"bg-primary-selected":e(N)==="data-source","bg-gray-50":e(N)!=="data-source"}])},i(e(H).sources.length),3)):T("",!0)])]}),default:s(()=>[a(n,{state:e(ae),"onUpdate:state":Q[0]||(Q[0]=oe=>re(ae)?ae.value=oe:null),"base-id":e(H).id,class:"max-h-full"},null,8,["state","base-id"])]),_:1})):T("",!0)]),_:1},8,["activeKey"])])])}}}),An=Ue(jn,[["__scopeId","data-v-f4e0418c"]]),Mn=ye({__name:"index",setup(v){const g=Ze(),{base:I,sources:D}=fe(g),{isMobileMode:f}=Gt(),{files:x,reset:k}=Va(),{$e:L}=Ae(),J=["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel.sheet.macroenabled.12","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.spreadsheet-template","text/csv","application/json","text/json"];we(x,_=>_&&W(_),{flush:"post"});function W(_){if(!_)return;const $=Array.from(_).map(P=>P);y($)}function y(_){if(!_)return;if(_.length>1)return ge.error({content:"Only one file can be imported at a time.",duration:2});let $=null;const P=J.some(q=>{const w=_[0].type===q;if(w){const O=_[0].name.split(".").pop();$=O==="csv"||O==="json"?O:"excel"}return w});if(!P)return ge.error({content:"Invalid file type",duration:2});$&&P&&m($,_[0])}function m(_,$){var d,Y,G,H,N;if(!((d=I.value)!=null&&d.id))return;L(`a:actions:import-${_}`);const P=B(!0),{close:q,vNode:w}=rt(Nt,{modelValue:P,importType:_,"onUpdate:modelValue":O,baseId:I.value.id,sourceId:(Y=D.value)==null?void 0:Y.filter(ce=>ce.enabled)[0].id});(N=(H=(G=w.value)==null?void 0:G.component)==null?void 0:H.exposed)==null||N.handleChange({file:{uid:`${_}-${$.name}-${Math.random().toString(36).substring(2)}`,name:$.name,type:$.type,status:"done",fileName:$.name,lastModified:$.lastModified,size:$.size,originFileObj:$},event:{percent:100}});function O(){P.value=!1,q(1e3),k()}}return we(()=>{var _;return(_=I.value)==null?void 0:_.id},()=>{var _;if((_=I.value)!=null&&_.id&&I.value.type==="database"){const{addTab:$}=Cs();$({id:I.value.id,title:I.value.title,type:Ga.DB,baseId:I.value.id})}}),(_,$)=>{const P=An;return e(f)?T("",!0):(l(),A(P,{key:0}))}}}),ki=Object.freeze(Object.defineProperty({__proto__:null,default:Mn},Symbol.toStringTag,{value:"Module"}));export{wo as _,Ko as a,Jo as b,ki as i,xo as u};
