const __vite__fileDeps=["./CPAoOH_N.js","./DKhUGBot.js","./entry.B8GgT5QA.css","./gyTZjA1h.js","./Cy50pBgZ.js","./Cz8K5PX4.js","./GPQ-Eg6I.js","./BQQOEPN4.js","./CUg8TjpL.js","./BOlDoh1A.js","./BpnlUwoJ.js","./CxxuE4Yq.js","./links.C8uCzV-l.css","./DFT4Rrrq.js","./RichText.M7uMQ9pA.css","./BvBAAA1q.js","./CjzcE-AP.js","./lyxpGZoZ.js","./VirtualCell.CZh3Dt_h.css","./THlkrJVo.js","./DrSobHNn.js","./DGy9VVU7.js","./DO1hNe_j.js","./boyBAVNN.js","./Ce4Hnuew.js","./Cell.DV_4HH8i.css","./BAM3UH7U.js","./DivDataCell.1yCNpUg3.css","./whrtjqtf.js","./DEmMk44y.js","./BE1_LBl_.js","./Clu_wjSJ.js","./DeleteModal.SEMJ_gSK.css","./Burj4haU.js","./BuIhGPvc.js","./SpRAMPoI.js","./B5mlyM8k.js","./u8rUVe3y.js","./DyY7ABnl.js","./BY49hpjj.js","./DEJjMRn_.js","./DgXVCOuO.js","./DKmEfV3N.js","./BtAVuBkh.js","./B6Ky1gTN.js","./SelectOptions.JaHDUZhn.css","./BuggOm2-.js","./DPW1f6my.js","./D_FwWME_.js","./CX4Cv_ut.js","./DX_5E9FR.js","./gHfFefeo.js","./B0emH2s-.js","./DDp3Vqr0.js","./DL47xb_5.js","./BMlI7u7p.js","./C9s6MY6c.js","./DNxjIm4c.js","./Switch.CEh6YzqD.css","./C9Sjn86N.js","./BkUIf4Fh.js","./G7I_n9Op.js","./CNjr3NNT.js","./Cx8Z_l6r.js","./C600yAEI.js","./Select.Ct6CicDJ.css","./B6zJhUZ3.js","./CX32jp6d.js","./EditOrAddProvider.CRN0tnY2.css","./q9dVKJar.js","./Bsv-elP3.js","./CXIEl1K6.js","./C0L-INnH.js","./DJYXGfCo.js","./Cx8swDhG.js","./MenuItem.C7h59s4s.css","./CyGutrdy.js","./Menu.CQ8GNWeI.css","./YfoePngN.js","./DOSyHa8b.js","./D-d1Vlq3.js","./BqRqK2Ui.js","./CzWiRRCe.js","./B_ChuaCH.js","./Badge.D0-UrqG9.css","./DYyLu51D.js","./BfoRuF4I.js","./splitpanes.Ckqx9aWT.css","./B9odjZZ0.js","./B6xwUs71.js","./P2GfGWnR.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{o as b,U as z,a6 as $e,q as Ee,b as x,w as _,al as Ue,am as $i,V as he,R as He,aB as Vi,a7 as Kt,Y as ce,S as F,f as zt,cO as oo,ac as Ni,ag as so,r as P,H as Ze,a as g,P as r,c as j,d as ee,Q as Ve,a2 as Jt,$ as qi,aI as ao,p as Xi,e as Yi,an as Qe,ao as ei,_ as ti,ba as ro,bL as Me,g5 as Gi,d0 as Zi,c$ as Qi,d1 as Ki,av as Bt,fG as lo,ai as ii,cP as co,g as me,W as _e,t as R,cU as V,a_ as yt,af as Ji,A as ni,h8 as ho,at as Ht,a8 as Ut,d4 as Se,d2 as Vt,dS as en,fw as tn,fH as Nt,az as uo,ht as mo,hp as st,N as fo,L as po,cB as go,fB as vo,cG as bo,fX as wo,i8 as yo,i as _o,g7 as xo,cZ as zo,aA as Ii,cN as Ro,O as Co,X as Ce,T as we,fF as Ye,aF as Ao,cd as So,fV as Mo,Z as Ie,a5 as Fe,d9 as ko,gg as Eo,aG as $o,ap as Io,dt as Fo}from"./DKhUGBot.js";import{_ as To,a as Oo}from"./Bsv-elP3.js";import Do from"./DDp3Vqr0.js";import Lo from"./DL47xb_5.js";import{_ as Wo}from"./Cx8swDhG.js";import{_ as Po}from"./CyGutrdy.js";import{_ as jo,a as Bo}from"./YfoePngN.js";import{a as Ho}from"./D-d1Vlq3.js";import{k as Uo,i as Vo}from"./Ce4Hnuew.js";import{_ as nn}from"./CzWiRRCe.js";import{_ as No}from"./B_ChuaCH.js";import{u as qo}from"./DYyLu51D.js";import{g as xt,M as on}from"./BfoRuF4I.js";import{u as Xo}from"./CXIEl1K6.js";import{a as Yo}from"./B9odjZZ0.js";import{u as Go}from"./DGy9VVU7.js";import{g as Zo,e as Qo,r as Ko}from"./P2GfGWnR.js";import{F as sn}from"./DyY7ABnl.js";import{a as Jo}from"./BMlI7u7p.js";import{u as es}from"./DrSobHNn.js";import{D as Fi}from"./BtAVuBkh.js";import"./Cz8K5PX4.js";import{I as ts}from"./GPQ-Eg6I.js";import{_ as is}from"./BkUIf4Fh.js";import{_ as ns}from"./BpnlUwoJ.js";import{_ as os}from"./BY49hpjj.js";import{_ as ss}from"./DNxjIm4c.js";function Ti(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),i.push.apply(i,o)}return i}function D(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Ti(Object(i),!0).forEach(function(o){fe(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ti(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function fe(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function as(e,t){if(e==null)return{};var i,o,s=function(l,h){if(l==null)return{};var a,u,f={},p=Object.keys(l);for(u=0;u<p.length;u++)a=p[u],h.indexOf(a)>=0||(f[a]=l[a]);return f}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(o=0;o<n.length;o++)i=n[o],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(s[i]=e[i])}return s}function Ne(e){return function(t){if(Array.isArray(t))return Ot(t)}(e)||function(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}(e)||function(t,i){if(t){if(typeof t=="string")return Ot(t,i);var o=Object.prototype.toString.call(t).slice(8,-1);if(o==="Object"&&t.constructor&&(o=t.constructor.name),o==="Map"||o==="Set")return Array.from(t);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return Ot(t,i)}}(e)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Ot(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,o=new Array(t);i<t;i++)o[i]=e[i];return o}var Oi,rs,pt,Z=(Oi=function(e){/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(){var t={}.hasOwnProperty;function i(){for(var o=[],s=0;s<arguments.length;s++){var n=arguments[s];if(n){var l=typeof n;if(l==="string"||l==="number")o.push(n);else if(Array.isArray(n)){if(n.length){var h=i.apply(null,n);h&&o.push(h)}}else if(l==="object")if(n.toString===Object.prototype.toString)for(var a in n)t.call(n,a)&&n[a]&&o.push(a);else o.push(n.toString())}}return o.join(" ")}e.exports?(i.default=i,e.exports=i):window.classNames=i})()},Oi(pt={path:rs,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(t==null&&pt.path)}},pt.exports),pt.exports),ye=function(e){return function(t,i){if(!t)return e;var o;typeof t=="string"?o=t:i=t;var s=e;return o&&(s+="__"+o),s+(i?Object.keys(i).reduce(function(n,l){var h=i[l];return h&&(n+=" "+(typeof h=="boolean"?s+"--"+l:s+"--"+l+"_"+h)),n},""):"")}};function qt(e,t,i){var o,s,n,l,h;function a(){var f=Date.now()-l;f<t&&f>=0?o=setTimeout(a,t-f):(o=null,i||(h=e.apply(n,s),n=s=null))}t==null&&(t=100);var u=function(){n=this,s=arguments,l=Date.now();var f=i&&!o;return o||(o=setTimeout(a,t)),f&&(h=e.apply(n,s),n=s=null),h};return u.clear=function(){o&&(clearTimeout(o),o=null)},u.flush=function(){o&&(h=e.apply(n,s),n=s=null,clearTimeout(o),o=null)},u}qt.debounce=qt;var Xt=qt,S=function(){return S=Object.assign||function(e){for(var t,i=1,o=arguments.length;i<o;i++)for(var s in t=arguments[i])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},S.apply(this,arguments)};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function an(e,t){var i,o;return e&&t?(i=""+e+t[0].toUpperCase()+t.slice(1),o=e+"-"+t):(i=e||t,o=e||t),{name:i,classname:o}}function rn(e){return/^blob:/.test(e)}function Di(e){return rn(e)||function(t){return/^data:/.test(t)}(e)}function Ge(e){return!!(e&&e.constructor&&e.call&&e.apply)}function Q(e){return e===void 0}function _t(e){return typeof e=="object"&&e!==null}function Yt(e,t,i){var o={};return _t(e)?(Object.keys(t).forEach(function(s){Q(e[s])?o[s]=t[s]:_t(t[s])?_t(e[s])?o[s]=Yt(e[s],t[s],i[s]):o[s]=e[s]?t[s]:i[s]:t[s]===!0||t[s]===!1?o[s]=!!e[s]:o[s]=e[s]}),o):e?t:i}function gt(e){var t=Number(e);return Number.isNaN(t)?e:t}function Li(e){return typeof(e=="number"||function(t){return typeof t=="object"&&t!==null}(e)&&toString.call(e)=="[object Number]")&&!ln(e)}function ln(e){return e!=e}function cn(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}var at=function(e,t){e===void 0&&(e={}),t===void 0&&(t={}),this.type="manipulateImage",this.move=e,this.scale=t},ls=function(e,t){t===void 0&&(t={}),this.type="resize",this.directions=e,this.params=t},oi=function(e){this.type="move",this.directions=e},cs=function(){function e(t,i,o,s,n){this.type="drag",this.nativeEvent=t,this.position=o,this.previousPosition=s,this.element=i,this.anchor=n}return e.prototype.shift=function(){var t=this,i=t.element,o=t.anchor,s=t.position;if(i){var n=i.getBoundingClientRect(),l=n.left,h=n.top;return{left:s.left-l-o.left,top:s.top-h-o.top}}return{left:0,top:0}},e}(),si={name:"DraggableElement",props:{classname:{type:String}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},mounted:function(){if(!this.$refs.draggable)throw new Error('You should add ref "draggable" to your root element to use draggable mixin');this.touches=[],this.hovered=!1},methods:{onMouseOver:function(){this.hovered||(this.hovered=!0,this.$emit("enter"))},onMouseLeave:function(){this.hovered&&!this.touches.length&&(this.hovered=!1,this.$emit("leave"))},onTouchStart:function(e){e.cancelable&&!this.disabled&&e.touches.length===1&&(this.touches=Ne(e.touches),this.hovered||(this.$emit("enter"),this.hovered=!0),e.touches.length&&this.initAnchor(this.touches.reduce(function(t,i){return{clientX:t.clientX+i.clientX/e.touches.length,clientY:t.clientY+i.clientY/e.touches.length}},{clientX:0,clientY:0})),e.preventDefault&&e.preventDefault(),e.stopPropagation())},onTouchEnd:function(){this.processEnd()},onTouchMove:function(e){this.touches.length&&(this.processMove(e,e.touches),e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation())},onMouseDown:function(e){if(!this.disabled){var t={fake:!0,clientX:e.clientX,clientY:e.clientY};this.touches=[t],this.initAnchor(t),e.stopPropagation()}},onMouseMove:function(e){this.touches.length&&(this.processMove(e,[{fake:!0,clientX:e.clientX,clientY:e.clientY}]),e.preventDefault&&e.preventDefault())},onMouseUp:function(){this.processEnd()},initAnchor:function(e){var t=this.$refs.draggable.getBoundingClientRect(),i=t.left,o=t.right,s=t.bottom,n=t.top;this.anchor={left:e.clientX-i,top:e.clientY-n,bottom:s-e.clientY,right:o-e.clientX}},processMove:function(e,t){var i=Ne(t);if(this.touches.length){if(this.touches.length===1&&i.length===1){var o=this.$refs.draggable;this.$emit("drag",new cs(e,o,{left:i[0].clientX,top:i[0].clientY},{left:this.touches[0].clientX,top:this.touches[0].clientY},this.anchor))}this.touches=i}},processEnd:function(){this.touches.length&&this.$emit("drag-end"),this.hovered&&(this.$emit("leave"),this.hovered=!1),this.touches=[]}},emits:["drag","drag-end","leave","enter"]};si.render=function(e,t,i,o,s,n){return b(),z("div",{ref:"draggable",class:i.classname,onTouchstart:t[1]||(t[1]=function(){return n.onTouchStart&&n.onTouchStart.apply(n,arguments)}),onMousedown:t[2]||(t[2]=function(){return n.onMouseDown&&n.onMouseDown.apply(n,arguments)}),onMouseover:t[3]||(t[3]=function(){return n.onMouseOver&&n.onMouseOver.apply(n,arguments)}),onMouseleave:t[4]||(t[4]=function(){return n.onMouseLeave&&n.onMouseLeave.apply(n,arguments)})},[$e(e.$slots,"default")],34)};var Dt=ye("vue-handler-wrapper"),hn={name:"HandlerWrapper",components:{DraggableElement:si},props:{horizontalPosition:{type:String},verticalPosition:{type:String},disabled:{type:Boolean,default:!1}},computed:{classes:function(){var e;if(this.horizontalPosition||this.verticalPosition){var t,i=an(this.horizontalPosition,this.verticalPosition);e=Dt((fe(t={},i.classname,!0),fe(t,"disabled",this.disabled),t))}else e=Dt({disabled:this.disabled});return{root:e,draggable:Dt("draggable")}}},emits:["leave","enter","drag","drag-end"]};hn.render=function(e,t,i,o,s,n){var l=Ee("DraggableElement");return b(),z("div",{class:n.classes.root},[x(l,{class:n.classes.draggable,onDrag:t[1]||(t[1]=function(h){return e.$emit("drag",h)}),onDragEnd:t[2]||(t[2]=function(h){return e.$emit("drag-end")}),onLeave:t[3]||(t[3]=function(h){return e.$emit("leave")}),onEnter:t[4]||(t[4]=function(h){return e.$emit("enter")})},{default:_(function(){return[$e(e.$slots,"default")]}),_:3},8,["class"])],2)};var hs=ye("vue-line-wrapper"),dn={name:"LineWrapper",components:{DraggableElement:si},props:{position:{type:String,required:!0},disabled:{type:Boolean,default:!1}},computed:{classname:function(){var e;return hs((fe(e={},this.position,!0),fe(e,"disabled",this.disabled),e))}},emits:["leave","enter","drag","drag-end"]};dn.render=function(e,t,i,o,s,n){var l=Ee("DraggableElement");return b(),z(l,{class:n.classname,onDrag:t[1]||(t[1]=function(h){return e.$emit("drag",h)}),onDragEnd:t[2]||(t[2]=function(h){return e.$emit("drag-end")}),onLeave:t[3]||(t[3]=function(h){return e.$emit("leave")}),onEnter:t[4]||(t[4]=function(h){return e.$emit("enter")})},{default:_(function(){return[$e(e.$slots,"default")]}),_:3},8,["class"])};var ze=["left","right","top","bottom"],ds=["left","right"],us=["top","bottom"],ms=["left","top"],fs=["fill-area","fit-area","stencil","none"],Wi={left:0,top:0,width:0,height:0};function Pi(e,t,i){return!(i=i||["width","height","left","top"]).some(function(o){return e[o]!==t[o]})}function Re(e){return{left:e.left,top:e.top,right:e.left+e.width,bottom:e.top+e.height}}function Ke(e,t){return{left:e.left-t.left,top:e.top-t.top}}function te(e){return{left:e.left+e.width/2,top:e.top+e.height/2}}function rt(e,t){var i={left:0,top:0,right:0,bottom:0};return ze.forEach(function(o){var s=t[o],n=Re(e)[o];i[o]=s!==void 0&&n!==void 0?o==="left"||o==="top"?Math.max(0,s-n):Math.max(0,n-s):0}),i}function xe(e,t){return{left:e.left-t.left,top:e.top-t.top,width:e.width+t.left+t.right,height:e.height+t.top+t.bottom}}function Rt(e){return{left:-e.left,top:-e.top}}function de(e,t){return S(S({},e),{left:e.left+t.left,top:e.top+t.top})}function pe(e,t,i,o){if(t!==1){if(i){var s=te(e);return{width:e.width*t,height:e.height*t,left:e.left+e.width*(1-t)/2+(i.left-s.left)*(1-t),top:e.top+e.height*(1-t)/2+(i.top-s.top)*(1-t)}}return{width:e.width*t,height:e.height*t,left:e.left+e.width*(1-t)/2,top:e.top+e.height*(1-t)/2}}return e}function L(e){return e.width/e.height}function Je(e,t){return Math.min(t.right!==void 0&&t.left!==void 0?(t.right-t.left)/e.width:1/0,t.bottom!==void 0&&t.top!==void 0?(t.bottom-t.top)/e.height:1/0)}function et(e,t){var i={left:0,top:0},o=rt(e,t);return o.left&&o.left>0?i.left=o.left:o.right&&o.right>0&&(i.left=-o.right),o.top&&o.top>0?i.top=o.top:o.bottom&&o.bottom>0&&(i.top=-o.bottom),i}function Lt(e,t){var i;return t.minimum&&e<t.minimum?i=t.minimum:t.maximum&&e>t.maximum&&(i=t.maximum),i}function un(e,t){var i=L(e),o=L(t);return t.width<1/0&&t.height<1/0?i>o?{width:t.width,height:t.width/i}:{width:t.height*i,height:t.height}:t.width<1/0?{width:t.width,height:t.width/i}:t.height<1/0?{width:t.height*i,height:t.height}:e}function mn(e,t){var i=t*Math.PI/180;return{width:Math.abs(e.width*Math.cos(i))+Math.abs(e.height*Math.sin(i)),height:Math.abs(e.width*Math.sin(i))+Math.abs(e.height*Math.cos(i))}}function Le(e,t){var i=t*Math.PI/180;return{left:e.left*Math.cos(i)-e.top*Math.sin(i),top:e.left*Math.sin(i)+e.top*Math.cos(i)}}function Ct(e,t){var i=rt(ie(e,t),t);return i.left+i.right+i.top+i.bottom?i.left+i.right>i.top+i.bottom?Math.min((e.width+i.left+i.right)/e.width,Je(e,t)):Math.min((e.height+i.top+i.bottom)/e.height,Je(e,t)):1}function ie(e,t,i){i===void 0&&(i=!1);var o=et(e,t);return de(e,i?Rt(o):o)}function Gt(e){return{width:e.right!==void 0&&e.left!==void 0?e.right-e.left:1/0,height:e.bottom!==void 0&&e.top!==void 0?e.bottom-e.top:1/0}}function ps(e,t){return S(S({},e),{minWidth:Math.min(t.width,e.minWidth),minHeight:Math.min(t.height,e.minHeight),maxWidth:Math.min(t.width,e.maxWidth),maxHeight:Math.min(t.height,e.maxHeight)})}function fn(e,t,i){i===void 0&&(i=!0);var o={};return ze.forEach(function(s){var n=e[s],l=t[s];n!==void 0&&l!==void 0?o[s]=s==="left"||s==="top"?i?Math.max(n,l):Math.min(n,l):i?Math.min(n,l):Math.max(n,l):l!==void 0?o[s]=l:n!==void 0&&(o[s]=n)}),o}function At(e,t){return fn(e,t,!0)}function ji(e){var t=e.size,i=e.aspectRatio,o=e.ignoreMinimum,s=e.sizeRestrictions;return!!((t.correctRatio||L(t)>=i.minimum&&L(t)<=i.maximum)&&t.height<=s.maxHeight&&t.width<=s.maxWidth&&t.width&&t.height&&(o||t.height>=s.minHeight&&t.width>=s.minWidth))}function Bi(e,t){return Math.pow(e.width-t.width,2)+Math.pow(e.height-t.height,2)}function ke(e){var t=e.width,i=e.height,o=e.sizeRestrictions,s={minimum:e.aspectRatio&&e.aspectRatio.minimum||0,maximum:e.aspectRatio&&e.aspectRatio.maximum||1/0},n={width:Math.max(o.minWidth,Math.min(o.maxWidth,t)),height:Math.max(o.minHeight,Math.min(o.maxHeight,i))};function l(u,f){return f===void 0&&(f=!1),u.reduce(function(p,m){return ji({size:m,aspectRatio:s,sizeRestrictions:o,ignoreMinimum:f})&&(!p||Bi(m,{width:t,height:i})<Bi(p,{width:t,height:i}))?m:p},null)}var h=[];s&&[s.minimum,s.maximum].forEach(function(u){u&&h.push({width:n.width,height:n.width/u,correctRatio:!0},{width:n.height*u,height:n.height,correctRatio:!0})}),ji({size:n,aspectRatio:s,sizeRestrictions:o})&&h.push(n);var a=l(h)||l(h,!0);return a&&{width:a.width,height:a.height}}function Zt(e){var t=e.event,i=e.coordinates,o=e.positionRestrictions,s=o===void 0?{}:o,n=de(i,t.directions);return de(n,et(n,s))}function gs(e){var t=e.coordinates,i=e.transform,o=e.imageSize,s=e.sizeRestrictions,n=e.positionRestrictions,l=e.aspectRatio,h=e.visibleArea,a=function(f,p){return Zt({coordinates:f,positionRestrictions:n,event:new oi({left:p.left-f.left,top:p.top-f.top})})},u=S({},t);return(Array.isArray(i)?i:[i]).forEach(function(f){var p={};Q((p=typeof f=="function"?f({coordinates:u,imageSize:o,visibleArea:h}):f).width)&&Q(p.height)||(u=function(m,v){var A=S(S(S({},m),ke({width:v.width,height:v.height,sizeRestrictions:s,aspectRatio:l})),{left:0,top:0});return a(A,{left:m.left,top:m.top})}(u,S(S({},u),p))),Q(p.left)&&Q(p.top)||(u=a(u,S(S({},u),p)))}),u}function vs(e){e.event;var t=e.getAreaRestrictions,i=e.boundaries,o=e.coordinates,s=e.visibleArea;e.aspectRatio;var n=e.stencilSize,l=e.sizeRestrictions,h=e.positionRestrictions;e.stencilReference;var a,u,f,p=S({},o),m=S({},s),v=S({},n);a=L(v),u=L(p),f===void 0&&(f=.001),(a===0||u===0?Math.abs(u-a)<f:Math.abs(u/a)<1+f&&Math.abs(u/a)>1-f)||(p=S(S({},p),ke({sizeRestrictions:l,width:p.width,height:p.height,aspectRatio:{minimum:L(v),maximum:L(v)}})));var A=Ct(m=pe(m,p.width*i.width/(m.width*v.width)),t({visibleArea:m,type:"resize"}));return A!==1&&(m=pe(m,A),p=pe(p,A)),m=ie(m=de(m,Ke(te(p),te(m))),t({visibleArea:m,type:"move"})),{coordinates:p=ie(p,At(Re(m),h)),visibleArea:m}}function bs(e){var t=e.event,i=e.getAreaRestrictions,o=e.boundaries,s=e.coordinates,n=e.visibleArea;e.aspectRatio,e.stencilSize,e.sizeRestrictions;var l=e.positionRestrictions;e.stencilReference;var h=S({},s),a=S({},n);if(s&&n&&t.type!=="manipulateImage"){var u={width:0,height:0};a.width,o.width,L(o)>L(h)?(u.height=.8*o.height,u.width=u.height*L(h)):(u.width=.8*o.width,u.height=u.width*L(h));var f=Ct(a=pe(a,h.width*o.width/(a.width*u.width)),i({visibleArea:a,type:"resize"}));a=pe(a,f),f!==1&&(u.height/=f,u.width/=f),a=ie(a=de(a,Ke(te(h),te(a))),i({visibleArea:a,type:"move"})),h=ie(h,At(Re(a),l))}return{coordinates:h,visibleArea:a}}function ws(e){var t=e.event,i=e.coordinates,o=e.visibleArea,s=e.getAreaRestrictions,n=S({},o),l=S({},i);if(t.type==="setCoordinates"){var h=Math.max(0,l.width-n.width),a=Math.max(0,l.height-n.height);h>a?n=pe(n,Math.min(l.width/n.width,Je(n,s({visibleArea:n,type:"resize"})))):a>h&&(n=pe(n,Math.min(l.height/n.height,Je(n,s({visibleArea:n,type:"resize"}))))),n=ie(n=de(n,Rt(et(l,Re(n)))),s({visibleArea:n,type:"move"}))}return{visibleArea:n,coordinates:l}}function ys(e){var t=e.imageSize,i=e.visibleArea,o=e.coordinates,s=i||t;return{left:(i?i.left:0)+s.width/2-o.width/2,top:(i?i.top:0)+s.height/2-o.height/2}}function _s(e){var t=e.imageSize,i=e.visibleArea,o=e.aspectRatio,s=e.sizeRestrictions,n=i||t,l=Math.min(o.maximum||1/0,Math.max(o.minimum||0,L(n))),h=n.width<n.height?{width:.8*n.width,height:.8*n.width/l}:{height:.8*n.height,width:.8*n.height*l};return ke(S(S({},h),{aspectRatio:o,sizeRestrictions:s}))}function xs(e){var t,i,o=e.imageSize,s=e.visibleArea,n=e.boundaries,l=e.aspectRatio,h=e.sizeRestrictions,a=e.stencilSize,u=s||o;return L(u)>L(n)?i=(t=a.height*u.height/n.height)*L(a):t=(i=a.width*u.width/n.width)/L(a),ke({width:i,height:t,aspectRatio:l,sizeRestrictions:h})}function zs(e){var t=e.getAreaRestrictions,i=e.coordinates,o=e.imageSize,s=L(e.boundaries);if(i){var n={height:Math.max(i.height,o.height),width:Math.max(i.width,o.width)},l=un({width:L(n)>s?n.width:n.height*s,height:L(n)>s?n.width/s:n.height},Gt(t())),h={left:i.left+i.width/2-l.width/2,top:i.top+i.height/2-l.height/2,width:l.width,height:l.height},a=rt(i,Re(S({left:0,top:0},o))),u={};return!a.left&&!a.right&&h.width<=o.width&&(u.left=0,u.right=o.width),!a.top&&!a.bottom&&h.height<=o.height&&(u.top=0,u.bottom=o.height),ie(h,u)}var f=L(o);return l={height:f>s?o.height:o.width/s,width:f>s?o.height*s:o.width},{left:o.width/2-l.width/2,top:o.height/2-l.height/2,width:l.width,height:l.height}}function vt(e,t){return fn(e,Re(t))}function Rs(e){var t=e.event,i=e.coordinates,o=e.visibleArea,s=e.sizeRestrictions,n=e.getAreaRestrictions,l=e.positionRestrictions,h=e.adjustStencil,a=t.scale,u=t.move,f=S({},o),p=S({},i),m=1,v=1,A=a.factor&&Math.abs(a.factor-1)>.001;f=de(f,{left:u.left||0,top:u.top||0});var M={stencil:{minimum:Math.max(s.minWidth?s.minWidth/p.width:0,s.minHeight?s.minHeight/p.height:0),maximum:Math.min(s.maxWidth?s.maxWidth/p.width:1/0,s.maxHeight?s.maxHeight/p.height:1/0,Je(p,l))},area:{maximum:Je(f,n({visibleArea:f,type:"resize"}))}};a.factor&&A&&(a.factor<1?(v=Math.max(a.factor,M.stencil.minimum))>1&&(v=1):a.factor>1&&(v=Math.min(a.factor,Math.min(M.area.maximum,M.stencil.maximum)))<1&&(v=1)),v&&(f=pe(f,v,a.center));var B=i.left-o.left,U=o.width+o.left-(i.width+i.left),K=i.top-o.top,se=o.height+o.top-(i.height+i.top);return f=ie(f=de(f,et(f,{left:l.left!==void 0?l.left-B*v:void 0,top:l.top!==void 0?l.top-K*v:void 0,bottom:l.bottom!==void 0?l.bottom+se*v:void 0,right:l.right!==void 0?l.right+U*v:void 0})),n({visibleArea:f,type:"move"})),p.width=p.width*v,p.height=p.height*v,p.left=f.left+B*v,p.top=f.top+K*v,p=ie(p,At(Re(f),l)),a.factor&&A&&h&&(a.factor>1?m=Math.min(M.area.maximum,a.factor)/v:a.factor<1&&(m=Math.max(p.height/f.height,p.width/f.width,a.factor/v)),m!==1&&(f=de(f=ie(f=pe(f,m,a.factor>1?a.center:te(p)),n({visibleArea:f,type:"move"})),Rt(et(p,Re(f)))))),{coordinates:p,visibleArea:f}}function Cs(e){var t=e.aspectRatio,i=e.getAreaRestrictions,o=e.coordinates,s=e.visibleArea,n=e.sizeRestrictions,l=e.positionRestrictions,h=e.imageSize,a=e.previousImageSize,u=e.angle,f=S({},o),p=S({},s),m=Le(te(S({left:0,top:0},a)),u);return(f=S(S({},ke({sizeRestrictions:n,aspectRatio:t,width:f.width,height:f.height})),Le(te(f),u))).left-=m.left-h.width/2+f.width/2,f.top-=m.top-h.height/2+f.height/2,p=pe(p,Ct(p,i({visibleArea:p,type:"resize"}))),{coordinates:f=ie(f,l),visibleArea:p=ie(p=de(p,Ke(te(f),te(o))),i({visibleArea:p,type:"move"}))}}function As(e){var t=e.flip,i=e.previousFlip,o=e.rotate,s=e.getAreaRestrictions,n=e.coordinates,l=e.visibleArea,h=e.imageSize,a=S({},n),u=S({},l),f=i.horizontal!==t.horizontal,p=i.vertical!==t.vertical;if(f||p){var m=Le({left:h.width/2,top:h.height/2},-o),v=Le(te(a),-o),A=Le({left:f?m.left-(v.left-m.left):v.left,top:p?m.top-(v.top-m.top):v.top},o);a=de(a,Ke(A,te(a))),v=Le(te(u),-o),u=ie(u=de(u,Ke(A=Le({left:f?m.left-(v.left-m.left):v.left,top:p?m.top-(v.top-m.top):v.top},o),te(u))),s({visibleArea:u,type:"move"}))}return{coordinates:a,visibleArea:u}}function Hi(e){var t=e.directions,i=e.coordinates,o=e.positionRestrictions,s=o===void 0?{}:o,n=e.sizeRestrictions,l=e.preserveRatio,h=e.compensate,a=S({},t),u=xe(i,a).width,f=xe(i,a).height;u<0&&(a.left<0&&a.right<0?(a.left=-(i.width-n.minWidth)/(a.left/a.right),a.right=-(i.width-n.minWidth)/(a.right/a.left)):a.left<0?a.left=-(i.width-n.minWidth):a.right<0&&(a.right=-(i.width-n.minWidth))),f<0&&(a.top<0&&a.bottom<0?(a.top=-(i.height-n.minHeight)/(a.top/a.bottom),a.bottom=-(i.height-n.minHeight)/(a.bottom/a.top)):a.top<0?a.top=-(i.height-n.minHeight):a.bottom<0&&(a.bottom=-(i.height-n.minHeight)));var p=rt(xe(i,a),s);h&&(p.left&&p.left>0&&p.right===0?(a.right+=p.left,a.left-=p.left):p.right&&p.right>0&&p.left===0&&(a.left+=p.right,a.right-=p.right),p.top&&p.top>0&&p.bottom===0?(a.bottom+=p.top,a.top-=p.top):p.bottom&&p.bottom>0&&p.top===0&&(a.top+=p.bottom,a.bottom-=p.bottom),p=rt(xe(i,a),s));var m={width:1/0,height:1/0,left:1/0,right:1/0,top:1/0,bottom:1/0};if(ze.forEach(function(M){var B=p[M];B&&a[M]&&(m[M]=Math.max(0,1-B/a[M]))}),l){var v=Math.min.apply(null,ze.map(function(M){return m[M]}));v!==1/0&&ze.forEach(function(M){a[M]*=v})}else ze.forEach(function(M){m[M]!==1/0&&(a[M]*=m[M])});if(u=xe(i,a).width,f=xe(i,a).height,a.right+a.left&&(u>n.maxWidth?m.width=(n.maxWidth-i.width)/(a.right+a.left):u<n.minWidth&&(m.width=(n.minWidth-i.width)/(a.right+a.left))),a.bottom+a.top&&(f>n.maxHeight?m.height=(n.maxHeight-i.height)/(a.bottom+a.top):f<n.minHeight&&(m.height=(n.minHeight-i.height)/(a.bottom+a.top))),l){var A=Math.min(m.width,m.height);A!==1/0&&ze.forEach(function(M){a[M]*=A})}else m.width!==1/0&&ds.forEach(function(M){a[M]*=m.width}),m.height!==1/0&&us.forEach(function(M){a[M]*=m.height});return a}function bt(e,t,i){return t==0&&i==0?e/2:t==0?0:i==0?e:e*Math.abs(t/(t+i))}var Ss=ye("vue-simple-handler"),Ms=ye("vue-simple-handler-wrapper"),ai={name:"SimpleHandler",components:{HandlerWrapper:hn},props:{defaultClass:{type:String},hoverClass:{type:String},wrapperClass:{type:String},horizontalPosition:{type:String},verticalPosition:{type:String},disabled:{type:Boolean,default:!1}},data:function(){return{hover:!1}},computed:{classes:function(){var e,t=(fe(e={},this.horizontalPosition,!!this.horizontalPosition),fe(e,this.verticalPosition,!!this.verticalPosition),fe(e,"".concat(this.horizontalPosition,"-").concat(this.verticalPosition),!!(this.verticalPosition&&this.horizontalPosition)),fe(e,"hover",this.hover),e);return{default:Z(Ss(t),this.defaultClass,this.hover&&this.hoverClass),wrapper:Z(Ms(t),this.wrapperClass)}}},methods:{onDrag:function(e){this.$emit("drag",e)},onEnter:function(){this.hover=!0},onLeave:function(){this.hover=!1},onDragEnd:function(){this.$emit("drag-end")}},emits:["drag","drag-end"]};ai.render=function(e,t,i,o,s,n){var l=Ee("HandlerWrapper");return b(),z(l,{class:n.classes.wrapper,"vertical-position":i.verticalPosition,"horizontal-position":i.horizontalPosition,disabled:i.disabled,onDrag:n.onDrag,onDragEnd:n.onDragEnd,onEnter:n.onEnter,onLeave:n.onLeave},{default:_(function(){return[x("div",{class:n.classes.default},null,2)]}),_:1},8,["class","vertical-position","horizontal-position","disabled","onDrag","onDragEnd","onEnter","onLeave"])};var ks=ye("vue-simple-line"),Es=ye("vue-simple-line-wrapper"),ri={name:"SimpleLine",components:{LineWrapper:dn},props:{defaultClass:{type:String},hoverClass:{type:String},wrapperClass:{type:String},position:{type:String},disabled:{type:Boolean,default:!1}},data:function(){return{hover:!1}},computed:{classes:function(){return{root:Z(ks(fe({},this.position,!0)),this.defaultClass,this.hover&&this.hoverClass),wrapper:Z(Es(fe({},this.position,!0)),this.wrapperClass)}}},methods:{onDrag:function(e){this.$emit("drag",e)},onEnter:function(){this.hover=!0},onLeave:function(){this.hover=!1},onDragEnd:function(){this.$emit("drag-end")}},emits:["drag","drag-end"]};ri.render=function(e,t,i,o,s,n){var l=Ee("LineWrapper");return b(),z(l,{class:n.classes.wrapper,position:i.position,disabled:i.disabled,onDrag:n.onDrag,onDragEnd:n.onDragEnd,onEnter:n.onEnter,onLeave:n.onLeave},{default:_(function(){return[x("div",{class:n.classes.root},null,2)]}),_:1},8,["class","position","disabled","onDrag","onDragEnd","onEnter","onLeave"])};var Wt=ye("vue-bounding-box"),$s=["east","west",null],Is=["south","north",null],pn={name:"BoundingBox",props:{width:{type:Number},height:{type:Number},transitions:{type:Object},handlers:{type:Object,default:function(){return{eastNorth:!0,north:!0,westNorth:!0,west:!0,westSouth:!0,south:!0,eastSouth:!0,east:!0}}},handlersComponent:{type:[Object,String],default:function(){return ai}},handlersClasses:{type:Object,default:function(){return{}}},handlersWrappersClasses:{type:Object,default:function(){return{}}},lines:{type:Object,default:function(){return{west:!0,north:!0,east:!0,south:!0}}},linesComponent:{type:[Object,String],default:function(){return ri}},linesClasses:{type:Object,default:function(){return{}}},linesWrappersClasses:{type:Object,default:function(){return{}}},resizable:{type:Boolean,default:!0}},data:function(){var e=[];return $s.forEach(function(t){Is.forEach(function(i){if(t!==i){var o=an(t,i),s=o.name,n=o.classname;e.push({name:s,classname:n,verticalDirection:i,horizontalDirection:t})}})}),{points:e}},computed:{style:function(){var e={};return this.width&&this.height&&(e.width="".concat(this.width,"px"),e.height="".concat(this.height,"px"),this.transitions&&this.transitions.enabled&&(e.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction))),e},classes:function(){var e=this.handlersClasses,t=this.handlersWrappersClasses,i=this.linesClasses,o=this.linesWrappersClasses;return{root:Wt(),handlers:e,handlersWrappers:t,lines:i,linesWrappers:o}},lineNodes:function(){var e=this,t=[];return this.points.forEach(function(i){i.horizontalDirection&&i.verticalDirection||!e.lines[i.name]||t.push({name:i.name,component:e.linesComponent,class:Z(e.classes.lines.default,e.classes.lines[i.name],!e.resizable&&e.classes.lines.disabled),wrapperClass:Z(e.classes.linesWrappers.default,e.classes.linesWrappers[i.name],!e.resizable&&e.classes.linesWrappers.disabled),hoverClass:e.classes.lines.hover,verticalDirection:i.verticalDirection,horizontalDirection:i.horizontalDirection,disabled:!e.resizable})}),t},handlerNodes:function(){var e=this,t=[],i=this.width,o=this.height;return this.points.forEach(function(s){if(e.handlers[s.name]){var n={name:s.name,component:e.handlersComponent,class:Z(e.classes.handlers.default,e.classes.handlers[s.name]),wrapperClass:Z(e.classes.handlersWrappers.default,e.classes.handlersWrappers[s.name]),hoverClass:e.classes.handlers.hover,verticalDirection:s.verticalDirection,horizontalDirection:s.horizontalDirection,disabled:!e.resizable};if(i&&o){var l=s.horizontalDirection,h=s.verticalDirection,a=l==="east"?i:l==="west"?0:i/2,u=h==="south"?o:h==="north"?0:o/2;n.wrapperClass=Wt("handler"),n.wrapperStyle={transform:"translate(".concat(a,"px, ").concat(u,"px)")},e.transitions&&e.transitions.enabled&&(n.wrapperStyle.transition="".concat(e.transitions.time,"ms ").concat(e.transitions.timingFunction))}else n.wrapperClass=Wt("handler",fe({},s.classname,!0));t.push(n)}}),t}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},mounted:function(){this.touches=[]},methods:{onEnd:function(){this.$emit("resize-end")},onHandlerDrag:function(e,t,i){var o,s=e.shift(),n=s.left,l=s.top,h={left:0,right:0,top:0,bottom:0};t==="west"?h.left-=n:t==="east"&&(h.right+=n),i==="north"?h.top-=l:i==="south"&&(h.bottom+=l),!i&&t?o="width":i&&!t&&(o="height"),this.resizable&&this.$emit("resize",new ls(h,{allowedDirections:{left:t==="west"||!t,right:t==="east"||!t,bottom:i==="south"||!i,top:i==="north"||!i},preserveAspectRatio:e.nativeEvent&&e.nativeEvent.shiftKey,respectDirection:o}))}},emits:["resize","resize-end"]};pn.render=function(e,t,i,o,s,n){return b(),z("div",{ref:"box",class:n.classes.root,style:n.style},[$e(e.$slots,"default"),x("div",null,[(b(!0),z(Ue,null,$i(n.lineNodes,function(l){return b(),z(he(l.component),{key:l.name,"default-class":l.class,"hover-class":l.hoverClass,"wrapper-class":l.wrapperClass,position:l.name,disabled:l.disabled,onDrag:function(h){return n.onHandlerDrag(h,l.horizontalDirection,l.verticalDirection)},onDragEnd:t[1]||(t[1]=function(h){return n.onEnd()})},null,8,["default-class","hover-class","wrapper-class","position","disabled","onDrag"])}),128))]),(b(!0),z(Ue,null,$i(n.handlerNodes,function(l){return b(),z("div",{key:l.name,style:l.wrapperStyle,class:l.wrapperClass},[(b(),z(he(l.component),{"default-class":l.class,"hover-class":l.hoverClass,"wrapper-class":l.wrapperClass,"horizontal-position":l.horizontalDirection,"vertical-position":l.verticalDirection,disabled:l.disabled,onDrag:function(h){return n.onHandlerDrag(h,l.horizontalDirection,l.verticalDirection)},onDragEnd:t[2]||(t[2]=function(h){return n.onEnd()})},null,8,["default-class","hover-class","wrapper-class","horizontal-position","vertical-position","disabled","onDrag"]))],6)}),128))],6)};var Fs=ye("vue-draggable-area"),gn={name:"DraggableArea",props:{movable:{type:Boolean,default:!0},activationDistance:{type:Number,default:20}},computed:{classnames:function(){return{default:Fs()}}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},mounted:function(){this.touches=[],this.touchStarted=!1},methods:{onTouchStart:function(e){if(e.cancelable){var t=this.movable&&e.touches.length===1;t&&(this.touches=Ne(e.touches)),(this.touchStarted||t)&&(e.preventDefault(),e.stopPropagation())}},onTouchEnd:function(){this.touchStarted=!1,this.processEnd()},onTouchMove:function(e){this.touches.length>=1&&(this.touchStarted?(this.processMove(e,e.touches),e.preventDefault(),e.stopPropagation()):cn({x:this.touches[0].clientX,y:this.touches[0].clientY},{x:e.touches[0].clientX,y:e.touches[0].clientY})>this.activationDistance&&(this.initAnchor({clientX:e.touches[0].clientX,clientY:e.touches[0].clientY}),this.touchStarted=!0))},onMouseDown:function(e){if(this.movable&&e.button===0){var t={fake:!0,clientX:e.clientX,clientY:e.clientY};this.touches=[t],this.initAnchor(t),e.stopPropagation()}},onMouseMove:function(e){this.touches.length&&(this.processMove(e,[{fake:!0,clientX:e.clientX,clientY:e.clientY}]),e.preventDefault&&e.cancelable&&e.preventDefault(),e.stopPropagation())},onMouseUp:function(){this.processEnd()},initAnchor:function(e){var t=this.$refs.container.getBoundingClientRect(),i=t.left,o=t.top;this.anchor={x:e.clientX-i,y:e.clientY-o}},processMove:function(e,t){var i=Ne(t);if(this.touches.length){var o=this.$refs.container.getBoundingClientRect(),s=o.left,n=o.top;this.touches.length===1&&i.length===1&&this.$emit("move",new oi({left:i[0].clientX-(s+this.anchor.x),top:i[0].clientY-(n+this.anchor.y)}))}},processEnd:function(){this.touches.length&&this.$emit("move-end"),this.touches=[]}},emits:["move","move-end"]};gn.render=function(e,t,i,o,s,n){return b(),z("div",{ref:"container",onTouchstart:t[1]||(t[1]=function(){return n.onTouchStart&&n.onTouchStart.apply(n,arguments)}),onMousedown:t[2]||(t[2]=function(){return n.onMouseDown&&n.onMouseDown.apply(n,arguments)})},[$e(e.$slots,"default")],544)};function Pt(e){var t,i;return{rotate:e.rotate||0,flip:{horizontal:((t=e==null?void 0:e.flip)===null||t===void 0?void 0:t.horizontal)||!1,vertical:((i=e==null?void 0:e.flip)===null||i===void 0?void 0:i.vertical)||!1}}}function Ts(e){return new Promise(function(t,i){try{if(e)if(/^data:/i.test(e))t(function(a){a=a.replace(/^data:([^;]+);base64,/gim,"");for(var u=atob(a),f=u.length,p=new ArrayBuffer(f),m=new Uint8Array(p),v=0;v<f;v++)m[v]=u.charCodeAt(v);return p}(e));else if(/^blob:/i.test(e)){var o=new FileReader;o.onload=function(a){t(a.target.result)},n=e,l=function(a){o.readAsArrayBuffer(a)},(h=new XMLHttpRequest).open("GET",n,!0),h.responseType="blob",h.onload=function(){this.status!=200&&this.status!==0||l(this.response)},h.send()}else{var s=new XMLHttpRequest;s.onreadystatechange=function(){s.readyState===4&&(s.status===200||s.status===0?t(s.response):i("Warning: could not load an image to parse its orientation"),s=null)},s.onprogress=function(){s.getResponseHeader("content-type")!=="image/jpeg"&&s.abort()},s.withCredentials=!1,s.open("GET",e,!0),s.responseType="arraybuffer",s.send(null)}else i("Error: the image is empty")}catch(a){i(a)}var n,l,h})}function vn(e){var t=e.rotate,i=e.flip,o=e.scaleX,s=e.scaleY,n="";return n+=" rotate("+t+"deg) ",n+=" scaleX("+o*(i.horizontal?-1:1)+") ",n+=" scaleY("+s*(i.vertical?-1:1)+") "}function Os(e){try{var t,i=new DataView(e),o=void 0,s=void 0,n=void 0,l=void 0;if(i.getUint8(0)===255&&i.getUint8(1)===216)for(var h=i.byteLength,a=2;a+1<h;){if(i.getUint8(a)===255&&i.getUint8(a+1)===225){n=a;break}a++}if(n&&(o=n+10,function(v,A,M){var B,U="";for(B=A,M+=A;B<M;B++)U+=String.fromCharCode(v.getUint8(B));return U}(i,n+4,4)==="Exif")){var u=i.getUint16(o);if(((s=u===18761)||u===19789)&&i.getUint16(o+2,s)===42){var f=i.getUint32(o+4,s);f>=8&&(l=o+f)}}if(l){for(var p=i.getUint16(l,s),m=0;m<p;m++)if(a=l+12*m+2,i.getUint16(a,s)===274){a+=8,t=i.getUint16(a,s),i.setUint16(a,1,s);break}}return t}catch{return null}}function Ui(e,t){var i=t.getBoundingClientRect(),o=i.left,s=i.top,n={left:0,top:0},l=0;return e.forEach(function(h){n.left+=(h.clientX-o)/e.length,n.top+=(h.clientY-s)/e.length}),e.forEach(function(h){l+=cn({x:n.left,y:n.top},{x:h.clientX-o,y:h.clientY-s})}),{centerMass:n,spread:l,count:e.length}}var bn={props:{touchMove:{type:Boolean,required:!0},mouseMove:{type:Boolean,required:!0},touchResize:{type:Boolean,required:!0},wheelResize:{type:[Boolean,Object],required:!0},eventsFilter:{type:Function,required:!1}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},created:function(){this.transforming=!1,this.debouncedProcessEnd=Xt(this.processEnd),this.touches=[]},methods:{processMove:function(e,t){if(this.touches.length){if(this.touches.length===1&&t.length===1)this.$emit("move",new at({left:this.touches[0].clientX-t[0].clientX,top:this.touches[0].clientY-t[0].clientY}));else if(this.touches.length>1&&this.touchResize){var i=Ui(t,this.$refs.container),o=this.oldGeometricProperties;o.count===i.count&&o.count>1&&this.$emit("resize",new at({left:o.centerMass.left-i.centerMass.left,top:o.centerMass.top-i.centerMass.top},{factor:o.spread/i.spread,center:i.centerMass})),this.oldGeometricProperties=i}this.touches=t}},processEnd:function(){this.transforming&&(this.transforming=!1,this.$emit("transform-end"))},processStart:function(){this.transforming=!0,this.debouncedProcessEnd.clear()},processEvent:function(e){return this.eventsFilter?this.eventsFilter(e,this.transforming)!==!1:(e.preventDefault(),e.stopPropagation(),!0)},onTouchStart:function(e){if(e.cancelable&&(this.touchMove||this.touchResize&&e.touches.length>1)&&this.processEvent(e)){var t=this.$refs.container,i=t.getBoundingClientRect(),o=i.left,s=i.top,n=i.bottom,l=i.right;this.touches=Ne(e.touches).filter(function(h){return h.clientX>o&&h.clientX<l&&h.clientY>s&&h.clientY<n}),this.oldGeometricProperties=Ui(this.touches,t)}},onTouchEnd:function(e){e.touches.length===0&&(this.touches=[],this.processEnd())},onTouchMove:function(e){var t=this;if(this.touches.length){var i=Ne(e.touches).filter(function(o){return!o.identifier||t.touches.find(function(s){return s.identifier===o.identifier})});this.processEvent(e)&&(this.processMove(e,i),this.processStart())}},onMouseDown:function(e){if(this.mouseMove&&"buttons"in e&&e.buttons===1&&this.processEvent(e)){var t={fake:!0,clientX:e.clientX,clientY:e.clientY};this.touches=[t],this.processStart()}},onMouseMove:function(e){this.touches.length&&this.processEvent(e)&&this.processMove(e,[{clientX:e.clientX,clientY:e.clientY}])},onMouseUp:function(){this.touches=[],this.processEnd()},onWheel:function(e){if(this.wheelResize&&this.processEvent(e)){var t=this.$refs.container.getBoundingClientRect(),i=t.left,o=t.top,s=1+this.wheelResize.ratio*(l=e.deltaY||e.detail||e.wheelDelta,(h=+l)==0||ln(h)?h:h>0?1:-1),n={left:e.clientX-i,top:e.clientY-o};this.$emit("resize",new at({},{factor:s,center:n})),this.touches.length||this.debouncedProcessEnd()}var l,h}},emits:["resize","move","transform-end"]};bn.render=function(e,t,i,o,s,n){return b(),z("div",{ref:"container",onTouchstart:t[1]||(t[1]=function(){return n.onTouchStart&&n.onTouchStart.apply(n,arguments)}),onMousedown:t[2]||(t[2]=function(){return n.onMouseDown&&n.onMouseDown.apply(n,arguments)}),onWheel:t[3]||(t[3]=function(){return n.onWheel&&n.onWheel.apply(n,arguments)})},[$e(e.$slots,"default")],544)};var Qt={components:{TransformableImage:bn},props:{touchMove:{type:Boolean,required:!0},mouseMove:{type:Boolean,required:!0},touchResize:{type:Boolean,required:!0},wheelResize:{type:[Boolean,Object],required:!0}},emits:["resize","move"]};Qt.render=function(e,t,i,o,s,n){var l=Ee("transformable-image");return b(),z(l,{"touch-move":i.touchMove,"touch-resize":i.touchResize,"mouse-move":i.mouseMove,"wheel-resize":i.wheelResize,onMove:t[1]||(t[1]=function(h){return e.$emit("move",h)}),onResize:t[2]||(t[2]=function(h){return e.$emit("resize",h)})},{default:_(function(){return[$e(e.$slots,"default")]}),_:3},8,["touch-move","touch-resize","mouse-move","wheel-resize"])};var wt=ye("vue-preview"),wn={props:{coordinates:{type:Object},transitions:{type:Object},image:{type:Object,default:function(){return{}}},imageClass:{type:String},width:{type:Number},height:{type:Number},fill:{type:Boolean}},data:function(){return{calculatedImageSize:{width:0,height:0},calculatedSize:{width:0,height:0}}},computed:{classes:function(){return{root:wt({fill:this.fill}),wrapper:wt("wrapper"),imageWrapper:wt("image-wrapper"),image:Z(wt("image"),this.imageClass)}},style:function(){if(this.fill)return{};var e={};return this.width&&(e.width="".concat(this.size.width,"px")),this.height&&(e.height="".concat(this.size.height,"px")),this.transitions&&this.transitions.enabled&&(e.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),e},wrapperStyle:function(){var e={width:"".concat(this.size.width,"px"),height:"".concat(this.size.height,"px"),left:"calc(50% - ".concat(this.size.width/2,"px)"),top:"calc(50% - ".concat(this.size.height/2,"px)")};return this.transitions&&this.transitions.enabled&&(e.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),e},imageStyle:function(){if(this.coordinates&&this.image){var e=this.coordinates.width/this.size.width,t=D(D({rotate:0,flip:{horizontal:!1,vertical:!1}},this.image.transforms),{},{scaleX:1/e,scaleY:1/e}),i=this.imageSize.width,o=this.imageSize.height,s=mn({width:i,height:o},t.rotate),n={width:"".concat(i,"px"),height:"".concat(o,"px"),left:"0px",top:"0px"},l={rotate:{left:(i-s.width)*t.scaleX/2,top:(o-s.height)*t.scaleY/2},scale:{left:(1-t.scaleX)*i/2,top:(1-t.scaleY)*o/2}};return n.transform=`translate(
				`.concat(-this.coordinates.left/e-l.rotate.left-l.scale.left,"px,").concat(-this.coordinates.top/e-l.rotate.top-l.scale.top,"px) ")+vn(t),this.transitions&&this.transitions.enabled&&(n.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),n}return{}},size:function(){return{width:this.width||this.calculatedSize.width,height:this.height||this.calculatedSize.height}},imageSize:function(){return{width:this.image.width||this.calculatedImageSize.width,height:this.image.height||this.calculatedImageSize.height}}},watch:{image:function(e){(e.width||e.height)&&this.onChangeImage()}},mounted:function(){var e=this;this.onChangeImage(),this.$refs.image.addEventListener("load",function(){e.refreshImage()}),window.addEventListener("resize",this.refresh),window.addEventListener("orientationchange",this.refresh)},unmounted:function(){window.removeEventListener("resize",this.refresh),window.removeEventListener("orientationchange",this.refresh)},methods:{refreshImage:function(){var e=this.$refs.image;this.calculatedImageSize.height=e.naturalHeight,this.calculatedImageSize.width=e.naturalWidth},refresh:function(){var e=this.$refs.root;this.width||(this.calculatedSize.width=e.clientWidth),this.height||(this.calculatedSize.height=e.clientHeight)},onChangeImage:function(){var e=this.$refs.image;e&&e.complete&&this.refreshImage(),this.refresh()}}};wn.render=function(e,t,i,o,s,n){return b(),z("div",{ref:"root",class:n.classes.root,style:n.style},[x("div",{ref:"wrapper",class:n.classes.wrapper,style:n.wrapperStyle},[He(x("img",{ref:"image",src:i.image&&i.image.src,class:n.classes.image,style:n.imageStyle},null,14,["src"]),[[Vi,i.image&&i.image.src]])],6)],6)};var yn={components:{Preview:wn},inheritAttrs:!1};yn.render=function(e,t,i,o,s,n){var l=Ee("preview");return b(),z(l,Kt(e.$attrs,{fill:!0}),null,16)};var jt=ye("vue-rectangle-stencil"),_n={name:"RectangleStencil",components:{StencilPreview:yn,BoundingBox:pn,DraggableArea:gn},props:{image:{type:Object},coordinates:{type:Object},stencilCoordinates:{type:Object},handlers:{type:Object},handlersComponent:{type:[Object,String],default:function(){return ai}},lines:{type:Object},linesComponent:{type:[Object,String],default:function(){return ri}},aspectRatio:{type:[Number,String]},minAspectRatio:{type:[Number,String]},maxAspectRatio:{type:[Number,String]},movable:{type:Boolean,default:!0},resizable:{type:Boolean,default:!0},transitions:{type:Object},movingClass:{type:String},resizingClass:{type:String},previewClass:{type:String},boundingBoxClass:{type:String},linesClasses:{type:Object,default:function(){return{}}},linesWrappersClasses:{type:Object,default:function(){return{}}},handlersClasses:{type:Object,default:function(){return{}}},handlersWrappersClasses:{type:Object,default:function(){return{}}}},data:function(){return{moving:!1,resizing:!1}},computed:{classes:function(){return{stencil:Z(jt({movable:this.movable,moving:this.moving,resizing:this.resizing}),this.moving&&this.movingClass,this.resizing&&this.resizingClass),preview:Z(jt("preview"),this.previewClass),boundingBox:Z(jt("bounding-box"),this.boundingBoxClass)}},style:function(){var e=this.stencilCoordinates,t=e.height,i=e.width,o=e.left,s=e.top,n={width:"".concat(i,"px"),height:"".concat(t,"px"),transform:"translate(".concat(o,"px, ").concat(s,"px)")};return this.transitions&&this.transitions.enabled&&(n.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),n}},methods:{onMove:function(e){this.$emit("move",e),this.moving=!0},onMoveEnd:function(){this.$emit("move-end"),this.moving=!1},onResize:function(e){this.$emit("resize",e),this.resizing=!0},onResizeEnd:function(){this.$emit("resize-end"),this.resizing=!1},aspectRatios:function(){return{minimum:this.aspectRatio||this.minAspectRatio,maximum:this.aspectRatio||this.maxAspectRatio}}},emits:["resize","resize-end","move","move-end"]};_n.render=function(e,t,i,o,s,n){var l=Ee("stencil-preview"),h=Ee("draggable-area"),a=Ee("bounding-box");return b(),z("div",{class:n.classes.stencil,style:n.style},[x(a,{width:i.stencilCoordinates.width,height:i.stencilCoordinates.height,transitions:i.transitions,class:n.classes.boundingBox,handlers:i.handlers,"handlers-component":i.handlersComponent,"handlers-classes":i.handlersClasses,"handlers-wrappers-classes":i.handlersWrappersClasses,lines:i.lines,"lines-component":i.linesComponent,"lines-classes":i.linesClasses,"lines-wrappers-classes":i.linesWrappersClasses,resizable:i.resizable,onResize:n.onResize,onResizeEnd:n.onResizeEnd},{default:_(function(){return[x(h,{movable:i.movable,onMove:n.onMove,onMoveEnd:n.onMoveEnd},{default:_(function(){return[x(l,{image:i.image,coordinates:i.coordinates,width:i.stencilCoordinates.width,height:i.stencilCoordinates.height,class:n.classes.preview,transitions:i.transitions},null,8,["image","coordinates","width","height","class","transitions"])]}),_:1},8,["movable","onMove","onMoveEnd"])]}),_:1},8,["width","height","transitions","class","handlers","handlers-component","handlers-classes","handlers-wrappers-classes","lines","lines-component","lines-classes","lines-wrappers-classes","resizable","onResize","onResizeEnd"])],6)};var Ds=["transitions"],Ae=ye("vue-advanced-cropper"),xn={name:"Cropper",components:{BackgroundWrapper:Qt},props:{src:{type:String,default:null},stencilComponent:{type:[Object,String],default:function(){return _n}},backgroundWrapperComponent:{type:[Object,String],default:function(){return Qt}},stencilProps:{type:Object,default:function(){return{}}},autoZoom:{type:Boolean,default:!1},imageClass:{type:String},boundariesClass:{type:String},backgroundClass:{type:String},foregroundClass:{type:String},minWidth:{type:[Number,String]},minHeight:{type:[Number,String]},maxWidth:{type:[Number,String]},maxHeight:{type:[Number,String]},debounce:{type:[Boolean,Number],default:500},transitions:{type:Boolean,default:!0},checkOrientation:{type:Boolean,default:!0},canvas:{type:[Object,Boolean],default:!0},crossOrigin:{type:[Boolean,String],default:void 0},transitionTime:{type:Number,default:300},imageRestriction:{type:String,default:"fit-area",validator:function(e){return fs.indexOf(e)!==-1}},roundResult:{type:Boolean,default:!0},defaultSize:{type:[Function,Object]},defaultPosition:{type:[Function,Object]},defaultVisibleArea:{type:[Function,Object]},defaultTransforms:{type:[Function,Object]},defaultBoundaries:{type:[Function,String],validator:function(e){return!(typeof e=="string"&&e!=="fill"&&e!=="fit")}},priority:{type:String,default:"coordinates"},stencilSize:{type:[Object,Function]},resizeImage:{type:[Boolean,Object],default:!0},moveImage:{type:[Boolean,Object],default:!0},autoZoomAlgorithm:{type:Function},resizeAlgorithm:{type:Function,default:function(e){var t=e.event,i=e.coordinates,o=e.aspectRatio,s=e.positionRestrictions,n=e.sizeRestrictions,l=S(S({},i),{right:i.left+i.width,bottom:i.top+i.height}),h=t.params||{},a=S({},t.directions),u=h.allowedDirections||{left:!0,right:!0,bottom:!0,top:!0};n.widthFrozen&&(a.left=0,a.right=0),n.heightFrozen&&(a.top=0,a.bottom=0),ze.forEach(function(w){u[w]||(a[w]=0)});var f=xe(l,a=Hi({coordinates:l,directions:a,sizeRestrictions:n,positionRestrictions:s})).width,p=xe(l,a).height,m=h.preserveRatio?L(l):Lt(f/p,o);if(m){var v=h.respectDirection;if(v||(v=l.width>=l.height||m===1?"width":"height"),v==="width"){var A=f/m-l.height;if(u.top&&u.bottom){var M=a.top,B=a.bottom;a.bottom=bt(A,B,M),a.top=bt(A,M,B)}else u.bottom?a.bottom=A:u.top?a.top=A:u.right?a.right=0:u.left&&(a.left=0)}else if(v==="height"){var U=l.width-p*m;if(u.left&&u.right){var K=a.left,se=a.right;a.left=-bt(U,K,se),a.right=-bt(U,se,K)}else u.left?a.left=-U:u.right?a.right=-U:u.top?a.top=0:u.bottom&&(a.bottom=0)}a=Hi({directions:a,coordinates:l,sizeRestrictions:n,positionRestrictions:s,preserveRatio:!0,compensate:h.compensate})}return f=xe(l,a).width,p=xe(l,a).height,(m=h.preserveRatio?L(l):Lt(f/p,o))&&Math.abs(m-f/p)>.001&&ze.forEach(function(w){u[w]||(a[w]=0)}),Zt({event:new oi({left:-a.left,top:-a.top}),coordinates:{width:i.width+a.right+a.left,height:i.height+a.top+a.bottom,left:i.left,top:i.top},positionRestrictions:s})}},moveAlgorithm:{type:Function,default:Zt},initStretcher:{type:Function,default:function(e){var t=e.stretcher,i=e.imageSize,o=L(i);t.style.width=i.width+"px",t.style.height=t.clientWidth/o+"px",t.style.width=t.clientWidth+"px"}},fitCoordinates:{type:Function,default:function(e){var t=e.visibleArea,i=e.coordinates,o=e.aspectRatio,s=e.sizeRestrictions,n=e.positionRestrictions,l=S(S({},i),ke({width:i.width,height:i.height,aspectRatio:o,sizeRestrictions:{maxWidth:t.width,maxHeight:t.height,minHeight:Math.min(t.height,s.minHeight),minWidth:Math.min(t.width,s.minWidth)}}));return l=ie(l=de(l,Ke(te(i),te(l))),At(Re(t),n))}},fitVisibleArea:{type:Function,default:function(e){var t=e.visibleArea,i=e.boundaries,o=e.getAreaRestrictions,s=e.coordinates,n=S({},t);n.height=n.width/L(i),n.top+=(t.height-n.height)/2,(s.height-n.height>0||s.width-n.width>0)&&(n=pe(n,Math.max(s.height/n.height,s.width/n.width)));var l=Rt(et(s,Re(n=pe(n,Ct(n,o({visibleArea:n,type:"resize"}))))));return n.width<s.width&&(l.left=0),n.height<s.height&&(l.top=0),n=ie(n=de(n,l),o({visibleArea:n,type:"move"}))}},areaRestrictionsAlgorithm:{type:Function,default:function(e){var t=e.visibleArea,i=e.boundaries,o=e.imageSize,s=e.imageRestriction,n=e.type,l={};return s==="fill-area"?l={left:0,top:0,right:o.width,bottom:o.height}:s==="fit-area"&&(L(i)>L(o)?(l={top:0,bottom:o.height},t&&n==="move"&&(t.width>o.width?(l.left=-(t.width-o.width)/2,l.right=o.width-l.left):(l.left=0,l.right=o.width))):(l={left:0,right:o.width},t&&n==="move"&&(t.height>o.height?(l.top=-(t.height-o.height)/2,l.bottom=o.height-l.top):(l.top=0,l.bottom=o.height)))),l}},sizeRestrictionsAlgorithm:{type:Function,default:function(e){return{minWidth:e.minWidth,minHeight:e.minHeight,maxWidth:e.maxWidth,maxHeight:e.maxHeight}}},positionRestrictionsAlgorithm:{type:Function,default:function(e){var t=e.imageSize,i={};return e.imageRestriction!=="none"&&(i={left:0,top:0,right:t.width,bottom:t.height}),i}}},data:function(){return{transitionsActive:!1,imageLoaded:!1,imageAttributes:{width:null,height:null,crossOrigin:null,src:null},defaultImageTransforms:{rotate:0,flip:{horizontal:!1,vertical:!1}},appliedImageTransforms:{rotate:0,flip:{horizontal:!1,vertical:!1}},boundaries:{width:0,height:0},visibleArea:null,coordinates:D({},Wi)}},computed:{image:function(){return{src:this.imageAttributes.src,width:this.imageAttributes.width,height:this.imageAttributes.height,transforms:this.imageTransforms}},imageTransforms:function(){return{rotate:this.appliedImageTransforms.rotate,flip:{horizontal:this.appliedImageTransforms.flip.horizontal,vertical:this.appliedImageTransforms.flip.vertical},translateX:this.visibleArea?this.visibleArea.left/this.coefficient:0,translateY:this.visibleArea?this.visibleArea.top/this.coefficient:0,scaleX:1/this.coefficient,scaleY:1/this.coefficient}},imageSize:function(){var e=function(t){return t*Math.PI/180}(this.imageTransforms.rotate);return{width:Math.abs(this.imageAttributes.width*Math.cos(e))+Math.abs(this.imageAttributes.height*Math.sin(e)),height:Math.abs(this.imageAttributes.width*Math.sin(e))+Math.abs(this.imageAttributes.height*Math.cos(e))}},initialized:function(){return!!(this.visibleArea&&this.imageLoaded)},settings:function(){var e=Yt(this.resizeImage,{touch:!0,wheel:{ratio:.1},adjustStencil:!0},{touch:!1,wheel:!1,adjustStencil:!1});return{moveImage:Yt(this.moveImage,{touch:!0,mouse:!0},{touch:!1,mouse:!1}),resizeImage:e}},coefficient:function(){return this.visibleArea?this.visibleArea.width/this.boundaries.width:0},areaRestrictions:function(){return this.imageLoaded?this.areaRestrictionsAlgorithm({imageSize:this.imageSize,imageRestriction:this.imageRestriction,boundaries:this.boundaries}):{}},transitionsOptions:function(){return{enabled:this.transitionsActive,timingFunction:"ease-in-out",time:350}},sizeRestrictions:function(){if(this.boundaries.width&&this.boundaries.height&&this.imageSize.width&&this.imageSize.height){var e=this.sizeRestrictionsAlgorithm({imageSize:this.imageSize,minWidth:Q(this.minWidth)?0:gt(this.minWidth),minHeight:Q(this.minHeight)?0:gt(this.minHeight),maxWidth:Q(this.maxWidth)?1/0:gt(this.maxWidth),maxHeight:Q(this.maxHeight)?1/0:gt(this.maxHeight)});if(e=function(o){var s=o.areaRestrictions,n=o.sizeRestrictions,l=o.boundaries,h=o.positionRestrictions,a=S(S({},n),{minWidth:n.minWidth!==void 0?n.minWidth:0,minHeight:n.minHeight!==void 0?n.minHeight:0,maxWidth:n.maxWidth!==void 0?n.maxWidth:1/0,maxHeight:n.maxHeight!==void 0?n.maxHeight:1/0});h.left!==void 0&&h.right!==void 0&&(a.maxWidth=Math.min(a.maxWidth,h.right-h.left)),h.bottom!==void 0&&h.top!==void 0&&(a.maxHeight=Math.min(a.maxHeight,h.bottom-h.top));var u=Gt(s),f=un(l,u);return u.width<1/0&&(!a.maxWidth||a.maxWidth>f.width)&&(a.maxWidth=Math.min(a.maxWidth,f.width)),u.height<1/0&&(!a.maxHeight||a.maxHeight>f.height)&&(a.maxHeight=Math.min(a.maxHeight,f.height)),a.minWidth>a.maxWidth&&(a.minWidth=a.maxWidth,a.widthFrozen=!0),a.minHeight>a.maxHeight&&(a.minHeight=a.maxHeight,a.heightFrozen=!0),a}({sizeRestrictions:e,areaRestrictions:this.getAreaRestrictions({visibleArea:this.visibleArea,type:"resize"}),imageSize:this.imageSize,boundaries:this.boundaries,positionRestrictions:this.positionRestrictions,imageRestriction:this.imageRestriction,visibleArea:this.visibleArea,stencilSize:this.getStencilSize()}),this.visibleArea&&this.stencilSize){var t=this.getStencilSize(),i=Gt(this.getAreaRestrictions({visibleArea:this.visibleArea,type:"resize"}));e.maxWidth=Math.min(e.maxWidth,i.width*t.width/this.boundaries.width),e.maxHeight=Math.min(e.maxHeight,i.height*t.height/this.boundaries.height),e.maxWidth<e.minWidth&&(e.minWidth=e.maxWidth),e.maxHeight<e.minHeight&&(e.minHeight=e.maxHeight)}return e}return{minWidth:0,minHeight:0,maxWidth:0,maxHeight:0}},positionRestrictions:function(){return this.positionRestrictionsAlgorithm({imageSize:this.imageSize,imageRestriction:this.imageRestriction})},classes:function(){return{cropper:Ae(),image:Z(Ae("image"),this.imageClass),stencil:Ae("stencil"),boundaries:Z(Ae("boundaries"),this.boundariesClass),stretcher:Z(Ae("stretcher")),background:Z(Ae("background"),this.backgroundClass),foreground:Z(Ae("foreground"),this.foregroundClass),imageWrapper:Z(Ae("image-wrapper")),cropperWrapper:Z(Ae("cropper-wrapper"))}},stencilCoordinates:function(){if(this.initialized){var e=this.coordinates,t=e.width,i=e.height,o=e.left,s=e.top;return{width:t/this.coefficient,height:i/this.coefficient,left:(o-this.visibleArea.left)/this.coefficient,top:(s-this.visibleArea.top)/this.coefficient}}return this.defaultCoordinates()},boundariesStyle:function(){var e={width:this.boundaries.width?"".concat(Math.round(this.boundaries.width),"px"):"auto",height:this.boundaries.height?"".concat(Math.round(this.boundaries.height),"px"):"auto",transition:"opacity ".concat(this.transitionTime,"ms"),pointerEvents:this.imageLoaded?"all":"none"};return this.imageLoaded||(e.opacity="0"),e},imageStyle:function(){var e=this.imageAttributes.width>this.imageAttributes.height?{width:Math.min(1024,this.imageAttributes.width),height:Math.min(1024,this.imageAttributes.width)/(this.imageAttributes.width/this.imageAttributes.height)}:{height:Math.min(1024,this.imageAttributes.height),width:Math.min(1024,this.imageAttributes.height)*(this.imageAttributes.width/this.imageAttributes.height)},t={left:(e.width-this.imageSize.width)/(2*this.coefficient),top:(e.height-this.imageSize.height)/(2*this.coefficient)},i={left:(1-1/this.coefficient)*e.width/2,top:(1-1/this.coefficient)*e.height/2},o=D(D({},this.imageTransforms),{},{scaleX:this.imageTransforms.scaleX*(this.imageAttributes.width/e.width),scaleY:this.imageTransforms.scaleY*(this.imageAttributes.height/e.height)}),s={width:"".concat(e.width,"px"),height:"".concat(e.height,"px"),left:"0px",top:"0px",transform:"translate(".concat(-t.left-i.left-this.imageTransforms.translateX,"px, ").concat(-t.top-i.top-this.imageTransforms.translateY,"px)")+vn(o)};return this.transitionsOptions.enabled&&(s.transition="".concat(this.transitionsOptions.time,"ms ").concat(this.transitionsOptions.timingFunction)),s}},watch:{src:function(){this.onChangeImage()},stencilComponent:function(){var e=this;this.$nextTick(function(){e.resetCoordinates(),e.runAutoZoom("setCoordinates"),e.onChange()})},minWidth:function(){this.onPropsChange()},maxWidth:function(){this.onPropsChange()},minHeight:function(){this.onPropsChange()},maxHeight:function(){this.onPropsChange()},imageRestriction:function(){this.reset()},stencilProps:function(e,t){["aspectRatio","minAspectRatio","maxAspectRatio"].find(function(i){return e[i]!==t[i]})&&this.$nextTick(this.onPropsChange)}},created:function(){this.debouncedUpdate=Xt(this.update,this.debounce),this.debouncedDisableTransitions=Xt(this.disableTransitions,this.transitionsOptions.time),this.awaiting=!1},mounted:function(){this.$refs.image.addEventListener("load",this.onSuccessLoadImage),this.$refs.image.addEventListener("error",this.onFailLoadImage),this.onChangeImage(),window.addEventListener("resize",this.refresh),window.addEventListener("orientationchange",this.refresh)},unmounted:function(){window.removeEventListener("resize",this.refresh),window.removeEventListener("orientationchange",this.refresh),this.imageAttributes.revoke&&this.imageAttributes.src&&URL.revokeObjectURL(this.imageAttributes.src),this.debouncedUpdate.clear(),this.debouncedDisableTransitions.clear()},methods:{getResult:function(){var e=this.initialized?this.prepareResult(D({},this.coordinates)):this.defaultCoordinates(),t={rotate:this.imageTransforms.rotate%360,flip:D({},this.imageTransforms.flip)};if(this.src&&this.imageLoaded){var i=this;return{image:this.image,coordinates:e,visibleArea:this.visibleArea?D({},this.visibleArea):null,imageTransforms:t,get canvas(){return i.canvas?i.getCanvas():void 0}}}return{image:this.image,coordinates:e,visibleArea:this.visibleArea?D({},this.visibleArea):null,canvas:void 0,imageTransforms:t}},zoom:function(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=i.transitions,s=o===void 0||o;this.onManipulateImage(new at({},{factor:1/e,center:t}),{normalize:!1,transitions:s})},move:function(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=i.transitions,s=o===void 0||o;this.onManipulateImage(new at({left:e||0,top:t||0}),{normalize:!1,transitions:s})},setCoordinates:function(e){var t=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=i.autoZoom,s=o===void 0||o,n=i.transitions,l=n===void 0||n;this.$nextTick(function(){t.imageLoaded?(t.transitionsActive||(l&&t.enableTransitions(),t.coordinates=t.applyTransform(e),s&&t.runAutoZoom("setCoordinates"),l&&t.debouncedDisableTransitions()),t.onChange()):t.delayedTransforms=e})},refresh:function(){var e=this,t=this.$refs.image;if(this.src&&t)return this.initialized?this.updateVisibleArea().then(function(){e.onChange()}):this.resetVisibleArea().then(function(){e.onChange()})},reset:function(){var e=this;return this.resetVisibleArea().then(function(){e.onChange(!1)})},awaitRender:function(e){var t=this;this.awaiting||(this.awaiting=!0,this.$nextTick(function(){e(),t.awaiting=!1}))},prepareResult:function(e){return this.roundResult?function(t){var i=t.coordinates,o=t.sizeRestrictions,s=t.positionRestrictions,n={width:Math.round(i.width),height:Math.round(i.height),left:Math.round(i.left),top:Math.round(i.top)};return n.width>o.maxWidth?n.width=Math.floor(i.width):n.width<o.minWidth&&(n.width=Math.ceil(i.width)),n.height>o.maxHeight?n.height=Math.floor(i.height):n.height<o.minHeight&&(n.height=Math.ceil(i.height)),ie(n,s)}(D(D({},this.getPublicProperties()),{},{positionRestrictions:vt(this.positionRestrictions,this.visibleArea),coordinates:e})):e},processAutoZoom:function(e,t,i,o){var s=this.autoZoomAlgorithm;s||(s=this.stencilSize?vs:this.autoZoom?bs:ws);var n=s({event:{type:e,params:o},visibleArea:t,coordinates:i,boundaries:this.boundaries,aspectRatio:this.getAspectRatio(),positionRestrictions:this.positionRestrictions,getAreaRestrictions:this.getAreaRestrictions,sizeRestrictions:this.sizeRestrictions,stencilSize:this.getStencilSize()});return D(D({},n),{},{changed:!Pi(n.visibleArea,t)||!Pi(n.coordinates,i)})},runAutoZoom:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=t.transitions,o=i!==void 0&&i,s=as(t,Ds),n=this.processAutoZoom(e,this.visibleArea,this.coordinates,s),l=n.visibleArea,h=n.coordinates,a=n.changed;o&&a&&this.enableTransitions(),this.visibleArea=l,this.coordinates=h,o&&a&&this.debouncedDisableTransitions()},normalizeEvent:function(e){return function(t){var i=t.event,o=t.visibleArea,s=t.coefficient;if(i.type==="manipulateImage")return S(S({},i),{move:{left:i.move&&i.move.left?s*i.move.left:0,top:i.move&&i.move.top?s*i.move.top:0},scale:{factor:i.scale&&i.scale.factor?i.scale.factor:1,center:i.scale&&i.scale.center?{left:i.scale.center.left*s+o.left,top:i.scale.center.top*s+o.top}:null}});if(i.type==="resize"){var n=S(S({},i),{directions:S({},i.directions)});return ze.forEach(function(h){n.directions[h]*=s}),n}if(i.type==="move"){var l=S(S({},i),{directions:S({},i.directions)});return ms.forEach(function(h){l.directions[h]*=s}),l}return i}(D(D({},this.getPublicProperties()),{},{event:e}))},getCanvas:function(){if(this.$refs.canvas){var e=this.$refs.canvas,t=this.$refs.image,i=this.imageTransforms.rotate!==0||this.imageTransforms.flip.horizontal||this.imageTransforms.flip.vertical?function(h,a,u){var f=u.rotate,p=u.flip,m={width:a.naturalWidth,height:a.naturalHeight},v=mn(m,f),A=h.getContext("2d");h.height=v.height,h.width=v.width,A.save();var M=Le(te(S({left:0,top:0},m)),f);return A.translate(-(M.left-v.width/2),-(M.top-v.height/2)),A.rotate(f*Math.PI/180),A.translate(p.horizontal?m.width:0,p.vertical?m.height:0),A.scale(p.horizontal?-1:1,p.vertical?-1:1),A.drawImage(a,0,0,m.width,m.height),A.restore(),h}(this.$refs.sourceCanvas,t,this.imageTransforms):t,o=D({minWidth:0,minHeight:0,maxWidth:1/0,maxHeight:1/0,maxArea:this.maxCanvasSize,imageSmoothingEnabled:!0,imageSmoothingQuality:"high",fillColor:"transparent"},this.canvas),s=function(h){return h.find(function(a){return u=a,!Number.isNaN(parseFloat(u))&&isFinite(u);var u})},n=ke({sizeRestrictions:{minWidth:s([o.width,o.minWidth])||0,minHeight:s([o.height,o.minHeight])||0,maxWidth:s([o.width,o.maxWidth])||1/0,maxHeight:s([o.height,o.maxHeight])||1/0},width:this.coordinates.width,height:this.coordinates.height,aspectRatio:{minimum:this.coordinates.width/this.coordinates.height,maximum:this.coordinates.width/this.coordinates.height}});if(o.maxArea&&n.width*n.height>o.maxArea){var l=Math.sqrt(o.maxArea/(n.width*n.height));n={width:Math.round(l*n.width),height:Math.round(l*n.height)}}return function(h,a,u,f,p){h.width=f?f.width:u.width,h.height=f?f.height:u.height;var m=h.getContext("2d");m.clearRect(0,0,h.width,h.height),p&&(p.imageSmoothingEnabled&&(m.imageSmoothingEnabled=p.imageSmoothingEnabled),p.imageSmoothingQuality&&(m.imageSmoothingQuality=p.imageSmoothingQuality),p.fillColor&&(m.fillStyle=p.fillColor,m.fillRect(0,0,h.width,h.height),m.save()));var v=u.left<0?-u.left:0,A=u.top<0?-u.top:0;m.drawImage(a,u.left+v,u.top+A,u.width,u.height,v,A,h.width,h.height)}(e,i,this.coordinates,n,o),e}},update:function(){this.$emit("change",this.getResult())},applyTransform:function(e){var t=arguments.length>1&&arguments[1]!==void 0&&arguments[1],i=this.visibleArea&&t?ps(this.sizeRestrictions,this.visibleArea):this.sizeRestrictions,o=this.visibleArea&&t?vt(this.positionRestrictions,this.visibleArea):this.positionRestrictions;return gs({transform:e,coordinates:this.coordinates,imageSize:this.imageSize,sizeRestrictions:i,positionRestrictions:o,aspectRatio:this.getAspectRatio(),visibleArea:this.visibleArea})},resetCoordinates:function(){var e=this;if(this.$refs.image){this.$refs.cropper,this.$refs.image;var t=this.defaultSize;t||(t=this.stencilSize?xs:_s);var i=this.sizeRestrictions;i.minWidth,i.minHeight,i.maxWidth,i.maxHeight;var o=Ge(t)?t({boundaries:this.boundaries,imageSize:this.imageSize,aspectRatio:this.getAspectRatio(),sizeRestrictions:this.sizeRestrictions,stencilSize:this.getStencilSize(),visibleArea:this.visibleArea}):t,s=this.defaultPosition||ys,n=[o,function(l){var h=l.coordinates;return D({},Ge(s)?s({coordinates:h,imageSize:e.imageSize,visibleArea:e.visibleArea}):e.defaultPosition)}];this.delayedTransforms&&n.push.apply(n,Ne(Array.isArray(this.delayedTransforms)?this.delayedTransforms:[this.delayedTransforms])),this.coordinates=this.applyTransform(n,!0),this.delayedTransforms=null}},clearImage:function(){var e=this;this.imageLoaded=!1,setTimeout(function(){var t=e.$refs.stretcher;t&&(t.style.height="auto",t.style.width="auto"),e.coordinates=e.defaultCoordinates(),e.boundaries={width:0,height:0}},this.transitionTime)},enableTransitions:function(){this.transitions&&(this.transitionsActive=!0)},disableTransitions:function(){this.transitionsActive=!1},updateBoundaries:function(){var e=this,t=this.$refs.stretcher,i=this.$refs.cropper;return this.initStretcher({cropper:i,stretcher:t,imageSize:this.imageSize}),this.$nextTick().then(function(){var o={cropper:i,imageSize:e.imageSize};if(Ge(e.defaultBoundaries)?e.boundaries=e.defaultBoundaries(o):e.defaultBoundaries==="fit"?e.boundaries=function(s){var n=s.cropper,l=s.imageSize,h=n.clientHeight,a=n.clientWidth,u=h,f=l.width*h/l.height;return f>a&&(f=a,u=l.height*a/l.width),{width:f,height:u}}(o):e.boundaries=function(s){var n=s.cropper;return{width:n.clientWidth,height:n.clientHeight}}(o),!e.boundaries.width||!e.boundaries.height)throw new Error("It's impossible to fit the cropper in the current container")})},resetVisibleArea:function(){var e=this;return this.appliedImageTransforms=D(D({},this.defaultImageTransforms),{},{flip:D({},this.defaultImageTransforms.flip)}),this.updateBoundaries().then(function(){e.priority!=="visible-area"&&(e.visibleArea=null,e.resetCoordinates());var t,i,o,s,n,l,h=e.defaultVisibleArea||zs;e.visibleArea=Ge(h)?h({imageSize:e.imageSize,boundaries:e.boundaries,coordinates:e.priority!=="visible-area"?e.coordinates:null,getAreaRestrictions:e.getAreaRestrictions,stencilSize:e.getStencilSize()}):e.defaultVisibleArea,e.visibleArea=(t={visibleArea:e.visibleArea,boundaries:e.boundaries,getAreaRestrictions:e.getAreaRestrictions},i=t.visibleArea,o=t.boundaries,s=t.getAreaRestrictions,n=S({},i),l=L(o),n.width/n.height!==l&&(n.height=n.width/l),ie(n,s({visibleArea:n,type:"move"}))),e.priority==="visible-area"?e.resetCoordinates():e.coordinates=e.fitCoordinates({visibleArea:e.visibleArea,coordinates:e.coordinates,aspectRatio:e.getAspectRatio(),positionRestrictions:e.positionRestrictions,sizeRestrictions:e.sizeRestrictions}),e.runAutoZoom("resetVisibleArea")}).catch(function(){e.visibleArea=null})},updateVisibleArea:function(){var e=this;return this.updateBoundaries().then(function(){e.visibleArea=e.fitVisibleArea({imageSize:e.imageSize,boundaries:e.boundaries,visibleArea:e.visibleArea,coordinates:e.coordinates,getAreaRestrictions:e.getAreaRestrictions}),e.coordinates=e.fitCoordinates({visibleArea:e.visibleArea,coordinates:e.coordinates,aspectRatio:e.getAspectRatio(),positionRestrictions:e.positionRestrictions,sizeRestrictions:e.sizeRestrictions}),e.runAutoZoom("updateVisibleArea")}).catch(function(){e.visibleArea=null})},onChange:function(){var e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];e&&this.debounce?this.debouncedUpdate():this.update()},onChangeImage:function(){var e,t=this;if(this.imageLoaded=!1,this.delayedTransforms=null,this.src){if(function(s){if(Di(s))return!1;var n=window.location,l=/(\w+:)?(?:\/\/)([\w.-]+)?(?::(\d+))?\/?/.exec(s)||[],h={protocol:l[1]||"",host:l[2]||"",port:l[3]||""},a=function(u){return u.port||((u.protocol||n.protocol)==="http"?80:433)};return!(!h.protocol&&!h.host&&!h.port||h.protocol&&h.protocol==n.protocol&&h.host&&h.host==n.host&&h.host&&a(h)==a(n))}(this.src)){var i=Q(this.crossOrigin)?this.canvas:this.crossOrigin;i===!0&&(i="anonymous"),this.imageAttributes.crossOrigin=i||null}if(this.checkOrientation){var o=(e=this.src,new Promise(function(s){Ts(e).then(function(n){var l=Os(n);s(n?{source:e,arrayBuffer:n,orientation:l}:{source:e,arrayBuffer:null,orientation:null})}).catch(function(n){console.warn(n),s({source:e,arrayBuffer:null,orientation:null})})}));setTimeout(function(){o.then(t.onParseImage)},this.transitionTime)}else setTimeout(function(){t.onParseImage({source:t.src})},this.transitionTime)}else this.clearImage()},onFailLoadImage:function(){this.imageAttributes.src&&(this.clearImage(),this.$emit("error"))},onSuccessLoadImage:function(){var e=this,t=this.$refs.image;t&&!this.imageLoaded&&(this.imageAttributes.height=t.naturalHeight,this.imageAttributes.width=t.naturalWidth,this.imageLoaded=!0,this.resetVisibleArea().then(function(){e.$emit("ready"),e.onChange(!1)}))},onParseImage:function(e){var t=this,i=e.source,o=e.arrayBuffer,s=e.orientation;this.imageAttributes.revoke&&this.imageAttributes.src&&URL.revokeObjectURL(this.imageAttributes.src),this.imageAttributes.revoke=!1,o&&s&&s>1?rn(i)||!Di(i)?(this.imageAttributes.src=URL.createObjectURL(new Blob([o])),this.imageAttributes.revoke=!0):this.imageAttributes.src=function(n){for(var l=[],h=new Uint8Array(n);h.length>0;){var a=h.subarray(0,8192);l.push(String.fromCharCode.apply(null,Array.from?Array.from(a):a.slice())),h=h.subarray(8192)}return"data:image/jpeg;base64,"+btoa(l.join(""))}(o):this.imageAttributes.src=i,Ge(this.defaultTransforms)?this.appliedImageTransforms=Pt(this.defaultTransforms()):_t(this.defaultTransforms)?this.appliedImageTransforms=Pt(this.defaultTransforms):this.appliedImageTransforms=function(n){var l=Pt({});if(n)switch(n){case 2:l.flip.horizontal=!0;break;case 3:l.rotate=-180;break;case 4:l.flip.vertical=!0;break;case 5:l.rotate=90,l.flip.vertical=!0;break;case 6:l.rotate=90;break;case 7:l.rotate=90,l.flip.horizontal=!0;break;case 8:l.rotate=-90}return l}(s),this.defaultImageTransforms=D(D({},this.appliedImageTransforms),{},{flip:D({},this.appliedImageTransforms.flip)}),this.$nextTick(function(){var n=t.$refs.image;n&&n.complete&&(function(l){return!!l.naturalWidth}(n)?t.onSuccessLoadImage():t.onFailLoadImage())})},onResizeEnd:function(){this.runAutoZoom("resize",{transitions:!0})},onMoveEnd:function(){this.runAutoZoom("move",{transitions:!0})},onMove:function(e){var t=this;this.transitionsOptions.enabled||this.awaitRender(function(){t.coordinates=t.moveAlgorithm(D(D({},t.getPublicProperties()),{},{positionRestrictions:vt(t.positionRestrictions,t.visibleArea),coordinates:t.coordinates,event:t.normalizeEvent(e)})),t.onChange()})},onResize:function(e){var t=this;this.transitionsOptions.enabled||this.stencilSize&&!this.autoZoom||this.awaitRender(function(){var i=t.sizeRestrictions,o=Math.min(t.coordinates.width,t.coordinates.height,20*t.coefficient);t.coordinates=t.resizeAlgorithm(D(D({},t.getPublicProperties()),{},{positionRestrictions:vt(t.positionRestrictions,t.visibleArea),sizeRestrictions:{maxWidth:Math.min(i.maxWidth,t.visibleArea.width),maxHeight:Math.min(i.maxHeight,t.visibleArea.height),minWidth:Math.max(i.minWidth,o),minHeight:Math.max(i.minHeight,o)},event:t.normalizeEvent(e)})),t.onChange(),t.ticking=!1})},onManipulateImage:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.transitionsOptions.enabled){var i=t.transitions,o=i!==void 0&&i,s=t.normalize,n=s===void 0||s;o&&this.enableTransitions();var l=Rs(D(D({},this.getPublicProperties()),{},{event:n?this.normalizeEvent(e):e,getAreaRestrictions:this.getAreaRestrictions,imageRestriction:this.imageRestriction,adjustStencil:!this.stencilSize&&this.settings.resizeImage.adjustStencil})),h=l.visibleArea,a=l.coordinates;this.visibleArea=h,this.coordinates=a,this.runAutoZoom("manipulateImage"),this.onChange(),o&&this.debouncedDisableTransitions()}},onPropsChange:function(){this.coordinates=this.applyTransform(this.coordinates,!0),this.onChange(!1)},getAreaRestrictions:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.visibleArea,i=e.type,o=i===void 0?"move":i;return this.areaRestrictionsAlgorithm({boundaries:this.boundaries,imageSize:this.imageSize,imageRestriction:this.imageRestriction,visibleArea:t,type:o})},getAspectRatio:function(e){var t,i,o=this.stencilProps,s=o.aspectRatio,n=o.minAspectRatio,l=o.maxAspectRatio;if(this.$refs.stencil&&this.$refs.stencil.aspectRatios){var h=this.$refs.stencil.aspectRatios();t=h.minimum,i=h.maximum}if(Q(t)&&(t=Q(s)?n:s),Q(i)&&(i=Q(s)?l:s),!e&&(Q(t)||Q(i))){var a=this.getStencilSize(),u=a?L(a):null;Q(t)&&(t=Li(u)?u:void 0),Q(i)&&(i=Li(u)?u:void 0)}return{minimum:t,maximum:i}},getStencilSize:function(){if(this.stencilSize)return e={currentStencilSize:{width:this.stencilCoordinates.width,height:this.stencilCoordinates.height},stencilSize:this.stencilSize,boundaries:this.boundaries,coefficient:this.coefficient,coordinates:this.coordinates,aspectRatio:this.getAspectRatio(!0)},t=e.boundaries,i=e.stencilSize,o=e.aspectRatio,Lt(L(s=Ge(i)?i({boundaries:t,aspectRatio:o}):i),o)&&(s=ke({sizeRestrictions:{maxWidth:t.width,maxHeight:t.height,minWidth:0,minHeight:0},width:s.width,height:s.height,aspectRatio:{minimum:o.minimum,maximum:o.maximum}})),(s.width>t.width||s.height>t.height)&&(s=ke({sizeRestrictions:{maxWidth:t.width,maxHeight:t.height,minWidth:0,minHeight:0},width:s.width,height:s.height,aspectRatio:{minimum:L(s),maximum:L(s)}})),s;var e,t,i,o,s},getPublicProperties:function(){return{coefficient:this.coefficient,visibleArea:this.visibleArea,coordinates:this.coordinates,boundaries:this.boundaries,sizeRestrictions:this.sizeRestrictions,positionRestrictions:this.positionRestrictions,aspectRatio:this.getAspectRatio(),imageRestriction:this.imageRestriction}},defaultCoordinates:function(){return D({},Wi)},flip:function(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=i.transitions,s=o===void 0||o;if(!this.transitionsActive){s&&this.enableTransitions();var n=D({},this.imageTransforms.flip),l=As({flip:{horizontal:e?!n.horizontal:n.horizontal,vertical:t?!n.vertical:n.vertical},previousFlip:n,rotate:this.imageTransforms.rotate,visibleArea:this.visibleArea,coordinates:this.coordinates,imageSize:this.imageSize,positionRestrictions:this.positionRestrictions,sizeRestrictions:this.sizeRestrictions,getAreaRestrictions:this.getAreaRestrictions,aspectRatio:this.getAspectRatio()}),h=l.visibleArea,a=l.coordinates;e&&(this.appliedImageTransforms.flip.horizontal=!this.appliedImageTransforms.flip.horizontal),t&&(this.appliedImageTransforms.flip.vertical=!this.appliedImageTransforms.flip.vertical),this.visibleArea=h,this.coordinates=a,this.onChange(),s&&this.debouncedDisableTransitions()}},rotate:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=t.transitions,o=i===void 0||i;if(!this.transitionsActive){o&&this.enableTransitions();var s=D({},this.imageSize);this.appliedImageTransforms.rotate+=e;var n=Cs({visibleArea:this.visibleArea,coordinates:this.coordinates,previousImageSize:s,imageSize:this.imageSize,angle:e,positionRestrictions:this.positionRestrictions,sizeRestrictions:this.sizeRestrictions,getAreaRestrictions:this.getAreaRestrictions,aspectRatio:this.getAspectRatio()}),l=n.visibleArea,h=n.coordinates,a=this.processAutoZoom("rotateImage",l,h);l=a.visibleArea,h=a.coordinates,this.visibleArea=l,this.coordinates=h,this.onChange(),o&&this.debouncedDisableTransitions()}}},emits:["change","error","ready"]},Ls={key:0,ref:"canvas",style:{display:"none"}},Ws={key:1,ref:"sourceCanvas",style:{display:"none"}};xn.render=function(e,t,i,o,s,n){return b(),z("div",{ref:"cropper",class:n.classes.cropper},[x("div",{ref:"stretcher",class:n.classes.stretcher},null,2),x("div",{class:n.classes.boundaries,style:n.boundariesStyle},[(b(),z(he(i.backgroundWrapperComponent),{class:n.classes.cropperWrapper,"wheel-resize":n.settings.resizeImage.wheel,"touch-resize":n.settings.resizeImage.touch,"touch-move":n.settings.moveImage.touch,"mouse-move":n.settings.moveImage.mouse,onMove:n.onManipulateImage,onResize:n.onManipulateImage},{default:_(function(){return[x("div",{class:n.classes.background,style:n.boundariesStyle},null,6),x("div",{class:n.classes.imageWrapper},[x("img",{ref:"image",crossorigin:s.imageAttributes.crossOrigin,src:s.imageAttributes.src,class:n.classes.image,style:n.imageStyle,onMousedown:t[1]||(t[1]=ce(function(){},["prevent"]))},null,46,["crossorigin","src"])],2),x("div",{class:n.classes.foreground,style:n.boundariesStyle},null,6),He((b(),z(he(i.stencilComponent),Kt({ref:"stencil",image:n.image,coordinates:s.coordinates,"stencil-coordinates":n.stencilCoordinates,transitions:n.transitionsOptions},i.stencilProps,{onResize:n.onResize,onResizeEnd:n.onResizeEnd,onMove:n.onMove,onMoveEnd:n.onMoveEnd}),null,16,["image","coordinates","stencil-coordinates","transitions","onResize","onResizeEnd","onMove","onMoveEnd"])),[[Vi,s.imageLoaded]]),i.canvas?(b(),z("canvas",Ls,null,512)):F("",!0),i.canvas?(b(),z("canvas",Ws,null,512)):F("",!0)]}),_:1},8,["class","wheel-resize","touch-resize","touch-move","mouse-move","onMove","onResize"]))],6)],2)};const Ps=e=>(Xi("data-v-bec7f64d"),e=e(),Yi(),e),js={class:"nc-image-cropper-wrapper relative"},Bs={key:0,class:"result_preview"},Hs=["src"],Us={class:"flex justify-between items-center space-x-4 mt-4"},Vs={class:"flex items-center space-x-4"},Ns={class:"flex items-center space-x-4"},qs=Ps(()=>g("span",{class:"ml-2"},"Crop",-1)),Xs=zt({__name:"ImageCropper",props:{imageConfig:{},cropperConfig:{},uploadConfig:{},showCropper:{type:Boolean}},emits:["update:showCropper","submit"],setup(e,{emit:t}){const i=oo(e,["imageConfig","cropperConfig","uploadConfig"]),o=t,s=Ni(i,"showCropper",o),{api:n,isLoading:l}=so(),h=P(),a=P({canvas:{},src:""}),u=()=>{const{canvas:m}=h.value.getResult();a.value={canvas:m,src:m.toDataURL()}},f=async m=>{var v,A;if((v=e.uploadConfig)!=null&&v.path)try{const M=await n.storage.uploadByUrl({path:(A=e.uploadConfig)==null?void 0:A.path},m);M!=null&&M[0]?o("submit",{...M[0],data:m[0].data}):o("submit",m[0])}catch(M){console.error(M),Qe.error(await ei(M))}else o("submit",m[0]);s.value=!1},p=async()=>{a.value.canvas&&a.value.canvas.toBlob(async m=>{await f([{title:e.imageConfig.name,fileName:e.imageConfig.name,mimetype:e.imageConfig.type,size:m.size,url:a.value.src,data:a.value.src}])},e.imageConfig.type)};return Ze(s,()=>{s.value||(a.value={canvas:{},src:""})}),(m,v)=>{const A=Jt,M=qi,B=ao;return b(),z(B,{visible:r(s),"onUpdate:visible":v[1]||(v[1]=U=>Ve(s)?s.value=U:null),"mask-closable":!1},{default:_(()=>{var U,K,se,w;return[g("div",js,[x(r(xn),{ref_key:"cropperRef",ref:h,class:"nc-cropper relative",src:m.imageConfig.src,"auto-zoom":!0,"stencil-props":((U=m.cropperConfig)==null?void 0:U.stencilProps)||{},"min-height":(K=m.cropperConfig)==null?void 0:K.minHeight,"min-width":(se=m.cropperConfig)==null?void 0:se.minWidth,"image-restriction":(w=m.cropperConfig)==null?void 0:w.imageRestriction},null,8,["src","stencil-props","min-height","min-width","image-restriction"]),r(a).src?(b(),j("div",Bs,[g("img",{src:r(a).src,alt:"Preview Image"},null,8,Hs)])):F("",!0)]),g("div",Us,[g("div",Vs,[x(A,{type:"secondary",size:"small",disabled:r(l),onClick:v[0]||(v[0]=qe=>s.value=!1)},{default:_(()=>[ee(" Cancel ")]),_:1},8,["disabled"])]),g("div",Ns,[x(A,{type:"secondary",size:"small",disabled:r(l),onClick:u},{default:_(()=>[x(M,{icon:"crop"}),qs]),_:1},8,["disabled"]),x(A,{size:"small",loading:r(l),disabled:!r(a).src,onClick:p},{default:_(()=>[ee(" Save ")]),_:1},8,["loading","disabled"])])])]}),_:1},8,["visible"])}}}),Ys=ti(Xs,[["__scopeId","data-v-bec7f64d"]]);const Gs={class:"nc-column-insert-before nc-form-header-menu-item"},Zs={class:"nc-column-delete nc-form-header-menu-item text-red-600"},Qs=zt({__name:"FieldMenu",props:{column:{},formColumn:{},isRequired:{type:Boolean},isOpen:{type:Boolean},onDelete:{type:Function}},emits:["hideField","update:isOpen","delete"],setup(e,{emit:t}){const i=e,o=t,{column:s,isRequired:n}=ro(i),l=Ni(i,"isOpen",o),{eventBus:h}=Ho(),a=Me(Gi),u=Me(Zi,P()),f=Me(Qi,P()),p=Me(Ki);Bt(lo,s);const{$api:m}=ni(),{t:v}=ii(),{getMeta:A}=co(),M=P(!1),B=P(!1),U=P(),K=P(),se=async()=>{var Y;let C={};const y=Uo(`${s.value.title} copy`,u.value.columns);C={...s.value,...s.value.colOptions??{},title:y,column_name:y.replace(/\s/g,"_"),id:void 0,colOptions:void 0,order:void 0,system:!1};try{const N=(await m.dbViewColumn.list((Y=f.value)==null?void 0:Y.id)).list,W=N.findIndex(We=>We.fk_column_id===s.value.id);let ge;W===N.length-1?ge=N[W].order+1:ge=(N[W].order+N[W+1].order)/2,await m.dbTableColumn.create(u.value.id,{...C,pv:!1,view_id:f.value.id,column_order:{order:ge,view_id:f.value.id}}),await A(u.value.id,!0),h.emit(ho.FIELD_RELOAD),a==null||a.trigger()}catch(N){Qe.error(await ei(N))}l.value=!1},w=async()=>{var C;if(s!=null&&s.value)if(s.value.uidt&&[V.Lookup,V.Rollup,V.CreatedTime,V.LastModifiedTime,V.CreatedBy,V.LastModifiedBy].includes(s.value.uidt))se();else{const y=(await m.dbViewColumn.list((C=f.value)==null?void 0:C.id)).list,Y=y.findIndex(W=>W.fk_column_id===s.value.id);let N;Y===y.length-1?N=y[Y].order+1:N=(y[Y].order+y[Y+1].order)/2,U.value={pv:!1,view_id:f.value.id,column_order:{order:N,view_id:f.value.id}},s.value.uidt===V.Formula?yt(()=>{var W;(W=K==null?void 0:K.value)==null||W.duplicate()}):B.value=!0,l.value=!1}},qe=async()=>{n.value||(l.value=!1,o("hideField"))},q=()=>{l.value=!1,M.value=!0},O=me(()=>(s==null?void 0:s.value)&&!s.value.system),T=me(()=>(s==null?void 0:s.value)&&!s.value.system);return(C,y)=>{const Y=Jt,N=Wo,W=nn,ge=Po,We=Ji,ct=jo,St=Bo;return b(),j(Ue,null,[r(p)?F("",!0):(b(),z(We,{key:0,visible:r(l),"onUpdate:visible":y[1]||(y[1]=ne=>Ve(l)?l.value=ne:null),trigger:["click"],placement:"bottomLeft","overlay-class-name":"nc-dropdown-form-column-operations !border-1 rounded-lg !shadow-xl",onClick:y[2]||(y[2]=ce(ne=>l.value=!r(l),["stop"]))},{overlay:_(()=>[x(ge,{class:"flex flex-col gap-1 border-gray-200 nc-column-options"},{default:_(()=>{var ne;return[F("",!0),x(N,{disabled:r(n),onClick:qe},{default:_(()=>[g("div",Gs,[(b(),z(he(("iconMap"in C?C.iconMap:r(_e)).eye),{class:"!w-3.75 !h-3.75"})),ee(" "+R(C.$t("general.hideField")),1)])]),_:1},8,["disabled"]),(ne=r(s))!=null&&ne.pv?F("",!0):(b(),j(Ue,{key:1},[x(W,{class:"!my-0"}),x(N,{disabled:!O.value,class:"!hover:bg-red-50",onClick:q},{default:_(()=>[g("div",Zs,[(b(),z(he(("iconMap"in C?C.iconMap:r(_e)).delete))),ee(" "+R(C.$t("general.delete")),1)])]),_:1},8,["disabled"])],64))]}),_:1})]),default:_(()=>[x(Y,{type:"secondary",size:"small",class:"nc-form-add-field","data-testid":"nc-form-add-field",onClick:y[0]||(y[0]=ce(ne=>C.showAddColumnDropdown=!0,["stop"]))},{default:_(()=>[(b(),z(he(("iconMap"in C?C.iconMap:r(_e)).threeDotVertical),{class:"flex-none w-4 h-4"}))]),_:1})]),_:1},8,["visible"])),x(ct,{visible:r(M),"onUpdate:visible":y[3]||(y[3]=ne=>Ve(M)?M.value=ne:null),class:"nc-form-column-delete-dropdown","on-delete-column":C.onDelete},null,8,["visible","on-delete-column"]),r(s)?(b(),z(St,{key:1,ref_key:"duplicateDialogRef",ref:K,modelValue:r(B),"onUpdate:modelValue":y[4]||(y[4]=ne=>Ve(B)?B.value=ne:null),column:r(s),extra:r(U)},null,8,["modelValue","column","extra"])):F("",!0)],64)}}}),Ks=ti(Qs,[["__scopeId","data-v-4aab5ffe"]]),Js=zt({__name:"Layout",setup(e){const{leftSidebarWidth:t,windowSize:i,formRightSidebarState:o,formRightSidebarWidthPercent:s}=Ht(qo()),n=me(()=>100-s.value);function l(a){const u=a*(i.value-t.value)/100;u>o.value.maxWidth?o.value.width=o.value.maxWidth:u<o.value.minWidth?o.value.width=o.value.minWidth:o.value.width=u}const h=me(()=>o.value.width>o.value.maxWidth?o.value.maxWidth:o.value.width<o.value.minWidth?o.value.minWidth:o.value.width);return(a,u)=>(b(),z(r(on),{class:"nc-form-right-sidebar-content-resizable-wrapper w-full h-full",onResize:u[0]||(u[0]=f=>l(f[1].size))},{default:_(()=>[x(r(xt),{size:r(n),class:"flex-1 h-full"},{default:_(()=>[$e(a.$slots,"preview")]),_:3},8,["size"]),x(r(xt),{"min-size":"15%",class:"nc-sidebar-splitpane relative",size:r(s),style:Ut({minWidth:`${r(o).minWidth}px !important`,maxWidth:`${r(h)}px !important`})},{default:_(()=>[$e(a.$slots,"sidebar")]),_:3},8,["size","style"])]),_:3}))}}),ea=sn.useForm,[ta,ia]=Go((e,t,i,o,s)=>{const{$api:n}=ni(),{t:l}=ii(),h=en(),a=P({}),u=P([]),f=P(""),p=me(()=>u.value.filter(T=>T.show).sort((T,C)=>T.order-C.order)),m=me(()=>p.value.find(T=>T.id===f.value)||null),v=me(()=>{var T;if(e.value&&m.value){if(e.value.columnsById&&e.value.columnsById[(T=m.value)==null?void 0:T.fk_column_id])return e.value.columnsById[m.value.fk_column_id];if(e.value.columns)return e.value.columns.find(C=>{var y;return C.id===((y=m.value)==null?void 0:y.fk_column_id)})??null}return null}),A=me(()=>{const T=new Set;return p.value.reduce((C,y)=>(C[y.title]=Zo(y.title,T),C),{})}),M=me(()=>{const T={};if(!p.value||!Object.keys(A.value).length)return T;for(const C of p.value){let y=[{validator:(N,W)=>new Promise((ge,We)=>O(C,C.required)&&(typeof W=="string"&&(W=W.trim()),C.uidt===V.Checkbox&&!W||C.uidt!==V.Checkbox&&!Ko(W))?We(l("msg.error.fieldRequired")):ge())}];const Y=Qo(Se(C.meta).validators??[],C);y=[...y,...Y],y.length&&(T[A.value[C.title]]=y)}return T}),B=me(()=>Object.keys(A.value).length?Object.keys(a.value).reduce((T,C)=>(T[A.value[C]]=a.value[C],T),{}):{}),{validate:U,validateInfos:K,clearValidate:se}=ea(B,M),w=async T=>{if(T.title)try{await U(A.value[T.title])}catch{}},qe=Vt(()=>{o(i.value)},300,{maxWait:2e3}),q=Vt(async T=>{if(T.id&&s){w(T);try{await n.dbView.formColumnUpdate(T.id,T)}catch(C){Qe.error(await ei(C))}}},250);function O(T,C=!1){var Y;let y=T;return tn(y.uidt)&&y.colOptions&&y.colOptions.type===Nt.BELONGS_TO&&(y=(((Y=e==null?void 0:e.value)==null?void 0:Y.columns)||[]).find(N=>N.id===y.colOptions.fk_child_column_id)),C||y&&y.rqd&&!y.cdf}return{onReset:h.on,formState:a,localColumns:u,visibleColumns:p,activeRow:f,activeField:m,activeColumn:v,isRequired:O,updateView:qe,updateColMeta:q,validate:U,validateInfos:K,clearValidate:se,fieldMappings:A}},"form-view-store");function Ol(){const e=ia();if(e==null)throw new Error("Please call `useProvideFormViewStore` on the appropriate parent component");return e}const na=Ie(()=>Fe(()=>import("./CPAoOH_N.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url).then(e=>e.default||e)),oa=Ie(()=>Fe(()=>import("./BvBAAA1q.js"),__vite__mapDeps([15,1,2]),import.meta.url).then(e=>e.default||e)),sa=Ie(()=>Fe(()=>import("./CjzcE-AP.js"),__vite__mapDeps([16,1,2,17,13,18]),import.meta.url).then(e=>e.default||e)),aa=Ie(()=>Fe(()=>import("./THlkrJVo.js"),__vite__mapDeps([19,1,2,20,21,22,17,23,24,13,25]),import.meta.url).then(e=>e.default||e)),ra=Ie(()=>Fe(()=>import("./BAM3UH7U.js"),__vite__mapDeps([26,1,2,27]),import.meta.url).then(e=>e.default||e)),la=Ie(()=>Fe(()=>import("./whrtjqtf.js"),__vite__mapDeps([28,1,2]),import.meta.url).then(e=>e.default||e)),ca=Ie(()=>Fe(()=>import("./DEmMk44y.js"),__vite__mapDeps([29,30,1,2,31,32,33,34,5,6,7,8,9,10,11,35,36,37,38,39,40,41,42,43,44,45,24,46,47,48,49,50,51,52,53,17,54,13,55,21,56,57,58,59,60,61,62,63,64,65,66,67,68]),import.meta.url).then(e=>e.default||e)),ha=Ie(()=>Fe(()=>import("./q9dVKJar.js"),__vite__mapDeps([69,1,2,66,61,62,8,57,70,71,72,73,53,17,54,13,74,75,76,77,78,79,31,32,80,21,81,82,24,83,84,85,86,87,88,89,90,37,38,39,40,41,55,20,22,23,43,5,6,7,9,10,11,60]),import.meta.url).then(e=>e.default||e)),da=Ie(()=>Fe(()=>import("./DKhUGBot.js").then(e=>e.i$),__vite__mapDeps([1,2]),import.meta.url).then(e=>e.default||e)),lt=e=>(Xi("data-v-01cab400"),e=e(),Yi(),e),ua={class:"h-full relative"},ma={key:0,class:"pl-6 pr-[120px] py-6 bg-white flex-col justify-start items-start gap-2.5 inline-flex"},fa={class:"text-gray-500 text-5xl font-semibold leading-16"},pa=lt(()=>g("br",null,null,-1)),ga={class:"text-gray-500 text-base font-medium leading-normal"},va={class:"max-w-[max(33%,688px)] mx-auto"},ba={class:"transition-all duration-300 ease-in relative my-6 bg-white rounded-3xl border-1 border-gray-200 px-4 py-8 lg:p-12 md:p-8 md:dark:bg-slate-700"},wa={key:0,class:"items-center justify-center text-left mt-2"},ya={class:"text-2xl font-bold text-gray-900 mb-4"},_a={key:0},xa={class:"flex justify-center"},za={class:"w-full"},Ra={key:1},Ca={class:"mt-16 w-full flex justify-between items-center gap-3"},Aa={key:0,class:"text-gray-400"},Sa={key:1,class:"flex-1 flex justify-end"},Ma={key:1,class:"nc-form-wrapper h-full w-full flex relative","data-testid":"nc-form-wrapper"},ka={key:0,class:"flex-1 flex items-center justify-center text-center h-full"},Ea={class:"mt-2"},$a={class:"min-w-[616px] overflow-x-auto nc-form-scrollbar"},Ia={key:1,class:"group relative max-w-[max(33%,688px)] mx-auto"},Fa={class:"absolute bottom-0 right-0 hidden group-hover:block"},Ta={class:"flex items-center space-x-1 m-2"},Oa={class:"text-center"},Da={class:"flex gap-2 items-center"},La={class:"flex gap-2 items-center"},Wa={class:"flex flex-col px-4 lg:px-6"},Pa={class:"mb-4"},ja={class:"text-center"},Ba={class:"flex gap-2 items-center"},Ha={class:"flex gap-2 items-center"},Ua={key:1,class:"font-bold text-2xl text-gray-900"},Va=["data-title","onClick"],Na={key:0,class:"absolute -left-3 top-6"},qa={class:"text-sm font-semibold text-gray-800"},Xa={"data-testid":"nc-form-input-label"},Ya={key:0,class:"text-red-500 text-base leading-[18px]"},Ga={class:"nc-form-field-body"},Za={class:"mt-2"},Qa={key:0,class:"mt-4 border-dashed border-2 border-gray-400 py-3 text-gray-400 text-center"},Ka={class:"flex justify-between items-center mt-6 !px-8 !lg:px-12"},Ja={key:0,class:"px-8 lg:px-12"},er={class:"inline-block"},tr={class:"px-3 pt-4 pb-2 flex items-center justify-between border-b border-gray-200 font-medium"},ir={class:"flex items-center"},nr=lt(()=>g("div",{class:"px-1.75 text-gray-500 text-xl font-normal"},"/",-1)),or={class:"flex items-center pr-1 py-1.5 text-gray-800"},sr={class:"text-center"},ar={"data-testid":"nc-form-input-label"},rr={class:"flex items-center space-x-2"},lr={class:"nc-edit-or-add-provider-wrapper"},cr={class:"nc-form-field-text p-4 flex flex-col gap-4 border-b border-gray-200"},hr={class:"text-base font-bold text-gray-600"},dr={class:"flex flex-wrap justify-between items-center gap-2"},ur={class:"flex gap-3"},mr={class:"text-base font-bold text-gray-600"},fr={class:"flex gap-2 items-center"},pr={class:"nc-edit-or-add-provider-wrapper"},gr={autocomplete:"off"},vr={class:"nc-form-fields-list border-1 border-gray-200 rounded-lg overflow-y-auto nc-form-scrollbar"},br={key:0,class:"px-0.5 py-2 text-gray-500 text-center"},wr=lt(()=>g("div",{class:"w-4 h-4 flex-none mx-2"},null,-1)),yr={class:"flex-1 flex flex-row items-center truncate cursor-pointer"},_r={class:"flex-1 font-base my-1.5"},xr={class:"flex items-center px-2"},zr=["data-testid"],Rr={class:"py-1.5 flex items-center"},Cr={class:"flex-1 flex items-center justify-between cursor-pointer max-w-[calc(100%_-_20px)] py-1.5"},Ar=["onClick"],Sr={class:"flex-1 flex items-center justify-start max-w-[calc(100%_-_28px)]"},Mr={class:"w-full flex items-center"},kr={class:"text-center"},Er={"data-testid":"nc-field-title"},$r={key:0,class:"truncate inline-flex text-xs font-normal text-gray-700"},Ir=lt(()=>g("span",null," (",-1)),Fr={class:"text-center"},Tr={"data-testid":"nc-field-title "},Or=lt(()=>g("span",null,")",-1)),Dr={key:1,class:"text-red-500 text-sm align-top"},Lr={class:"px-0.5 py-2 text-gray-500 text-center"},Wr={class:"p-4 flex flex-col space-y-4 border-b border-gray-200"},Pr={class:"text-base font-bold text-gray-600"},jr={class:"flex flex-col space-y-3"},Br={class:"text-gray-800"},Hr={class:"flex justify-start"},Ur={class:"flex items-center justify-between gap-3"},Vr={class:"text-center"},Nr={class:"flex items-center justify-between gap-3"},qr={class:"p-4 flex flex-col space-y-4"},Xr={class:"text-base font-bold text-gray-600"},Yr={class:"flex flex-col gap-3"},Gr={class:"flex items-center justify-between gap-3"},Zr={class:"flex items-center justify-between gap-3"},Qr={class:"flex items-center justify-between gap-3"},Kr={class:"text-bold text-gray-600"},Jr={class:"pb-10"},el={class:"text-gray-800 mb-2"},tl={key:2,class:"absolute inset-0 bg-black/40 z-500 grid place-items-center"},il={class:"text-center bg-white px-6 py-8 rounded-xl max-w-lg"},nl={class:"text-2xl text-gray-800 font-bold"},ol={class:"capitalize"},sl={class:"text-sm text-gray-700 pt-6"},al=zt({__name:"Form",setup(e){Bt(uo,P(!0)),Bt(mo,P(!1));const t=["created_at","updated_at"],i=[V.Rollup,V.Lookup,V.Formula,V.QrCode,V.Barcode,V.SpecificDBType,V.CreatedTime,V.LastModifiedTime,V.CreatedBy,V.LastModifiedBy],o=[st.code,st.blockQuote,st.bulletList,st.numberedList,st.taskList],{isMobileMode:s,user:n}=fo(),{$api:l,$e:h}=ni(),{isUIAllowed:a}=po(),{base:u}=Ht(go()),{getPossibleAttachmentSrc:f}=Xo(),p=P(0),m=Me(Ki,P(!1)),v=a("viewFieldEdit"),A=Me(Zi,P()),M=Me(Qi,P()),B=Me(vo,P(!1)),{loadFormView:U,insertRow:K,formColumnData:se,formViewData:w,updateFormView:qe}=Yo(A,M),{formState:q,localColumns:O,visibleColumns:T,activeRow:C,activeField:y,activeColumn:Y,isRequired:N,updateView:W,updateColMeta:ge,validateInfos:We,validate:ct,clearValidate:St,fieldMappings:ne}=ta(A,M,w,qe,v),{preFillFormSearchParams:li}=Ht(bo()),Pe=Me(Gi,en());Pe.on(async()=>{await U(),ui()});const{fields:Xe,showAll:zn,hideAll:Rn}=Jo(),{state:je,row:Cn}=es(P({row:q.value,oldRow:{},rowMeta:{new:!0}})),ci=me(()=>{var c;return((c=A==null?void 0:A.value)==null?void 0:c.columns)||[]}),Mt=P(),kt=P([]),re=P({showColumnMenu:!1,showEditColumn:!1,showAddColumn:!1}),ht=P(!1),Be=P(!1),tt=P(!1),Et=P(!1),dt=P(!1),oe=P({imageConfig:{src:"",type:"",name:""},cropperConfig:{stencilProps:{},minHeight:0,minWidth:0,imageRestriction:"none"},uploadConfig:{path:""},cropFor:"banner"}),ut=P(),Te=P(""),$t=P(!1),{t:It}=ii(),{open:An,onChange:Sn}=wo({accept:"image/*",multiple:!1,reset:!0}),Mn=me(()=>{var c;return f(Se((c=w.value)==null?void 0:c.logo_url))}),kn=Vt(()=>{if(m.value||!a("dataInsert"))return;const c={...q.value,...je.value},d=new URLSearchParams;for(const k of T.value)k.title&&c[k.title]&&!Ye(k)&&V.Attachment!==k.uidt&&d.append(k.title,c[k.title]);li.value=d.toString()},250);async function En(){var c;if(!(m.value||!a("dataInsert"))){for(const d of T.value)N(d,d.required)&&q.value[d.title]===void 0&&(q.value[d.title]=null);try{await ct(Object.keys(q.value).map(d=>ne.value[d]))}catch(d){if((c=d==null?void 0:d.errorFields)!=null&&c.length){Qe.error(It("msg.error.someOfTheRequiredFieldsAreEmpty"));return}}await K({row:{...q.value,...je.value},oldRow:{},rowMeta:{new:!0}}),tt.value=!0}}async function Ft(){m.value||!a("dataInsert")||(q.value={},je.value={},St(),Pe.trigger())}function $n(c){if(t.includes(c.fk_column_id))return!1;let d=!Ye(c)&&c.rqd&&!Vo(c==null?void 0:c.cdf)&&!ci.value.some(k=>{var I;return tn(k.uidt)&&((I=k==null?void 0:k.colOptions)==null?void 0:I.type)===Nt.BELONGS_TO&&c.fk_column_id===k.colOptions.fk_child_column_id})||c.pk&&!c.ai&&!c.cdf;if(c.uidt===V.LinkToAnotherRecord&&c.colOptions.type===Nt.BELONGS_TO){const k=ci.value.find(I=>I.id===c.colOptions.fk_child_column_id);k.rqd&&!k.default&&(d=!0)}return d}function In(c){if(c.from!==c.to&&mt(c.draggedContext.element))return!1}async function hi(c,d=!1){var G,ve,ae,le;if(m.value||!v)return;let{newIndex:k,element:I}=c.moved;const ue=(G=Xe.value)==null?void 0:G.findIndex(X=>(X==null?void 0:X.fk_column_id)===I.fk_column_id);ue===-1||ue===void 0||!((ve=Xe.value)!=null&&ve[ue])||(d&&(I=O.value[(ae=O.value)==null?void 0:ae.findIndex(X=>X.fk_column_id===I.fk_column_id)],k=O.value.findIndex(X=>X.fk_column_id===T.value[k].fk_column_id)),!O.value.length||O.value.length===1?I.order=1:O.value.length-1===k?I.order=Math.max(...O.value.map(X=>(X==null?void 0:X.order)??0))+1:k===0?I.order=Math.min(...O.value.map(X=>(X==null?void 0:X.order)??0))/2:I.order=((((le=O.value[k-1])==null?void 0:le.order)??0)+(O.value[k+1].order??0))/2,await l.dbView.formColumnUpdate(I.id,I),Xe.value[ue]=I,O.value=[...O.value].sort((X,it)=>X.order!==void 0&&it.order!==void 0?X.order-it.order:0),h("a:form-view:reorder"))}async function di(c,d,k=!1){var ue,G;if(m.value||!v)return;if(mt(c)){!k&&Qe.info(It("msg.info.requriedFieldsCantBeMoved"));return}const I=(ue=Xe.value)==null?void 0:ue.findIndex(ve=>(ve==null?void 0:ve.fk_column_id)===c.fk_column_id);I!==-1&&I!==void 0&&((G=Xe.value)!=null&&G[I])&&(c.show=d,await l.dbView.formColumnUpdate(c.id,c),Xe.value[I]=c,Pe.trigger(),h(d?"a:form-view:show-columns":"a:form-view:hide-columns")),!d&&!k&&C.value&&(C.value="")}function mt(c){return $n(c)||!!c.required||!!c.rqd&&!c.cdf||c.uidt===V.QrCode||c.uidt===V.Barcode}async function Fn(c){if(!(m.value||!v))if(c){for(const d of O==null?void 0:O.value)d.show=!0;await zn(kt.value),h("a:form-view:add-all")}else{for(const d of O==null?void 0:O.value)mt(d)||(d.show=!1);await Rn(O==null?void 0:O.value.filter(d=>mt(d)).map(d=>d.fk_column_id)),h("a:form-view:remove-all")}}async function Tn(){return Be.value&&!Ce&&!await l.plugin.status("SMTP")?(Be.value=!1,Qe.info(It("msg.toast.formEmailSMTP")),!1):!0}function ui(){var k,I,ue,G,ve;const c=(se==null?void 0:se.value)||[];kt.value=yo(c).map(ae=>ae.fk_column_id),w.value={banner_image_url:null,logo_url:null,...w.value,submit_another_form:!!(((k=w.value)==null?void 0:k.submit_another_form)??0),show_blank_form:!!(((I=w.value)==null?void 0:I.show_blank_form)??0),meta:{hide_branding:!1,background_color:"#F9F9FA",hide_banner:!1,...Se((ue=w.value)==null?void 0:ue.meta)??{}}};let d={};try{d=JSON.parse(((G=w.value)==null?void 0:G.email)||"")||{}}catch{}Be.value=d[(ve=n.value)==null?void 0:ve.email],O.value=c.filter(ae=>!i.includes(ae.uidt)&&!kt.value.includes(ae.fk_column_id)).sort((ae,le)=>ae.order-le.order).map(ae=>({...ae,required:!!ae.required}))}async function On(){var c,d,k;try{if(!await Tn())return;const I=(c=w.value)!=null&&c.email?JSON.parse((d=w.value)==null?void 0:d.email):{};I[(k=n.value)==null?void 0:k.email]=Be.value,w.value.email=JSON.stringify(I)}catch{}}function Dn(){On(),W()}function mi(){y.value&&(delete q.value[y.value.title],Ye(y.value)&&delete je.value[y.value.title])}async function Ln(){re.value.showAddColumn=!1,Pe.trigger()}async function Wn(){var c;re.value.showEditColumn=!1,y.value&&y.value.uidt!==((c=Y.value)==null?void 0:c.uidt)&&mi(),Pe.trigger()}async function Pn(){mi(),Pe.trigger()}const ft=(c,d=!1)=>{m.value||!v||(d&&($t.value=!0),C.value=c.id)},jn=c=>{var k;if(m.value||!v)return;ko(c).isValid()&&(((k=w.value)==null?void 0:k.meta).background_color=c,W())},fi=c=>{var d,k;!v||!Ce||(oe.value.uploadConfig={path:[Eo,u.value.id,(d=A.value)==null?void 0:d.id,(k=w.value)==null?void 0:k.id].join("/")},c?(oe.value.cropperConfig={...oe.value.cropperConfig,stencilProps:{aspectRatio:4/1},minHeight:100,minWidth:0},oe.value.cropFor="banner"):(oe.value.cropperConfig={...oe.value.cropperConfig,stencilProps:{aspectRatio:void 0},minHeight:150,minWidth:150},oe.value.cropFor="logo"),An())};Sn(c=>{if(c&&c[0]){oe.value.imageConfig.src&&URL.revokeObjectURL(oe.value.imageConfig.src);const d=URL.createObjectURL(c[0]);oe.value.imageConfig={src:d,type:c[0].type,name:c[0].name},dt.value=!0}});const Bn=(c=null)=>{oe.value.cropFor==="banner"?w.value.banner_image_url=c:w.value.logo_url=c,W()},Hn=c=>{c.target.select()},Un=c=>{y.value&&(y.value.title===c?y.value.label=null:y.value.label=c)};_o(async()=>{oe.value.src&&URL.revokeObjectURL(oe.value.imageConfig.src),li.value="",Et.value=!0,await U(),ui(),Et.value=!1}),Ze(tt,c=>{var d;if(c&&((d=w.value)!=null&&d.show_blank_form)){p.value=5;const k=xo(()=>{--p.value<0&&(tt.value=!1,Ft(),clearInterval(k))},1e3)}}),Ze(M,c=>{(c==null?void 0:c.type)===zo.FORM&&Pe.trigger()}),Ze([q,je],async()=>{for(const c in je.value)q.value[c]=je.value[c];kn();try{await ct(Object.keys(q.value).map(c=>ne.value[c]))}catch{}},{deep:!0});const pi=(c,d)=>{const k=document.querySelector(`${d?".nc-form-field-item-":".nc-form-drag-"}${CSS.escape(c==null?void 0:c.replaceAll(" ",""))}`);k&&setTimeout(()=>{k==null||k.scrollIntoView({behavior:"smooth",block:"center"})},50)};return Ze(y,(c,d)=>{c&&$t.value?yt(()=>{pi(c.title,!1)}):d&&yt(()=>{pi(d.title,!0)}),$t.value=!1,re.value={...re.value,showColumnMenu:!1,showEditColumn:!1}}),Ze([ut,y],()=>{y&&ut.value&&yt(()=>{var c;(c=ut.value)==null||c.focus()})}),Ii(document,"keydown",c=>{var k,I;const d=Ro()?c.metaKey:c.ctrlKey;switch((k=c.key)==null?void 0:k.toLowerCase()){case"s":d&&!(["input","textarea"].includes(c.target.nodeName.toLowerCase())||(I=c.target)!=null&&I.getAttribute("contenteditable"))&&(c.preventDefault(),W());break}},!0),Ii(document,"mousedown",c=>{var d,k,I;(d=Mt.value)!=null&&d.targetDomElement&&((k=Mt.value)!=null&&k.targetDomElement.contains(c.target))||(I=c.target)!=null&&I.closest('.nc-form-right-panel, [class*="dropdown"], .nc-form-rich-text-field, .ant-modal, .ant-modal-wrap, .nc-share-base-button, .nc-form-right-sidebar-content-resizable-wrapper .splitpanes__splitter')||(C.value="")},!0),(c,d)=>{var _i,xi,zi,Ri,Ci,Ai,Si,Mi,ki,Ei;const k=To,I=na,ue=is,G=Jt,ve=$o,ae=Ys,le=Io,X=oa,it=ns,Tt=os,Vn=sa,Nn=aa,qn=ra,Xn=la,Yn=sn,Gn=nn,Zn=Oo,Qn=Fo,gi=Do,vi=Lo,bi=ca,wi=Ji,Kn=Ks,Jn=ha,eo=No,yi=qi,to=ts,Oe=ss,io=da,no=Js,nt=Co("e");return b(),j("div",ua,[r(s)?(b(),j("div",ma,[g("div",fa,[ee(R(c.$t("general.available")),1),pa,ee(R(c.$t("title.inDesktop")),1)]),g("div",ga,R(c.$t("msg.formViewNotSupportedOnMobile")),1)])):(b(),j(Ue,{key:1},[r(tt)?(b(),j("div",{key:0,class:"h-full p-6 overflow-auto nc-form-scrollbar",style:Ut({background:((xi=("parseProp"in c?c.parseProp:r(Se))((_i=r(w))==null?void 0:_i.meta))==null?void 0:xi.background_color)||"#F9F9FA"}),"data-testid":"nc-form-wrapper-submit"},[g("div",va,[("parseProp"in c?c.parseProp:r(Se))((zi=r(w))==null?void 0:zi.meta).hide_banner?F("",!0):(b(),z(k,{key:0,"banner-image-url":(Ri=r(w))==null?void 0:Ri.banner_image_url},null,8,["banner-image-url"])),g("div",ba,[r(w)?(b(),j("div",wa,[g("div",null,[g("h1",ya,R(r(w).heading),1),(Ci=r(w).subheading)!=null&&Ci.trim()?(b(),j("div",_a,[x(I,{value:r(w).subheading,class:"font-medium text-base text-gray-500 !h-auto mb-4 -ml-1","is-form-field":"","read-only":"","sync-value-change":""},null,8,["value"])])):F("",!0)]),g("div",xa,[g("div",za,[x(ue,{class:"nc-form-success-msg !my-4 !py-4 text-left !rounded-lg",type:"success",outlined:""},{message:_(()=>{var De,H,$;return[(H=(De=r(w))==null?void 0:De.success_msg)!=null&&H.trim()?(b(),z(I,{key:0,value:($=r(w))==null?void 0:$.success_msg,class:"!h-auto -ml-1","is-form-field":"","read-only":"","sync-value-change":""},null,8,["value"])):(b(),j("span",Ra,R(c.$t("msg.successfullySubmittedFormData")),1))]}),_:1}),g("div",Ca,[r(w).show_blank_form?(b(),j("div",Aa,R(c.$t("msg.newFormWillBeLoaded",{seconds:r(p)})),1)):F("",!0),r(w).submit_another_form||!r(B)?(b(),j("div",Sa,[x(G,{type:"primary",size:"small",onClick:d[0]||(d[0]=()=>{tt.value=!1,Ft()})},{default:_(()=>[ee(R(c.$t("activity.submitAnotherForm")),1)]),_:1})])):F("",!0)])])])])):F("",!0)])])],4)):(b(),j("div",Ma,[r(Et)?(b(),j("div",ka,[g("div",null,[x(ve,{size:"xlarge"}),g("div",Ea,R(c.$t("general.loading")),1)])])):r(w)?(b(),z(no,{key:1},{preview:_(()=>{var De,H,$;return[g("div",{class:"w-full h-full overflow-auto nc-form-scrollbar p-6",style:Ut({background:((De=r(w))==null?void 0:De.meta).background_color||"#F9F9FA"})},[g("div",$a,[r(v)?(b(),z(ae,{key:0,"show-cropper":r(dt),"onUpdate:showCropper":d[1]||(d[1]=be=>Ve(dt)?dt.value=be:null),"image-config":r(oe).imageConfig,"cropper-config":r(oe).cropperConfig,"upload-config":r(oe).uploadConfig,onSubmit:Bn},null,8,["show-cropper","image-config","cropper-config","upload-config"])):F("",!0),("parseProp"in c?c.parseProp:r(Se))((H=r(w))==null?void 0:H.meta).hide_banner?F("",!0):(b(),j("div",Ia,[(b(),z(k,{key:($=r(w).banner_image_url)==null?void 0:$.path,"banner-image-url":r(w).banner_image_url},null,8,["banner-image-url"])),g("div",Fa,[g("div",Ta,[x(le,{disabled:"isEeUI"in c?c.isEeUI:r(Ce)},{title:_(()=>[g("div",Oa,R(c.$t("msg.info.thisFeatureIsOnlyAvailableInEnterpriseEdition")),1)]),default:_(()=>[x(G,{type:"secondary",size:"small",class:"nc-form-upload-banner-btn","data-testid":"nc-form-upload-banner-btn",disabled:!("isEeUI"in c?c.isEeUI:r(Ce)),onClick:d[2]||(d[2]=be=>fi(!0))},{default:_(()=>[g("div",Da,[(b(),z(he(("iconMap"in c?c.iconMap:r(_e)).upload),{class:"w-4 h-4"})),g("span",null,R(r(w).banner_image_url?c.$t("general.replace"):c.$t("general.upload"))+" "+R(c.$t("general.banner")),1)])]),_:1},8,["disabled"])]),_:1},8,["disabled"]),("isEeUI"in c?c.isEeUI:r(Ce))&&r(w).banner_image_url?(b(),z(le,{key:0},{title:_(()=>[ee(R(c.$t("general.delete"))+" "+R(c.$t("general.banner")),1)]),default:_(()=>[x(G,{type:"secondary",size:"small",class:"nc-form-delete-banner-btn","data-testid":"nc-form-delete-banner-btn",onClick:d[3]||(d[3]=()=>{r(v)&&(r(w).banner_image_url=null,r(W)())})},{default:_(()=>[g("div",La,[(b(),z(he(("iconMap"in c?c.iconMap:r(_e)).delete),{class:"w-4 h-4"}))])]),_:1})]),_:1})):F("",!0)])])])),x(Qn,{class:"!py-8 !lg:py-12 !border-gray-200 !rounded-3xl !mt-6 !max-w-[max(33%,688px)] !mx-auto","body-style":{margin:"0 auto",padding:"0px !important"}},{default:_(()=>{var be;return[x(Yn,{model:r(q),class:"nc-form","no-style":""},{default:_(()=>{var J;return[g("div",Wa,[g("div",Pa,[g("div",{class:we(["nc-form-logo-wrapper mx-6 group relative inline-block h-56px overflow-hidden flex items-center",r(w).logo_url?"max-w-189px hover:w-full hover:bg-gray-100 hover:rounded-xl ":"bg-gray-100 max-w-147px rounded-xl"]),style:{transition:"all 0.3s ease-in"}},[r(w).logo_url?(b(),z(X,{key:(J=r(w).logo_url)==null?void 0:J.path,srcs:r(Mn),class:"flex-none nc-form-logo !object-contain object-left max-h-full max-w-full !m-0"},null,8,["srcs"])):F("",!0),g("div",{class:we(["items-center space-x-1 flex-nowrap m-3",r(w).logo_url?"hidden absolute top-0 left-0 group-hover:flex":"flex"])},[x(le,{disabled:"isEeUI"in c?c.isEeUI:r(Ce)},{title:_(()=>[g("div",ja,R(c.$t("msg.info.thisFeatureIsOnlyAvailableInEnterpriseEdition")),1)]),default:_(()=>[r(v)?(b(),z(G,{key:0,type:"secondary",size:"small",class:"nc-form-upload-logo-btn","data-testid":"nc-form-upload-log-btn",disabled:!("isEeUI"in c?c.isEeUI:r(Ce)),onClick:d[4]||(d[4]=E=>fi(!1))},{default:_(()=>[g("div",Ba,[(b(),z(he(("iconMap"in c?c.iconMap:r(_e)).upload),{class:"w-4 h-4"})),g("span",null,R(r(w).logo_url?c.$t("general.replace"):c.$t("general.upload"))+" Logo",1)])]),_:1},8,["disabled"])):F("",!0)]),_:1},8,["disabled"]),("isEeUI"in c?c.isEeUI:r(Ce))&&r(w).logo_url?(b(),z(le,{key:0},{title:_(()=>[ee(R(c.$t("general.delete"))+" "+R(c.$t("general.logo")),1)]),default:_(()=>[x(G,{type:"secondary",size:"small",class:"nc-form-delete-logo-btn","data-testid":"nc-form-delete-logo-btn",onClick:d[5]||(d[5]=()=>{r(v)&&(r(w).logo_url=null,r(W)())})},{default:_(()=>[g("div",Ha,[(b(),z(he(("iconMap"in c?c.iconMap:r(_e)).delete),{class:"w-4 h-4"}))])]),_:1})]),_:1})):F("",!0)],2)],2)]),g("div",{class:we(["border-transparent px-4 lg:px-6",[{"rounded-2xl overflow-hidden border-2 cursor-pointer mb-1 py-4 lg:py-6 focus-within:bg-gray-50":r(v)},{"mb-4 py-0 lg:py-0":!r(v)},{"hover:bg-gray-50":r(C)!=="nc-form-heading"&&r(v)},{"bg-gray-50":r(C)==="nc-form-heading"&&r(v)},{"!hover:bg-white !ring-0 !cursor-auto":r(m)}]]),onClick:d[9]||(d[9]=ce(E=>ft({id:"nc-form-heading"}),["stop"]))},[r(v)?(b(),z(Tt,{key:0,class:"!my-0"},{default:_(()=>[x(it,{value:r(w).heading,"onUpdate:value":d[6]||(d[6]=E=>r(w).heading=E),class:"nc-form-focus-element !p-0 !m-0 w-full !font-bold !text-2xl !border-0 !rounded-none !text-gray-900",style:{borderRightWidth:"0px !important",height:"70px","max-height":"250px",resize:"vertical"},"auto-size":"",size:"large","hide-details":"",disabled:r(m),placeholder:"Form Title",bordered:!1,"data-testid":"nc-form-heading","data-title":"nc-form-heading",onInput:r(W),onFocus:d[7]||(d[7]=E=>C.value="nc-form-heading"),onBlur:d[8]||(d[8]=E=>C.value="")},null,8,["value","disabled","data-testid","data-title","onInput"])]),_:1})):(b(),j("div",Ua,R(r(w).heading),1))],2),g("div",{class:we(["border-transparent px-4 lg:px-6",[{"rounded-2xl border-2 cursor-pointer mb-1 py-4 lg:py-6 focus-within:bg-gray-50":r(v)},{"mb-4 py-0 lg:py-0":!r(v)},{"hover:bg-gray-50":r(C)!=="nc-form-sub-heading"&&r(v)},{"bg-gray-50":r(C)==="nc-form-sub-heading"&&r(v)},{"!hover:bg-white !ring-0 !cursor-auto":r(m)}]]),onClick:d[13]||(d[13]=ce(E=>ft({id:"nc-form-sub-heading"}),["stop"]))},[r(v)&&!r(m)?(b(),z(I,{key:0,value:r(w).subheading,"onUpdate:value":[d[10]||(d[10]=E=>r(w).subheading=E),r(W)],placeholder:c.$t("msg.info.formDesc"),class:"nc-form-description nc-form-focus-element font-medium text-base !text-gray-500 -ml-1","is-form-field":"",autofocus:r(C)==="nc-form-sub-heading","data-testid":"nc-form-sub-heading","data-title":"nc-form-sub-heading",onFocus:d[11]||(d[11]=E=>C.value="nc-form-sub-heading"),onBlur:d[12]||(d[12]=E=>C.value="")},null,8,["value","placeholder","autofocus","data-testid","data-title","onUpdate:value"])):r(w).subheading?(b(),z(I,{key:1,value:r(w).subheading,class:"font-medium text-base !text-gray-500 -ml-1","is-form-field":"","read-only":"","sync-value-change":""},null,8,["value"])):F("",!0)],2)]),x(r(Fi),{ref_key:"draggableRef",ref:Mt,"model-value":r(T),"item-key":"fk_column_id",draggable:".item",handle:".nc-form-field-drag-handler",group:"form-inputs","ghost-class":"nc-form-field-ghost",class:"h-full px-4 lg:px-6",move:In,disabled:r(m)||!r(v),onChange:d[15]||(d[15]=E=>hi(E,!0))},{item:_(({element:E})=>[(b(),j("div",{key:E.id,class:we(["nc-editable nc-form-focus-element item relative bg-white p-4 lg:p-6",[`nc-form-drag-${E.title.replaceAll(" ","")}`,{"rounded-2xl border-2 my-1":r(v)},{"border-transparent my-0":!r(v)},{"nc-form-field-drag-handler border-transparent hover:bg-gray-50 cursor-pointer":r(C)!==E.id&&r(v)},{"border-brand-500":r(C)===E.id},{"!hover:bg-white !ring-0 !cursor-auto":r(m)}]]),"data-title":E.title,"data-testid":"nc-form-fields",onClick:ce(ot=>ft(E),["stop"])},[r(C)===E.id?(b(),j("div",Na,[x(G,{type:"primary",size:"small",class:"nc-form-field-drag-handler !cursor-move !p-1 !min-w-6 !h-auto !rounded"},{default:_(()=>[(b(),z(he(("iconMap"in c?c.iconMap:r(_e)).drag),{class:"nc-form-field-drag-handler flex-none !h-4 !w-4 text-white font-bold"}))]),_:1})])):F("",!0),g("div",qa,[g("span",Xa,R(E.label||E.title),1),r(N)(E,E.required)?(b(),j("span",Ya," *")):F("",!0)]),E.description?(b(),z(I,{key:1,value:E.description,"is-form-field":"","read-only":"","sync-value-change":"",class:"nc-form-help-text text-gray-500 text-sm mt-2 -ml-1","data-testid":"nc-form-help-text","onUpdate:value":ot=>r(ge)(E)},null,8,["value","onUpdate:value"])):F("",!0),g("div",Ga,[g("div",Za,[r(ne)[E.title]?(b(),z(Tt,Kt({key:0,name:r(ne)[E.title],class:"!my-0 nc-input-required-error nc-form-input-item"},r(We)[r(ne)[E.title]]),{default:_(()=>[x(qn,{class:"relative",onClick:d[14]||(d[14]=ce(()=>{},["stop"]))},{default:_(()=>[r(Ye)(E)?(b(),z(Vn,{key:0,modelValue:r(q)[E.title],"onUpdate:modelValue":ot=>r(q)[E.title]=ot,row:r(Cn),class:we(["nc-input",`nc-form-input-${E.title.replaceAll(" ","")}`]),"data-testid":`nc-form-input-${E.title.replaceAll(" ","")}`,column:E},null,8,["modelValue","onUpdate:modelValue","row","class","data-testid","column"])):(b(),z(Nn,{key:1,modelValue:r(q)[E.title],"onUpdate:modelValue":ot=>r(q)[E.title]=ot,class:we(["nc-input truncate",[`nc-form-input-${E.title.replaceAll(" ","")}`,{"layout-list":E.meta.isList}]]),"data-testid":`nc-form-input-${E.title.replaceAll(" ","")}`,column:E,"edit-enabled":!0},null,8,["modelValue","onUpdate:modelValue","class","data-testid","column"]))]),_:2},1024)]),_:2},1040,["name"])):F("",!0),x(Xn,{column:E},null,8,["column"])])])],10,Va))]),footer:_(()=>[!r(T).length&&r(v)?(b(),j("div",Qa,R(c.$t("title.selectFieldsFromRightPannelToAddHere")),1)):F("",!0)]),_:1},8,["model-value","disabled"]),g("div",Ka,[x(G,{type:"secondary",size:"small",disabled:!r(a)("dataInsert")||!r(T).length,class:"nc-form-clear nc-form-focus-element","data-testid":"nc-form-clear","data-title":"nc-form-clear",onClick:Ft},{default:_(()=>[ee(R(c.$t("activity.clearForm")),1)]),_:1},8,["disabled"]),x(G,{"html-type":"submit",type:"primary",size:"small",disabled:!r(a)("dataInsert")||!r(T).length,class:"nc-form-submit nc-form-focus-element","data-testid":"nc-form-submit","data-title":"nc-form-submit",onClick:En},{default:_(()=>[ee(R(c.$t("general.submit")),1)]),_:1},8,["disabled"])])]}),_:1},8,["model"]),("parseProp"in c?c.parseProp:r(Se))((be=r(w))==null?void 0:be.meta).hide_branding?F("",!0):(b(),j("div",Ja,[r(m)?F("",!0):(b(),z(Gn,{key:0,class:"!my-8"})),g("div",er,[x(Zn)])]))]}),_:1})])],4)]}),sidebar:_(()=>{var De;return[g("div",{class:we(["nc-form-right-panel h-full flex-grow max-w-full",{"overflow-y-auto nc-form-scrollbar":r(y)}])},[r(y)&&r(Y)?(b(),j("div",{key:(De=r(y))==null?void 0:De.id,class:"nc-form-field-right-panel"},[g("div",tr,[g("div",ir,[g("div",{class:"text-gray-600 font-medium cursor-pointer select-none hover:underline",onClick:d[16]||(d[16]=H=>C.value="")},R(c.$t("objects.viewType.form")),1),nr,g("div",or,[r(Ye)(r(y))?(b(),z(gi,{key:0,"column-meta":r(y),class:"flex-none"},null,8,["column-meta"])):(b(),z(vi,{key:1,"column-meta":r(y),class:"flex-none"},null,8,["column-meta"])),x(le,{class:"truncate max-w-[120px] text-sm font-semibold","show-on-truncate-only":""},{title:_(()=>[g("div",sr,R(r(y).title),1)]),default:_(()=>[g("span",ar,R(r(y).title),1)]),_:1})])]),g("div",rr,[x(wi,{visible:r(re).showEditColumn,"onUpdate:visible":d[20]||(d[20]=H=>r(re).showEditColumn=H),trigger:["click"],"overlay-class-name":"nc-dropdown-form-edit-column",disabled:!r(a)("fieldEdit")},{overlay:_(()=>[g("div",lr,[r(re).showEditColumn?(b(),z(bi,{key:0,column:r(Y),onSubmit:Wn,onCancel:d[17]||(d[17]=H=>r(re).showEditColumn=!1),onClick:d[18]||(d[18]=ce(()=>{},["stop"])),onKeydown:d[19]||(d[19]=ce(()=>{},["stop"]))},null,8,["column"])):F("",!0)])]),default:_(()=>[x(G,{type:"secondary",size:"small",class:"nc-form-add-field","data-testid":"nc-form-add-field"},{default:_(()=>[ee(R(c.$t("general.edit"))+" "+R(c.$t("objects.field")),1)]),_:1})]),_:1},8,["visible","disabled"]),x(Kn,{"is-open":r(re).showColumnMenu,"onUpdate:isOpen":d[21]||(d[21]=H=>r(re).showColumnMenu=H),column:r(Y),"form-column":r(y),"is-required":r(N)(r(y),r(y).required),"on-delete":()=>{Pn()},onHideField:d[22]||(d[22]=H=>di(r(y),!1,!1))},null,8,["is-open","column","form-column","is-required","on-delete"])])]),g("div",cr,[g("div",hr,R(c.$t("objects.field"))+" "+R(c.$t("general.text").toLowerCase()),1),x(it,{ref_key:"focusLabel",ref:ut,value:r(y).label||r(y).title,rows:1,"auto-size":"","hide-details":"",class:"form-meta-input nc-form-input-label !max-h-7.5rem nc-form-scrollbar","data-testid":"nc-form-input-label",placeholder:c.$t("msg.info.formInput"),onFocus:Hn,onKeydown:d[23]||(d[23]=Ao(ce(()=>{},["prevent"]),["enter"])),onInput:d[24]||(d[24]=H=>Un(H.target.value)),onChange:d[25]||(d[25]=H=>r(ge)(r(y)))},null,8,["value","placeholder"]),x(I,{value:r(y).description,"onUpdate:value":[d[26]||(d[26]=H=>r(y).description=H),d[27]||(d[27]=H=>r(ge)(r(y)))],placeholder:c.$t("msg.info.formHelpText"),class:"form-meta-input nc-form-input-help-text","is-form-field":"","hidden-bubble-menu-options":o,"data-testid":"nc-form-input-help-text"},null,8,["value","placeholder"])]),r(y)?(b(),z(Jn,{key:0})):F("",!0)])):(b(),j(Ue,{key:1},[r(w)?(b(),z(r(on),{key:0,horizontal:"",class:"nc-form-settings w-full nc-form-right-splitpane"},{default:_(()=>[x(r(xt),{"min-size":"30",size:"50",class:"nc-form-right-splitpane-item p-4 flex flex-col space-y-4 !min-h-200px"},{default:_(()=>{var H;return[g("div",dr,[g("div",ur,[g("div",mr,R(c.$t("objects.viewType.form"))+" "+R(c.$t("objects.fields")),1),x(eo,{color:"border-gray-200"},{default:_(()=>[ee(R(r(T).length)+"/"+R(r(O).length)+" "+R(c.$t("objects.field")),1)]),_:1})]),r(a)("fieldAdd")?(b(),z(wi,{key:0,visible:r(re).showAddColumn,"onUpdate:visible":d[31]||(d[31]=$=>r(re).showAddColumn=$),trigger:["click"],"overlay-class-name":"nc-dropdown-form-add-column"},{overlay:_(()=>[g("div",pr,[r(re).showAddColumn?(b(),z(bi,{key:0,onSubmit:Ln,onCancel:d[28]||(d[28]=$=>r(re).showAddColumn=!1),onClick:d[29]||(d[29]=ce(()=>{},["stop"])),onKeydown:d[30]||(d[30]=ce(()=>{},["stop"]))})):F("",!0)])]),default:_(()=>[x(G,{type:"secondary",size:"small",class:"nc-form-add-field","data-testid":"nc-form-add-field"},{default:_(()=>[g("div",fr,[(b(),z(he(("iconMap"in c?c.iconMap:r(_e)).plus),{class:"w-4 h-4"})),g("span",null,R(c.$t("activity.addFieldFromFormView")),1)])]),_:1})]),_:1},8,["visible"])):F("",!0)]),g("form",gr,[x(to,{key:"nc-form-field-search-input",value:r(Te),"onUpdate:value":d[33]||(d[33]=$=>Ve(Te)?Te.value=$:null),type:"text",autocomplete:"off",class:"!h-9 !px-3 !py-1 !rounded-lg",placeholder:`${c.$t("placeholder.searchFields")}...`,name:"nc-form-field-search-input","data-testid":"nc-form-field-search-input"},{prefix:_(()=>[x(yi,{icon:"search",class:"mr-2 h-4 w-4 text-gray-500 group-hover:text-black"})]),suffix:_(()=>[r(Te).length>0?(b(),z(yi,{key:0,icon:"close",class:"ml-2 h-4 w-4 text-gray-500 group-hover:text-black","data-testid":"nc-form-field-clear-search",onClick:d[32]||(d[32]=$=>Te.value="")})):F("",!0)]),_:1},8,["value","placeholder"])]),g("div",vr,[r(O).length?F("",!0):(b(),j("div",br,R(c.$t("title.noFieldsFound")),1)),r(O).length?(b(),j(Ue,{key:1},[g("div",{key:"nc-form-show-all-fields",class:"w-full flex items-center border-b-1 rounded-t-lg border-gray-200 bg-gray-50 sticky top-0 z-100","data-testid":"nc-form-show-all-fields",onClick:d[34]||(d[34]=ce(()=>{},["stop"]))},[wr,g("div",yr,[g("div",_r,R(c.$t("activity.selectAllFields")),1),g("div",xr,[x(Oe,{checked:r(T).length===r(O).length,size:"small",class:"nc-switch",onChange:Fn},null,8,["checked"])])])]),x(r(Fi),{list:r(O),"item-key":"id","ghost-class":"nc-form-field-ghost",style:{height:"calc(100% - 64px)"},disabled:r(m)||!r(v),onChange:d[35]||(d[35]=$=>hi($)),onStart:d[36]||(d[36]=$=>ht.value=!0),onEnd:d[37]||(d[37]=$=>ht.value=!1)},So({item:_(({element:$})=>{var be,J;return[$.title.toLowerCase().includes(r(Te).toLowerCase())?(b(),j("div",{key:$.id,class:we(["w-full px-2 flex flex-row items-center border-b-1 last:border-none border-gray-200",[`nc-form-field-item-${$.title.replaceAll(" ","")}`,`${r(C)===$.id?"bg-brand-50 font-medium":"hover:bg-gray-50"}`]]),"data-testid":`nc-form-field-item-${$.title}`},[g("div",Rr,[(b(),z(he(("iconMap"in c?c.iconMap:r(_e)).drag),{class:"flex-none cursor-move !h-4 !w-4 text-gray-600 mr-1"}))]),g("div",Cr,[g("div",{class:"flex-1 flex items-center cursor-pointer max-w-[calc(100%_-_40px)]",onClick:ce(E=>ft($,!0),["prevent"])},[$&&r(Ye)($)?(b(),z(gi,{key:0,"column-meta":$},null,8,["column-meta"])):(b(),z(vi,{key:1,"column-meta":$},null,8,["column-meta"])),g("div",Sr,[g("div",Mr,[g("div",{class:we(["ml-1 inline-flex",(be=$.label)!=null&&be.trim()?"max-w-1/2":"max-w-[95%]"])},[x(le,{class:"truncate text-sm",disabled:r(ht),"show-on-truncate-only":""},{title:_(()=>[g("div",kr,R($.title),1)]),default:_(()=>[g("span",Er,R($.title),1)]),_:2},1032,["disabled"])],2),(J=$.label)!=null&&J.trim()?(b(),j("div",$r,[Ir,x(le,{class:"truncate",disabled:r(ht),"show-on-truncate-only":""},{title:_(()=>[g("div",Fr,R($.label),1)]),default:_(()=>{var E;return[g("span",Tr,R((E=$.label)==null?void 0:E.trim()),1)]}),_:2},1032,["disabled"]),Or])):F("",!0),r(N)($,$.required)?(b(),j("span",Dr," *")):F("",!0)])])],8,Ar),x(le,{disabled:!$.required||r(m)||!r(v),class:"flex",placement:"topRight"},{title:_(()=>[ee(" You can't hide a required field.")]),default:_(()=>[x(Oe,{checked:!!$.show,disabled:$.required||r(m)||!r(v),class:"flex-none nc-switch",size:"small",onChange:E=>{di($,E,!0)}},null,8,["checked","disabled","onChange"])]),_:2},1032,["disabled"])])],10,zr)):F("",!0)]}),_:2},[(H=r(O))!=null&&H.filter($=>$.title.toLowerCase().includes(r(Te).toLowerCase())).length?void 0:{name:"footer",fn:_(()=>[g("div",Lr,R(c.$t("title.noFieldsFound"))+" with title `"+R(r(Te))+"` ",1)]),key:"0"}]),1032,["list","disabled"])],64)):F("",!0)])]}),_:1}),x(r(xt),{"min-size":"20",size:"50",class:"nc-form-right-splitpane-item !overflow-y-auto nc-form-scrollbar"},{default:_(()=>{var H,$,be;return[g("div",Wr,[g("div",Pr,R(c.$t("labels.appearanceSettings")),1),g("div",jr,[g("div",{class:we(r(m)||!r(v)?"pointer-events-none":"")},[g("div",Br,R(c.$t("labels.backgroundColor")),1),g("div",Hr,[x(io,{"model-value":r(w).meta.background_color,colors:["#FFFFFF","#FFDBD9","#FEE6D6","#FFF0D1","#D4F7E0","#D7F2FF","#FED8F4","#E5D4F5","#FFCFE6"],"color-box-border":"","is-new-design":"",class:"nc-form-theme-color-picker !pb-0 !pl-0 -ml-1",onInput:jn},null,8,["model-value"])])],2),g("div",Ur,[g("span",null,R(c.$t("labels.hideNocodbBranding")),1),("isEeUI"in c?c.isEeUI:r(Ce))?He((b(),z(Oe,{key:0,checked:(H=("parseProp"in c?c.parseProp:r(Se))(r(w).meta))==null?void 0:H.hide_branding,size:"small",class:"nc-form-hide-branding","data-testid":"nc-form-hide-branding",disabled:r(m)||!r(v),onChange:d[38]||(d[38]=J=>{r(m)||!r(v)||(r(w).meta.hide_branding=J,r(W)())})},null,8,["checked","disabled"])),[[nt,["a:form-view:hide-branding"]]]):(b(),z(le,{key:1,placement:"top"},{title:_(()=>[g("div",Vr,R(c.$t("msg.info.thisFeatureIsOnlyAvailableInEnterpriseEdition")),1)]),default:_(()=>[x(Oe,{checked:!1,size:"small",disabled:!0})]),_:1}))]),g("div",Nr,[g("span",null,R(c.$t("general.hide"))+" "+R(c.$t("general.banner")),1),He(x(Oe,{checked:($=("parseProp"in c?c.parseProp:r(Se))(r(w).meta))==null?void 0:$.hide_banner,size:"small",class:"nc-form-hide-banner","data-testid":"nc-form-hide-banner",disabled:r(m)||!r(v),onChange:d[39]||(d[39]=J=>{r(m)||!r(v)||(r(w).meta.hide_banner=J,r(W)())})},null,8,["checked","disabled"]),[[nt,["a:form-view:hide-banner"]]])])])]),g("div",qr,[g("div",Xr,R(c.$t("msg.info.postFormSubmissionSettings")),1),g("div",Yr,[g("div",Gr,[g("span",null,R(c.$t("msg.info.submitAnotherForm")),1),He(x(Oe,{checked:r(w).submit_another_form,"onUpdate:checked":d[40]||(d[40]=J=>r(w).submit_another_form=J),size:"small",class:"nc-form-checkbox-submit-another-form","data-testid":"nc-form-checkbox-submit-another-form",disabled:r(m)||!r(v),onChange:r(W)},null,8,["checked","disabled","onChange"]),[[nt,["a:form-view:submit-another-form"]]])]),g("div",Zr,[g("span",null,R(c.$t("msg.info.showBlankForm")),1),He(x(Oe,{checked:r(w).show_blank_form,"onUpdate:checked":d[41]||(d[41]=J=>r(w).show_blank_form=J),size:"small",class:"nc-form-checkbox-show-blank-form","data-testid":"nc-form-checkbox-show-blank-form",disabled:r(m)||!r(v),onChange:r(W)},null,8,["checked","disabled","onChange"]),[[nt,["a:form-view:show-blank-form"]]])]),g("div",Qr,[g("span",null,[ee(R(c.$t("msg.info.emailForm"))+" ",1),g("span",Kr,R((be=r(n))==null?void 0:be.email),1)]),He(x(Oe,{checked:r(Be),"onUpdate:checked":d[42]||(d[42]=J=>Ve(Be)?Be.value=J:null),size:"small",class:"nc-form-checkbox-send-email","data-testid":"nc-form-checkbox-send-email",disabled:r(m)||!r(v),onChange:Dn},null,8,["checked","disabled"]),[[nt,["a:form-view:email-me"]]])])]),g("div",Jr,[g("div",el,R(c.$t("msg.info.formDisplayMessage")),1),x(Tt,{class:"!my-0"},{default:_(()=>[!r(m)&&r(v)?(b(),z(I,{key:0,value:r(w).success_msg,"onUpdate:value":[d[43]||(d[43]=J=>r(w).success_msg=J),r(W)],class:"nc-form-after-submit-msg editable","is-form-field":"","hidden-bubble-menu-options":o,"data-testid":"nc-form-after-submit-msg"},null,8,["value","onUpdate:value"])):(b(),z(I,{key:1,value:r(w).success_msg,class:"nc-form-after-submit-msg","is-form-field":"","read-only":"","data-testid":"nc-form-after-submit-msg"},null,8,["value"]))]),_:1})])])]}),_:1})]),_:1})):F("",!0)],64))],2)]}),_:1})):F("",!0)]))],64)),(Si=(Ai=r(n))==null?void 0:Ai.base_roles)!=null&&Si.viewer||(ki=(Mi=r(n))==null?void 0:Mi.base_roles)!=null&&ki.commenter?(b(),j("div",tl,[g("div",il,[g("div",nl,[ee(R(c.$t("msg.info.yourCurrentRoleIs"))+" '",1),g("span",ol,R(((Ei=Object.keys(r(n).base_roles))==null?void 0:Ei[0])??r(Mo).NO_ACCESS),1),ee("'. ")]),g("div",sl,R(c.$t("msg.info.pleaseRequestAccessForView",{viewName:"form view"})),1)])])):F("",!0)])}}}),rl=ti(al,[["__scopeId","data-v-01cab400"]]),Dl=Object.freeze(Object.defineProperty({__proto__:null,default:rl},Symbol.toStringTag,{value:"Module"}));export{Dl as F,Ol as u};
