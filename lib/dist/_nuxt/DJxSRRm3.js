import{f as R,ac as U,r as b,g as q,aj as O,o as r,U as c,w as a,b as n,P as o,a as s,t as d,Y as f,V as y,W as w,T,S as C,d as x,c as S,ca as j,Q as A,aS as K,af as P,_ as z}from"./nEPQs079.js";import{l as H}from"./D73X0J_4.js";import"./BdIpmjdG.js";import{I as J}from"./ByzT15Y-.js";import{F as Q}from"./BzWD3wIg.js";import{_ as W}from"./5fs2TD9N.js";import"./DKtVUO_j.js";import"./DzMAdbS0.js";import"./BQQOEPN4.js";import"./COktFmkf.js";import"./QHUCxglU.js";import"./DYYbRAhI.js";import"./BTGvCRQH.js";const Y={key:0,class:"group cursor-pointer flex gap-1 items-center mx-auto max-w-64 justify-center active:ring active:ring-accent active:ring-opacity-100 rounded border-1 p-1 shadow-sm hover:bg-primary hover:bg-opacity-10 !dark:bg-slate-500 my-1",tabindex:"0"},X={class:"flex items-center gap-2","data-testid":"nc-geo-data-set-location-button"},Z={class:"group-hover:text-primary text-gray-500 dark:text-gray-200 dark:group-hover:!text-white text-xs"},ee={key:1,"data-testid":"nc-geo-data-lat-long-set",tabindex:"0",class:"nc-cell-field h-full w-full flex items-center py-1 focus-visible:!outline-none focus:!outline-none"},te={class:"flex mt-4 items-center mx-2"},oe={class:"mr-2"},ae={class:"flex items-center mx-2"},ne={class:"mr-2"},se={class:"mr-2 flex flex-col items-end gap-1 text-left"},le={class:"flex items-center gap-1"},ie={class:"mr-2 flex flex-row items-end gap-1 text-left"},re={class:"flex items-center gap-1"},de={class:"flex items-center gap-1"},ue={class:"ml-auto mr-2 w-auto"},pe=R({__name:"GeoData",props:{modelValue:{}},emits:["update:modelValue"],setup(I,{emit:V}){const m=U(I,"modelValue",V),g=b(!1),v=b(!1),M=b(!1),[k,$]=(m.value||"").split(";"),h=q(()=>{const[e,t]=(m.value||"").split(";");return e&&(M.value=!0),e&&t?`${e}; ${t}`:"Set location"}),l=O({latitude:k,longitude:$}),L=()=>{m.value=H(parseFloat(l.latitude),parseFloat(l.longitude)),g.value=!1},F=()=>{g.value=!1,l.latitude=k,l.longitude=$},N=()=>{v.value=!0;const e=i=>{const p=i.coords;l.latitude=`${p.latitude}`,l.longitude=`${p.longitude}`,v.value=!1},t=i=>{console.error(`ERROR(${i.code}): ${i.message}`),v.value=!1},u={enableHighAccuracy:!0,timeout:2e4,maximumAge:2e3};navigator.geolocation.getCurrentPosition(e,t,u)},B=()=>{const[e,t]=(m.value||"").split(";"),u=`https://www.google.com/maps/search/?api=1&query=${e},${t}`;window.open(u,"_blank","noopener,noreferrer")},D=()=>{const[e,t]=(m.value||"").split(";"),u=`https://www.openstreetmap.org/?mlat=${e}&mlon=${t}#map=15/${e}/${t}`;window.open(u,"_blank","'noopener,noreferrer'")};return(e,t)=>{const u=J,i=W,p=K,E=Q,G=P;return r(),c(G,{is:o(g)?o(j):"div",visible:o(g),"onUpdate:visible":t[8]||(t[8]=_=>A(g)?g.value=_:null),trigger:["click"]},{overlay:a(()=>[n(E,{model:o(l),class:"flex flex-col w-max-64 border-1 border-gray-200",onFinish:L},{default:a(()=>[n(i,null,{default:a(()=>[s("div",te,[s("div",oe,d(e.$t("labels.lat"))+":",1),n(u,{value:o(l).latitude,"onUpdate:value":t[0]||(t[0]=_=>o(l).latitude=_),"data-testid":"nc-geo-data-latitude",type:"number",step:"0.0000001",min:-90,required:"",max:90,onKeydown:t[1]||(t[1]=f(()=>{},["stop"])),onSelectstartCapture:t[2]||(t[2]=f(()=>{},["stop"])),onMousedown:t[3]||(t[3]=f(()=>{},["stop"]))},null,8,["value"])])]),_:1}),n(i,null,{default:a(()=>[s("div",ae,[s("div",ne,d(e.$t("labels.lng"))+":",1),n(u,{value:o(l).longitude,"onUpdate:value":t[4]||(t[4]=_=>o(l).longitude=_),"data-testid":"nc-geo-data-longitude",type:"number",step:"0.0000001",required:"",min:-180,max:180,onKeydown:t[5]||(t[5]=f(()=>{},["stop"])),onSelectstartCapture:t[6]||(t[6]=f(()=>{},["stop"])),onMousedown:t[7]||(t[7]=f(()=>{},["stop"]))},null,8,["value"])])]),_:1}),n(i,null,{default:a(()=>[s("div",se,[o(v)?(r(),c(y(("iconMap"in e?e.iconMap:o(w)).reload),{key:0,class:T({"animate-infinite animate-spin text-gray-500":o(v)})},null,8,["class"])):C("",!0),n(p,{class:"ml-2 !rounded-lg",onClick:N},{default:a(()=>[s("div",le,[(r(),c(y(("iconMap"in e?e.iconMap:o(w)).currentLocation))),x(d(e.$t("labels.currentLocation")),1)])]),_:1})])]),_:1}),o(m)?(r(),c(i,{key:0},{default:a(()=>[s("div",ie,[n(p,{class:"!rounded-lg",onClick:D},{default:a(()=>[s("div",re,[(r(),c(y(("iconMap"in e?e.iconMap:o(w)).openInNew))),x(d(e.$t("activity.map.openInOpenStreetMap")),1)])]),_:1}),n(p,{class:"!rounded-lg",onClick:B},{default:a(()=>[s("div",de,[(r(),c(y(("iconMap"in e?e.iconMap:o(w)).openInNew))),x(d(e.$t("activity.map.openInGoogleMaps")),1)])]),_:1})])]),_:1})):C("",!0),n(i,null,{default:a(()=>[s("div",ue,[n(p,{type:"text",class:"!rounded-lg",onClick:F},{default:a(()=>[x(d(e.$t("general.cancel")),1)]),_:1}),n(p,{type:"primary","html-type":"submit","data-testid":"nc-geo-data-save",class:"!rounded-lg"},{default:a(()=>[x(d(e.$t("general.submit")),1)]),_:1})])]),_:1})]),_:1},8,["model"])]),default:a(()=>[o(M)?(r(),S("div",ee,d(o(h)),1)):(r(),S("div",Y,[s("div",X,[(r(),c(y(("iconMap"in e?e.iconMap:o(w)).mapMarker),{class:"transform !dark:text-white !group-hover:text-accent group-hover:scale-120 text-gray-500 text-[0.75rem]"})),s("div",Z,d(o(h)),1)])]))]),_:1},8,["is","visible"])}}}),Se=z(pe,[["__scopeId","data-v-9cc4e8be"]]);export{Se as default};
