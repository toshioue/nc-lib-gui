import{f as Dt,a7 as zt,r as R,aB as je,fQ as It,aD as Et,aE as Ht,hr as Yt,az as nt,cN as it,g as I,d2 as e,aC as Qt,aF as Zt,P as a,o as i,S as _,Q as vt,c as T,a9 as Kt,V as K,U as E,Y as Q,_ as Lt,iZ as ye,i_ as Vt,i3 as Wt,dd as Xt,bN as ge,gD as St,dB as $t,L as Jt,cZ as ea,c_ as ta,da as Bt,d9 as Ut,d3 as Xe,i$ as aa,iX as la,H as Pe,aj as Ze,ak as Ke,A as Ot,ad as yt,bc as sa,ai as oa,hq as na,hR as ia,ay as ua,iY as ra,i as da,l as ca,b1 as pa,O as ma,a as w,a8 as st,b as re,w as x,X as _t,aq as Z,iW as gt,W as J,d as _e,t as Y,T as D,av as Ne,R as Le,fP as ot,$ as fa,a0 as va,a1 as ya,Z as _a,a6 as ga,p as Ta,e as ha}from"./Cgw6cdOy.js";import{_ as wa}from"./DBOeGHNL.js";import{_ as ba}from"./Bxm040c6.js";import{_ as ka}from"./CiTH7PYd.js";import{_ as xa}from"./CJBRTPd8.js";import{_ as Ma}from"./xtxyOwu-.js";import{x as Tt,d as ht,e as wt,n as bt,m as kt,j as Ca,h as Fa,G as Da,o as La,t as Va,u as Sa,s as $a,p as Ba,J as Ua,y as Oa,k as Aa,w as Ra,K as ja}from"./BBXMuneh.js";import Na from"./gH8vPeMd.js";import xt from"./DU05l6X4.js";import Pa from"./ahHmng0e.js";import qa from"./D5zISnV5.js";import Ga from"./BF7wSEKp.js";import za from"./CsF9MKko.js";import Ia from"./maf90uZR.js";import Ea from"./BHi8gM78.js";import Ha from"./JQyvIjgn.js";import Mt from"./SWJcscO-.js";import Ct from"./D9QxSUdR.js";import Ya from"./CAzRlw23.js";import{_ as Qa}from"./CBaQbo8T.js";import Ft from"./CgXXRQ_R.js";import{_ as Za,S as Ka}from"./D8rpj5Lr.js";import{a as At}from"./DFiWgQ57.js";import{a as Wa}from"./BcpeJQoi.js";import{C as Xa}from"./KNudlHpk.js";const Ja=Dt({__name:"FilterInput",props:{column:{},filter:{}},emits:["updateFilterValue"],setup(d,{emit:de}){var oe,we,ce;const M=d,B=de,b=zt(M,"column"),fe=R(!0);je(It,b),je(Ht,Et(fe)),je(Yt,R(!1));const $={isSingleSelect:Fa,isMultiSelect:Da,isDate:ht,isYear:kt,isDateTime:wt,isTime:bt,isRating:La,isDuration:Va,isPercent:Sa,isCurrency:$a,isDecimal:Ba,isReadonlyDateTime:Ua,isInt:Tt,isFloat:Oa,isTextArea:Aa,isLinks:V=>V.uidt===e.Links,isUser:Ra,isReadonlyUser:ja},{sqlUis:C}=nt(it()),k=R((oe=b.value)!=null&&oe.source_id&&C.value[(we=b.value)==null?void 0:we.source_id]?C.value[(ce=b.value)==null?void 0:ce.source_id]:Object.values(C.value)[0]),j=I(()=>b.value&&k.value.getAbstractType(b.value)),W=V=>{const N=$[V];return!b.value||!N?!1:N(b.value,j.value)},L=I({get:()=>M.filter.value,set:V=>{B("updateFilterValue",V)}}),ee=[{value:!0,label:"true"},{value:!1,label:"false"},{value:null,label:"unset"}],he=V=>["anyof","nanyof"].includes(V)?xt:Na,g=V=>["daysAgo","daysFromNow","pastNumberOfDays","nextNumberOfDays"].includes(V)?Mt:Pa,U=I(()=>({isSingleSelect:he(M.filter.comparison_op),isMultiSelect:xt,isDate:g(M.filter.comparison_sub_op),isYear:qa,isDateTime:g(M.filter.comparison_sub_op),isReadonlyDateTime:g(M.filter.comparison_sub_op),isTime:Ga,isRating:za,isDuration:Ia,isPercent:Ea,isCurrency:Ha,isDecimal:Mt,isInt:Ct,isFloat:Ya,isLinks:Ct,isUser:Ft,isReadonlyUser:Ft})),O=I(()=>Object.keys(U.value).find(V=>W(V))),P=I(()=>{switch(O.value){case"isSingleSelect":case"isMultiSelect":return{disableOptionCreation:!0};case"isPercent":case"isDecimal":case"isFloat":case"isLinks":case"isInt":return{class:"h-32px"};case"isDuration":return{showValidationError:!1};case"isUser":return{forceMulti:!0};case"isReadonlyUser":return["anyof","nanyof"].includes(M.filter.comparison_op)?{forceMulti:!0}:{};default:return{}}}),Ve=I(()=>{var V;return b.value&&(((V=b.value)==null?void 0:V.uidt)===e.Links||Tt(b.value,j)||ht(b.value,j)||wt(b.value,j)||bt(b.value,j)||kt(b.value,j))}),A=R(!1);return je(Qt,R(!0)),je(Zt,R(!0)),(V,N)=>{const pe=Za;return a(b)&&("isBoolean"in V?V.isBoolean:a(Ca))(a(b),a(j))?(i(),_(pe,{key:0,value:a(L),"onUpdate:value":N[0]||(N[0]=me=>vt(L)?L.value=me:null),disabled:V.filter.readOnly,options:ee},null,8,["value","disabled"])):(i(),T("div",{key:1,class:E(["bg-white border-1 flex flex-grow min-h-4 h-full px-1 items-center nc-filter-input-wrapper !rounded-lg",{"px-2":a(Ve),"border-brand-500":a(A)}]),onMouseup:N[4]||(N[4]=Q(()=>{},["stop"]))},[(i(),_(K(a(O)?a(U)[a(O)]:Qa),Kt({modelValue:a(L),"onUpdate:modelValue":N[1]||(N[1]=me=>vt(L)?L.value=me:null),disabled:V.filter.readOnly,placeholder:"Enter a value",column:a(b),class:"flex !rounded-lg"},a(P),{location:"filter",onFocus:N[2]||(N[2]=me=>A.value=!0),onBlur:N[3]||(N[3]=me=>A.value=!1)}),null,16,["modelValue","disabled","column"]))],34))}}}),el=Lt(Ja,[["__scopeId","data-v-d0689560"]]),tl=d=>Vt(d)||d===e.Time?"=":[e.SingleSelect,e.Collaborator,e.LinkToAnotherRecord,e.Date,e.CreatedTime,e.LastModifiedTime,e.DateTime].includes(d)?"is":"is equal",al=d=>Vt(d)||d===e.Time?"!=":[e.SingleSelect,e.Collaborator,e.LinkToAnotherRecord,e.Date,e.CreatedTime,e.LastModifiedTime,e.DateTime].includes(d)?"is not":"is not equal",ll=d=>d===e.Attachment?"filenames contain":"is like",sl=d=>d===e.Attachment?"filenames doesn't contain":"is not like",ol=d=>[e.Date,e.DateTime,e.CreatedTime,e.LastModifiedTime].includes(d)?"is after":">",nl=d=>[e.Date,e.DateTime,e.CreatedTime,e.LastModifiedTime].includes(d)?"is before":"<",il=d=>[e.Date,e.DateTime,e.CreatedTime,e.LastModifiedTime].includes(d)?"is on or after":">=",ul=d=>[e.Date,e.DateTime,e.CreatedTime,e.LastModifiedTime].includes(d)?"is on or before":"<=",qe=(d,de)=>[{text:"is checked",value:"checked",ignoreVal:!0,includedTypes:[e.Checkbox]},{text:"is not checked",value:"notchecked",ignoreVal:!0,includedTypes:[e.Checkbox]},{text:tl(d),value:"eq",ignoreVal:!1,excludedTypes:[e.Checkbox,e.MultiSelect,e.Attachment,e.User,e.CreatedBy,e.LastModifiedBy]},{text:al(d),value:"neq",ignoreVal:!1,excludedTypes:[e.Checkbox,e.MultiSelect,e.Attachment,e.User,e.CreatedBy,e.LastModifiedBy]},{text:ll(d),value:"like",ignoreVal:!1,excludedTypes:[e.Checkbox,e.SingleSelect,e.MultiSelect,e.User,e.CreatedBy,e.LastModifiedBy,e.Collaborator,e.Date,e.DateTime,e.CreatedTime,e.LastModifiedTime,e.Time,...ye]},{text:sl(d),value:"nlike",ignoreVal:!1,excludedTypes:[e.Checkbox,e.SingleSelect,e.MultiSelect,e.User,e.CreatedBy,e.LastModifiedBy,e.Collaborator,e.Date,e.DateTime,e.CreatedTime,e.LastModifiedTime,e.Time,...ye]},{text:"is empty",value:"empty",ignoreVal:!0,excludedTypes:[e.Checkbox,e.SingleSelect,e.MultiSelect,e.User,e.CreatedBy,e.LastModifiedBy,e.Collaborator,e.Attachment,e.LinkToAnotherRecord,e.Lookup,e.Date,e.DateTime,e.CreatedTime,e.LastModifiedTime,e.Time,...ye]},{text:"is not empty",value:"notempty",ignoreVal:!0,excludedTypes:[e.Checkbox,e.SingleSelect,e.MultiSelect,e.User,e.CreatedBy,e.LastModifiedBy,e.Collaborator,e.Attachment,e.LinkToAnotherRecord,e.Lookup,e.Date,e.DateTime,e.CreatedTime,e.LastModifiedTime,e.Time,...ye]},{text:"is null",value:"null",ignoreVal:!0,excludedTypes:[...ye,e.Checkbox,e.SingleSelect,e.MultiSelect,e.User,e.CreatedBy,e.LastModifiedBy,e.Collaborator,e.Attachment,e.LinkToAnotherRecord,e.Lookup,e.Date,e.DateTime,e.CreatedTime,e.LastModifiedTime,e.Time]},{text:"is not null",value:"notnull",ignoreVal:!0,excludedTypes:[...ye,e.Checkbox,e.SingleSelect,e.MultiSelect,e.User,e.CreatedBy,e.LastModifiedBy,e.Collaborator,e.Attachment,e.LinkToAnotherRecord,e.Lookup,e.Date,e.DateTime,e.CreatedTime,e.LastModifiedTime,e.Time]},{text:"contains all of",value:"allof",ignoreVal:!1,includedTypes:[e.MultiSelect,e.User,e.CreatedBy,e.LastModifiedBy]},{text:"contains any of",value:"anyof",ignoreVal:!1,includedTypes:[e.MultiSelect,e.SingleSelect,e.User,e.CreatedBy,e.LastModifiedBy]},{text:"does not contain all of",value:"nallof",ignoreVal:!1,includedTypes:[e.MultiSelect,e.User,e.CreatedBy,e.LastModifiedBy]},{text:"does not contain any of",value:"nanyof",ignoreVal:!1,includedTypes:[e.MultiSelect,e.SingleSelect,e.User,e.CreatedBy,e.LastModifiedBy]},{text:ol(d),value:"gt",ignoreVal:!1,includedTypes:[...ye,e.Date,e.DateTime,e.LastModifiedTime,e.CreatedTime,e.Time]},{text:nl(d),value:"lt",ignoreVal:!1,includedTypes:[...ye,e.Date,e.DateTime,e.LastModifiedTime,e.CreatedTime,e.Time]},{text:il(d),value:"gte",ignoreVal:!1,includedTypes:[...ye,e.Date,e.DateTime,e.LastModifiedTime,e.CreatedTime,e.Time]},{text:ul(d),value:"lte",ignoreVal:!1,includedTypes:[...ye,e.Date,e.DateTime,e.Time,e.CreatedTime,e.LastModifiedTime]},{text:"is within",value:"isWithin",ignoreVal:!0,includedTypes:[e.Date,e.DateTime,e.LastModifiedTime,e.CreatedTime]},{text:"is blank",value:"blank",ignoreVal:!0,excludedTypes:[e.Checkbox,e.Links,e.Rollup]},{text:"is not blank",value:"notblank",ignoreVal:!0,excludedTypes:[e.Checkbox,e.Links,e.Rollup]}],We=(d,de)=>{const M=de&&Wt(de);return d==="isWithin"?[{text:"the past week",value:"pastWeek",ignoreVal:!0,includedTypes:[e.Date,e.DateTime,e.LastModifiedTime,e.CreatedTime]},{text:"the past month",value:"pastMonth",ignoreVal:!0,includedTypes:[e.Date,e.DateTime,e.LastModifiedTime,e.CreatedTime]},{text:"the past year",value:"pastYear",ignoreVal:!0,includedTypes:[e.Date,e.DateTime,e.LastModifiedTime,e.CreatedTime]},{text:"the next week",value:"nextWeek",ignoreVal:!0,includedTypes:[e.Date,e.DateTime,e.LastModifiedTime,e.CreatedTime]},{text:"the next month",value:"nextMonth",ignoreVal:!0,includedTypes:[e.Date,e.DateTime,e.LastModifiedTime,e.CreatedTime]},{text:"the next year",value:"nextYear",ignoreVal:!0,includedTypes:[e.Date,e.DateTime,e.LastModifiedTime,e.CreatedTime]},{text:"the next number of days",value:"nextNumberOfDays",ignoreVal:!1,includedTypes:[e.Date,e.DateTime,e.LastModifiedTime,e.CreatedTime]},{text:"the past number of days",value:"pastNumberOfDays",ignoreVal:!1,includedTypes:[e.Date,e.DateTime,e.LastModifiedTime,e.CreatedTime]}]:[{text:"today",value:"today",ignoreVal:!0,includedTypes:[...M?[]:[e.Date,e.DateTime,e.LastModifiedTime,e.CreatedTime]]},{text:"tomorrow",value:"tomorrow",ignoreVal:!0,includedTypes:[...M?[]:[e.Date,e.DateTime,e.LastModifiedTime,e.CreatedTime]]},{text:"yesterday",value:"yesterday",ignoreVal:!0,includedTypes:[...M?[]:[e.Date,e.DateTime,e.LastModifiedTime,e.CreatedTime]]},{text:"one week ago",value:"oneWeekAgo",ignoreVal:!0,includedTypes:[...M?[]:[e.Date,e.DateTime,e.LastModifiedTime,e.CreatedTime]]},{text:"one week from now",value:"oneWeekFromNow",ignoreVal:!0,includedTypes:[...M?[]:[e.Date,e.DateTime,e.LastModifiedTime,e.CreatedTime]]},{text:"one month ago",value:"oneMonthAgo",ignoreVal:!0,includedTypes:[e.Date,e.DateTime,e.LastModifiedTime,e.CreatedTime]},{text:"one month from now",value:"oneMonthFromNow",ignoreVal:!0,includedTypes:[e.Date,e.DateTime,e.LastModifiedTime,e.CreatedTime]},{text:"number of days ago",value:"daysAgo",ignoreVal:!1,includedTypes:[...M?[]:[e.Date,e.DateTime,e.LastModifiedTime,e.CreatedTime]]},{text:"number of days from now",value:"daysFromNow",ignoreVal:!1,includedTypes:[...M?[]:[e.Date,e.DateTime,e.LastModifiedTime,e.CreatedTime]]},{text:M?"exact month":"exact date",value:"exactDate",ignoreVal:!1,includedTypes:[e.Date,e.DateTime,e.LastModifiedTime,e.CreatedTime]}]};function rl(){return"default"}function dl(d,de=500,M=rl,B={}){const b=new Map;return(...fe)=>{const $=M(...fe);if(!b.has($)){const k=Xt(d,de,B);b.set($,k)}return b.get($)(...fe)}}function cl(d,de,M,B,b,fe,$,C,k,j){const W={},L=R(de),ee=R(b),he=R({}),g=ge(St),{nestedFilters:U,allFilters:O}=At(),{baseMeta:P}=nt(it()),Ve=ge($t,R(!1)),{$api:A,$e:oe}=Ot(),{isUIAllowed:we}=Jt(),{metas:ce,getMeta:V}=ea(),{addUndo:N,clone:pe,defineViewScope:me}=ta(),ze=R([...ee.value||[]]),Te=I(()=>Ve.value||!we("filterSync")||!we("filterChildrenRead")),c=I({get:()=>Te.value&&!C&&!$?ee.value:ze.value,set:s=>{if(Te.value){ee.value=s,!C&&!$&&(fe||(U.value=s),U.value=[...U.value]),g==null||g.trigger();return}ze.value=s}}),te=I(()=>c.value.filter(s=>s.status!=="delete")),xe=ge(Bt,R()),Me=ge(Ut,R()),{showSystemFields:ve,metaColumnById:Se}=Wa(),Ie=I(()=>{var s,n;return(n=(s=xe.value)==null?void 0:s.columns)==null?void 0:n.filter(u=>{var r;return Xe((r=Se==null?void 0:Se.value)==null?void 0:r[u.id])?ve.value:u.uidt===e.QrCode||u.uidt===e.Barcode||u.uidt===e.ID||u.system?!1:!(u.colOptions&&u.system)})}),$e=I(()=>{var s,n,u,r;return(n=(s=xe.value)==null?void 0:s.columns)!=null&&n.length?(r=(u=xe.value)==null?void 0:u.columns)==null?void 0:r.reduce((v,m)=>{if(m.uidt===e.Formula){const h=aa({formulaColumn:m});v[m.id]=h||m.uidt}else he.value[m.id]?v[m.id]=he.value[m.id].uidt:v[m.id]=m.uidt;return v},{}):{}}),be=R([]);la(c,s=>{be.value=pe(s)});const Je=(s,n)=>Object.entries(n).filter(([u,r])=>s[u]!==r&&u in s).reduce((u,[r,v])=>({...u,[r]:v}),{}),Be=(s,n)=>{const u=["empty","notempty","null","notnull"].includes(n.value),r=$e.value[s.fk_column_id];return n.includedTypes?s.fk_column_id&&n.includedTypes.includes(r)?u?P.value.showNullAndEmptyInFilter:!0:!1:n.excludedTypes?s.fk_column_id&&!n.excludedTypes.includes(r)?u?P.value.showNullAndEmptyInFilter:!0:!1:u?P.value.showNullAndEmptyInFilter:!0},et=(s,n)=>{const u=$e.value[s.fk_column_id];if(n.includedTypes)return s.fk_column_id&&n.includedTypes.includes(u);if(n.excludedTypes)return s.fk_column_id&&!n.excludedTypes.includes(u)},Ue=()=>{var n,u,r,v,m,h;const s=new Set(c.value.slice(1).map(F=>F.logical_op));return{comparison_op:(r=(u=qe((n=Ie.value)==null?void 0:n[0].uidt).filter(F=>{var q;return Be({fk_column_id:(q=Ie.value)==null?void 0:q[0].id},F)}))==null?void 0:u[0])==null?void 0:r.value,value:null,status:"create",logical_op:s.size===1?s.values().next().value:"and",fk_column_id:((h=(m=(v=j==null?void 0:j.value)==null?void 0:v.filter(F=>!Xe(F)))==null?void 0:m[0])==null?void 0:h.id)??void 0}},tt=()=>{const s=new Set(c.value.slice(1).map(n=>n.logical_op));return{is_group:!0,status:"create",logical_op:s.size===1?s.values().next().value:"and"}},ae=async s=>{const n=[],u=[];for(const r of s)if(r.id&&r.is_group){const v=A.dbTableFilter.childrenRead(r.id).then(m=>{const h=m.list;return u.push(...h),ae(h)});n.push(v)}await Promise.all(n),!C&&!$&&O.value.push(...u)},Oe=async({hookId:s,isLink:n,isWebhook:u,loadAllFilters:r}={})=>{var v;if((v=d.value)!=null&&v.id&&!Te.value)try{u||s?L.value?c.value=(await A.dbTableFilter.childrenRead(L.value)).list:s&&!fe&&(c.value=(await A.dbTableWebhookFilter.read(s)).list):n||k!=null&&k.value?L.value?c.value=(await A.dbTableFilter.childrenRead(L.value)).list:k!=null&&k.value&&!fe&&(c.value=(await A.dbTableLinkFilter.read(k==null?void 0:k.value)).list):L.value?c.value=(await A.dbTableFilter.childrenRead(L.value)).list:(c.value=(await A.dbTableFilter.read(d.value.id)).list,r&&(O.value=[...c.value],await ae(O.value)))}catch(m){console.log(m),Ze.error(await Ke(m))}},Ae=async({hookId:s,linkId:n})=>{var u,r;try{for(const[v,m]of Object.entries(c.value))if(m.status==="delete")await A.dbTableFilter.delete(m.id),m.is_group?Fe(m):!C&&!$&&(O.value=O.value.filter(h=>h.id!==m.id));else if(m.status==="update")await A.dbTableFilter.update(m.id,{...m,fk_parent_id:L.value});else if(m.status==="create"){const h=(u=c.value[+v])==null?void 0:u.children;s?c.value[+v]=await A.dbTableWebhookFilter.create(s,{...m,children:void 0,fk_parent_id:L.value}):n||k!=null&&k.value?c.value[+v]=await A.dbTableLinkFilter.create(n||k.value,{...m,children:void 0,fk_parent_id:L.value}):c.value[+v]=await A.dbTableFilter.create((r=d==null?void 0:d.value)==null?void 0:r.id,{...m,fk_parent_id:L.value}),h&&(c.value[+v].children=h),!C&&!$&&O.value.push(c.value[+v])}!$&&!C&&(B==null||B())}catch(v){console.log(v),Ze.error(await Ke(v))}},Ce=dl(ne,500,(s,n)=>n);async function ne(s,n,u=!1,r=!1,v=!1){var m,h;if(W[n])return Ce(s,n,u,r,v);if(Array.from({length:n}).some((F,q)=>W[q]))return Ce(s,n,u,r,v);if(W[n]=!0,!(!d.value&&!(k!=null&&k.value))){if(!r){const F=be.value[n];if(F){const q=pe(Je(s,F));Object.keys(q).length>0&&N({undo:{fn:(X,ke)=>{const G=c.value[n];G&&(G[X]=ke,ne(G,n,u,!0))},args:[Object.keys(q)[0],Object.values(q)[0]]},redo:{fn:(X,ke)=>{const G=c.value[n];G&&(G[X]=ke,ne(G,n,u,!0))},args:[Object.keys(q)[0],s[Object.keys(q)[0]]]},scope:me({view:Me.value})})}}try{if(Te.value)c.value[n]={...s},c.value=[...c.value];else if(!(M!=null&&M.value)&&!u)s.status=s.id?"update":"create";else if((m=c.value[n])!=null&&m.id&&((h=c.value[n])==null?void 0:h.status)!=="create")await A.dbTableFilter.update(c.value[n].id,{...s,fk_parent_id:L.value}),oe("a:filter:update",{logical:s.logical_op,comparison:s.comparison_op,link:!!C,webHook:!!$});else{if(k!=null&&k.value){const F=await A.dbTableLinkFilter.create(k.value,{...s,fk_parent_id:L.value});c.value[n]={...c.value[n],fk_parent_id:L.value,id:F.id,status:void 0}}else{const F=await A.dbTableFilter.create(d.value.id,{...s,fk_parent_id:L.value});c.value[n]={...c.value[n],fk_parent_id:L.value,id:F.id,status:void 0}}!C&&!$&&O.value.push(c.value[+n])}}catch(F){console.log(F),Ze.error(await Ke(F))}finally{W[n]=!1}be.value=pe(c.value),!$&&!v&&!C&&(B==null||B())}}function Fe(s){if(!C&&!$)return;O.value.filter(u=>u.fk_parent_id===s.id).forEach(u=>{u.is_group&&Fe(u)}),O.value=O.value.filter(u=>u.id!==s.id&&u.fk_parent_id!==s.id)}const le=async(s,n,u=!1)=>{if(s.status="delete",!u&&!s.is_group&&N({undo:{fn:async r=>{r.status="create",c.value.splice(n,0,r),await ne(r,n,!1,!0)},args:[pe(s)]},redo:{fn:async r=>{await le(c.value[r],r,!0)},args:[n]},scope:me({view:Me.value})}),Te.value)c.value.splice(n,1),c.value=[...c.value],!$&&!C&&(B==null||B());else{if(s.id)if(!(M!=null&&M.value))s.status="delete";else try{await A.dbTableFilter.delete(s.id),!$&&!C&&(B==null||B());const r=c.value.findIndex(v=>v.id===s.id);r>-1&&c.value.splice(r,1)}catch(r){console.log(r),Ze.error(await Ke(r))}else c.value.splice(n,1);oe("a:filter:delete",{length:te.value.length,link:!!C,webHook:!!$})}s.is_group?Fe(s):!C&&!$&&(O.value=O.value.filter(r=>r.id!==s.id))},Ee=async(s=!1,n={})=>{c.value.push(n!=null&&n.fk_column_id?{...Ue(),...n}:Ue()),s||N({undo:{fn:async function(r){this.redo.args=[r,pe(c.value[r])],await le(c.value[r],r,!0)},args:[c.value.length-1]},redo:{fn:async(u,r)=>{r.status="create",c.value.splice(u,0,r),await ne(r,u,!1,!0)},args:[]},scope:me({view:Me.value})}),be.value=pe(c.value),oe("a:filter:add",{length:c.value.length,link:!!C,webHook:!!$})},He=async()=>{const s=Ue(),n=tt();Te.value&&(n.children=[s]),c.value.push(n);const u=c.value.length-1;await ne(c.value[u],u),be.value=pe(c.value),oe("a:filter:add",{length:c.value.length,group:!0,link:!!C,webHook:!!$})};return Pe(()=>{var s,n,u,r,v,m;return!(d!=null&&d.value)||!((n=ce==null?void 0:ce.value)!=null&&n[(s=d==null?void 0:d.value)==null?void 0:s.fk_model_id])?0:((m=(v=(r=ce==null?void 0:ce.value)==null?void 0:r[(u=d==null?void 0:d.value)==null?void 0:u.fk_model_id])==null?void 0:v.columns)==null?void 0:m.length)||0},async(s,n)=>{s&&s<n&&await Oe()}),{filters:c,nonDeletedFilters:te,loadFilters:Oe,sync:Ae,deleteFilter:le,saveOrUpdate:ne,addFilter:Ee,addFilterGroup:He,saveOrUpdateDebounced:Ce,isComparisonOpAllowed:Be,isComparisonSubOpAllowed:et,loadBtLookupTypes:async()=>{var n,u,r,v;const s={};try{for(const m of((n=xe.value)==null?void 0:n.columns)||[]){if(m.uidt!==e.Lookup)continue;let h=m;for(;h&&h.uidt===e.Lookup;){const F=(r=(u=await V(h.fk_model_id))==null?void 0:u.columns)==null?void 0:r.find(X=>X.id===h.colOptions.fk_relation_column_id);if(!F)break;const q=await V((F==null?void 0:F.colOptions).fk_related_model_id);if(h=(v=q==null?void 0:q.columns)==null?void 0:v.find(X=>X.id===h.colOptions.fk_lookup_column_id),(h==null?void 0:h.id)===m.id)break}s[m.id]=h}he.value=s}catch(m){console.error(m)}},btLookupTypesMap:he,types:$e}}const pl=_a(()=>ga(()=>Promise.resolve().then(()=>Ql),void 0,import.meta.url).then(d=>d.default||d)),Ge=d=>(Ta("data-v-16161f23"),d=d(),ha(),d),ml={key:0,class:"flex min-w-full w-min items-center mb-2"},fl=Ge(()=>w("div",{class:"flex-grow"},null,-1)),vl={class:"flex items-center gap-1"},yl={class:"flex items-center gap-1"},_l={class:"flex items-center gap-1"},gl={class:"flex items-center gap-1"},Tl={key:0,class:"flex flex-col min-w-full w-min gap-y-2"},hl={key:0,class:"flex items-center nc-filter-where-label ml-1"},wl={class:"flex items-center w-full justify-between w-full gap-2"},bl={class:"truncate flex-1 capitalize"},kl={key:0,class:"flex items-center !min-w-18 !max-w-18 pl-3 nc-filter-where-label"},xl={class:"flex items-center w-full justify-between w-full gap-2"},Ml={class:"truncate flex-1 capitalize"},Cl={class:"flex items-center w-full justify-between w-full gap-2"},Fl={class:"truncate flex-1"},Dl={key:2,class:"flex flex-grow"},Ll={class:"flex items-center w-full justify-between w-full gap-2 max-w-40"},Vl={class:"flex items-center flex-grow"},Sl={key:0,class:"flex-grow"},$l={key:2,class:"flex-grow"},Bl={class:"relative overflow-visible min-h-17 w-10"},Ul=["onClick"],Ol={class:"flex flex-row items-center justify-between w-full"},Al=Ge(()=>w("div",{class:"flex flex-row items-center justify-start gap-x-3"},"Static condition",-1)),Rl=Ge(()=>w("div",{class:"flex flex-row text-xs text-gray-400"},"Filter based on static value",-1)),jl=["onClick"],Nl={class:"flex flex-row items-center justify-between w-full"},Pl=Ge(()=>w("div",{class:"flex flex-row items-center justify-start gap-x-2.5"},"Dynamic condition",-1)),ql=Ge(()=>w("div",{class:"flex flex-row text-xs text-gray-400"},"Filter based on dynamic value",-1)),Gl={class:"flex items-center gap-1"},zl={class:"flex items-center gap-1"},Il={class:"flex items-center gap-1"},El={class:"flex items-center gap-1"},Hl=Dt({__name:"ColumnFilter",props:{nestedLevel:{default:0},parentId:{default:void 0},autoSave:{type:Boolean,default:!0},hookId:{default:void 0},showLoading:{type:Boolean,default:!0},modelValue:{},webHook:{type:Boolean,default:!1},link:{type:Boolean,default:!1},draftFilter:{},isOpen:{type:Boolean},rootMeta:{},linkColId:{default:void 0},actionBtnType:{default:"text"}},emits:["update:filtersLength","update:draftFilter","update:modelValue"],setup(d,{expose:de,emit:M}){var pt,mt;const B=d,b=M,fe=B.modelValue,$=[e.QrCode,e.Barcode,e.Button],C=yt(B,"draftFilter",b),k=yt(B,"modelValue",b),{nestedLevel:j,parentId:W,autoSave:L,hookId:ee,showLoading:he,webHook:g,link:U,linkColId:O}=sa(B),P=I(()=>j.value>0),{t:Ve}=oa(),A=[{value:"and",text:Ve("general.and")},{value:"or",text:Ve("general.or")}],oe=ge(Bt,R()),we=ge(Ut,R()),ce=ge(St),V=ge(na),N=ge($t,R(!1)),{$e:pe}=Ot(),{nestedFilters:me}=At(),ze=k.value||!U.value&&!g.value&&me.value||[],Te=I(()=>{var t;return(t=oe.value)==null?void 0:t.columns}),c=I(()=>(Te.value||[]).filter(t=>U.value&&Xe(t)&&!t.pk&&!ia(t)?!1:!$.includes(t.uidt))),{filters:te,nonDeletedFilters:xe,deleteFilter:Me,saveOrUpdate:ve,loadFilters:Se,addFilter:Ie,addFilterGroup:$e,sync:be,saveOrUpdateDebounced:Je,isComparisonOpAllowed:Be,isComparisonSubOpAllowed:et,loadBtLookupTypes:Ue,btLookupTypesMap:tt,types:ae}=cl(we,W,I(()=>L.value),()=>{ce.trigger({shouldShowLoading:he.value,offset:0}),V==null||V.trigger()},ze,B.nestedLevel>0,g.value,U.value,O,c),{getPlanLimit:Oe}=ua(),Ae=R(),Ce=R(),ne=R(),Fe=R(!1),le=t=>{var o;return tt.value[t.fk_column_id]||((o=Te.value)==null?void 0:o.find(p=>p.id===t.fk_column_id))},Ee=R({}),He=(t,o)=>{var p,S,y,H;return!(t.id||t.comparison_op&&((S=We(t.comparison_op,(p=o==null?void 0:o.meta)==null?void 0:p.date_format).find(se=>se.value===t.comparison_sub_op))!=null&&S.ignoreVal)||(H=qe(ae.value[o.id],(y=o==null?void 0:o.meta)==null?void 0:y.date_format).find(se=>se.value===t.comparison_op))!=null&&H.ignoreVal||t.value)},at=(t,o)=>{var S;const p=le(t);p&&(p.uidt===e.SingleSelect&&["anyof","nanyof"].includes(Ee.value[t.id])&&["eq","neq"].includes(t.comparison_op)?t.value=null:["blank","notblank","empty","notempty","null","notnull"].includes(t.comparison_op)?(t.value=null,t.comparison_sub_op=null):ke(ae.value[p.id])&&(t.value=null,We(t.comparison_op,(S=p==null?void 0:p.meta)==null?void 0:S.date_format).map(y=>y.value).includes(t.comparison_sub_op)||(t.comparison_op==="isWithin"?t.comparison_sub_op="pastNumberOfDays":t.comparison_sub_op="exactDate")),He(t,p)||ve(t,o),Ee.value[t.id]=t.comparison_op,pe("a:filter:update",{logical:t.logical_op,comparison:t.comparison_op,comparison_sub_op:t.comparison_sub_op,link:!!U.value,webHook:!!g.value}))};Pe(()=>{var t;return(t=we.value)==null?void 0:t.id},(t,o)=>{!P.value&&t!==o&&(ee!=null&&ee.value||!g.value)&&(O!=null&&O.value||!U.value)&&Se({hookId:ee.value,isWebhook:g.value,linkColId:a(O),isLink:U.value})});const s=ge(ra,R({}));Pe(()=>xe.value.length,t=>{s.value[(W==null?void 0:W.value)??"root"]=[...xe.value],b("update:filtersLength",t??0)});const n=I(()=>Object.values(s.value).reduce((t,o)=>t+o.filter(p=>!p.is_group).length,0)),u=async(t,o=!1,p=!0)=>{var S;if(!p)for(let y=te.value.length-1;y>=0;y--)await Me(te.value[y],y);if(U.value){if(!t&&!B.nestedLevel)return;await be({linkId:t,nested:o})}else await be({hookId:t,nested:o});if((S=Ae.value)!=null&&S.length)for(const y of Ae.value)y.parentId&&await y.applyChanges(t,!0)},r=(t,o)=>{var S,y;const p=le(t);p&&(ot(p)?rt(t,o).catch(()=>{}):t.fk_value_col_id=null,t.comparison_op=(y=qe(ae.value[p.id],(S=p==null?void 0:p.meta)==null?void 0:S.date_format).find(H=>Be(t,H)))==null?void 0:y.value,ke(ae.value[p.id])&&!["blank","notblank"].includes(t.comparison_op)?t.comparison_op==="isWithin"?t.comparison_sub_op="pastNumberOfDays":t.comparison_sub_op="exactDate":t.comparison_sub_op=null,t.value=null,He(t,p)||ve(t,o))},v=(t,o,p)=>{o.value=t,Je(o,p)};de({applyChanges:u,parentId:W});const m=()=>{var t;(t=Ce.value)==null||t.scrollTo({top:Ce.value.scrollHeight,behavior:"smooth"})},h=()=>{var t;P.value&&((t=ne==null?void 0:ne.value)==null||t.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"}))},F=async t=>{await Ie(!1,t),t&&r(te.value[te.value.length-1],te.value.length-1),P.value?h():m()},q=async()=>{await $e(),P.value?h():m()},X=t=>{var p,S,y,H,se;const o=le(t);return t.comparison_op?t.comparison_sub_op?!((y=We(t.comparison_op,(S=(p=le(t))==null?void 0:p.meta)==null?void 0:S.date_format).find(ie=>ie.value===t.comparison_sub_op))!=null&&y.ignoreVal):!((se=qe(ae.value[o==null?void 0:o.id],(H=o==null?void 0:o.meta)==null?void 0:H.date_format).find(ie=>ie.value===t.comparison_op))!=null&&se.ignoreVal):!1};da(async()=>{await Promise.all([(async()=>{fe||await Se({hookId:ee==null?void 0:ee.value,isWebhook:g.value,linkColId:a(O),isLink:U.value})})(),Ue()]),Fe.value=!0}),ca(()=>{W.value&&delete s.value[W.value]});function ke(t){return[e.Date,e.DateTime,e.CreatedTime,e.LastModifiedTime].includes(t)}Pe([C,Fe],async()=>{var p,S;if(!Fe.value||!((p=C.value)!=null&&p.fk_column_id))return;await F(C.value),await pa(),m();const t=document.querySelectorAll(`.nc-filter-wrapper-${C.value.fk_column_id}`);if(C.value={},!t.length)return;const o=(S=t[t.length-1])==null?void 0:S.querySelector(".nc-filter-value-select input");o&&setTimeout(()=>{var y,H;(y=o==null?void 0:o.focus)==null||y.call(o),(H=o==null?void 0:o.click)==null||H.call(o)},100)},{deep:!0,immediate:!0});const G=I(()=>te.value.filter(t=>t.status!=="delete")),Ye=I(()=>new Set(G.value.slice(1).map(t=>t.logical_op)).size>1),ut=async(t,o)=>{o===1&&G.value.slice(2).every(p=>p.logical_op!==t.logical_op)&&await Promise.all(G.value.slice(2).map(async(p,S)=>{p.logical_op=t.logical_op,await ve(p,S+2,!1,!1,!0)})),await ve(t,o)};Pe(te,t=>{t&&t!==k.value&&(k.value=t)},{immediate:!0});async function rt(t,o){t.dynamic=!1,t.fk_value_col_id=null,await ve(t,o)}const{sqlUis:dt}=nt(it()),lt=(pt=oe.value)!=null&&pt.source_id?dt.value[(mt=oe.value)==null?void 0:mt.source_id]:Object.values(dt.value)[0],ct=t=>{const o=le(t);if(ot(o)||[e.Attachment,e.Rating,e.Checkbox,e.QrCode,e.Barcode,e.Collaborator,e.GeoData,e.SpecificDBType].includes(o.uidt))return!1;const p=lt.getAbstractType(o);return["integer","float","text","string"].includes(p)?!t.comparison_op||["eq","lt","gt","lte","gte","like","nlike","neq"].includes(t.comparison_op):!1},Rt=t=>{var p,S;const o=le(t);return o?(S=(p=B.rootMeta)==null?void 0:p.columns)==null?void 0:S.filter(y=>{if($.includes(y.uidt)||ot(y)||Xe(y)&&!y.pk)return!1;const H=lt.getAbstractType(y),se=lt.getAbstractType(o);return[H,se].every(ie=>["float","integer"].includes(ie))||[H,se].every(ie=>["text","string"].includes(ie))?!0:se===H}):[]},jt=async(t,o)=>{t.dynamic=ct(t)&&X(t),await ve(t,o)};return(t,o)=>{const p=fa,S=wa,y=va,H=ba,se=ka,ie=Ka,Qe=xa,Nt=pl,ft=Ma,Pt=ya,qt=Xa,Gt=el,De=ma("e");return i(),T("div",{"data-testid":"nc-filter",class:E(["menu-filter-dropdown w-min",{"max-h-[max(80vh,500px)] min-w-112 py-2 pl-4":!a(P),"!min-w-full !w-full !pl-0":!a(P)&&a(g),"min-w-full":a(P)}])},[a(P)?(i(),T("div",ml,[w("div",{class:E([`nc-filter-logical-op-level-${a(j)}`])},[st(t.$slots,"start",{},void 0,!0)],2),fl,re(se,{trigger:["hover"],"overlay-class-name":"nc-dropdown-filter-group-sub-menu"},{overlay:x(()=>[re(H,null,{default:x(()=>[("isEeUI"in t?t.isEeUI:a(_t))&&!a(N)?(i(),T(Z,{key:0},[a(n)<a(Oe)(a(gt).FILTER_LIMIT)?(i(),T(Z,{key:0},[re(S,{onClick:o[0]||(o[0]=Q(l=>F(),["stop"]))},{default:x(()=>[w("div",vl,[(i(),_(K(("iconMap"in t?t.iconMap:a(J)).plus))),_e(" "+Y(t.$t("activity.addFilter")),1)])]),_:1}),a(j)<5?(i(),_(S,{key:0,onClick:o[1]||(o[1]=Q(l=>q(),["stop"]))},{default:x(()=>[w("div",yl,[(i(),_(K(("iconMap"in t?t.iconMap:a(J)).plusSquare))),_e(" "+Y(t.$t("activity.addFilterGroup")),1)])]),_:1})):D("",!0)],64)):D("",!0)],64)):(i(),T(Z,{key:1},[re(S,{onClick:o[2]||(o[2]=Q(l=>F(),["stop"]))},{default:x(()=>[w("div",_l,[(i(),_(K(("iconMap"in t?t.iconMap:a(J)).plus))),_e(" "+Y(t.$t("activity.addFilter")),1)])]),_:1}),!a(g)&&a(j)<5?(i(),_(y,{key:0,onClick:o[3]||(o[3]=Q(l=>q(),["stop"]))},{default:x(()=>[w("div",gl,[(i(),_(K(("iconMap"in t?t.iconMap:a(J)).plusSquare))),_e(" "+Y(t.$t("activity.addFilterGroup")),1)])]),_:1})):D("",!0)],64))]),_:1})]),default:x(()=>[re(p,{icon:"plus",class:"cursor-pointer"})]),_:1}),w("div",null,[st(t.$slots,"end",{},void 0,!0)])])):D("",!0),a(G)&&a(G).length?(i(),T("div",{key:1,ref_key:"wrapperDomRef",ref:Ce,class:E(["flex flex-col gap-y-1.5 nc-filter-grid min-w-full w-min",{"max-h-420px nc-scrollbar-thin nc-filter-top-wrapper pr-4 my-2 py-1":!a(P),"!pr-0":a(g)&&!a(P)}]),onClick:o[8]||(o[8]=Q(()=>{},["stop"]))},[(i(!0),T(Z,null,Ne(a(te),(l,z)=>(i(),T(Z,{key:z},[l.status!=="delete"?(i(),T(Z,{key:0},[l.is_group?(i(),T("div",Tl,[w("div",{class:E(["flex rounded-lg p-2 min-w-full w-min border-1",[`nc-filter-nested-level-${a(j)}`]])},[l.id||l.children||!a(L)?(i(),_(Nt,{key:z,ref_for:!0,ref_key:"localNestedFilters",ref:Ae,modelValue:l.children,"onUpdate:modelValue":f=>l.children=f,"nested-level":a(j)+1,"parent-id":l.id,"auto-save":a(L),"web-hook":a(g),link:a(U),"show-loading":!1,"root-meta":t.rootMeta,"link-col-id":a(O)},{start:x(()=>[a(G).indexOf(l)?(i(),T("div",{key:`${z}nested`,class:"flex nc-filter-logical-op"},[Le((i(),_(Qe,{value:l.logical_op,"onUpdate:value":f=>l.logical_op=f,"dropdown-match-select-width":!1,class:E(["min-w-18 capitalize",{"nc-disabled-logical-op":l.readOnly||z>1&&!a(Ye),"!max-w-18":!a(g),"!w-full":a(g)}]),placeholder:"Group op","dropdown-class-name":"nc-dropdown-filter-logical-op-group",disabled:z>1&&!a(Ye),onClick:o[4]||(o[4]=Q(()=>{},["stop"])),onChange:f=>ut(l,z)},{default:x(()=>[(i(),T(Z,null,Ne(A,f=>re(ie,{key:f.value,value:f.value},{default:x(()=>[w("div",wl,[w("div",bl,Y(f.value),1),l.logical_op===f.value?(i(),_(K(("iconMap"in t?t.iconMap:a(J)).check),{key:0,id:"nc-selected-item-icon",class:"text-primary w-4 h-4"})):D("",!0)])]),_:2},1032,["value"])),64))]),_:2},1032,["value","onUpdate:value","disabled","class","onChange"])),[[De,["c:filter:logical-op:select"]]])])):(i(),T("span",hl,Y(t.$t("labels.where")),1))]),end:x(()=>[l.readOnly?D("",!0):Le((i(),_(y,{key:z,type:"text",size:"small",class:"nc-filter-item-remove-btn cursor-pointer",onClick:Q(f=>a(Me)(l,z),["stop"])},{default:x(()=>[(i(),_(K(("iconMap"in t?t.iconMap:a(J)).deleteListItem)))]),_:2},1032,["onClick"])),[[De,["c:filter:delete",{link:!!a(U),webHook:!!a(g)}]]])]),_:2},1032,["modelValue","onUpdate:modelValue","nested-level","parent-id","auto-save","web-hook","link","root-meta","link-col-id"])):D("",!0)],2)])):(i(),T("div",{key:1,class:E(["flex flex-row gap-x-0 w-full nc-filter-wrapper",`nc-filter-wrapper-${l.fk_column_id}`])},[a(G).indexOf(l)?Le((i(),_(Qe,{key:1,value:l.logical_op,"onUpdate:value":f=>l.logical_op=f,"dropdown-match-select-width":!1,class:E(["h-full !max-w-18 !min-w-18 capitalize",{"nc-disabled-logical-op":l.readOnly||a(G).indexOf(l)>1&&!a(Ye)}]),"hide-details":"",disabled:l.readOnly||a(G).indexOf(l)>1&&!a(Ye),"dropdown-class-name":"nc-dropdown-filter-logical-op",onChange:f=>ut(l,z),onClick:o[5]||(o[5]=Q(()=>{},["stop"]))},{default:x(()=>[(i(),T(Z,null,Ne(A,f=>re(ie,{key:f.value,value:f.value},{default:x(()=>[w("div",xl,[w("div",Ml,Y(f.value),1),l.logical_op===f.value?(i(),_(K(("iconMap"in t?t.iconMap:a(J)).check),{key:0,id:"nc-selected-item-icon",class:"text-primary w-4 h-4"})):D("",!0)])]),_:2},1032,["value"])),64))]),_:2},1032,["value","onUpdate:value","disabled","class","onChange"])),[[De,["c:filter:logical-op:select",{link:!!a(U),webHook:!!a(g)}]]]):(i(),T("div",kl,Y(t.$t("labels.where")),1)),(i(),_(ft,{key:`${z}_6`,modelValue:l.fk_column_id,"onUpdate:modelValue":f=>l.fk_column_id=f,class:E([{"max-w-32":!a(g),"!w-full":a(g)},"nc-filter-field-select min-w-32 max-h-8"]),columns:a(c),disabled:l.readOnly,meta:a(oe),onClick:o[6]||(o[6]=Q(()=>{},["stop"])),onChange:f=>r(l,z)},null,8,["modelValue","onUpdate:modelValue","class","columns","disabled","meta","onChange"])),Le((i(),_(Qe,{value:l.comparison_op,"onUpdate:value":f=>l.comparison_op=f,"dropdown-match-select-width":!1,class:E(["caption nc-filter-operation-select !min-w-26.75 max-h-8",{"!max-w-26.75":!a(g),"!w-full":a(g)}]),placeholder:t.$t("labels.operation"),density:"compact",variant:"solo",disabled:l.readOnly,"hide-details":"","dropdown-class-name":"nc-dropdown-filter-comp-op !max-w-80",onChange:f=>at(l,z)},{default:x(()=>{var f,Re;return[(i(!0),T(Z,null,Ne(("comparisonOpList"in t?t.comparisonOpList:a(qe))(a(ae)[l.fk_column_id],(Re=(f=le(l))==null?void 0:f.meta)==null?void 0:Re.date_format),ue=>(i(),T(Z,{key:ue.value},[a(Be)(l,ue)?(i(),_(ie,{key:0,value:ue.value},{default:x(()=>[w("div",Cl,[w("div",Fl,Y(ue.text),1),l.comparison_op===ue.value?(i(),_(K(("iconMap"in t?t.iconMap:a(J)).check),{key:0,id:"nc-selected-item-icon",class:"text-primary w-4 h-4"})):D("",!0)])]),_:2},1032,["value"])):D("",!0)],64))),128))]}),_:2},1032,["value","onUpdate:value","placeholder","class","disabled","onChange"])),[[De,["c:filter:comparison-op:select",{link:!!a(U),webHook:!!a(g)}]]]),["blank","notblank"].includes(l.comparison_op)?(i(),T("div",Dl)):ke(a(ae)[l.fk_column_id])?Le((i(),_(Qe,{key:3,value:l.comparison_sub_op,"onUpdate:value":f=>l.comparison_sub_op=f,"dropdown-match-select-width":!1,class:E(["caption nc-filter-sub_operation-select min-w-28",{"flex-grow w-full":!X(l),"max-w-28":X(l)&&!a(g)}]),placeholder:t.$t("labels.operationSub"),density:"compact",variant:"solo",disabled:l.readOnly,"hide-details":"","dropdown-class-name":"nc-dropdown-filter-comp-sub-op",onChange:f=>at(l,z)},{default:x(()=>{var f,Re;return[(i(!0),T(Z,null,Ne(("comparisonSubOpList"in t?t.comparisonSubOpList:a(We))(l.comparison_op,(Re=(f=le(l))==null?void 0:f.meta)==null?void 0:Re.date_format),ue=>(i(),T(Z,{key:ue.value},[a(et)(l,ue)?(i(),_(ie,{key:0,value:ue.value},{default:x(()=>[w("div",Ll,[re(Pt,{"show-on-truncate-only":"",class:"truncate flex-1"},{title:x(()=>[_e(Y(ue.text),1)]),default:x(()=>[_e(" "+Y(ue.text),1)]),_:2},1024),l.comparison_sub_op===ue.value?(i(),_(K(("iconMap"in t?t.iconMap:a(J)).check),{key:0,id:"nc-selected-item-icon",class:"text-primary w-4 h-4"})):D("",!0)])]),_:2},1032,["value"])):D("",!0)],64))),128))]}),_:2},1032,["value","onUpdate:value","class","placeholder","disabled","onChange"])),[[De,["c:filter:sub-comparison-op:select",{link:!!a(U),webHook:!!a(g)}]]]):D("",!0),w("div",Vl,[a(U)&&(l.dynamic||l.fk_value_col_id)?(i(),T("div",Sl,[X(l)?(i(),_(ft,{key:0,modelValue:l.fk_value_col_id,"onUpdate:modelValue":f=>l.fk_value_col_id=f,class:"nc-filter-field-select min-w-32 w-full max-h-8",columns:Rt(l),meta:t.rootMeta,onChange:f=>a(ve)(l,z)},null,8,["modelValue","onUpdate:modelValue","columns","meta","onChange"])):D("",!0)])):(i(),T(Z,{key:1},[l.field&&a(ae)[l.field]==="boolean"?(i(),_(qt,{key:0,checked:l.value,"onUpdate:checked":f=>l.value=f,dense:"",disabled:l.readOnly,onChange:f=>a(ve)(l,z)},null,8,["checked","onUpdate:checked","disabled","onChange"])):D("",!0),X(l)?(i(),_(Gt,{key:1,class:E(["nc-filter-value-select rounded-md min-w-34",{"!w-full":a(g),"!w-18":!a(g)}]),column:{...le(l),uidt:a(ae)[l.fk_column_id]},filter:l,onUpdateFilterValue:f=>v(f,l,z),onClick:o[7]||(o[7]=Q(()=>{},["stop"]))},null,8,["class","column","filter","onUpdateFilterValue"])):ke(a(ae)[l.fk_column_id])?D("",!0):(i(),T("div",$l))],64)),a(U)?(i(),_(se,{key:2,class:"nc-settings-dropdown h-full flex items-center min-w-0 rounded-lg",trigger:["click"],placement:"bottom"},{overlay:x(()=>[w("div",Bl,[w("div",{class:E(["absolute -top-21 flex flex-col min-h-34.5 w-70 p-1.5 bg-white rounded-lg border-1 border-gray-200 justify-start overflow-hidden",{"-left-32.5":!t.isAddNewRecordGridMode,"-left-21.5":t.isAddNewRecordGridMode}]),style:{"box-shadow":"0px 4px 6px -2px rgba(0, 0, 0, 0.06), 0px -12px 16px -4px rgba(0, 0, 0, 0.1)"}},[w("div",{class:"px-4 py-3 flex flex-col select-none gap-y-2 cursor-pointer rounded-md hover:bg-gray-100 text-gray-600 nc-new-record-with-grid group",onClick:f=>rt(l,z)},[w("div",Ol,[Al,!l.dynamic&&!l.fk_value_col_id?(i(),_(p,{key:0,icon:"check",class:"w-4 h-4 text-primary"})):D("",!0)]),Rl],8,Ul),Le((i(),T("div",{class:E(["px-4 py-3 flex flex-col select-none gap-y-2 cursor-pointer rounded-md hover:bg-gray-100 text-gray-600 nc-new-record-with-form group",ct(l)&&X(l)?"cursor-pointer":"cursor-not-allowed"]),onClick:f=>jt(l,z)},[w("div",Nl,[Pl,l.dynamic||l.fk_value_col_id?(i(),_(p,{key:0,icon:"check",class:"w-4 h-4 text-primary"})):D("",!0)]),ql],10,jl)),[[De,["c:filter:dynamic-filter"]]])],2)])]),default:x(()=>[re(y,{type:"text",size:"small"},{default:x(()=>[re(p,{icon:"settings"})]),_:1})]),_:2},1024)):D("",!0)]),l.readOnly?D("",!0):Le((i(),_(y,{key:4,type:"text",size:"small",class:"nc-filter-item-remove-btn self-center",onClick:Q(f=>a(Me)(l,z),["stop"])},{default:x(()=>[(i(),_(K(("iconMap"in t?t.iconMap:a(J)).deleteListItem)))]),_:2},1032,["onClick"])),[[De,["c:filter:delete",{link:!!a(U),webHook:!!a(g)}]]])],2))],64)):D("",!0)],64))),128))],2)):D("",!0),a(P)?D("",!0):(i(),T(Z,{key:2},[("isEeUI"in t?t.isEeUI:a(_t))&&!a(N)?(i(),T(Z,{key:0},[a(n)<a(Oe)(a(gt).FILTER_LIMIT)?(i(),T("div",{key:0,class:E(["flex gap-2",{"mt-1 mb-2":a(te).length}])},[re(y,{size:"small",type:t.actionBtnType,class:"nc-btn-focus",onClick:o[9]||(o[9]=Q(l=>F(),["stop"]))},{default:x(()=>[w("div",Gl,[(i(),_(K(("iconMap"in t?t.iconMap:a(J)).plus))),_e(" "+Y(t.$t("activity.addFilter")),1)])]),_:1},8,["type"]),a(j)<5?(i(),_(y,{key:0,class:"nc-btn-focus",type:t.actionBtnType,size:"small",onClick:o[10]||(o[10]=Q(l=>q(),["stop"]))},{default:x(()=>[w("div",zl,[(i(),_(K(("iconMap"in t?t.iconMap:a(J)).plus))),_e(" "+Y(t.$t("activity.addFilterGroup")),1)])]),_:1},8,["type"])):D("",!0)],2)):D("",!0)],64)):(i(),T("div",{key:1,ref_key:"addFiltersRowDomRef",ref:ne,class:E(["flex gap-2",{"mt-1 mb-2":a(te).length}])},[re(y,{class:"nc-btn-focus",size:"small",type:t.actionBtnType,onClick:o[11]||(o[11]=Q(l=>F(),["stop"]))},{default:x(()=>[w("div",Il,[(i(),_(K(("iconMap"in t?t.iconMap:a(J)).plus))),_e(" "+Y(t.$t("activity.addFilter")),1)])]),_:1},8,["type"]),!a(U)&&!a(g)&&a(j)<5?(i(),_(y,{key:0,class:"nc-btn-focus",type:t.actionBtnType,size:"small",onClick:o[12]||(o[12]=Q(l=>q(),["stop"]))},{default:x(()=>[w("div",El,[(i(),_(K(("iconMap"in t?t.iconMap:a(J)).plus))),_e(" "+Y(t.$t("activity.addFilterGroup")),1)])]),_:1},8,["type"])):D("",!0)],2))],64)),!a(G)||!a(G).length?(i(),T("div",{key:3,class:E(["flex flex-row text-gray-400 mt-2",{"ml-1":a(P),"ml-0.5":!a(P)}])},Y(t.$t("title.noFiltersAdded")),3)):D("",!0),st(t.$slots,"default",{},void 0,!0)],2)}}}),Yl=Lt(Hl,[["__scopeId","data-v-16161f23"]]),Ql=Object.freeze(Object.defineProperty({__proto__:null,default:Yl},Symbol.toStringTag,{value:"Module"}));export{Ql as C,Yl as _,cl as u};
