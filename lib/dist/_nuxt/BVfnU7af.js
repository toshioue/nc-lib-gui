const __vite__fileDeps=["./CnHJnvS0.js","./BLdk6lRf.js","./entry.B8GgT5QA.css","./B0DrfDji.js","./Cy50pBgZ.js","./JimKVLH8.js","./DWFLnnq8.js","./BQQOEPN4.js","./BD_L_KCX.js","./C-Z2v8Hi.js","./BTh9o-aK.js","./ETGzLqdt.js","./links.C8uCzV-l.css","./DV47GYLy.js","./RichText.M7uMQ9pA.css","./BV3lS4Sb.js","./BPzsK8fx.js","./CSxPNiqH.js","./VirtualCell.CZh3Dt_h.css","./utCgnnET.js","./BPK89SF_.js","./DTl_5Njz.js","./DoWzg9_J.js","./boyBAVNN.js","./CwqgNcWF.js","./Cell.DV_4HH8i.css","./CUmqjySl.js","./DivDataCell.1yCNpUg3.css","./hBhzkt6Q.js","./76B7kuMs.js","./D4vTL36A.js","./B0-3_x1m.js","./DeleteModal.SEMJ_gSK.css","./BWqs1SG-.js","./BwgB2nHU.js","./D13eUeY3.js","./BaHXy0hV.js","./DD6KJAAC.js","./JCToPTxN.js","./BLwY008C.js","./CBNgcPSC.js","./wBAlULwF.js","./BYLX6PMP.js","./DJNpGLJk.js","./DRbVe3tA.js","./SelectOptions.JaHDUZhn.css","./BFWmkR58.js","./Cajlse94.js","./DZeneEWs.js","./BrF0EXdL.js","./DTv03lbO.js","./KHtB3uuq.js","./DCNkOWj0.js","./DehHWxa3.js","./CKK7YKGi.js","./KocR1J4Z.js","./CeUmvK4L.js","./yAvBJhn8.js","./Switch.CEh6YzqD.css","./C9Sjn86N.js","./B2oTMMt7.js","./CAR_5qDD.js","./C0Si9_oy.js","./Df7iec88.js","./iRN6wbuV.js","./Select.Ct6CicDJ.css","./BpBaP95G.js","./ZMTPBx1J.js","./EditOrAddProvider.CRN0tnY2.css","./z-DV38Ib.js","./CMq1Pd5K.js","./yb8eD1L0.js","./BOA_Sk9j.js","./CaG6F-8Q.js","./DMNHEWRT.js","./MenuItem.C7h59s4s.css","./CsKtxyeB.js","./Menu.CQ8GNWeI.css","./B2VnlbYE.js","./D1rFOljU.js","./BtPl72f0.js","./C9I3jrHo.js","./9nfE2yqV.js","./ImiwO6hR.js","./Badge.D0-UrqG9.css","./DDDDo8jf.js","./DymyTw9u.js","./splitpanes.Ckqx9aWT.css","./Ba2iTMbm.js","./B4uVmeYG.js","./BQZLjQkv.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{o as b,U as C,a6 as Me,q as Se,b as y,w as x,al as We,am as ki,V as ye,R as Xe,aB as Hi,a7 as Qt,Y as re,S as T,f as xt,cO as io,ac as Ui,ag as no,r as B,H as Ye,a as v,P as l,c as W,d as se,Q as Pe,a2 as Kt,$ as Ni,aI as oo,p as qi,e as Yi,an as Ge,ao as Jt,_ as ei,ba as so,bL as Re,g6 as Xi,d0 as Gi,c$ as Zi,d1 as Qi,av as Pt,fH as ao,ai as ti,cP as ro,g as de,W as Ze,t as E,cU as H,a_ as wt,af as Ki,A as ii,h9 as lo,at as jt,a8 as Vt,d4 as De,d2 as Ht,dS as Ji,fw as en,fI as Ut,az as co,hu as ho,hq as nt,N as uo,L as mo,cB as fo,fC as po,cG as go,fY as vo,i9 as bo,i as wo,g8 as yo,cZ as _o,aA as Ei,cN as xo,O as zo,X as $i,T as ze,fG as Ne,aF as Co,cd as Ro,fW as Ao,Z as ke,a5 as Ee,d9 as So,gh as Mo,aG as ko,ap as Eo,dt as $o}from"./BLdk6lRf.js";import{_ as Io,a as Do}from"./CMq1Pd5K.js";import To from"./DehHWxa3.js";import Fo from"./CKK7YKGi.js";import{_ as Oo}from"./DMNHEWRT.js";import{_ as Lo}from"./CsKtxyeB.js";import{_ as Bo,a as Wo}from"./B2VnlbYE.js";import{a as Po}from"./BtPl72f0.js";import{k as jo,i as Vo}from"./CwqgNcWF.js";import{_ as tn}from"./9nfE2yqV.js";import{_ as Ho}from"./ImiwO6hR.js";import{u as Uo}from"./DDDDo8jf.js";import{g as _t,M as nn}from"./DymyTw9u.js";import{u as No}from"./yb8eD1L0.js";import{a as qo}from"./Ba2iTMbm.js";import{u as Yo}from"./DTl_5Njz.js";import{g as Xo,e as Go,r as Zo}from"./BQZLjQkv.js";import{F as on}from"./JCToPTxN.js";import{a as Qo}from"./KocR1J4Z.js";import{u as Ko}from"./BPK89SF_.js";import{D as Ii}from"./DJNpGLJk.js";import"./JimKVLH8.js";import{I as Jo}from"./DWFLnnq8.js";import{_ as es}from"./B2oTMMt7.js";import{_ as ts}from"./BTh9o-aK.js";import{_ as is}from"./BLwY008C.js";import{_ as ns}from"./yAvBJhn8.js";function Di(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),i.push.apply(i,o)}return i}function O(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Di(Object(i),!0).forEach(function(o){ue(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Di(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function ue(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function os(e,t){if(e==null)return{};var i,o,s=function(r,c){if(r==null)return{};var a,d,f={},p=Object.keys(r);for(d=0;d<p.length;d++)a=p[d],c.indexOf(a)>=0||(f[a]=r[a]);return f}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(o=0;o<n.length;o++)i=n[o],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(s[i]=e[i])}return s}function je(e){return function(t){if(Array.isArray(t))return Tt(t)}(e)||function(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}(e)||function(t,i){if(t){if(typeof t=="string")return Tt(t,i);var o=Object.prototype.toString.call(t).slice(8,-1);if(o==="Object"&&t.constructor&&(o=t.constructor.name),o==="Map"||o==="Set")return Array.from(t);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return Tt(t,i)}}(e)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Tt(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,o=new Array(t);i<t;i++)o[i]=e[i];return o}var Ti,ss,ft,G=(Ti=function(e){/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(){var t={}.hasOwnProperty;function i(){for(var o=[],s=0;s<arguments.length;s++){var n=arguments[s];if(n){var r=typeof n;if(r==="string"||r==="number")o.push(n);else if(Array.isArray(n)){if(n.length){var c=i.apply(null,n);c&&o.push(c)}}else if(r==="object")if(n.toString===Object.prototype.toString)for(var a in n)t.call(n,a)&&n[a]&&o.push(a);else o.push(n.toString())}}return o.join(" ")}e.exports?(i.default=i,e.exports=i):window.classNames=i})()},Ti(ft={path:ss,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(t==null&&ft.path)}},ft.exports),ft.exports),ve=function(e){return function(t,i){if(!t)return e;var o;typeof t=="string"?o=t:i=t;var s=e;return o&&(s+="__"+o),s+(i?Object.keys(i).reduce(function(n,r){var c=i[r];return c&&(n+=" "+(typeof c=="boolean"?s+"--"+r:s+"--"+r+"_"+c)),n},""):"")}};function Nt(e,t,i){var o,s,n,r,c;function a(){var f=Date.now()-r;f<t&&f>=0?o=setTimeout(a,t-f):(o=null,i||(c=e.apply(n,s),n=s=null))}t==null&&(t=100);var d=function(){n=this,s=arguments,r=Date.now();var f=i&&!o;return o||(o=setTimeout(a,t)),f&&(c=e.apply(n,s),n=s=null),c};return d.clear=function(){o&&(clearTimeout(o),o=null)},d.flush=function(){o&&(c=e.apply(n,s),n=s=null,clearTimeout(o),o=null)},d}Nt.debounce=Nt;var qt=Nt,A=function(){return A=Object.assign||function(e){for(var t,i=1,o=arguments.length;i<o;i++)for(var s in t=arguments[i])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},A.apply(this,arguments)};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function sn(e,t){var i,o;return e&&t?(i=""+e+t[0].toUpperCase()+t.slice(1),o=e+"-"+t):(i=e||t,o=e||t),{name:i,classname:o}}function an(e){return/^blob:/.test(e)}function Fi(e){return an(e)||function(t){return/^data:/.test(t)}(e)}function qe(e){return!!(e&&e.constructor&&e.call&&e.apply)}function Z(e){return e===void 0}function yt(e){return typeof e=="object"&&e!==null}function Yt(e,t,i){var o={};return yt(e)?(Object.keys(t).forEach(function(s){Z(e[s])?o[s]=t[s]:yt(t[s])?yt(e[s])?o[s]=Yt(e[s],t[s],i[s]):o[s]=e[s]?t[s]:i[s]:t[s]===!0||t[s]===!1?o[s]=!!e[s]:o[s]=e[s]}),o):e?t:i}function pt(e){var t=Number(e);return Number.isNaN(t)?e:t}function Oi(e){return typeof(e=="number"||function(t){return typeof t=="object"&&t!==null}(e)&&toString.call(e)=="[object Number]")&&!rn(e)}function rn(e){return e!=e}function ln(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}var ot=function(e,t){e===void 0&&(e={}),t===void 0&&(t={}),this.type="manipulateImage",this.move=e,this.scale=t},as=function(e,t){t===void 0&&(t={}),this.type="resize",this.directions=e,this.params=t},ni=function(e){this.type="move",this.directions=e},rs=function(){function e(t,i,o,s,n){this.type="drag",this.nativeEvent=t,this.position=o,this.previousPosition=s,this.element=i,this.anchor=n}return e.prototype.shift=function(){var t=this,i=t.element,o=t.anchor,s=t.position;if(i){var n=i.getBoundingClientRect(),r=n.left,c=n.top;return{left:s.left-r-o.left,top:s.top-c-o.top}}return{left:0,top:0}},e}(),oi={name:"DraggableElement",props:{classname:{type:String}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},mounted:function(){if(!this.$refs.draggable)throw new Error('You should add ref "draggable" to your root element to use draggable mixin');this.touches=[],this.hovered=!1},methods:{onMouseOver:function(){this.hovered||(this.hovered=!0,this.$emit("enter"))},onMouseLeave:function(){this.hovered&&!this.touches.length&&(this.hovered=!1,this.$emit("leave"))},onTouchStart:function(e){e.cancelable&&!this.disabled&&e.touches.length===1&&(this.touches=je(e.touches),this.hovered||(this.$emit("enter"),this.hovered=!0),e.touches.length&&this.initAnchor(this.touches.reduce(function(t,i){return{clientX:t.clientX+i.clientX/e.touches.length,clientY:t.clientY+i.clientY/e.touches.length}},{clientX:0,clientY:0})),e.preventDefault&&e.preventDefault(),e.stopPropagation())},onTouchEnd:function(){this.processEnd()},onTouchMove:function(e){this.touches.length&&(this.processMove(e,e.touches),e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation())},onMouseDown:function(e){if(!this.disabled){var t={fake:!0,clientX:e.clientX,clientY:e.clientY};this.touches=[t],this.initAnchor(t),e.stopPropagation()}},onMouseMove:function(e){this.touches.length&&(this.processMove(e,[{fake:!0,clientX:e.clientX,clientY:e.clientY}]),e.preventDefault&&e.preventDefault())},onMouseUp:function(){this.processEnd()},initAnchor:function(e){var t=this.$refs.draggable.getBoundingClientRect(),i=t.left,o=t.right,s=t.bottom,n=t.top;this.anchor={left:e.clientX-i,top:e.clientY-n,bottom:s-e.clientY,right:o-e.clientX}},processMove:function(e,t){var i=je(t);if(this.touches.length){if(this.touches.length===1&&i.length===1){var o=this.$refs.draggable;this.$emit("drag",new rs(e,o,{left:i[0].clientX,top:i[0].clientY},{left:this.touches[0].clientX,top:this.touches[0].clientY},this.anchor))}this.touches=i}},processEnd:function(){this.touches.length&&this.$emit("drag-end"),this.hovered&&(this.$emit("leave"),this.hovered=!1),this.touches=[]}},emits:["drag","drag-end","leave","enter"]};oi.render=function(e,t,i,o,s,n){return b(),C("div",{ref:"draggable",class:i.classname,onTouchstart:t[1]||(t[1]=function(){return n.onTouchStart&&n.onTouchStart.apply(n,arguments)}),onMousedown:t[2]||(t[2]=function(){return n.onMouseDown&&n.onMouseDown.apply(n,arguments)}),onMouseover:t[3]||(t[3]=function(){return n.onMouseOver&&n.onMouseOver.apply(n,arguments)}),onMouseleave:t[4]||(t[4]=function(){return n.onMouseLeave&&n.onMouseLeave.apply(n,arguments)})},[Me(e.$slots,"default")],34)};var Ft=ve("vue-handler-wrapper"),cn={name:"HandlerWrapper",components:{DraggableElement:oi},props:{horizontalPosition:{type:String},verticalPosition:{type:String},disabled:{type:Boolean,default:!1}},computed:{classes:function(){var e;if(this.horizontalPosition||this.verticalPosition){var t,i=sn(this.horizontalPosition,this.verticalPosition);e=Ft((ue(t={},i.classname,!0),ue(t,"disabled",this.disabled),t))}else e=Ft({disabled:this.disabled});return{root:e,draggable:Ft("draggable")}}},emits:["leave","enter","drag","drag-end"]};cn.render=function(e,t,i,o,s,n){var r=Se("DraggableElement");return b(),C("div",{class:n.classes.root},[y(r,{class:n.classes.draggable,onDrag:t[1]||(t[1]=function(c){return e.$emit("drag",c)}),onDragEnd:t[2]||(t[2]=function(c){return e.$emit("drag-end")}),onLeave:t[3]||(t[3]=function(c){return e.$emit("leave")}),onEnter:t[4]||(t[4]=function(c){return e.$emit("enter")})},{default:x(function(){return[Me(e.$slots,"default")]}),_:3},8,["class"])],2)};var ls=ve("vue-line-wrapper"),hn={name:"LineWrapper",components:{DraggableElement:oi},props:{position:{type:String,required:!0},disabled:{type:Boolean,default:!1}},computed:{classname:function(){var e;return ls((ue(e={},this.position,!0),ue(e,"disabled",this.disabled),e))}},emits:["leave","enter","drag","drag-end"]};hn.render=function(e,t,i,o,s,n){var r=Se("DraggableElement");return b(),C(r,{class:n.classname,onDrag:t[1]||(t[1]=function(c){return e.$emit("drag",c)}),onDragEnd:t[2]||(t[2]=function(c){return e.$emit("drag-end")}),onLeave:t[3]||(t[3]=function(c){return e.$emit("leave")}),onEnter:t[4]||(t[4]=function(c){return e.$emit("enter")})},{default:x(function(){return[Me(e.$slots,"default")]}),_:3},8,["class"])};var we=["left","right","top","bottom"],cs=["left","right"],hs=["top","bottom"],ds=["left","top"],us=["fill-area","fit-area","stencil","none"],Li={left:0,top:0,width:0,height:0};function Bi(e,t,i){return!(i=i||["width","height","left","top"]).some(function(o){return e[o]!==t[o]})}function _e(e){return{left:e.left,top:e.top,right:e.left+e.width,bottom:e.top+e.height}}function Qe(e,t){return{left:e.left-t.left,top:e.top-t.top}}function K(e){return{left:e.left+e.width/2,top:e.top+e.height/2}}function st(e,t){var i={left:0,top:0,right:0,bottom:0};return we.forEach(function(o){var s=t[o],n=_e(e)[o];i[o]=s!==void 0&&n!==void 0?o==="left"||o==="top"?Math.max(0,s-n):Math.max(0,n-s):0}),i}function be(e,t){return{left:e.left-t.left,top:e.top-t.top,width:e.width+t.left+t.right,height:e.height+t.top+t.bottom}}function zt(e){return{left:-e.left,top:-e.top}}function le(e,t){return A(A({},e),{left:e.left+t.left,top:e.top+t.top})}function me(e,t,i,o){if(t!==1){if(i){var s=K(e);return{width:e.width*t,height:e.height*t,left:e.left+e.width*(1-t)/2+(i.left-s.left)*(1-t),top:e.top+e.height*(1-t)/2+(i.top-s.top)*(1-t)}}return{width:e.width*t,height:e.height*t,left:e.left+e.width*(1-t)/2,top:e.top+e.height*(1-t)/2}}return e}function L(e){return e.width/e.height}function Ke(e,t){return Math.min(t.right!==void 0&&t.left!==void 0?(t.right-t.left)/e.width:1/0,t.bottom!==void 0&&t.top!==void 0?(t.bottom-t.top)/e.height:1/0)}function Je(e,t){var i={left:0,top:0},o=st(e,t);return o.left&&o.left>0?i.left=o.left:o.right&&o.right>0&&(i.left=-o.right),o.top&&o.top>0?i.top=o.top:o.bottom&&o.bottom>0&&(i.top=-o.bottom),i}function Ot(e,t){var i;return t.minimum&&e<t.minimum?i=t.minimum:t.maximum&&e>t.maximum&&(i=t.maximum),i}function dn(e,t){var i=L(e),o=L(t);return t.width<1/0&&t.height<1/0?i>o?{width:t.width,height:t.width/i}:{width:t.height*i,height:t.height}:t.width<1/0?{width:t.width,height:t.width/i}:t.height<1/0?{width:t.height*i,height:t.height}:e}function un(e,t){var i=t*Math.PI/180;return{width:Math.abs(e.width*Math.cos(i))+Math.abs(e.height*Math.sin(i)),height:Math.abs(e.width*Math.sin(i))+Math.abs(e.height*Math.cos(i))}}function Te(e,t){var i=t*Math.PI/180;return{left:e.left*Math.cos(i)-e.top*Math.sin(i),top:e.left*Math.sin(i)+e.top*Math.cos(i)}}function Ct(e,t){var i=st(J(e,t),t);return i.left+i.right+i.top+i.bottom?i.left+i.right>i.top+i.bottom?Math.min((e.width+i.left+i.right)/e.width,Ke(e,t)):Math.min((e.height+i.top+i.bottom)/e.height,Ke(e,t)):1}function J(e,t,i){i===void 0&&(i=!1);var o=Je(e,t);return le(e,i?zt(o):o)}function Xt(e){return{width:e.right!==void 0&&e.left!==void 0?e.right-e.left:1/0,height:e.bottom!==void 0&&e.top!==void 0?e.bottom-e.top:1/0}}function ms(e,t){return A(A({},e),{minWidth:Math.min(t.width,e.minWidth),minHeight:Math.min(t.height,e.minHeight),maxWidth:Math.min(t.width,e.maxWidth),maxHeight:Math.min(t.height,e.maxHeight)})}function mn(e,t,i){i===void 0&&(i=!0);var o={};return we.forEach(function(s){var n=e[s],r=t[s];n!==void 0&&r!==void 0?o[s]=s==="left"||s==="top"?i?Math.max(n,r):Math.min(n,r):i?Math.min(n,r):Math.max(n,r):r!==void 0?o[s]=r:n!==void 0&&(o[s]=n)}),o}function Rt(e,t){return mn(e,t,!0)}function Wi(e){var t=e.size,i=e.aspectRatio,o=e.ignoreMinimum,s=e.sizeRestrictions;return!!((t.correctRatio||L(t)>=i.minimum&&L(t)<=i.maximum)&&t.height<=s.maxHeight&&t.width<=s.maxWidth&&t.width&&t.height&&(o||t.height>=s.minHeight&&t.width>=s.minWidth))}function Pi(e,t){return Math.pow(e.width-t.width,2)+Math.pow(e.height-t.height,2)}function Ae(e){var t=e.width,i=e.height,o=e.sizeRestrictions,s={minimum:e.aspectRatio&&e.aspectRatio.minimum||0,maximum:e.aspectRatio&&e.aspectRatio.maximum||1/0},n={width:Math.max(o.minWidth,Math.min(o.maxWidth,t)),height:Math.max(o.minHeight,Math.min(o.maxHeight,i))};function r(d,f){return f===void 0&&(f=!1),d.reduce(function(p,m){return Wi({size:m,aspectRatio:s,sizeRestrictions:o,ignoreMinimum:f})&&(!p||Pi(m,{width:t,height:i})<Pi(p,{width:t,height:i}))?m:p},null)}var c=[];s&&[s.minimum,s.maximum].forEach(function(d){d&&c.push({width:n.width,height:n.width/d,correctRatio:!0},{width:n.height*d,height:n.height,correctRatio:!0})}),Wi({size:n,aspectRatio:s,sizeRestrictions:o})&&c.push(n);var a=r(c)||r(c,!0);return a&&{width:a.width,height:a.height}}function Gt(e){var t=e.event,i=e.coordinates,o=e.positionRestrictions,s=o===void 0?{}:o,n=le(i,t.directions);return le(n,Je(n,s))}function fs(e){var t=e.coordinates,i=e.transform,o=e.imageSize,s=e.sizeRestrictions,n=e.positionRestrictions,r=e.aspectRatio,c=e.visibleArea,a=function(f,p){return Gt({coordinates:f,positionRestrictions:n,event:new ni({left:p.left-f.left,top:p.top-f.top})})},d=A({},t);return(Array.isArray(i)?i:[i]).forEach(function(f){var p={};Z((p=typeof f=="function"?f({coordinates:d,imageSize:o,visibleArea:c}):f).width)&&Z(p.height)||(d=function(m,g){var R=A(A(A({},m),Ae({width:g.width,height:g.height,sizeRestrictions:s,aspectRatio:r})),{left:0,top:0});return a(R,{left:m.left,top:m.top})}(d,A(A({},d),p))),Z(p.left)&&Z(p.top)||(d=a(d,A(A({},d),p)))}),d}function ps(e){e.event;var t=e.getAreaRestrictions,i=e.boundaries,o=e.coordinates,s=e.visibleArea;e.aspectRatio;var n=e.stencilSize,r=e.sizeRestrictions,c=e.positionRestrictions;e.stencilReference;var a,d,f,p=A({},o),m=A({},s),g=A({},n);a=L(g),d=L(p),f===void 0&&(f=.001),(a===0||d===0?Math.abs(d-a)<f:Math.abs(d/a)<1+f&&Math.abs(d/a)>1-f)||(p=A(A({},p),Ae({sizeRestrictions:r,width:p.width,height:p.height,aspectRatio:{minimum:L(g),maximum:L(g)}})));var R=Ct(m=me(m,p.width*i.width/(m.width*g.width)),t({visibleArea:m,type:"resize"}));return R!==1&&(m=me(m,R),p=me(p,R)),m=J(m=le(m,Qe(K(p),K(m))),t({visibleArea:m,type:"move"})),{coordinates:p=J(p,Rt(_e(m),c)),visibleArea:m}}function gs(e){var t=e.event,i=e.getAreaRestrictions,o=e.boundaries,s=e.coordinates,n=e.visibleArea;e.aspectRatio,e.stencilSize,e.sizeRestrictions;var r=e.positionRestrictions;e.stencilReference;var c=A({},s),a=A({},n);if(s&&n&&t.type!=="manipulateImage"){var d={width:0,height:0};a.width,o.width,L(o)>L(c)?(d.height=.8*o.height,d.width=d.height*L(c)):(d.width=.8*o.width,d.height=d.width*L(c));var f=Ct(a=me(a,c.width*o.width/(a.width*d.width)),i({visibleArea:a,type:"resize"}));a=me(a,f),f!==1&&(d.height/=f,d.width/=f),a=J(a=le(a,Qe(K(c),K(a))),i({visibleArea:a,type:"move"})),c=J(c,Rt(_e(a),r))}return{coordinates:c,visibleArea:a}}function vs(e){var t=e.event,i=e.coordinates,o=e.visibleArea,s=e.getAreaRestrictions,n=A({},o),r=A({},i);if(t.type==="setCoordinates"){var c=Math.max(0,r.width-n.width),a=Math.max(0,r.height-n.height);c>a?n=me(n,Math.min(r.width/n.width,Ke(n,s({visibleArea:n,type:"resize"})))):a>c&&(n=me(n,Math.min(r.height/n.height,Ke(n,s({visibleArea:n,type:"resize"}))))),n=J(n=le(n,zt(Je(r,_e(n)))),s({visibleArea:n,type:"move"}))}return{visibleArea:n,coordinates:r}}function bs(e){var t=e.imageSize,i=e.visibleArea,o=e.coordinates,s=i||t;return{left:(i?i.left:0)+s.width/2-o.width/2,top:(i?i.top:0)+s.height/2-o.height/2}}function ws(e){var t=e.imageSize,i=e.visibleArea,o=e.aspectRatio,s=e.sizeRestrictions,n=i||t,r=Math.min(o.maximum||1/0,Math.max(o.minimum||0,L(n))),c=n.width<n.height?{width:.8*n.width,height:.8*n.width/r}:{height:.8*n.height,width:.8*n.height*r};return Ae(A(A({},c),{aspectRatio:o,sizeRestrictions:s}))}function ys(e){var t,i,o=e.imageSize,s=e.visibleArea,n=e.boundaries,r=e.aspectRatio,c=e.sizeRestrictions,a=e.stencilSize,d=s||o;return L(d)>L(n)?i=(t=a.height*d.height/n.height)*L(a):t=(i=a.width*d.width/n.width)/L(a),Ae({width:i,height:t,aspectRatio:r,sizeRestrictions:c})}function _s(e){var t=e.getAreaRestrictions,i=e.coordinates,o=e.imageSize,s=L(e.boundaries);if(i){var n={height:Math.max(i.height,o.height),width:Math.max(i.width,o.width)},r=dn({width:L(n)>s?n.width:n.height*s,height:L(n)>s?n.width/s:n.height},Xt(t())),c={left:i.left+i.width/2-r.width/2,top:i.top+i.height/2-r.height/2,width:r.width,height:r.height},a=st(i,_e(A({left:0,top:0},o))),d={};return!a.left&&!a.right&&c.width<=o.width&&(d.left=0,d.right=o.width),!a.top&&!a.bottom&&c.height<=o.height&&(d.top=0,d.bottom=o.height),J(c,d)}var f=L(o);return r={height:f>s?o.height:o.width/s,width:f>s?o.height*s:o.width},{left:o.width/2-r.width/2,top:o.height/2-r.height/2,width:r.width,height:r.height}}function gt(e,t){return mn(e,_e(t))}function xs(e){var t=e.event,i=e.coordinates,o=e.visibleArea,s=e.sizeRestrictions,n=e.getAreaRestrictions,r=e.positionRestrictions,c=e.adjustStencil,a=t.scale,d=t.move,f=A({},o),p=A({},i),m=1,g=1,R=a.factor&&Math.abs(a.factor-1)>.001;f=le(f,{left:d.left||0,top:d.top||0});var S={stencil:{minimum:Math.max(s.minWidth?s.minWidth/p.width:0,s.minHeight?s.minHeight/p.height:0),maximum:Math.min(s.maxWidth?s.maxWidth/p.width:1/0,s.maxHeight?s.maxHeight/p.height:1/0,Ke(p,r))},area:{maximum:Ke(f,n({visibleArea:f,type:"resize"}))}};a.factor&&R&&(a.factor<1?(g=Math.max(a.factor,S.stencil.minimum))>1&&(g=1):a.factor>1&&(g=Math.min(a.factor,Math.min(S.area.maximum,S.stencil.maximum)))<1&&(g=1)),g&&(f=me(f,g,a.center));var j=i.left-o.left,V=o.width+o.left-(i.width+i.left),Q=i.top-o.top,ie=o.height+o.top-(i.height+i.top);return f=J(f=le(f,Je(f,{left:r.left!==void 0?r.left-j*g:void 0,top:r.top!==void 0?r.top-Q*g:void 0,bottom:r.bottom!==void 0?r.bottom+ie*g:void 0,right:r.right!==void 0?r.right+V*g:void 0})),n({visibleArea:f,type:"move"})),p.width=p.width*g,p.height=p.height*g,p.left=f.left+j*g,p.top=f.top+Q*g,p=J(p,Rt(_e(f),r)),a.factor&&R&&c&&(a.factor>1?m=Math.min(S.area.maximum,a.factor)/g:a.factor<1&&(m=Math.max(p.height/f.height,p.width/f.width,a.factor/g)),m!==1&&(f=le(f=J(f=me(f,m,a.factor>1?a.center:K(p)),n({visibleArea:f,type:"move"})),zt(Je(p,_e(f)))))),{coordinates:p,visibleArea:f}}function zs(e){var t=e.aspectRatio,i=e.getAreaRestrictions,o=e.coordinates,s=e.visibleArea,n=e.sizeRestrictions,r=e.positionRestrictions,c=e.imageSize,a=e.previousImageSize,d=e.angle,f=A({},o),p=A({},s),m=Te(K(A({left:0,top:0},a)),d);return(f=A(A({},Ae({sizeRestrictions:n,aspectRatio:t,width:f.width,height:f.height})),Te(K(f),d))).left-=m.left-c.width/2+f.width/2,f.top-=m.top-c.height/2+f.height/2,p=me(p,Ct(p,i({visibleArea:p,type:"resize"}))),{coordinates:f=J(f,r),visibleArea:p=J(p=le(p,Qe(K(f),K(o))),i({visibleArea:p,type:"move"}))}}function Cs(e){var t=e.flip,i=e.previousFlip,o=e.rotate,s=e.getAreaRestrictions,n=e.coordinates,r=e.visibleArea,c=e.imageSize,a=A({},n),d=A({},r),f=i.horizontal!==t.horizontal,p=i.vertical!==t.vertical;if(f||p){var m=Te({left:c.width/2,top:c.height/2},-o),g=Te(K(a),-o),R=Te({left:f?m.left-(g.left-m.left):g.left,top:p?m.top-(g.top-m.top):g.top},o);a=le(a,Qe(R,K(a))),g=Te(K(d),-o),d=J(d=le(d,Qe(R=Te({left:f?m.left-(g.left-m.left):g.left,top:p?m.top-(g.top-m.top):g.top},o),K(d))),s({visibleArea:d,type:"move"}))}return{coordinates:a,visibleArea:d}}function ji(e){var t=e.directions,i=e.coordinates,o=e.positionRestrictions,s=o===void 0?{}:o,n=e.sizeRestrictions,r=e.preserveRatio,c=e.compensate,a=A({},t),d=be(i,a).width,f=be(i,a).height;d<0&&(a.left<0&&a.right<0?(a.left=-(i.width-n.minWidth)/(a.left/a.right),a.right=-(i.width-n.minWidth)/(a.right/a.left)):a.left<0?a.left=-(i.width-n.minWidth):a.right<0&&(a.right=-(i.width-n.minWidth))),f<0&&(a.top<0&&a.bottom<0?(a.top=-(i.height-n.minHeight)/(a.top/a.bottom),a.bottom=-(i.height-n.minHeight)/(a.bottom/a.top)):a.top<0?a.top=-(i.height-n.minHeight):a.bottom<0&&(a.bottom=-(i.height-n.minHeight)));var p=st(be(i,a),s);c&&(p.left&&p.left>0&&p.right===0?(a.right+=p.left,a.left-=p.left):p.right&&p.right>0&&p.left===0&&(a.left+=p.right,a.right-=p.right),p.top&&p.top>0&&p.bottom===0?(a.bottom+=p.top,a.top-=p.top):p.bottom&&p.bottom>0&&p.top===0&&(a.top+=p.bottom,a.bottom-=p.bottom),p=st(be(i,a),s));var m={width:1/0,height:1/0,left:1/0,right:1/0,top:1/0,bottom:1/0};if(we.forEach(function(S){var j=p[S];j&&a[S]&&(m[S]=Math.max(0,1-j/a[S]))}),r){var g=Math.min.apply(null,we.map(function(S){return m[S]}));g!==1/0&&we.forEach(function(S){a[S]*=g})}else we.forEach(function(S){m[S]!==1/0&&(a[S]*=m[S])});if(d=be(i,a).width,f=be(i,a).height,a.right+a.left&&(d>n.maxWidth?m.width=(n.maxWidth-i.width)/(a.right+a.left):d<n.minWidth&&(m.width=(n.minWidth-i.width)/(a.right+a.left))),a.bottom+a.top&&(f>n.maxHeight?m.height=(n.maxHeight-i.height)/(a.bottom+a.top):f<n.minHeight&&(m.height=(n.minHeight-i.height)/(a.bottom+a.top))),r){var R=Math.min(m.width,m.height);R!==1/0&&we.forEach(function(S){a[S]*=R})}else m.width!==1/0&&cs.forEach(function(S){a[S]*=m.width}),m.height!==1/0&&hs.forEach(function(S){a[S]*=m.height});return a}function vt(e,t,i){return t==0&&i==0?e/2:t==0?0:i==0?e:e*Math.abs(t/(t+i))}var Rs=ve("vue-simple-handler"),As=ve("vue-simple-handler-wrapper"),si={name:"SimpleHandler",components:{HandlerWrapper:cn},props:{defaultClass:{type:String},hoverClass:{type:String},wrapperClass:{type:String},horizontalPosition:{type:String},verticalPosition:{type:String},disabled:{type:Boolean,default:!1}},data:function(){return{hover:!1}},computed:{classes:function(){var e,t=(ue(e={},this.horizontalPosition,!!this.horizontalPosition),ue(e,this.verticalPosition,!!this.verticalPosition),ue(e,"".concat(this.horizontalPosition,"-").concat(this.verticalPosition),!!(this.verticalPosition&&this.horizontalPosition)),ue(e,"hover",this.hover),e);return{default:G(Rs(t),this.defaultClass,this.hover&&this.hoverClass),wrapper:G(As(t),this.wrapperClass)}}},methods:{onDrag:function(e){this.$emit("drag",e)},onEnter:function(){this.hover=!0},onLeave:function(){this.hover=!1},onDragEnd:function(){this.$emit("drag-end")}},emits:["drag","drag-end"]};si.render=function(e,t,i,o,s,n){var r=Se("HandlerWrapper");return b(),C(r,{class:n.classes.wrapper,"vertical-position":i.verticalPosition,"horizontal-position":i.horizontalPosition,disabled:i.disabled,onDrag:n.onDrag,onDragEnd:n.onDragEnd,onEnter:n.onEnter,onLeave:n.onLeave},{default:x(function(){return[y("div",{class:n.classes.default},null,2)]}),_:1},8,["class","vertical-position","horizontal-position","disabled","onDrag","onDragEnd","onEnter","onLeave"])};var Ss=ve("vue-simple-line"),Ms=ve("vue-simple-line-wrapper"),ai={name:"SimpleLine",components:{LineWrapper:hn},props:{defaultClass:{type:String},hoverClass:{type:String},wrapperClass:{type:String},position:{type:String},disabled:{type:Boolean,default:!1}},data:function(){return{hover:!1}},computed:{classes:function(){return{root:G(Ss(ue({},this.position,!0)),this.defaultClass,this.hover&&this.hoverClass),wrapper:G(Ms(ue({},this.position,!0)),this.wrapperClass)}}},methods:{onDrag:function(e){this.$emit("drag",e)},onEnter:function(){this.hover=!0},onLeave:function(){this.hover=!1},onDragEnd:function(){this.$emit("drag-end")}},emits:["drag","drag-end"]};ai.render=function(e,t,i,o,s,n){var r=Se("LineWrapper");return b(),C(r,{class:n.classes.wrapper,position:i.position,disabled:i.disabled,onDrag:n.onDrag,onDragEnd:n.onDragEnd,onEnter:n.onEnter,onLeave:n.onLeave},{default:x(function(){return[y("div",{class:n.classes.root},null,2)]}),_:1},8,["class","position","disabled","onDrag","onDragEnd","onEnter","onLeave"])};var Lt=ve("vue-bounding-box"),ks=["east","west",null],Es=["south","north",null],fn={name:"BoundingBox",props:{width:{type:Number},height:{type:Number},transitions:{type:Object},handlers:{type:Object,default:function(){return{eastNorth:!0,north:!0,westNorth:!0,west:!0,westSouth:!0,south:!0,eastSouth:!0,east:!0}}},handlersComponent:{type:[Object,String],default:function(){return si}},handlersClasses:{type:Object,default:function(){return{}}},handlersWrappersClasses:{type:Object,default:function(){return{}}},lines:{type:Object,default:function(){return{west:!0,north:!0,east:!0,south:!0}}},linesComponent:{type:[Object,String],default:function(){return ai}},linesClasses:{type:Object,default:function(){return{}}},linesWrappersClasses:{type:Object,default:function(){return{}}},resizable:{type:Boolean,default:!0}},data:function(){var e=[];return ks.forEach(function(t){Es.forEach(function(i){if(t!==i){var o=sn(t,i),s=o.name,n=o.classname;e.push({name:s,classname:n,verticalDirection:i,horizontalDirection:t})}})}),{points:e}},computed:{style:function(){var e={};return this.width&&this.height&&(e.width="".concat(this.width,"px"),e.height="".concat(this.height,"px"),this.transitions&&this.transitions.enabled&&(e.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction))),e},classes:function(){var e=this.handlersClasses,t=this.handlersWrappersClasses,i=this.linesClasses,o=this.linesWrappersClasses;return{root:Lt(),handlers:e,handlersWrappers:t,lines:i,linesWrappers:o}},lineNodes:function(){var e=this,t=[];return this.points.forEach(function(i){i.horizontalDirection&&i.verticalDirection||!e.lines[i.name]||t.push({name:i.name,component:e.linesComponent,class:G(e.classes.lines.default,e.classes.lines[i.name],!e.resizable&&e.classes.lines.disabled),wrapperClass:G(e.classes.linesWrappers.default,e.classes.linesWrappers[i.name],!e.resizable&&e.classes.linesWrappers.disabled),hoverClass:e.classes.lines.hover,verticalDirection:i.verticalDirection,horizontalDirection:i.horizontalDirection,disabled:!e.resizable})}),t},handlerNodes:function(){var e=this,t=[],i=this.width,o=this.height;return this.points.forEach(function(s){if(e.handlers[s.name]){var n={name:s.name,component:e.handlersComponent,class:G(e.classes.handlers.default,e.classes.handlers[s.name]),wrapperClass:G(e.classes.handlersWrappers.default,e.classes.handlersWrappers[s.name]),hoverClass:e.classes.handlers.hover,verticalDirection:s.verticalDirection,horizontalDirection:s.horizontalDirection,disabled:!e.resizable};if(i&&o){var r=s.horizontalDirection,c=s.verticalDirection,a=r==="east"?i:r==="west"?0:i/2,d=c==="south"?o:c==="north"?0:o/2;n.wrapperClass=Lt("handler"),n.wrapperStyle={transform:"translate(".concat(a,"px, ").concat(d,"px)")},e.transitions&&e.transitions.enabled&&(n.wrapperStyle.transition="".concat(e.transitions.time,"ms ").concat(e.transitions.timingFunction))}else n.wrapperClass=Lt("handler",ue({},s.classname,!0));t.push(n)}}),t}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},mounted:function(){this.touches=[]},methods:{onEnd:function(){this.$emit("resize-end")},onHandlerDrag:function(e,t,i){var o,s=e.shift(),n=s.left,r=s.top,c={left:0,right:0,top:0,bottom:0};t==="west"?c.left-=n:t==="east"&&(c.right+=n),i==="north"?c.top-=r:i==="south"&&(c.bottom+=r),!i&&t?o="width":i&&!t&&(o="height"),this.resizable&&this.$emit("resize",new as(c,{allowedDirections:{left:t==="west"||!t,right:t==="east"||!t,bottom:i==="south"||!i,top:i==="north"||!i},preserveAspectRatio:e.nativeEvent&&e.nativeEvent.shiftKey,respectDirection:o}))}},emits:["resize","resize-end"]};fn.render=function(e,t,i,o,s,n){return b(),C("div",{ref:"box",class:n.classes.root,style:n.style},[Me(e.$slots,"default"),y("div",null,[(b(!0),C(We,null,ki(n.lineNodes,function(r){return b(),C(ye(r.component),{key:r.name,"default-class":r.class,"hover-class":r.hoverClass,"wrapper-class":r.wrapperClass,position:r.name,disabled:r.disabled,onDrag:function(c){return n.onHandlerDrag(c,r.horizontalDirection,r.verticalDirection)},onDragEnd:t[1]||(t[1]=function(c){return n.onEnd()})},null,8,["default-class","hover-class","wrapper-class","position","disabled","onDrag"])}),128))]),(b(!0),C(We,null,ki(n.handlerNodes,function(r){return b(),C("div",{key:r.name,style:r.wrapperStyle,class:r.wrapperClass},[(b(),C(ye(r.component),{"default-class":r.class,"hover-class":r.hoverClass,"wrapper-class":r.wrapperClass,"horizontal-position":r.horizontalDirection,"vertical-position":r.verticalDirection,disabled:r.disabled,onDrag:function(c){return n.onHandlerDrag(c,r.horizontalDirection,r.verticalDirection)},onDragEnd:t[2]||(t[2]=function(c){return n.onEnd()})},null,8,["default-class","hover-class","wrapper-class","horizontal-position","vertical-position","disabled","onDrag"]))],6)}),128))],6)};var $s=ve("vue-draggable-area"),pn={name:"DraggableArea",props:{movable:{type:Boolean,default:!0},activationDistance:{type:Number,default:20}},computed:{classnames:function(){return{default:$s()}}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},mounted:function(){this.touches=[],this.touchStarted=!1},methods:{onTouchStart:function(e){if(e.cancelable){var t=this.movable&&e.touches.length===1;t&&(this.touches=je(e.touches)),(this.touchStarted||t)&&(e.preventDefault(),e.stopPropagation())}},onTouchEnd:function(){this.touchStarted=!1,this.processEnd()},onTouchMove:function(e){this.touches.length>=1&&(this.touchStarted?(this.processMove(e,e.touches),e.preventDefault(),e.stopPropagation()):ln({x:this.touches[0].clientX,y:this.touches[0].clientY},{x:e.touches[0].clientX,y:e.touches[0].clientY})>this.activationDistance&&(this.initAnchor({clientX:e.touches[0].clientX,clientY:e.touches[0].clientY}),this.touchStarted=!0))},onMouseDown:function(e){if(this.movable&&e.button===0){var t={fake:!0,clientX:e.clientX,clientY:e.clientY};this.touches=[t],this.initAnchor(t),e.stopPropagation()}},onMouseMove:function(e){this.touches.length&&(this.processMove(e,[{fake:!0,clientX:e.clientX,clientY:e.clientY}]),e.preventDefault&&e.cancelable&&e.preventDefault(),e.stopPropagation())},onMouseUp:function(){this.processEnd()},initAnchor:function(e){var t=this.$refs.container.getBoundingClientRect(),i=t.left,o=t.top;this.anchor={x:e.clientX-i,y:e.clientY-o}},processMove:function(e,t){var i=je(t);if(this.touches.length){var o=this.$refs.container.getBoundingClientRect(),s=o.left,n=o.top;this.touches.length===1&&i.length===1&&this.$emit("move",new ni({left:i[0].clientX-(s+this.anchor.x),top:i[0].clientY-(n+this.anchor.y)}))}},processEnd:function(){this.touches.length&&this.$emit("move-end"),this.touches=[]}},emits:["move","move-end"]};pn.render=function(e,t,i,o,s,n){return b(),C("div",{ref:"container",onTouchstart:t[1]||(t[1]=function(){return n.onTouchStart&&n.onTouchStart.apply(n,arguments)}),onMousedown:t[2]||(t[2]=function(){return n.onMouseDown&&n.onMouseDown.apply(n,arguments)})},[Me(e.$slots,"default")],544)};function Bt(e){var t,i;return{rotate:e.rotate||0,flip:{horizontal:((t=e==null?void 0:e.flip)===null||t===void 0?void 0:t.horizontal)||!1,vertical:((i=e==null?void 0:e.flip)===null||i===void 0?void 0:i.vertical)||!1}}}function Is(e){return new Promise(function(t,i){try{if(e)if(/^data:/i.test(e))t(function(a){a=a.replace(/^data:([^;]+);base64,/gim,"");for(var d=atob(a),f=d.length,p=new ArrayBuffer(f),m=new Uint8Array(p),g=0;g<f;g++)m[g]=d.charCodeAt(g);return p}(e));else if(/^blob:/i.test(e)){var o=new FileReader;o.onload=function(a){t(a.target.result)},n=e,r=function(a){o.readAsArrayBuffer(a)},(c=new XMLHttpRequest).open("GET",n,!0),c.responseType="blob",c.onload=function(){this.status!=200&&this.status!==0||r(this.response)},c.send()}else{var s=new XMLHttpRequest;s.onreadystatechange=function(){s.readyState===4&&(s.status===200||s.status===0?t(s.response):i("Warning: could not load an image to parse its orientation"),s=null)},s.onprogress=function(){s.getResponseHeader("content-type")!=="image/jpeg"&&s.abort()},s.withCredentials=!1,s.open("GET",e,!0),s.responseType="arraybuffer",s.send(null)}else i("Error: the image is empty")}catch(a){i(a)}var n,r,c})}function gn(e){var t=e.rotate,i=e.flip,o=e.scaleX,s=e.scaleY,n="";return n+=" rotate("+t+"deg) ",n+=" scaleX("+o*(i.horizontal?-1:1)+") ",n+=" scaleY("+s*(i.vertical?-1:1)+") "}function Ds(e){try{var t,i=new DataView(e),o=void 0,s=void 0,n=void 0,r=void 0;if(i.getUint8(0)===255&&i.getUint8(1)===216)for(var c=i.byteLength,a=2;a+1<c;){if(i.getUint8(a)===255&&i.getUint8(a+1)===225){n=a;break}a++}if(n&&(o=n+10,function(g,R,S){var j,V="";for(j=R,S+=R;j<S;j++)V+=String.fromCharCode(g.getUint8(j));return V}(i,n+4,4)==="Exif")){var d=i.getUint16(o);if(((s=d===18761)||d===19789)&&i.getUint16(o+2,s)===42){var f=i.getUint32(o+4,s);f>=8&&(r=o+f)}}if(r){for(var p=i.getUint16(r,s),m=0;m<p;m++)if(a=r+12*m+2,i.getUint16(a,s)===274){a+=8,t=i.getUint16(a,s),i.setUint16(a,1,s);break}}return t}catch{return null}}function Vi(e,t){var i=t.getBoundingClientRect(),o=i.left,s=i.top,n={left:0,top:0},r=0;return e.forEach(function(c){n.left+=(c.clientX-o)/e.length,n.top+=(c.clientY-s)/e.length}),e.forEach(function(c){r+=ln({x:n.left,y:n.top},{x:c.clientX-o,y:c.clientY-s})}),{centerMass:n,spread:r,count:e.length}}var vn={props:{touchMove:{type:Boolean,required:!0},mouseMove:{type:Boolean,required:!0},touchResize:{type:Boolean,required:!0},wheelResize:{type:[Boolean,Object],required:!0},eventsFilter:{type:Function,required:!1}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},created:function(){this.transforming=!1,this.debouncedProcessEnd=qt(this.processEnd),this.touches=[]},methods:{processMove:function(e,t){if(this.touches.length){if(this.touches.length===1&&t.length===1)this.$emit("move",new ot({left:this.touches[0].clientX-t[0].clientX,top:this.touches[0].clientY-t[0].clientY}));else if(this.touches.length>1&&this.touchResize){var i=Vi(t,this.$refs.container),o=this.oldGeometricProperties;o.count===i.count&&o.count>1&&this.$emit("resize",new ot({left:o.centerMass.left-i.centerMass.left,top:o.centerMass.top-i.centerMass.top},{factor:o.spread/i.spread,center:i.centerMass})),this.oldGeometricProperties=i}this.touches=t}},processEnd:function(){this.transforming&&(this.transforming=!1,this.$emit("transform-end"))},processStart:function(){this.transforming=!0,this.debouncedProcessEnd.clear()},processEvent:function(e){return this.eventsFilter?this.eventsFilter(e,this.transforming)!==!1:(e.preventDefault(),e.stopPropagation(),!0)},onTouchStart:function(e){if(e.cancelable&&(this.touchMove||this.touchResize&&e.touches.length>1)&&this.processEvent(e)){var t=this.$refs.container,i=t.getBoundingClientRect(),o=i.left,s=i.top,n=i.bottom,r=i.right;this.touches=je(e.touches).filter(function(c){return c.clientX>o&&c.clientX<r&&c.clientY>s&&c.clientY<n}),this.oldGeometricProperties=Vi(this.touches,t)}},onTouchEnd:function(e){e.touches.length===0&&(this.touches=[],this.processEnd())},onTouchMove:function(e){var t=this;if(this.touches.length){var i=je(e.touches).filter(function(o){return!o.identifier||t.touches.find(function(s){return s.identifier===o.identifier})});this.processEvent(e)&&(this.processMove(e,i),this.processStart())}},onMouseDown:function(e){if(this.mouseMove&&"buttons"in e&&e.buttons===1&&this.processEvent(e)){var t={fake:!0,clientX:e.clientX,clientY:e.clientY};this.touches=[t],this.processStart()}},onMouseMove:function(e){this.touches.length&&this.processEvent(e)&&this.processMove(e,[{clientX:e.clientX,clientY:e.clientY}])},onMouseUp:function(){this.touches=[],this.processEnd()},onWheel:function(e){if(this.wheelResize&&this.processEvent(e)){var t=this.$refs.container.getBoundingClientRect(),i=t.left,o=t.top,s=1+this.wheelResize.ratio*(r=e.deltaY||e.detail||e.wheelDelta,(c=+r)==0||rn(c)?c:c>0?1:-1),n={left:e.clientX-i,top:e.clientY-o};this.$emit("resize",new ot({},{factor:s,center:n})),this.touches.length||this.debouncedProcessEnd()}var r,c}},emits:["resize","move","transform-end"]};vn.render=function(e,t,i,o,s,n){return b(),C("div",{ref:"container",onTouchstart:t[1]||(t[1]=function(){return n.onTouchStart&&n.onTouchStart.apply(n,arguments)}),onMousedown:t[2]||(t[2]=function(){return n.onMouseDown&&n.onMouseDown.apply(n,arguments)}),onWheel:t[3]||(t[3]=function(){return n.onWheel&&n.onWheel.apply(n,arguments)})},[Me(e.$slots,"default")],544)};var Zt={components:{TransformableImage:vn},props:{touchMove:{type:Boolean,required:!0},mouseMove:{type:Boolean,required:!0},touchResize:{type:Boolean,required:!0},wheelResize:{type:[Boolean,Object],required:!0}},emits:["resize","move"]};Zt.render=function(e,t,i,o,s,n){var r=Se("transformable-image");return b(),C(r,{"touch-move":i.touchMove,"touch-resize":i.touchResize,"mouse-move":i.mouseMove,"wheel-resize":i.wheelResize,onMove:t[1]||(t[1]=function(c){return e.$emit("move",c)}),onResize:t[2]||(t[2]=function(c){return e.$emit("resize",c)})},{default:x(function(){return[Me(e.$slots,"default")]}),_:3},8,["touch-move","touch-resize","mouse-move","wheel-resize"])};var bt=ve("vue-preview"),bn={props:{coordinates:{type:Object},transitions:{type:Object},image:{type:Object,default:function(){return{}}},imageClass:{type:String},width:{type:Number},height:{type:Number},fill:{type:Boolean}},data:function(){return{calculatedImageSize:{width:0,height:0},calculatedSize:{width:0,height:0}}},computed:{classes:function(){return{root:bt({fill:this.fill}),wrapper:bt("wrapper"),imageWrapper:bt("image-wrapper"),image:G(bt("image"),this.imageClass)}},style:function(){if(this.fill)return{};var e={};return this.width&&(e.width="".concat(this.size.width,"px")),this.height&&(e.height="".concat(this.size.height,"px")),this.transitions&&this.transitions.enabled&&(e.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),e},wrapperStyle:function(){var e={width:"".concat(this.size.width,"px"),height:"".concat(this.size.height,"px"),left:"calc(50% - ".concat(this.size.width/2,"px)"),top:"calc(50% - ".concat(this.size.height/2,"px)")};return this.transitions&&this.transitions.enabled&&(e.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),e},imageStyle:function(){if(this.coordinates&&this.image){var e=this.coordinates.width/this.size.width,t=O(O({rotate:0,flip:{horizontal:!1,vertical:!1}},this.image.transforms),{},{scaleX:1/e,scaleY:1/e}),i=this.imageSize.width,o=this.imageSize.height,s=un({width:i,height:o},t.rotate),n={width:"".concat(i,"px"),height:"".concat(o,"px"),left:"0px",top:"0px"},r={rotate:{left:(i-s.width)*t.scaleX/2,top:(o-s.height)*t.scaleY/2},scale:{left:(1-t.scaleX)*i/2,top:(1-t.scaleY)*o/2}};return n.transform=`translate(
				`.concat(-this.coordinates.left/e-r.rotate.left-r.scale.left,"px,").concat(-this.coordinates.top/e-r.rotate.top-r.scale.top,"px) ")+gn(t),this.transitions&&this.transitions.enabled&&(n.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),n}return{}},size:function(){return{width:this.width||this.calculatedSize.width,height:this.height||this.calculatedSize.height}},imageSize:function(){return{width:this.image.width||this.calculatedImageSize.width,height:this.image.height||this.calculatedImageSize.height}}},watch:{image:function(e){(e.width||e.height)&&this.onChangeImage()}},mounted:function(){var e=this;this.onChangeImage(),this.$refs.image.addEventListener("load",function(){e.refreshImage()}),window.addEventListener("resize",this.refresh),window.addEventListener("orientationchange",this.refresh)},unmounted:function(){window.removeEventListener("resize",this.refresh),window.removeEventListener("orientationchange",this.refresh)},methods:{refreshImage:function(){var e=this.$refs.image;this.calculatedImageSize.height=e.naturalHeight,this.calculatedImageSize.width=e.naturalWidth},refresh:function(){var e=this.$refs.root;this.width||(this.calculatedSize.width=e.clientWidth),this.height||(this.calculatedSize.height=e.clientHeight)},onChangeImage:function(){var e=this.$refs.image;e&&e.complete&&this.refreshImage(),this.refresh()}}};bn.render=function(e,t,i,o,s,n){return b(),C("div",{ref:"root",class:n.classes.root,style:n.style},[y("div",{ref:"wrapper",class:n.classes.wrapper,style:n.wrapperStyle},[Xe(y("img",{ref:"image",src:i.image&&i.image.src,class:n.classes.image,style:n.imageStyle},null,14,["src"]),[[Hi,i.image&&i.image.src]])],6)],6)};var wn={components:{Preview:bn},inheritAttrs:!1};wn.render=function(e,t,i,o,s,n){var r=Se("preview");return b(),C(r,Qt(e.$attrs,{fill:!0}),null,16)};var Wt=ve("vue-rectangle-stencil"),yn={name:"RectangleStencil",components:{StencilPreview:wn,BoundingBox:fn,DraggableArea:pn},props:{image:{type:Object},coordinates:{type:Object},stencilCoordinates:{type:Object},handlers:{type:Object},handlersComponent:{type:[Object,String],default:function(){return si}},lines:{type:Object},linesComponent:{type:[Object,String],default:function(){return ai}},aspectRatio:{type:[Number,String]},minAspectRatio:{type:[Number,String]},maxAspectRatio:{type:[Number,String]},movable:{type:Boolean,default:!0},resizable:{type:Boolean,default:!0},transitions:{type:Object},movingClass:{type:String},resizingClass:{type:String},previewClass:{type:String},boundingBoxClass:{type:String},linesClasses:{type:Object,default:function(){return{}}},linesWrappersClasses:{type:Object,default:function(){return{}}},handlersClasses:{type:Object,default:function(){return{}}},handlersWrappersClasses:{type:Object,default:function(){return{}}}},data:function(){return{moving:!1,resizing:!1}},computed:{classes:function(){return{stencil:G(Wt({movable:this.movable,moving:this.moving,resizing:this.resizing}),this.moving&&this.movingClass,this.resizing&&this.resizingClass),preview:G(Wt("preview"),this.previewClass),boundingBox:G(Wt("bounding-box"),this.boundingBoxClass)}},style:function(){var e=this.stencilCoordinates,t=e.height,i=e.width,o=e.left,s=e.top,n={width:"".concat(i,"px"),height:"".concat(t,"px"),transform:"translate(".concat(o,"px, ").concat(s,"px)")};return this.transitions&&this.transitions.enabled&&(n.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),n}},methods:{onMove:function(e){this.$emit("move",e),this.moving=!0},onMoveEnd:function(){this.$emit("move-end"),this.moving=!1},onResize:function(e){this.$emit("resize",e),this.resizing=!0},onResizeEnd:function(){this.$emit("resize-end"),this.resizing=!1},aspectRatios:function(){return{minimum:this.aspectRatio||this.minAspectRatio,maximum:this.aspectRatio||this.maxAspectRatio}}},emits:["resize","resize-end","move","move-end"]};yn.render=function(e,t,i,o,s,n){var r=Se("stencil-preview"),c=Se("draggable-area"),a=Se("bounding-box");return b(),C("div",{class:n.classes.stencil,style:n.style},[y(a,{width:i.stencilCoordinates.width,height:i.stencilCoordinates.height,transitions:i.transitions,class:n.classes.boundingBox,handlers:i.handlers,"handlers-component":i.handlersComponent,"handlers-classes":i.handlersClasses,"handlers-wrappers-classes":i.handlersWrappersClasses,lines:i.lines,"lines-component":i.linesComponent,"lines-classes":i.linesClasses,"lines-wrappers-classes":i.linesWrappersClasses,resizable:i.resizable,onResize:n.onResize,onResizeEnd:n.onResizeEnd},{default:x(function(){return[y(c,{movable:i.movable,onMove:n.onMove,onMoveEnd:n.onMoveEnd},{default:x(function(){return[y(r,{image:i.image,coordinates:i.coordinates,width:i.stencilCoordinates.width,height:i.stencilCoordinates.height,class:n.classes.preview,transitions:i.transitions},null,8,["image","coordinates","width","height","class","transitions"])]}),_:1},8,["movable","onMove","onMoveEnd"])]}),_:1},8,["width","height","transitions","class","handlers","handlers-component","handlers-classes","handlers-wrappers-classes","lines","lines-component","lines-classes","lines-wrappers-classes","resizable","onResize","onResizeEnd"])],6)};var Ts=["transitions"],Ce=ve("vue-advanced-cropper"),_n={name:"Cropper",components:{BackgroundWrapper:Zt},props:{src:{type:String,default:null},stencilComponent:{type:[Object,String],default:function(){return yn}},backgroundWrapperComponent:{type:[Object,String],default:function(){return Zt}},stencilProps:{type:Object,default:function(){return{}}},autoZoom:{type:Boolean,default:!1},imageClass:{type:String},boundariesClass:{type:String},backgroundClass:{type:String},foregroundClass:{type:String},minWidth:{type:[Number,String]},minHeight:{type:[Number,String]},maxWidth:{type:[Number,String]},maxHeight:{type:[Number,String]},debounce:{type:[Boolean,Number],default:500},transitions:{type:Boolean,default:!0},checkOrientation:{type:Boolean,default:!0},canvas:{type:[Object,Boolean],default:!0},crossOrigin:{type:[Boolean,String],default:void 0},transitionTime:{type:Number,default:300},imageRestriction:{type:String,default:"fit-area",validator:function(e){return us.indexOf(e)!==-1}},roundResult:{type:Boolean,default:!0},defaultSize:{type:[Function,Object]},defaultPosition:{type:[Function,Object]},defaultVisibleArea:{type:[Function,Object]},defaultTransforms:{type:[Function,Object]},defaultBoundaries:{type:[Function,String],validator:function(e){return!(typeof e=="string"&&e!=="fill"&&e!=="fit")}},priority:{type:String,default:"coordinates"},stencilSize:{type:[Object,Function]},resizeImage:{type:[Boolean,Object],default:!0},moveImage:{type:[Boolean,Object],default:!0},autoZoomAlgorithm:{type:Function},resizeAlgorithm:{type:Function,default:function(e){var t=e.event,i=e.coordinates,o=e.aspectRatio,s=e.positionRestrictions,n=e.sizeRestrictions,r=A(A({},i),{right:i.left+i.width,bottom:i.top+i.height}),c=t.params||{},a=A({},t.directions),d=c.allowedDirections||{left:!0,right:!0,bottom:!0,top:!0};n.widthFrozen&&(a.left=0,a.right=0),n.heightFrozen&&(a.top=0,a.bottom=0),we.forEach(function(_){d[_]||(a[_]=0)});var f=be(r,a=ji({coordinates:r,directions:a,sizeRestrictions:n,positionRestrictions:s})).width,p=be(r,a).height,m=c.preserveRatio?L(r):Ot(f/p,o);if(m){var g=c.respectDirection;if(g||(g=r.width>=r.height||m===1?"width":"height"),g==="width"){var R=f/m-r.height;if(d.top&&d.bottom){var S=a.top,j=a.bottom;a.bottom=vt(R,j,S),a.top=vt(R,S,j)}else d.bottom?a.bottom=R:d.top?a.top=R:d.right?a.right=0:d.left&&(a.left=0)}else if(g==="height"){var V=r.width-p*m;if(d.left&&d.right){var Q=a.left,ie=a.right;a.left=-vt(V,Q,ie),a.right=-vt(V,ie,Q)}else d.left?a.left=-V:d.right?a.right=-V:d.top?a.top=0:d.bottom&&(a.bottom=0)}a=ji({directions:a,coordinates:r,sizeRestrictions:n,positionRestrictions:s,preserveRatio:!0,compensate:c.compensate})}return f=be(r,a).width,p=be(r,a).height,(m=c.preserveRatio?L(r):Ot(f/p,o))&&Math.abs(m-f/p)>.001&&we.forEach(function(_){d[_]||(a[_]=0)}),Gt({event:new ni({left:-a.left,top:-a.top}),coordinates:{width:i.width+a.right+a.left,height:i.height+a.top+a.bottom,left:i.left,top:i.top},positionRestrictions:s})}},moveAlgorithm:{type:Function,default:Gt},initStretcher:{type:Function,default:function(e){var t=e.stretcher,i=e.imageSize,o=L(i);t.style.width=i.width+"px",t.style.height=t.clientWidth/o+"px",t.style.width=t.clientWidth+"px"}},fitCoordinates:{type:Function,default:function(e){var t=e.visibleArea,i=e.coordinates,o=e.aspectRatio,s=e.sizeRestrictions,n=e.positionRestrictions,r=A(A({},i),Ae({width:i.width,height:i.height,aspectRatio:o,sizeRestrictions:{maxWidth:t.width,maxHeight:t.height,minHeight:Math.min(t.height,s.minHeight),minWidth:Math.min(t.width,s.minWidth)}}));return r=J(r=le(r,Qe(K(i),K(r))),Rt(_e(t),n))}},fitVisibleArea:{type:Function,default:function(e){var t=e.visibleArea,i=e.boundaries,o=e.getAreaRestrictions,s=e.coordinates,n=A({},t);n.height=n.width/L(i),n.top+=(t.height-n.height)/2,(s.height-n.height>0||s.width-n.width>0)&&(n=me(n,Math.max(s.height/n.height,s.width/n.width)));var r=zt(Je(s,_e(n=me(n,Ct(n,o({visibleArea:n,type:"resize"}))))));return n.width<s.width&&(r.left=0),n.height<s.height&&(r.top=0),n=J(n=le(n,r),o({visibleArea:n,type:"move"}))}},areaRestrictionsAlgorithm:{type:Function,default:function(e){var t=e.visibleArea,i=e.boundaries,o=e.imageSize,s=e.imageRestriction,n=e.type,r={};return s==="fill-area"?r={left:0,top:0,right:o.width,bottom:o.height}:s==="fit-area"&&(L(i)>L(o)?(r={top:0,bottom:o.height},t&&n==="move"&&(t.width>o.width?(r.left=-(t.width-o.width)/2,r.right=o.width-r.left):(r.left=0,r.right=o.width))):(r={left:0,right:o.width},t&&n==="move"&&(t.height>o.height?(r.top=-(t.height-o.height)/2,r.bottom=o.height-r.top):(r.top=0,r.bottom=o.height)))),r}},sizeRestrictionsAlgorithm:{type:Function,default:function(e){return{minWidth:e.minWidth,minHeight:e.minHeight,maxWidth:e.maxWidth,maxHeight:e.maxHeight}}},positionRestrictionsAlgorithm:{type:Function,default:function(e){var t=e.imageSize,i={};return e.imageRestriction!=="none"&&(i={left:0,top:0,right:t.width,bottom:t.height}),i}}},data:function(){return{transitionsActive:!1,imageLoaded:!1,imageAttributes:{width:null,height:null,crossOrigin:null,src:null},defaultImageTransforms:{rotate:0,flip:{horizontal:!1,vertical:!1}},appliedImageTransforms:{rotate:0,flip:{horizontal:!1,vertical:!1}},boundaries:{width:0,height:0},visibleArea:null,coordinates:O({},Li)}},computed:{image:function(){return{src:this.imageAttributes.src,width:this.imageAttributes.width,height:this.imageAttributes.height,transforms:this.imageTransforms}},imageTransforms:function(){return{rotate:this.appliedImageTransforms.rotate,flip:{horizontal:this.appliedImageTransforms.flip.horizontal,vertical:this.appliedImageTransforms.flip.vertical},translateX:this.visibleArea?this.visibleArea.left/this.coefficient:0,translateY:this.visibleArea?this.visibleArea.top/this.coefficient:0,scaleX:1/this.coefficient,scaleY:1/this.coefficient}},imageSize:function(){var e=function(t){return t*Math.PI/180}(this.imageTransforms.rotate);return{width:Math.abs(this.imageAttributes.width*Math.cos(e))+Math.abs(this.imageAttributes.height*Math.sin(e)),height:Math.abs(this.imageAttributes.width*Math.sin(e))+Math.abs(this.imageAttributes.height*Math.cos(e))}},initialized:function(){return!!(this.visibleArea&&this.imageLoaded)},settings:function(){var e=Yt(this.resizeImage,{touch:!0,wheel:{ratio:.1},adjustStencil:!0},{touch:!1,wheel:!1,adjustStencil:!1});return{moveImage:Yt(this.moveImage,{touch:!0,mouse:!0},{touch:!1,mouse:!1}),resizeImage:e}},coefficient:function(){return this.visibleArea?this.visibleArea.width/this.boundaries.width:0},areaRestrictions:function(){return this.imageLoaded?this.areaRestrictionsAlgorithm({imageSize:this.imageSize,imageRestriction:this.imageRestriction,boundaries:this.boundaries}):{}},transitionsOptions:function(){return{enabled:this.transitionsActive,timingFunction:"ease-in-out",time:350}},sizeRestrictions:function(){if(this.boundaries.width&&this.boundaries.height&&this.imageSize.width&&this.imageSize.height){var e=this.sizeRestrictionsAlgorithm({imageSize:this.imageSize,minWidth:Z(this.minWidth)?0:pt(this.minWidth),minHeight:Z(this.minHeight)?0:pt(this.minHeight),maxWidth:Z(this.maxWidth)?1/0:pt(this.maxWidth),maxHeight:Z(this.maxHeight)?1/0:pt(this.maxHeight)});if(e=function(o){var s=o.areaRestrictions,n=o.sizeRestrictions,r=o.boundaries,c=o.positionRestrictions,a=A(A({},n),{minWidth:n.minWidth!==void 0?n.minWidth:0,minHeight:n.minHeight!==void 0?n.minHeight:0,maxWidth:n.maxWidth!==void 0?n.maxWidth:1/0,maxHeight:n.maxHeight!==void 0?n.maxHeight:1/0});c.left!==void 0&&c.right!==void 0&&(a.maxWidth=Math.min(a.maxWidth,c.right-c.left)),c.bottom!==void 0&&c.top!==void 0&&(a.maxHeight=Math.min(a.maxHeight,c.bottom-c.top));var d=Xt(s),f=dn(r,d);return d.width<1/0&&(!a.maxWidth||a.maxWidth>f.width)&&(a.maxWidth=Math.min(a.maxWidth,f.width)),d.height<1/0&&(!a.maxHeight||a.maxHeight>f.height)&&(a.maxHeight=Math.min(a.maxHeight,f.height)),a.minWidth>a.maxWidth&&(a.minWidth=a.maxWidth,a.widthFrozen=!0),a.minHeight>a.maxHeight&&(a.minHeight=a.maxHeight,a.heightFrozen=!0),a}({sizeRestrictions:e,areaRestrictions:this.getAreaRestrictions({visibleArea:this.visibleArea,type:"resize"}),imageSize:this.imageSize,boundaries:this.boundaries,positionRestrictions:this.positionRestrictions,imageRestriction:this.imageRestriction,visibleArea:this.visibleArea,stencilSize:this.getStencilSize()}),this.visibleArea&&this.stencilSize){var t=this.getStencilSize(),i=Xt(this.getAreaRestrictions({visibleArea:this.visibleArea,type:"resize"}));e.maxWidth=Math.min(e.maxWidth,i.width*t.width/this.boundaries.width),e.maxHeight=Math.min(e.maxHeight,i.height*t.height/this.boundaries.height),e.maxWidth<e.minWidth&&(e.minWidth=e.maxWidth),e.maxHeight<e.minHeight&&(e.minHeight=e.maxHeight)}return e}return{minWidth:0,minHeight:0,maxWidth:0,maxHeight:0}},positionRestrictions:function(){return this.positionRestrictionsAlgorithm({imageSize:this.imageSize,imageRestriction:this.imageRestriction})},classes:function(){return{cropper:Ce(),image:G(Ce("image"),this.imageClass),stencil:Ce("stencil"),boundaries:G(Ce("boundaries"),this.boundariesClass),stretcher:G(Ce("stretcher")),background:G(Ce("background"),this.backgroundClass),foreground:G(Ce("foreground"),this.foregroundClass),imageWrapper:G(Ce("image-wrapper")),cropperWrapper:G(Ce("cropper-wrapper"))}},stencilCoordinates:function(){if(this.initialized){var e=this.coordinates,t=e.width,i=e.height,o=e.left,s=e.top;return{width:t/this.coefficient,height:i/this.coefficient,left:(o-this.visibleArea.left)/this.coefficient,top:(s-this.visibleArea.top)/this.coefficient}}return this.defaultCoordinates()},boundariesStyle:function(){var e={width:this.boundaries.width?"".concat(Math.round(this.boundaries.width),"px"):"auto",height:this.boundaries.height?"".concat(Math.round(this.boundaries.height),"px"):"auto",transition:"opacity ".concat(this.transitionTime,"ms"),pointerEvents:this.imageLoaded?"all":"none"};return this.imageLoaded||(e.opacity="0"),e},imageStyle:function(){var e=this.imageAttributes.width>this.imageAttributes.height?{width:Math.min(1024,this.imageAttributes.width),height:Math.min(1024,this.imageAttributes.width)/(this.imageAttributes.width/this.imageAttributes.height)}:{height:Math.min(1024,this.imageAttributes.height),width:Math.min(1024,this.imageAttributes.height)*(this.imageAttributes.width/this.imageAttributes.height)},t={left:(e.width-this.imageSize.width)/(2*this.coefficient),top:(e.height-this.imageSize.height)/(2*this.coefficient)},i={left:(1-1/this.coefficient)*e.width/2,top:(1-1/this.coefficient)*e.height/2},o=O(O({},this.imageTransforms),{},{scaleX:this.imageTransforms.scaleX*(this.imageAttributes.width/e.width),scaleY:this.imageTransforms.scaleY*(this.imageAttributes.height/e.height)}),s={width:"".concat(e.width,"px"),height:"".concat(e.height,"px"),left:"0px",top:"0px",transform:"translate(".concat(-t.left-i.left-this.imageTransforms.translateX,"px, ").concat(-t.top-i.top-this.imageTransforms.translateY,"px)")+gn(o)};return this.transitionsOptions.enabled&&(s.transition="".concat(this.transitionsOptions.time,"ms ").concat(this.transitionsOptions.timingFunction)),s}},watch:{src:function(){this.onChangeImage()},stencilComponent:function(){var e=this;this.$nextTick(function(){e.resetCoordinates(),e.runAutoZoom("setCoordinates"),e.onChange()})},minWidth:function(){this.onPropsChange()},maxWidth:function(){this.onPropsChange()},minHeight:function(){this.onPropsChange()},maxHeight:function(){this.onPropsChange()},imageRestriction:function(){this.reset()},stencilProps:function(e,t){["aspectRatio","minAspectRatio","maxAspectRatio"].find(function(i){return e[i]!==t[i]})&&this.$nextTick(this.onPropsChange)}},created:function(){this.debouncedUpdate=qt(this.update,this.debounce),this.debouncedDisableTransitions=qt(this.disableTransitions,this.transitionsOptions.time),this.awaiting=!1},mounted:function(){this.$refs.image.addEventListener("load",this.onSuccessLoadImage),this.$refs.image.addEventListener("error",this.onFailLoadImage),this.onChangeImage(),window.addEventListener("resize",this.refresh),window.addEventListener("orientationchange",this.refresh)},unmounted:function(){window.removeEventListener("resize",this.refresh),window.removeEventListener("orientationchange",this.refresh),this.imageAttributes.revoke&&this.imageAttributes.src&&URL.revokeObjectURL(this.imageAttributes.src),this.debouncedUpdate.clear(),this.debouncedDisableTransitions.clear()},methods:{getResult:function(){var e=this.initialized?this.prepareResult(O({},this.coordinates)):this.defaultCoordinates(),t={rotate:this.imageTransforms.rotate%360,flip:O({},this.imageTransforms.flip)};if(this.src&&this.imageLoaded){var i=this;return{image:this.image,coordinates:e,visibleArea:this.visibleArea?O({},this.visibleArea):null,imageTransforms:t,get canvas(){return i.canvas?i.getCanvas():void 0}}}return{image:this.image,coordinates:e,visibleArea:this.visibleArea?O({},this.visibleArea):null,canvas:void 0,imageTransforms:t}},zoom:function(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=i.transitions,s=o===void 0||o;this.onManipulateImage(new ot({},{factor:1/e,center:t}),{normalize:!1,transitions:s})},move:function(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=i.transitions,s=o===void 0||o;this.onManipulateImage(new ot({left:e||0,top:t||0}),{normalize:!1,transitions:s})},setCoordinates:function(e){var t=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=i.autoZoom,s=o===void 0||o,n=i.transitions,r=n===void 0||n;this.$nextTick(function(){t.imageLoaded?(t.transitionsActive||(r&&t.enableTransitions(),t.coordinates=t.applyTransform(e),s&&t.runAutoZoom("setCoordinates"),r&&t.debouncedDisableTransitions()),t.onChange()):t.delayedTransforms=e})},refresh:function(){var e=this,t=this.$refs.image;if(this.src&&t)return this.initialized?this.updateVisibleArea().then(function(){e.onChange()}):this.resetVisibleArea().then(function(){e.onChange()})},reset:function(){var e=this;return this.resetVisibleArea().then(function(){e.onChange(!1)})},awaitRender:function(e){var t=this;this.awaiting||(this.awaiting=!0,this.$nextTick(function(){e(),t.awaiting=!1}))},prepareResult:function(e){return this.roundResult?function(t){var i=t.coordinates,o=t.sizeRestrictions,s=t.positionRestrictions,n={width:Math.round(i.width),height:Math.round(i.height),left:Math.round(i.left),top:Math.round(i.top)};return n.width>o.maxWidth?n.width=Math.floor(i.width):n.width<o.minWidth&&(n.width=Math.ceil(i.width)),n.height>o.maxHeight?n.height=Math.floor(i.height):n.height<o.minHeight&&(n.height=Math.ceil(i.height)),J(n,s)}(O(O({},this.getPublicProperties()),{},{positionRestrictions:gt(this.positionRestrictions,this.visibleArea),coordinates:e})):e},processAutoZoom:function(e,t,i,o){var s=this.autoZoomAlgorithm;s||(s=this.stencilSize?ps:this.autoZoom?gs:vs);var n=s({event:{type:e,params:o},visibleArea:t,coordinates:i,boundaries:this.boundaries,aspectRatio:this.getAspectRatio(),positionRestrictions:this.positionRestrictions,getAreaRestrictions:this.getAreaRestrictions,sizeRestrictions:this.sizeRestrictions,stencilSize:this.getStencilSize()});return O(O({},n),{},{changed:!Bi(n.visibleArea,t)||!Bi(n.coordinates,i)})},runAutoZoom:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=t.transitions,o=i!==void 0&&i,s=os(t,Ts),n=this.processAutoZoom(e,this.visibleArea,this.coordinates,s),r=n.visibleArea,c=n.coordinates,a=n.changed;o&&a&&this.enableTransitions(),this.visibleArea=r,this.coordinates=c,o&&a&&this.debouncedDisableTransitions()},normalizeEvent:function(e){return function(t){var i=t.event,o=t.visibleArea,s=t.coefficient;if(i.type==="manipulateImage")return A(A({},i),{move:{left:i.move&&i.move.left?s*i.move.left:0,top:i.move&&i.move.top?s*i.move.top:0},scale:{factor:i.scale&&i.scale.factor?i.scale.factor:1,center:i.scale&&i.scale.center?{left:i.scale.center.left*s+o.left,top:i.scale.center.top*s+o.top}:null}});if(i.type==="resize"){var n=A(A({},i),{directions:A({},i.directions)});return we.forEach(function(c){n.directions[c]*=s}),n}if(i.type==="move"){var r=A(A({},i),{directions:A({},i.directions)});return ds.forEach(function(c){r.directions[c]*=s}),r}return i}(O(O({},this.getPublicProperties()),{},{event:e}))},getCanvas:function(){if(this.$refs.canvas){var e=this.$refs.canvas,t=this.$refs.image,i=this.imageTransforms.rotate!==0||this.imageTransforms.flip.horizontal||this.imageTransforms.flip.vertical?function(c,a,d){var f=d.rotate,p=d.flip,m={width:a.naturalWidth,height:a.naturalHeight},g=un(m,f),R=c.getContext("2d");c.height=g.height,c.width=g.width,R.save();var S=Te(K(A({left:0,top:0},m)),f);return R.translate(-(S.left-g.width/2),-(S.top-g.height/2)),R.rotate(f*Math.PI/180),R.translate(p.horizontal?m.width:0,p.vertical?m.height:0),R.scale(p.horizontal?-1:1,p.vertical?-1:1),R.drawImage(a,0,0,m.width,m.height),R.restore(),c}(this.$refs.sourceCanvas,t,this.imageTransforms):t,o=O({minWidth:0,minHeight:0,maxWidth:1/0,maxHeight:1/0,maxArea:this.maxCanvasSize,imageSmoothingEnabled:!0,imageSmoothingQuality:"high",fillColor:"transparent"},this.canvas),s=function(c){return c.find(function(a){return d=a,!Number.isNaN(parseFloat(d))&&isFinite(d);var d})},n=Ae({sizeRestrictions:{minWidth:s([o.width,o.minWidth])||0,minHeight:s([o.height,o.minHeight])||0,maxWidth:s([o.width,o.maxWidth])||1/0,maxHeight:s([o.height,o.maxHeight])||1/0},width:this.coordinates.width,height:this.coordinates.height,aspectRatio:{minimum:this.coordinates.width/this.coordinates.height,maximum:this.coordinates.width/this.coordinates.height}});if(o.maxArea&&n.width*n.height>o.maxArea){var r=Math.sqrt(o.maxArea/(n.width*n.height));n={width:Math.round(r*n.width),height:Math.round(r*n.height)}}return function(c,a,d,f,p){c.width=f?f.width:d.width,c.height=f?f.height:d.height;var m=c.getContext("2d");m.clearRect(0,0,c.width,c.height),p&&(p.imageSmoothingEnabled&&(m.imageSmoothingEnabled=p.imageSmoothingEnabled),p.imageSmoothingQuality&&(m.imageSmoothingQuality=p.imageSmoothingQuality),p.fillColor&&(m.fillStyle=p.fillColor,m.fillRect(0,0,c.width,c.height),m.save()));var g=d.left<0?-d.left:0,R=d.top<0?-d.top:0;m.drawImage(a,d.left+g,d.top+R,d.width,d.height,g,R,c.width,c.height)}(e,i,this.coordinates,n,o),e}},update:function(){this.$emit("change",this.getResult())},applyTransform:function(e){var t=arguments.length>1&&arguments[1]!==void 0&&arguments[1],i=this.visibleArea&&t?ms(this.sizeRestrictions,this.visibleArea):this.sizeRestrictions,o=this.visibleArea&&t?gt(this.positionRestrictions,this.visibleArea):this.positionRestrictions;return fs({transform:e,coordinates:this.coordinates,imageSize:this.imageSize,sizeRestrictions:i,positionRestrictions:o,aspectRatio:this.getAspectRatio(),visibleArea:this.visibleArea})},resetCoordinates:function(){var e=this;if(this.$refs.image){this.$refs.cropper,this.$refs.image;var t=this.defaultSize;t||(t=this.stencilSize?ys:ws);var i=this.sizeRestrictions;i.minWidth,i.minHeight,i.maxWidth,i.maxHeight;var o=qe(t)?t({boundaries:this.boundaries,imageSize:this.imageSize,aspectRatio:this.getAspectRatio(),sizeRestrictions:this.sizeRestrictions,stencilSize:this.getStencilSize(),visibleArea:this.visibleArea}):t,s=this.defaultPosition||bs,n=[o,function(r){var c=r.coordinates;return O({},qe(s)?s({coordinates:c,imageSize:e.imageSize,visibleArea:e.visibleArea}):e.defaultPosition)}];this.delayedTransforms&&n.push.apply(n,je(Array.isArray(this.delayedTransforms)?this.delayedTransforms:[this.delayedTransforms])),this.coordinates=this.applyTransform(n,!0),this.delayedTransforms=null}},clearImage:function(){var e=this;this.imageLoaded=!1,setTimeout(function(){var t=e.$refs.stretcher;t&&(t.style.height="auto",t.style.width="auto"),e.coordinates=e.defaultCoordinates(),e.boundaries={width:0,height:0}},this.transitionTime)},enableTransitions:function(){this.transitions&&(this.transitionsActive=!0)},disableTransitions:function(){this.transitionsActive=!1},updateBoundaries:function(){var e=this,t=this.$refs.stretcher,i=this.$refs.cropper;return this.initStretcher({cropper:i,stretcher:t,imageSize:this.imageSize}),this.$nextTick().then(function(){var o={cropper:i,imageSize:e.imageSize};if(qe(e.defaultBoundaries)?e.boundaries=e.defaultBoundaries(o):e.defaultBoundaries==="fit"?e.boundaries=function(s){var n=s.cropper,r=s.imageSize,c=n.clientHeight,a=n.clientWidth,d=c,f=r.width*c/r.height;return f>a&&(f=a,d=r.height*a/r.width),{width:f,height:d}}(o):e.boundaries=function(s){var n=s.cropper;return{width:n.clientWidth,height:n.clientHeight}}(o),!e.boundaries.width||!e.boundaries.height)throw new Error("It's impossible to fit the cropper in the current container")})},resetVisibleArea:function(){var e=this;return this.appliedImageTransforms=O(O({},this.defaultImageTransforms),{},{flip:O({},this.defaultImageTransforms.flip)}),this.updateBoundaries().then(function(){e.priority!=="visible-area"&&(e.visibleArea=null,e.resetCoordinates());var t,i,o,s,n,r,c=e.defaultVisibleArea||_s;e.visibleArea=qe(c)?c({imageSize:e.imageSize,boundaries:e.boundaries,coordinates:e.priority!=="visible-area"?e.coordinates:null,getAreaRestrictions:e.getAreaRestrictions,stencilSize:e.getStencilSize()}):e.defaultVisibleArea,e.visibleArea=(t={visibleArea:e.visibleArea,boundaries:e.boundaries,getAreaRestrictions:e.getAreaRestrictions},i=t.visibleArea,o=t.boundaries,s=t.getAreaRestrictions,n=A({},i),r=L(o),n.width/n.height!==r&&(n.height=n.width/r),J(n,s({visibleArea:n,type:"move"}))),e.priority==="visible-area"?e.resetCoordinates():e.coordinates=e.fitCoordinates({visibleArea:e.visibleArea,coordinates:e.coordinates,aspectRatio:e.getAspectRatio(),positionRestrictions:e.positionRestrictions,sizeRestrictions:e.sizeRestrictions}),e.runAutoZoom("resetVisibleArea")}).catch(function(){e.visibleArea=null})},updateVisibleArea:function(){var e=this;return this.updateBoundaries().then(function(){e.visibleArea=e.fitVisibleArea({imageSize:e.imageSize,boundaries:e.boundaries,visibleArea:e.visibleArea,coordinates:e.coordinates,getAreaRestrictions:e.getAreaRestrictions}),e.coordinates=e.fitCoordinates({visibleArea:e.visibleArea,coordinates:e.coordinates,aspectRatio:e.getAspectRatio(),positionRestrictions:e.positionRestrictions,sizeRestrictions:e.sizeRestrictions}),e.runAutoZoom("updateVisibleArea")}).catch(function(){e.visibleArea=null})},onChange:function(){var e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];e&&this.debounce?this.debouncedUpdate():this.update()},onChangeImage:function(){var e,t=this;if(this.imageLoaded=!1,this.delayedTransforms=null,this.src){if(function(s){if(Fi(s))return!1;var n=window.location,r=/(\w+:)?(?:\/\/)([\w.-]+)?(?::(\d+))?\/?/.exec(s)||[],c={protocol:r[1]||"",host:r[2]||"",port:r[3]||""},a=function(d){return d.port||((d.protocol||n.protocol)==="http"?80:433)};return!(!c.protocol&&!c.host&&!c.port||c.protocol&&c.protocol==n.protocol&&c.host&&c.host==n.host&&c.host&&a(c)==a(n))}(this.src)){var i=Z(this.crossOrigin)?this.canvas:this.crossOrigin;i===!0&&(i="anonymous"),this.imageAttributes.crossOrigin=i||null}if(this.checkOrientation){var o=(e=this.src,new Promise(function(s){Is(e).then(function(n){var r=Ds(n);s(n?{source:e,arrayBuffer:n,orientation:r}:{source:e,arrayBuffer:null,orientation:null})}).catch(function(n){console.warn(n),s({source:e,arrayBuffer:null,orientation:null})})}));setTimeout(function(){o.then(t.onParseImage)},this.transitionTime)}else setTimeout(function(){t.onParseImage({source:t.src})},this.transitionTime)}else this.clearImage()},onFailLoadImage:function(){this.imageAttributes.src&&(this.clearImage(),this.$emit("error"))},onSuccessLoadImage:function(){var e=this,t=this.$refs.image;t&&!this.imageLoaded&&(this.imageAttributes.height=t.naturalHeight,this.imageAttributes.width=t.naturalWidth,this.imageLoaded=!0,this.resetVisibleArea().then(function(){e.$emit("ready"),e.onChange(!1)}))},onParseImage:function(e){var t=this,i=e.source,o=e.arrayBuffer,s=e.orientation;this.imageAttributes.revoke&&this.imageAttributes.src&&URL.revokeObjectURL(this.imageAttributes.src),this.imageAttributes.revoke=!1,o&&s&&s>1?an(i)||!Fi(i)?(this.imageAttributes.src=URL.createObjectURL(new Blob([o])),this.imageAttributes.revoke=!0):this.imageAttributes.src=function(n){for(var r=[],c=new Uint8Array(n);c.length>0;){var a=c.subarray(0,8192);r.push(String.fromCharCode.apply(null,Array.from?Array.from(a):a.slice())),c=c.subarray(8192)}return"data:image/jpeg;base64,"+btoa(r.join(""))}(o):this.imageAttributes.src=i,qe(this.defaultTransforms)?this.appliedImageTransforms=Bt(this.defaultTransforms()):yt(this.defaultTransforms)?this.appliedImageTransforms=Bt(this.defaultTransforms):this.appliedImageTransforms=function(n){var r=Bt({});if(n)switch(n){case 2:r.flip.horizontal=!0;break;case 3:r.rotate=-180;break;case 4:r.flip.vertical=!0;break;case 5:r.rotate=90,r.flip.vertical=!0;break;case 6:r.rotate=90;break;case 7:r.rotate=90,r.flip.horizontal=!0;break;case 8:r.rotate=-90}return r}(s),this.defaultImageTransforms=O(O({},this.appliedImageTransforms),{},{flip:O({},this.appliedImageTransforms.flip)}),this.$nextTick(function(){var n=t.$refs.image;n&&n.complete&&(function(r){return!!r.naturalWidth}(n)?t.onSuccessLoadImage():t.onFailLoadImage())})},onResizeEnd:function(){this.runAutoZoom("resize",{transitions:!0})},onMoveEnd:function(){this.runAutoZoom("move",{transitions:!0})},onMove:function(e){var t=this;this.transitionsOptions.enabled||this.awaitRender(function(){t.coordinates=t.moveAlgorithm(O(O({},t.getPublicProperties()),{},{positionRestrictions:gt(t.positionRestrictions,t.visibleArea),coordinates:t.coordinates,event:t.normalizeEvent(e)})),t.onChange()})},onResize:function(e){var t=this;this.transitionsOptions.enabled||this.stencilSize&&!this.autoZoom||this.awaitRender(function(){var i=t.sizeRestrictions,o=Math.min(t.coordinates.width,t.coordinates.height,20*t.coefficient);t.coordinates=t.resizeAlgorithm(O(O({},t.getPublicProperties()),{},{positionRestrictions:gt(t.positionRestrictions,t.visibleArea),sizeRestrictions:{maxWidth:Math.min(i.maxWidth,t.visibleArea.width),maxHeight:Math.min(i.maxHeight,t.visibleArea.height),minWidth:Math.max(i.minWidth,o),minHeight:Math.max(i.minHeight,o)},event:t.normalizeEvent(e)})),t.onChange(),t.ticking=!1})},onManipulateImage:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.transitionsOptions.enabled){var i=t.transitions,o=i!==void 0&&i,s=t.normalize,n=s===void 0||s;o&&this.enableTransitions();var r=xs(O(O({},this.getPublicProperties()),{},{event:n?this.normalizeEvent(e):e,getAreaRestrictions:this.getAreaRestrictions,imageRestriction:this.imageRestriction,adjustStencil:!this.stencilSize&&this.settings.resizeImage.adjustStencil})),c=r.visibleArea,a=r.coordinates;this.visibleArea=c,this.coordinates=a,this.runAutoZoom("manipulateImage"),this.onChange(),o&&this.debouncedDisableTransitions()}},onPropsChange:function(){this.coordinates=this.applyTransform(this.coordinates,!0),this.onChange(!1)},getAreaRestrictions:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.visibleArea,i=e.type,o=i===void 0?"move":i;return this.areaRestrictionsAlgorithm({boundaries:this.boundaries,imageSize:this.imageSize,imageRestriction:this.imageRestriction,visibleArea:t,type:o})},getAspectRatio:function(e){var t,i,o=this.stencilProps,s=o.aspectRatio,n=o.minAspectRatio,r=o.maxAspectRatio;if(this.$refs.stencil&&this.$refs.stencil.aspectRatios){var c=this.$refs.stencil.aspectRatios();t=c.minimum,i=c.maximum}if(Z(t)&&(t=Z(s)?n:s),Z(i)&&(i=Z(s)?r:s),!e&&(Z(t)||Z(i))){var a=this.getStencilSize(),d=a?L(a):null;Z(t)&&(t=Oi(d)?d:void 0),Z(i)&&(i=Oi(d)?d:void 0)}return{minimum:t,maximum:i}},getStencilSize:function(){if(this.stencilSize)return e={currentStencilSize:{width:this.stencilCoordinates.width,height:this.stencilCoordinates.height},stencilSize:this.stencilSize,boundaries:this.boundaries,coefficient:this.coefficient,coordinates:this.coordinates,aspectRatio:this.getAspectRatio(!0)},t=e.boundaries,i=e.stencilSize,o=e.aspectRatio,Ot(L(s=qe(i)?i({boundaries:t,aspectRatio:o}):i),o)&&(s=Ae({sizeRestrictions:{maxWidth:t.width,maxHeight:t.height,minWidth:0,minHeight:0},width:s.width,height:s.height,aspectRatio:{minimum:o.minimum,maximum:o.maximum}})),(s.width>t.width||s.height>t.height)&&(s=Ae({sizeRestrictions:{maxWidth:t.width,maxHeight:t.height,minWidth:0,minHeight:0},width:s.width,height:s.height,aspectRatio:{minimum:L(s),maximum:L(s)}})),s;var e,t,i,o,s},getPublicProperties:function(){return{coefficient:this.coefficient,visibleArea:this.visibleArea,coordinates:this.coordinates,boundaries:this.boundaries,sizeRestrictions:this.sizeRestrictions,positionRestrictions:this.positionRestrictions,aspectRatio:this.getAspectRatio(),imageRestriction:this.imageRestriction}},defaultCoordinates:function(){return O({},Li)},flip:function(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=i.transitions,s=o===void 0||o;if(!this.transitionsActive){s&&this.enableTransitions();var n=O({},this.imageTransforms.flip),r=Cs({flip:{horizontal:e?!n.horizontal:n.horizontal,vertical:t?!n.vertical:n.vertical},previousFlip:n,rotate:this.imageTransforms.rotate,visibleArea:this.visibleArea,coordinates:this.coordinates,imageSize:this.imageSize,positionRestrictions:this.positionRestrictions,sizeRestrictions:this.sizeRestrictions,getAreaRestrictions:this.getAreaRestrictions,aspectRatio:this.getAspectRatio()}),c=r.visibleArea,a=r.coordinates;e&&(this.appliedImageTransforms.flip.horizontal=!this.appliedImageTransforms.flip.horizontal),t&&(this.appliedImageTransforms.flip.vertical=!this.appliedImageTransforms.flip.vertical),this.visibleArea=c,this.coordinates=a,this.onChange(),s&&this.debouncedDisableTransitions()}},rotate:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=t.transitions,o=i===void 0||i;if(!this.transitionsActive){o&&this.enableTransitions();var s=O({},this.imageSize);this.appliedImageTransforms.rotate+=e;var n=zs({visibleArea:this.visibleArea,coordinates:this.coordinates,previousImageSize:s,imageSize:this.imageSize,angle:e,positionRestrictions:this.positionRestrictions,sizeRestrictions:this.sizeRestrictions,getAreaRestrictions:this.getAreaRestrictions,aspectRatio:this.getAspectRatio()}),r=n.visibleArea,c=n.coordinates,a=this.processAutoZoom("rotateImage",r,c);r=a.visibleArea,c=a.coordinates,this.visibleArea=r,this.coordinates=c,this.onChange(),o&&this.debouncedDisableTransitions()}}},emits:["change","error","ready"]},Fs={key:0,ref:"canvas",style:{display:"none"}},Os={key:1,ref:"sourceCanvas",style:{display:"none"}};_n.render=function(e,t,i,o,s,n){return b(),C("div",{ref:"cropper",class:n.classes.cropper},[y("div",{ref:"stretcher",class:n.classes.stretcher},null,2),y("div",{class:n.classes.boundaries,style:n.boundariesStyle},[(b(),C(ye(i.backgroundWrapperComponent),{class:n.classes.cropperWrapper,"wheel-resize":n.settings.resizeImage.wheel,"touch-resize":n.settings.resizeImage.touch,"touch-move":n.settings.moveImage.touch,"mouse-move":n.settings.moveImage.mouse,onMove:n.onManipulateImage,onResize:n.onManipulateImage},{default:x(function(){return[y("div",{class:n.classes.background,style:n.boundariesStyle},null,6),y("div",{class:n.classes.imageWrapper},[y("img",{ref:"image",crossorigin:s.imageAttributes.crossOrigin,src:s.imageAttributes.src,class:n.classes.image,style:n.imageStyle,onMousedown:t[1]||(t[1]=re(function(){},["prevent"]))},null,46,["crossorigin","src"])],2),y("div",{class:n.classes.foreground,style:n.boundariesStyle},null,6),Xe((b(),C(ye(i.stencilComponent),Qt({ref:"stencil",image:n.image,coordinates:s.coordinates,"stencil-coordinates":n.stencilCoordinates,transitions:n.transitionsOptions},i.stencilProps,{onResize:n.onResize,onResizeEnd:n.onResizeEnd,onMove:n.onMove,onMoveEnd:n.onMoveEnd}),null,16,["image","coordinates","stencil-coordinates","transitions","onResize","onResizeEnd","onMove","onMoveEnd"])),[[Hi,s.imageLoaded]]),i.canvas?(b(),C("canvas",Fs,null,512)):T("",!0),i.canvas?(b(),C("canvas",Os,null,512)):T("",!0)]}),_:1},8,["class","wheel-resize","touch-resize","touch-move","mouse-move","onMove","onResize"]))],6)],2)};const Ls=e=>(qi("data-v-bec7f64d"),e=e(),Yi(),e),Bs={class:"nc-image-cropper-wrapper relative"},Ws={key:0,class:"result_preview"},Ps=["src"],js={class:"flex justify-between items-center space-x-4 mt-4"},Vs={class:"flex items-center space-x-4"},Hs={class:"flex items-center space-x-4"},Us=Ls(()=>v("span",{class:"ml-2"},"Crop",-1)),Ns=xt({__name:"ImageCropper",props:{imageConfig:{},cropperConfig:{},uploadConfig:{},showCropper:{type:Boolean}},emits:["update:showCropper","submit"],setup(e,{emit:t}){const i=io(e,["imageConfig","cropperConfig","uploadConfig"]),o=t,s=Ui(i,"showCropper",o),{api:n,isLoading:r}=no(),c=B(),a=B({canvas:{},src:""}),d=()=>{const{canvas:m}=c.value.getResult();a.value={canvas:m,src:m.toDataURL()}},f=async m=>{var g,R;if((g=e.uploadConfig)!=null&&g.path)try{const S=await n.storage.uploadByUrl({path:(R=e.uploadConfig)==null?void 0:R.path},m);S!=null&&S[0]?o("submit",{...S[0],data:m[0].data}):o("submit",m[0])}catch(S){console.error(S),Ge.error(await Jt(S))}else o("submit",m[0]);s.value=!1},p=async()=>{a.value.canvas&&a.value.canvas.toBlob(async m=>{await f([{title:e.imageConfig.name,fileName:e.imageConfig.name,mimetype:e.imageConfig.type,size:m.size,url:a.value.src,data:a.value.src}])},e.imageConfig.type)};return Ye(s,()=>{s.value||(a.value={canvas:{},src:""})}),(m,g)=>{const R=Kt,S=Ni,j=oo;return b(),C(j,{visible:l(s),"onUpdate:visible":g[1]||(g[1]=V=>Pe(s)?s.value=V:null),"mask-closable":!1},{default:x(()=>{var V,Q,ie,_;return[v("div",Bs,[y(l(_n),{ref_key:"cropperRef",ref:c,class:"nc-cropper relative",src:m.imageConfig.src,"auto-zoom":!0,"stencil-props":((V=m.cropperConfig)==null?void 0:V.stencilProps)||{},"min-height":(Q=m.cropperConfig)==null?void 0:Q.minHeight,"min-width":(ie=m.cropperConfig)==null?void 0:ie.minWidth,"image-restriction":(_=m.cropperConfig)==null?void 0:_.imageRestriction},null,8,["src","stencil-props","min-height","min-width","image-restriction"]),l(a).src?(b(),W("div",Ws,[v("img",{src:l(a).src,alt:"Preview Image"},null,8,Ps)])):T("",!0)]),v("div",js,[v("div",Vs,[y(R,{type:"secondary",size:"small",disabled:l(r),onClick:g[0]||(g[0]=Ve=>s.value=!1)},{default:x(()=>[se(" Cancel ")]),_:1},8,["disabled"])]),v("div",Hs,[y(R,{type:"secondary",size:"small",disabled:l(r),onClick:d},{default:x(()=>[y(S,{icon:"crop"}),Us]),_:1},8,["disabled"]),y(R,{size:"small",loading:l(r),disabled:!l(a).src,onClick:p},{default:x(()=>[se(" Save ")]),_:1},8,["loading","disabled"])])])]}),_:1},8,["visible"])}}}),qs=ei(Ns,[["__scopeId","data-v-bec7f64d"]]);const Ys={class:"nc-column-insert-before nc-form-header-menu-item"},Xs={class:"nc-column-delete nc-form-header-menu-item text-red-600"},Gs=xt({__name:"FieldMenu",props:{column:{},formColumn:{},isRequired:{type:Boolean},isOpen:{type:Boolean},onDelete:{type:Function}},emits:["hideField","update:isOpen","delete"],setup(e,{emit:t}){const i=e,o=t,{column:s,isRequired:n}=so(i),r=Ui(i,"isOpen",o),{eventBus:c}=Po(),a=Re(Xi),d=Re(Gi,B()),f=Re(Zi,B()),p=Re(Qi);Pt(ao,s);const{$api:m}=ii(),{t:g}=ti(),{getMeta:R}=ro(),S=B(!1),j=B(!1),V=B(),Q=B(),ie=async()=>{var Y;let z={};const w=jo(`${s.value.title} copy`,d.value.columns);z={...s.value,...s.value.colOptions??{},title:w,column_name:w.replace(/\s/g,"_"),id:void 0,colOptions:void 0,order:void 0,system:!1};try{const U=(await m.dbViewColumn.list((Y=f.value)==null?void 0:Y.id)).list,P=U.findIndex(Fe=>Fe.fk_column_id===s.value.id);let fe;P===U.length-1?fe=U[P].order+1:fe=(U[P].order+U[P+1].order)/2,await m.dbTableColumn.create(d.value.id,{...z,pv:!1,view_id:f.value.id,column_order:{order:fe,view_id:f.value.id}}),await R(d.value.id,!0),c.emit(lo.FIELD_RELOAD),a==null||a.trigger()}catch(U){Ge.error(await Jt(U))}r.value=!1},_=async()=>{var z;if(s!=null&&s.value)if(s.value.uidt&&[H.Lookup,H.Rollup,H.CreatedTime,H.LastModifiedTime,H.CreatedBy,H.LastModifiedBy].includes(s.value.uidt))ie();else{const w=(await m.dbViewColumn.list((z=f.value)==null?void 0:z.id)).list,Y=w.findIndex(P=>P.fk_column_id===s.value.id);let U;Y===w.length-1?U=w[Y].order+1:U=(w[Y].order+w[Y+1].order)/2,V.value={pv:!1,view_id:f.value.id,column_order:{order:U,view_id:f.value.id}},s.value.uidt===H.Formula?wt(()=>{var P;(P=Q==null?void 0:Q.value)==null||P.duplicate()}):j.value=!0,r.value=!1}},Ve=async()=>{n.value||(r.value=!1,o("hideField"))},q=()=>{r.value=!1,S.value=!0},F=de(()=>(s==null?void 0:s.value)&&!s.value.system),D=de(()=>(s==null?void 0:s.value)&&!s.value.system);return(z,w)=>{const Y=Kt,U=Oo,P=tn,fe=Lo,Fe=Ki,rt=Bo,At=Wo;return b(),W(We,null,[l(p)?T("",!0):(b(),C(Fe,{key:0,visible:l(r),"onUpdate:visible":w[1]||(w[1]=ee=>Pe(r)?r.value=ee:null),trigger:["click"],placement:"bottomLeft","overlay-class-name":"nc-dropdown-form-column-operations !border-1 rounded-lg !shadow-xl",onClick:w[2]||(w[2]=re(ee=>r.value=!l(r),["stop"]))},{overlay:x(()=>[y(fe,{class:"flex flex-col gap-1 border-gray-200 nc-column-options"},{default:x(()=>{var ee;return[T("",!0),y(U,{disabled:l(n),onClick:Ve},{default:x(()=>[v("div",Ys,[(b(),C(ye(("iconMap"in z?z.iconMap:l(Ze)).eye),{class:"!w-3.75 !h-3.75"})),se(" "+E(z.$t("general.hideField")),1)])]),_:1},8,["disabled"]),(ee=l(s))!=null&&ee.pv?T("",!0):(b(),W(We,{key:1},[y(P,{class:"!my-0"}),y(U,{disabled:!F.value,class:"!hover:bg-red-50",onClick:q},{default:x(()=>[v("div",Xs,[(b(),C(ye(("iconMap"in z?z.iconMap:l(Ze)).delete))),se(" "+E(z.$t("general.delete")),1)])]),_:1},8,["disabled"])],64))]}),_:1})]),default:x(()=>[y(Y,{type:"secondary",size:"small",class:"nc-form-add-field","data-testid":"nc-form-add-field",onClick:w[0]||(w[0]=re(ee=>z.showAddColumnDropdown=!0,["stop"]))},{default:x(()=>[(b(),C(ye(("iconMap"in z?z.iconMap:l(Ze)).threeDotVertical),{class:"flex-none w-4 h-4"}))]),_:1})]),_:1},8,["visible"])),y(rt,{visible:l(S),"onUpdate:visible":w[3]||(w[3]=ee=>Pe(S)?S.value=ee:null),class:"nc-form-column-delete-dropdown","on-delete-column":z.onDelete},null,8,["visible","on-delete-column"]),l(s)?(b(),C(At,{key:1,ref_key:"duplicateDialogRef",ref:Q,modelValue:l(j),"onUpdate:modelValue":w[4]||(w[4]=ee=>Pe(j)?j.value=ee:null),column:l(s),extra:l(V)},null,8,["modelValue","column","extra"])):T("",!0)],64)}}}),Zs=ei(Gs,[["__scopeId","data-v-4aab5ffe"]]),Qs=xt({__name:"Layout",setup(e){const{leftSidebarWidth:t,windowSize:i,formRightSidebarState:o,formRightSidebarWidthPercent:s}=jt(Uo()),n=de(()=>100-s.value);function r(a){const d=a*(i.value-t.value)/100;d>o.value.maxWidth?o.value.width=o.value.maxWidth:d<o.value.minWidth?o.value.width=o.value.minWidth:o.value.width=d}const c=de(()=>o.value.width>o.value.maxWidth?o.value.maxWidth:o.value.width<o.value.minWidth?o.value.minWidth:o.value.width);return(a,d)=>(b(),C(l(nn),{class:"nc-form-right-sidebar-content-resizable-wrapper w-full h-full",onResize:d[0]||(d[0]=f=>r(f[1].size))},{default:x(()=>[y(l(_t),{size:l(n),class:"flex-1 h-full"},{default:x(()=>[Me(a.$slots,"preview")]),_:3},8,["size"]),y(l(_t),{"min-size":"15%",class:"nc-sidebar-splitpane relative",size:l(s),style:Vt({minWidth:`${l(o).minWidth}px !important`,maxWidth:`${l(c)}px !important`})},{default:x(()=>[Me(a.$slots,"sidebar")]),_:3},8,["size","style"])]),_:3}))}}),Ks=on.useForm,[Js,ea]=Yo((e,t,i,o,s)=>{const{$api:n}=ii(),{t:r}=ti(),c=Ji(),a=B({}),d=B([]),f=B(""),p=de(()=>d.value.filter(D=>D.show).sort((D,z)=>D.order-z.order)),m=de(()=>p.value.find(D=>D.id===f.value)||null),g=de(()=>{var D;if(e.value&&m.value){if(e.value.columnsById&&e.value.columnsById[(D=m.value)==null?void 0:D.fk_column_id])return e.value.columnsById[m.value.fk_column_id];if(e.value.columns)return e.value.columns.find(z=>{var w;return z.id===((w=m.value)==null?void 0:w.fk_column_id)})??null}return null}),R=de(()=>{const D=new Set;return p.value.reduce((z,w)=>(z[w.title]=Xo(w.title,D),z),{})}),S=de(()=>{const D={};if(!p.value||!Object.keys(R.value).length)return D;for(const z of p.value){let w=[{validator:(U,P)=>new Promise((fe,Fe)=>F(z,z.required)&&(typeof P=="string"&&(P=P.trim()),z.uidt===H.Checkbox&&!P||z.uidt!==H.Checkbox&&!Zo(P))?Fe(r("msg.error.fieldRequired")):fe())}];const Y=Go(De(z.meta).validators??[],z);w=[...w,...Y],w.length&&(D[R.value[z.title]]=w)}return D}),j=de(()=>Object.keys(R.value).length?Object.keys(a.value).reduce((D,z)=>(D[R.value[z]]=a.value[z],D),{}):{}),{validate:V,validateInfos:Q,clearValidate:ie}=Ks(j,S),_=async D=>{if(D.title)try{await V(R.value[D.title])}catch{}},Ve=Ht(()=>{o(i.value)},300,{maxWait:2e3}),q=Ht(async D=>{if(D.id&&s){_(D);try{await n.dbView.formColumnUpdate(D.id,D)}catch(z){Ge.error(await Jt(z))}}},250);function F(D,z=!1){var Y;let w=D;return en(w.uidt)&&w.colOptions&&w.colOptions.type===Ut.BELONGS_TO&&(w=(((Y=e==null?void 0:e.value)==null?void 0:Y.columns)||[]).find(U=>U.id===w.colOptions.fk_child_column_id)),z||w&&w.rqd&&!w.cdf}return{onReset:c.on,formState:a,localColumns:d,visibleColumns:p,activeRow:f,activeField:m,activeColumn:g,isRequired:F,updateView:Ve,updateColMeta:q,validate:V,validateInfos:Q,clearValidate:ie,fieldMappings:R}},"form-view-store");function Cl(){const e=ea();if(e==null)throw new Error("Please call `useProvideFormViewStore` on the appropriate parent component");return e}const ta=ke(()=>Ee(()=>import("./CnHJnvS0.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url).then(e=>e.default||e)),ia=ke(()=>Ee(()=>import("./BV3lS4Sb.js"),__vite__mapDeps([15,1,2]),import.meta.url).then(e=>e.default||e)),na=ke(()=>Ee(()=>import("./BPzsK8fx.js"),__vite__mapDeps([16,1,2,17,13,18]),import.meta.url).then(e=>e.default||e)),oa=ke(()=>Ee(()=>import("./utCgnnET.js"),__vite__mapDeps([19,1,2,20,21,22,17,23,24,13,25]),import.meta.url).then(e=>e.default||e)),sa=ke(()=>Ee(()=>import("./CUmqjySl.js"),__vite__mapDeps([26,1,2,27]),import.meta.url).then(e=>e.default||e)),aa=ke(()=>Ee(()=>import("./hBhzkt6Q.js"),__vite__mapDeps([28,1,2]),import.meta.url).then(e=>e.default||e)),ra=ke(()=>Ee(()=>import("./76B7kuMs.js"),__vite__mapDeps([29,30,1,2,31,32,33,34,5,6,7,8,9,10,11,35,36,37,38,39,40,41,42,43,44,45,24,46,47,48,49,50,51,52,53,17,54,13,55,21,56,57,58,59,60,61,62,63,64,65,66,67,68]),import.meta.url).then(e=>e.default||e)),la=ke(()=>Ee(()=>import("./z-DV38Ib.js"),__vite__mapDeps([69,1,2,66,61,62,8,57,70,71,72,73,53,17,54,13,74,75,76,77,78,79,31,32,80,21,81,82,24,83,84,85,86,87,88,89,90,37,38,39,40,41,55,20,22,23,43,5,6,7,9,10,11,60]),import.meta.url).then(e=>e.default||e)),ca=ke(()=>Ee(()=>import("./BLdk6lRf.js").then(e=>e.i$),__vite__mapDeps([1,2]),import.meta.url).then(e=>e.default||e)),at=e=>(qi("data-v-29887755"),e=e(),Yi(),e),ha={class:"h-full relative"},da={key:0,class:"pl-6 pr-[120px] py-6 bg-white flex-col justify-start items-start gap-2.5 inline-flex"},ua={class:"text-gray-500 text-5xl font-semibold leading-16"},ma=at(()=>v("br",null,null,-1)),fa={class:"text-gray-500 text-base font-medium leading-normal"},pa={class:"max-w-[max(33%,688px)] mx-auto"},ga={class:"transition-all duration-300 ease-in relative my-6 bg-white rounded-3xl border-1 border-gray-200 px-4 py-8 lg:p-12 md:p-8 md:dark:bg-slate-700"},va={key:0,class:"items-center justify-center text-left mt-2"},ba={class:"text-2xl font-bold text-gray-900 mb-4"},wa={key:0},ya={class:"flex justify-center"},_a={class:"w-full"},xa={key:1},za={class:"mt-16 w-full flex justify-between items-center gap-3"},Ca={key:0,class:"text-gray-400"},Ra={key:1,class:"flex-1 flex justify-end"},Aa={key:1,class:"nc-form-wrapper h-full w-full flex relative","data-testid":"nc-form-wrapper"},Sa={key:0,class:"flex-1 flex items-center justify-center text-center h-full"},Ma={class:"mt-2"},ka={class:"min-w-[616px] overflow-x-auto nc-form-scrollbar"},Ea={key:1,class:"group relative max-w-[max(33%,688px)] mx-auto"};const $a={class:"flex flex-col px-4 lg:px-6"};const Ia={key:1,class:"font-bold text-2xl text-gray-900"},Da=["data-title","onClick"],Ta={key:0,class:"absolute -left-3 top-6"},Fa={class:"text-sm font-semibold text-gray-800"},Oa={"data-testid":"nc-form-input-label"},La={key:0,class:"text-red-500 text-base leading-[18px]"},Ba={class:"nc-form-field-body"},Wa={class:"mt-2"},Pa={key:0,class:"mt-4 border-dashed border-2 border-gray-400 py-3 text-gray-400 text-center"},ja={class:"flex justify-between items-center mt-6 !px-8 !lg:px-12"},Va={key:0,class:"px-8 lg:px-12"},Ha={class:"inline-block"},Ua={class:"px-3 pt-4 pb-2 flex items-center justify-between border-b border-gray-200 font-medium"},Na={class:"flex items-center"},qa=at(()=>v("div",{class:"px-1.75 text-gray-500 text-xl font-normal"},"/",-1)),Ya={class:"flex items-center pr-1 py-1.5 text-gray-800"},Xa={class:"text-center"},Ga={"data-testid":"nc-form-input-label"},Za={class:"flex items-center space-x-2"},Qa={class:"nc-edit-or-add-provider-wrapper"},Ka={class:"nc-form-field-text p-4 flex flex-col gap-4 border-b border-gray-200"},Ja={class:"text-base font-bold text-gray-600"},er={class:"flex flex-wrap justify-between items-center gap-2"},tr={class:"flex gap-3"},ir={class:"text-base font-bold text-gray-600"},nr={class:"flex gap-2 items-center"},or={class:"nc-edit-or-add-provider-wrapper"},sr={autocomplete:"off"},ar={class:"nc-form-fields-list border-1 border-gray-200 rounded-lg overflow-y-auto nc-form-scrollbar"},rr={key:0,class:"px-0.5 py-2 text-gray-500 text-center"},lr=at(()=>v("div",{class:"w-4 h-4 flex-none mx-2"},null,-1)),cr={class:"flex-1 flex flex-row items-center truncate cursor-pointer"},hr={class:"flex-1 font-base my-1.5"},dr={class:"flex items-center px-2"},ur=["data-testid"],mr={class:"py-1.5 flex items-center"},fr={class:"flex-1 flex items-center justify-between cursor-pointer max-w-[calc(100%_-_20px)] py-1.5"},pr=["onClick"],gr={class:"flex-1 flex items-center justify-start max-w-[calc(100%_-_28px)]"},vr={class:"w-full flex items-center"},br={class:"text-center"},wr={"data-testid":"nc-field-title"},yr={key:0,class:"truncate inline-flex text-xs font-normal text-gray-700"},_r=at(()=>v("span",null," (",-1)),xr={class:"text-center"},zr={"data-testid":"nc-field-title "},Cr=at(()=>v("span",null,")",-1)),Rr={key:1,class:"text-red-500 text-sm align-top"},Ar={class:"px-0.5 py-2 text-gray-500 text-center"},Sr={class:"p-4 flex flex-col space-y-4 border-b border-gray-200"},Mr={class:"text-base font-bold text-gray-600"},kr={class:"flex flex-col space-y-3"},Er={class:"text-gray-800"},$r={class:"flex justify-start"};const Ir={class:"flex items-center justify-between gap-3"},Dr={class:"p-4 flex flex-col space-y-4"},Tr={class:"text-base font-bold text-gray-600"},Fr={class:"flex flex-col gap-3"},Or={class:"flex items-center justify-between gap-3"},Lr={class:"flex items-center justify-between gap-3"},Br={class:"flex items-center justify-between gap-3"},Wr={class:"text-bold text-gray-600"},Pr={class:"pb-10"},jr={class:"text-gray-800 mb-2"},Vr={key:2,class:"absolute inset-0 bg-black/40 z-500 grid place-items-center"},Hr={class:"text-center bg-white px-6 py-8 rounded-xl max-w-lg"},Ur={class:"text-2xl text-gray-800 font-bold"},Nr={class:"capitalize"},qr={class:"text-sm text-gray-700 pt-6"},Yr=xt({__name:"Form",setup(e){Pt(co,B(!0)),Pt(ho,B(!1));const t=["created_at","updated_at"],i=[H.Rollup,H.Lookup,H.Formula,H.QrCode,H.Barcode,H.SpecificDBType,H.CreatedTime,H.LastModifiedTime,H.CreatedBy,H.LastModifiedBy],o=[nt.code,nt.blockQuote,nt.bulletList,nt.numberedList,nt.taskList],{isMobileMode:s,user:n}=uo(),{$api:r,$e:c}=ii(),{isUIAllowed:a}=mo(),{base:d}=jt(fo()),{getPossibleAttachmentSrc:f}=No(),p=B(0),m=Re(Qi,B(!1)),g=a("viewFieldEdit"),R=Re(Gi,B()),S=Re(Zi,B()),j=Re(po,B(!1)),{loadFormView:V,insertRow:Q,formColumnData:ie,formViewData:_,updateFormView:Ve}=qo(R,S),{formState:q,localColumns:F,visibleColumns:D,activeRow:z,activeField:w,activeColumn:Y,isRequired:U,updateView:P,updateColMeta:fe,validateInfos:Fe,validate:rt,clearValidate:At,fieldMappings:ee}=Js(R,S,_,Ve,g),{preFillFormSearchParams:ri}=jt(go()),Oe=Re(Xi,Ji());Oe.on(async()=>{await V(),di()});const{fields:He,showAll:xn,hideAll:zn}=Qo(),{state:Le,row:Cn}=Ko(B({row:q.value,oldRow:{},rowMeta:{new:!0}})),li=de(()=>{var h;return((h=R==null?void 0:R.value)==null?void 0:h.columns)||[]}),St=B(),Mt=B([]),ae=B({showColumnMenu:!1,showEditColumn:!1,showAddColumn:!1}),lt=B(!1),Be=B(!1),et=B(!1),kt=B(!1),ct=B(!1),te=B({imageConfig:{src:"",type:"",name:""},cropperConfig:{stencilProps:{},minHeight:0,minWidth:0,imageRestriction:"none"},uploadConfig:{path:""},cropFor:"banner"}),ht=B(),$e=B(""),Et=B(!1),{t:$t}=ti(),{open:Rn,onChange:An}=vo({accept:"image/*",multiple:!1,reset:!0}),Gr=de(()=>{var h;return f(De((h=_.value)==null?void 0:h.logo_url))}),Sn=Ht(()=>{if(m.value||!a("dataInsert"))return;const h={...q.value,...Le.value},u=new URLSearchParams;for(const M of D.value)M.title&&h[M.title]&&!Ne(M)&&H.Attachment!==M.uidt&&u.append(M.title,h[M.title]);ri.value=u.toString()},250);async function Mn(){var h;if(!(m.value||!a("dataInsert"))){for(const u of D.value)U(u,u.required)&&q.value[u.title]===void 0&&(q.value[u.title]=null);try{await rt(Object.keys(q.value).map(u=>ee.value[u]))}catch(u){if((h=u==null?void 0:u.errorFields)!=null&&h.length){Ge.error($t("msg.error.someOfTheRequiredFieldsAreEmpty"));return}}await Q({row:{...q.value,...Le.value},oldRow:{},rowMeta:{new:!0}}),et.value=!0}}async function It(){m.value||!a("dataInsert")||(q.value={},Le.value={},At(),Oe.trigger())}function kn(h){if(t.includes(h.fk_column_id))return!1;let u=!Ne(h)&&h.rqd&&!Vo(h==null?void 0:h.cdf)&&!li.value.some(M=>{var I;return en(M.uidt)&&((I=M==null?void 0:M.colOptions)==null?void 0:I.type)===Ut.BELONGS_TO&&h.fk_column_id===M.colOptions.fk_child_column_id})||h.pk&&!h.ai&&!h.cdf;if(h.uidt===H.LinkToAnotherRecord&&h.colOptions.type===Ut.BELONGS_TO){const M=li.value.find(I=>I.id===h.colOptions.fk_child_column_id);M.rqd&&!M.default&&(u=!0)}return u}function En(h){if(h.from!==h.to&&dt(h.draggedContext.element))return!1}async function ci(h,u=!1){var ne,pe,oe,xe;if(m.value||!g)return;let{newIndex:M,element:I}=h.moved;const he=(ne=He.value)==null?void 0:ne.findIndex(X=>(X==null?void 0:X.fk_column_id)===I.fk_column_id);he===-1||he===void 0||!((pe=He.value)!=null&&pe[he])||(u&&(I=F.value[(oe=F.value)==null?void 0:oe.findIndex(X=>X.fk_column_id===I.fk_column_id)],M=F.value.findIndex(X=>X.fk_column_id===D.value[M].fk_column_id)),!F.value.length||F.value.length===1?I.order=1:F.value.length-1===M?I.order=Math.max(...F.value.map(X=>(X==null?void 0:X.order)??0))+1:M===0?I.order=Math.min(...F.value.map(X=>(X==null?void 0:X.order)??0))/2:I.order=((((xe=F.value[M-1])==null?void 0:xe.order)??0)+(F.value[M+1].order??0))/2,await r.dbView.formColumnUpdate(I.id,I),He.value[he]=I,F.value=[...F.value].sort((X,tt)=>X.order!==void 0&&tt.order!==void 0?X.order-tt.order:0),c("a:form-view:reorder"))}async function hi(h,u,M=!1){var he,ne;if(m.value||!g)return;if(dt(h)){!M&&Ge.info($t("msg.info.requriedFieldsCantBeMoved"));return}const I=(he=He.value)==null?void 0:he.findIndex(pe=>(pe==null?void 0:pe.fk_column_id)===h.fk_column_id);I!==-1&&I!==void 0&&((ne=He.value)!=null&&ne[I])&&(h.show=u,await r.dbView.formColumnUpdate(h.id,h),He.value[I]=h,Oe.trigger(),c(u?"a:form-view:show-columns":"a:form-view:hide-columns")),!u&&!M&&z.value&&(z.value="")}function dt(h){return kn(h)||!!h.required||!!h.rqd&&!h.cdf||h.uidt===H.QrCode||h.uidt===H.Barcode}async function $n(h){if(!(m.value||!g))if(h){for(const u of F==null?void 0:F.value)u.show=!0;await xn(Mt.value),c("a:form-view:add-all")}else{for(const u of F==null?void 0:F.value)dt(u)||(u.show=!1);await zn(F==null?void 0:F.value.filter(u=>dt(u)).map(u=>u.fk_column_id)),c("a:form-view:remove-all")}}async function In(){return Be.value&&!$i&&!await r.plugin.status("SMTP")?(Be.value=!1,Ge.info($t("msg.toast.formEmailSMTP")),!1):!0}function di(){var M,I,he,ne,pe;const h=(ie==null?void 0:ie.value)||[];Mt.value=bo(h).map(oe=>oe.fk_column_id),_.value={banner_image_url:null,logo_url:null,..._.value,submit_another_form:!!(((M=_.value)==null?void 0:M.submit_another_form)??0),show_blank_form:!!(((I=_.value)==null?void 0:I.show_blank_form)??0),meta:{hide_branding:!1,background_color:"#F9F9FA",hide_banner:!1,...De((he=_.value)==null?void 0:he.meta)??{}}};let u={};try{u=JSON.parse(((ne=_.value)==null?void 0:ne.email)||"")||{}}catch{}Be.value=u[(pe=n.value)==null?void 0:pe.email],F.value=h.filter(oe=>!i.includes(oe.uidt)&&!Mt.value.includes(oe.fk_column_id)).sort((oe,xe)=>oe.order-xe.order).map(oe=>({...oe,required:!!oe.required}))}async function Dn(){var h,u,M;try{if(!await In())return;const I=(h=_.value)!=null&&h.email?JSON.parse((u=_.value)==null?void 0:u.email):{};I[(M=n.value)==null?void 0:M.email]=Be.value,_.value.email=JSON.stringify(I)}catch{}}function Tn(){Dn(),P()}function ui(){w.value&&(delete q.value[w.value.title],Ne(w.value)&&delete Le.value[w.value.title])}async function Fn(){ae.value.showAddColumn=!1,Oe.trigger()}async function On(){var h;ae.value.showEditColumn=!1,w.value&&w.value.uidt!==((h=Y.value)==null?void 0:h.uidt)&&ui(),Oe.trigger()}async function Ln(){ui(),Oe.trigger()}const ut=(h,u=!1)=>{m.value||!g||(u&&(Et.value=!0),z.value=h.id)},Bn=h=>{var M;if(m.value||!g)return;So(h).isValid()&&(((M=_.value)==null?void 0:M.meta).background_color=h,P())},Zr=h=>{var u,M;!g||!$i||(te.value.uploadConfig={path:[Mo,d.value.id,(u=R.value)==null?void 0:u.id,(M=_.value)==null?void 0:M.id].join("/")},h?(te.value.cropperConfig={...te.value.cropperConfig,stencilProps:{aspectRatio:4/1},minHeight:100,minWidth:0},te.value.cropFor="banner"):(te.value.cropperConfig={...te.value.cropperConfig,stencilProps:{aspectRatio:void 0},minHeight:150,minWidth:150},te.value.cropFor="logo"),Rn())};An(h=>{if(h&&h[0]){te.value.imageConfig.src&&URL.revokeObjectURL(te.value.imageConfig.src);const u=URL.createObjectURL(h[0]);te.value.imageConfig={src:u,type:h[0].type,name:h[0].name},ct.value=!0}});const Wn=(h=null)=>{te.value.cropFor==="banner"?_.value.banner_image_url=h:_.value.logo_url=h,P()},Pn=h=>{h.target.select()},jn=h=>{w.value&&(w.value.title===h?w.value.label=null:w.value.label=h)};wo(async()=>{te.value.src&&URL.revokeObjectURL(te.value.imageConfig.src),ri.value="",kt.value=!0,await V(),di(),kt.value=!1}),Ye(et,h=>{var u;if(h&&((u=_.value)!=null&&u.show_blank_form)){p.value=5;const M=yo(()=>{--p.value<0&&(et.value=!1,It(),clearInterval(M))},1e3)}}),Ye(S,h=>{(h==null?void 0:h.type)===_o.FORM&&Oe.trigger()}),Ye([q,Le],async()=>{for(const h in Le.value)q.value[h]=Le.value[h];Sn();try{await rt(Object.keys(q.value).map(h=>ee.value[h]))}catch{}},{deep:!0});const mi=(h,u)=>{const M=document.querySelector(`${u?".nc-form-field-item-":".nc-form-drag-"}${CSS.escape(h==null?void 0:h.replaceAll(" ",""))}`);M&&setTimeout(()=>{M==null||M.scrollIntoView({behavior:"smooth",block:"center"})},50)};return Ye(w,(h,u)=>{h&&Et.value?wt(()=>{mi(h.title,!1)}):u&&wt(()=>{mi(u.title,!0)}),Et.value=!1,ae.value={...ae.value,showColumnMenu:!1,showEditColumn:!1}}),Ye([ht,w],()=>{w&&ht.value&&wt(()=>{var h;(h=ht.value)==null||h.focus()})}),Ei(document,"keydown",h=>{var M,I;const u=xo()?h.metaKey:h.ctrlKey;switch((M=h.key)==null?void 0:M.toLowerCase()){case"s":u&&!(["input","textarea"].includes(h.target.nodeName.toLowerCase())||(I=h.target)!=null&&I.getAttribute("contenteditable"))&&(h.preventDefault(),P());break}},!0),Ei(document,"mousedown",h=>{var u,M,I;(u=St.value)!=null&&u.targetDomElement&&((M=St.value)!=null&&M.targetDomElement.contains(h.target))||(I=h.target)!=null&&I.closest('.nc-form-right-panel, [class*="dropdown"], .nc-form-rich-text-field, .ant-modal, .ant-modal-wrap, .nc-share-base-button, .nc-form-right-sidebar-content-resizable-wrapper .splitpanes__splitter')||(z.value="")},!0),(h,u)=>{var wi,yi,_i,xi,zi,Ci,Ri,Ai,Si,Mi;const M=Io,I=ta,he=es,ne=Kt,pe=ko,oe=qs,xe=Eo,X=ia,tt=ts,Dt=is,Vn=na,Hn=oa,Un=sa,Nn=aa,qn=on,Yn=tn,Xn=Do,Gn=$o,fi=To,pi=Fo,gi=ra,vi=Ki,Zn=Zs,Qn=la,Kn=Ho,bi=Ni,Jn=Jo,Ue=ns,eo=ca,to=Qs,mt=zo("e");return b(),W("div",ha,[l(s)?(b(),W("div",da,[v("div",ua,[se(E(h.$t("general.available")),1),ma,se(E(h.$t("title.inDesktop")),1)]),v("div",fa,E(h.$t("msg.formViewNotSupportedOnMobile")),1)])):(b(),W(We,{key:1},[l(et)?(b(),W("div",{key:0,class:"h-full p-6 overflow-auto nc-form-scrollbar",style:Vt({background:((yi=("parseProp"in h?h.parseProp:l(De))((wi=l(_))==null?void 0:wi.meta))==null?void 0:yi.background_color)||"#F9F9FA"}),"data-testid":"nc-form-wrapper-submit"},[v("div",pa,[("parseProp"in h?h.parseProp:l(De))((_i=l(_))==null?void 0:_i.meta).hide_banner?T("",!0):(b(),C(M,{key:0,"banner-image-url":(xi=l(_))==null?void 0:xi.banner_image_url},null,8,["banner-image-url"])),v("div",ga,[l(_)?(b(),W("div",va,[v("div",null,[v("h1",ba,E(l(_).heading),1),(zi=l(_).subheading)!=null&&zi.trim()?(b(),W("div",wa,[y(I,{value:l(_).subheading,class:"font-medium text-base text-gray-500 !h-auto mb-4 -ml-1","is-form-field":"","read-only":"","sync-value-change":""},null,8,["value"])])):T("",!0)]),v("div",ya,[v("div",_a,[y(he,{class:"nc-form-success-msg !my-4 !py-4 text-left !rounded-lg",type:"success",outlined:""},{message:x(()=>{var Ie,N,$;return[(N=(Ie=l(_))==null?void 0:Ie.success_msg)!=null&&N.trim()?(b(),C(I,{key:0,value:($=l(_))==null?void 0:$.success_msg,class:"!h-auto -ml-1","is-form-field":"","read-only":"","sync-value-change":""},null,8,["value"])):(b(),W("span",xa,E(h.$t("msg.successfullySubmittedFormData")),1))]}),_:1}),v("div",za,[l(_).show_blank_form?(b(),W("div",Ca,E(h.$t("msg.newFormWillBeLoaded",{seconds:l(p)})),1)):T("",!0),l(_).submit_another_form||!l(j)?(b(),W("div",Ra,[y(ne,{type:"primary",size:"small",onClick:u[0]||(u[0]=()=>{et.value=!1,It()})},{default:x(()=>[se(E(h.$t("activity.submitAnotherForm")),1)]),_:1})])):T("",!0)])])])])):T("",!0)])])],4)):(b(),W("div",Aa,[l(kt)?(b(),W("div",Sa,[v("div",null,[y(pe,{size:"xlarge"}),v("div",Ma,E(h.$t("general.loading")),1)])])):l(_)?(b(),C(to,{key:1},{preview:x(()=>{var Ie,N,$;return[v("div",{class:"w-full h-full overflow-auto nc-form-scrollbar p-6",style:Vt({background:((Ie=l(_))==null?void 0:Ie.meta).background_color||"#F9F9FA"})},[v("div",ka,[l(g)?(b(),C(oe,{key:0,"show-cropper":l(ct),"onUpdate:showCropper":u[1]||(u[1]=ge=>Pe(ct)?ct.value=ge:null),"image-config":l(te).imageConfig,"cropper-config":l(te).cropperConfig,"upload-config":l(te).uploadConfig,onSubmit:Wn},null,8,["show-cropper","image-config","cropper-config","upload-config"])):T("",!0),("parseProp"in h?h.parseProp:l(De))((N=l(_))==null?void 0:N.meta).hide_banner?T("",!0):(b(),W("div",Ea,[(b(),C(M,{key:($=l(_).banner_image_url)==null?void 0:$.path,"banner-image-url":l(_).banner_image_url},null,8,["banner-image-url"])),T("",!0)])),y(Gn,{class:"!py-8 !lg:py-12 !border-gray-200 !rounded-3xl !mt-6 !max-w-[max(33%,688px)] !mx-auto","body-style":{margin:"0 auto",padding:"0px !important"}},{default:x(()=>{var ge;return[y(qn,{model:l(q),class:"nc-form","no-style":""},{default:x(()=>[v("div",$a,[T("",!0),v("div",{class:ze(["border-transparent px-4 lg:px-6",[{"rounded-2xl overflow-hidden border-2 cursor-pointer mb-1 py-4 lg:py-6 focus-within:bg-gray-50":l(g)},{"mb-4 py-0 lg:py-0":!l(g)},{"hover:bg-gray-50":l(z)!=="nc-form-heading"&&l(g)},{"bg-gray-50":l(z)==="nc-form-heading"&&l(g)},{"!hover:bg-white !ring-0 !cursor-auto":l(m)}]]),onClick:u[9]||(u[9]=re(k=>ut({id:"nc-form-heading"}),["stop"]))},[l(g)?(b(),C(Dt,{key:0,class:"!my-0"},{default:x(()=>[y(tt,{value:l(_).heading,"onUpdate:value":u[6]||(u[6]=k=>l(_).heading=k),class:"nc-form-focus-element !p-0 !m-0 w-full !font-bold !text-2xl !border-0 !rounded-none !text-gray-900",style:{borderRightWidth:"0px !important",height:"70px","max-height":"250px",resize:"vertical"},"auto-size":"",size:"large","hide-details":"",disabled:l(m),placeholder:"Form Title",bordered:!1,"data-testid":"nc-form-heading","data-title":"nc-form-heading",onInput:l(P),onFocus:u[7]||(u[7]=k=>z.value="nc-form-heading"),onBlur:u[8]||(u[8]=k=>z.value="")},null,8,["value","disabled","data-testid","data-title","onInput"])]),_:1})):(b(),W("div",Ia,E(l(_).heading),1))],2),v("div",{class:ze(["border-transparent px-4 lg:px-6",[{"rounded-2xl border-2 cursor-pointer mb-1 py-4 lg:py-6 focus-within:bg-gray-50":l(g)},{"mb-4 py-0 lg:py-0":!l(g)},{"hover:bg-gray-50":l(z)!=="nc-form-sub-heading"&&l(g)},{"bg-gray-50":l(z)==="nc-form-sub-heading"&&l(g)},{"!hover:bg-white !ring-0 !cursor-auto":l(m)}]]),onClick:u[13]||(u[13]=re(k=>ut({id:"nc-form-sub-heading"}),["stop"]))},[l(g)&&!l(m)?(b(),C(I,{key:0,value:l(_).subheading,"onUpdate:value":[u[10]||(u[10]=k=>l(_).subheading=k),l(P)],placeholder:h.$t("msg.info.formDesc"),class:"nc-form-description nc-form-focus-element font-medium text-base !text-gray-500 -ml-1","is-form-field":"",autofocus:l(z)==="nc-form-sub-heading","data-testid":"nc-form-sub-heading","data-title":"nc-form-sub-heading",onFocus:u[11]||(u[11]=k=>z.value="nc-form-sub-heading"),onBlur:u[12]||(u[12]=k=>z.value="")},null,8,["value","placeholder","autofocus","data-testid","data-title","onUpdate:value"])):l(_).subheading?(b(),C(I,{key:1,value:l(_).subheading,class:"font-medium text-base !text-gray-500 -ml-1","is-form-field":"","read-only":"","sync-value-change":""},null,8,["value"])):T("",!0)],2)]),y(l(Ii),{ref_key:"draggableRef",ref:St,"model-value":l(D),"item-key":"fk_column_id",draggable:".item",handle:".nc-form-field-drag-handler",group:"form-inputs","ghost-class":"nc-form-field-ghost",class:"h-full px-4 lg:px-6",move:En,disabled:l(m)||!l(g),onChange:u[15]||(u[15]=k=>ci(k,!0))},{item:x(({element:k})=>[(b(),W("div",{key:k.id,class:ze(["nc-editable nc-form-focus-element item relative bg-white p-4 lg:p-6",[`nc-form-drag-${k.title.replaceAll(" ","")}`,{"rounded-2xl border-2 my-1":l(g)},{"border-transparent my-0":!l(g)},{"nc-form-field-drag-handler border-transparent hover:bg-gray-50 cursor-pointer":l(z)!==k.id&&l(g)},{"border-brand-500":l(z)===k.id},{"!hover:bg-white !ring-0 !cursor-auto":l(m)}]]),"data-title":k.title,"data-testid":"nc-form-fields",onClick:re(it=>ut(k),["stop"])},[l(z)===k.id?(b(),W("div",Ta,[y(ne,{type:"primary",size:"small",class:"nc-form-field-drag-handler !cursor-move !p-1 !min-w-6 !h-auto !rounded"},{default:x(()=>[(b(),C(ye(("iconMap"in h?h.iconMap:l(Ze)).drag),{class:"nc-form-field-drag-handler flex-none !h-4 !w-4 text-white font-bold"}))]),_:1})])):T("",!0),v("div",Fa,[v("span",Oa,E(k.label||k.title),1),l(U)(k,k.required)?(b(),W("span",La," *")):T("",!0)]),k.description?(b(),C(I,{key:1,value:k.description,"is-form-field":"","read-only":"","sync-value-change":"",class:"nc-form-help-text text-gray-500 text-sm mt-2 -ml-1","data-testid":"nc-form-help-text","onUpdate:value":it=>l(fe)(k)},null,8,["value","onUpdate:value"])):T("",!0),v("div",Ba,[v("div",Wa,[l(ee)[k.title]?(b(),C(Dt,Qt({key:0,name:l(ee)[k.title],class:"!my-0 nc-input-required-error nc-form-input-item"},l(Fe)[l(ee)[k.title]]),{default:x(()=>[y(Un,{class:"relative",onClick:u[14]||(u[14]=re(()=>{},["stop"]))},{default:x(()=>[l(Ne)(k)?(b(),C(Vn,{key:0,modelValue:l(q)[k.title],"onUpdate:modelValue":it=>l(q)[k.title]=it,row:l(Cn),class:ze(["nc-input",`nc-form-input-${k.title.replaceAll(" ","")}`]),"data-testid":`nc-form-input-${k.title.replaceAll(" ","")}`,column:k},null,8,["modelValue","onUpdate:modelValue","row","class","data-testid","column"])):(b(),C(Hn,{key:1,modelValue:l(q)[k.title],"onUpdate:modelValue":it=>l(q)[k.title]=it,class:ze(["nc-input truncate",[`nc-form-input-${k.title.replaceAll(" ","")}`,{"layout-list":k.meta.isList}]]),"data-testid":`nc-form-input-${k.title.replaceAll(" ","")}`,column:k,"edit-enabled":!0},null,8,["modelValue","onUpdate:modelValue","class","data-testid","column"]))]),_:2},1024)]),_:2},1040,["name"])):T("",!0),y(Nn,{column:k},null,8,["column"])])])],10,Da))]),footer:x(()=>[!l(D).length&&l(g)?(b(),W("div",Pa,E(h.$t("title.selectFieldsFromRightPannelToAddHere")),1)):T("",!0)]),_:1},8,["model-value","disabled"]),v("div",ja,[y(ne,{type:"secondary",size:"small",disabled:!l(a)("dataInsert")||!l(D).length,class:"nc-form-clear nc-form-focus-element","data-testid":"nc-form-clear","data-title":"nc-form-clear",onClick:It},{default:x(()=>[se(E(h.$t("activity.clearForm")),1)]),_:1},8,["disabled"]),y(ne,{"html-type":"submit",type:"primary",size:"small",disabled:!l(a)("dataInsert")||!l(D).length,class:"nc-form-submit nc-form-focus-element","data-testid":"nc-form-submit","data-title":"nc-form-submit",onClick:Mn},{default:x(()=>[se(E(h.$t("general.submit")),1)]),_:1},8,["disabled"])])]),_:1},8,["model"]),("parseProp"in h?h.parseProp:l(De))((ge=l(_))==null?void 0:ge.meta).hide_branding?T("",!0):(b(),W("div",Va,[l(m)?T("",!0):(b(),C(Yn,{key:0,class:"!my-8"})),v("div",Ha,[y(Xn)])]))]}),_:1})])],4)]}),sidebar:x(()=>{var Ie;return[v("div",{class:ze(["nc-form-right-panel h-full flex-grow max-w-full",{"overflow-y-auto nc-form-scrollbar":l(w)}])},[l(w)&&l(Y)?(b(),W("div",{key:(Ie=l(w))==null?void 0:Ie.id,class:"nc-form-field-right-panel"},[v("div",Ua,[v("div",Na,[v("div",{class:"text-gray-600 font-medium cursor-pointer select-none hover:underline",onClick:u[16]||(u[16]=N=>z.value="")},E(h.$t("objects.viewType.form")),1),qa,v("div",Ya,[l(Ne)(l(w))?(b(),C(fi,{key:0,"column-meta":l(w),class:"flex-none"},null,8,["column-meta"])):(b(),C(pi,{key:1,"column-meta":l(w),class:"flex-none"},null,8,["column-meta"])),y(xe,{class:"truncate max-w-[120px] text-sm font-semibold","show-on-truncate-only":""},{title:x(()=>[v("div",Xa,E(l(w).title),1)]),default:x(()=>[v("span",Ga,E(l(w).title),1)]),_:1})])]),v("div",Za,[y(vi,{visible:l(ae).showEditColumn,"onUpdate:visible":u[20]||(u[20]=N=>l(ae).showEditColumn=N),trigger:["click"],"overlay-class-name":"nc-dropdown-form-edit-column",disabled:!l(a)("fieldEdit")},{overlay:x(()=>[v("div",Qa,[l(ae).showEditColumn?(b(),C(gi,{key:0,column:l(Y),onSubmit:On,onCancel:u[17]||(u[17]=N=>l(ae).showEditColumn=!1),onClick:u[18]||(u[18]=re(()=>{},["stop"])),onKeydown:u[19]||(u[19]=re(()=>{},["stop"]))},null,8,["column"])):T("",!0)])]),default:x(()=>[y(ne,{type:"secondary",size:"small",class:"nc-form-add-field","data-testid":"nc-form-add-field"},{default:x(()=>[se(E(h.$t("general.edit"))+" "+E(h.$t("objects.field")),1)]),_:1})]),_:1},8,["visible","disabled"]),y(Zn,{"is-open":l(ae).showColumnMenu,"onUpdate:isOpen":u[21]||(u[21]=N=>l(ae).showColumnMenu=N),column:l(Y),"form-column":l(w),"is-required":l(U)(l(w),l(w).required),"on-delete":()=>{Ln()},onHideField:u[22]||(u[22]=N=>hi(l(w),!1,!1))},null,8,["is-open","column","form-column","is-required","on-delete"])])]),v("div",Ka,[v("div",Ja,E(h.$t("objects.field"))+" "+E(h.$t("general.text").toLowerCase()),1),y(tt,{ref_key:"focusLabel",ref:ht,value:l(w).label||l(w).title,rows:1,"auto-size":"","hide-details":"",class:"form-meta-input nc-form-input-label !max-h-7.5rem nc-form-scrollbar","data-testid":"nc-form-input-label",placeholder:h.$t("msg.info.formInput"),onFocus:Pn,onKeydown:u[23]||(u[23]=Co(re(()=>{},["prevent"]),["enter"])),onInput:u[24]||(u[24]=N=>jn(N.target.value)),onChange:u[25]||(u[25]=N=>l(fe)(l(w)))},null,8,["value","placeholder"]),y(I,{value:l(w).description,"onUpdate:value":[u[26]||(u[26]=N=>l(w).description=N),u[27]||(u[27]=N=>l(fe)(l(w)))],placeholder:h.$t("msg.info.formHelpText"),class:"form-meta-input nc-form-input-help-text","is-form-field":"","hidden-bubble-menu-options":o,"data-testid":"nc-form-input-help-text"},null,8,["value","placeholder"])]),l(w)?(b(),C(Qn,{key:0})):T("",!0)])):(b(),W(We,{key:1},[l(_)?(b(),C(l(nn),{key:0,horizontal:"",class:"nc-form-settings w-full nc-form-right-splitpane"},{default:x(()=>[y(l(_t),{"min-size":"30",size:"50",class:"nc-form-right-splitpane-item p-4 flex flex-col space-y-4 !min-h-200px"},{default:x(()=>{var N;return[v("div",er,[v("div",tr,[v("div",ir,E(h.$t("objects.viewType.form"))+" "+E(h.$t("objects.fields")),1),y(Kn,{color:"border-gray-200"},{default:x(()=>[se(E(l(D).length)+"/"+E(l(F).length)+" "+E(h.$t("objects.field")),1)]),_:1})]),l(a)("fieldAdd")?(b(),C(vi,{key:0,visible:l(ae).showAddColumn,"onUpdate:visible":u[31]||(u[31]=$=>l(ae).showAddColumn=$),trigger:["click"],"overlay-class-name":"nc-dropdown-form-add-column"},{overlay:x(()=>[v("div",or,[l(ae).showAddColumn?(b(),C(gi,{key:0,onSubmit:Fn,onCancel:u[28]||(u[28]=$=>l(ae).showAddColumn=!1),onClick:u[29]||(u[29]=re(()=>{},["stop"])),onKeydown:u[30]||(u[30]=re(()=>{},["stop"]))})):T("",!0)])]),default:x(()=>[y(ne,{type:"secondary",size:"small",class:"nc-form-add-field","data-testid":"nc-form-add-field"},{default:x(()=>[v("div",nr,[(b(),C(ye(("iconMap"in h?h.iconMap:l(Ze)).plus),{class:"w-4 h-4"})),v("span",null,E(h.$t("activity.addFieldFromFormView")),1)])]),_:1})]),_:1},8,["visible"])):T("",!0)]),v("form",sr,[y(Jn,{key:"nc-form-field-search-input",value:l($e),"onUpdate:value":u[33]||(u[33]=$=>Pe($e)?$e.value=$:null),type:"text",autocomplete:"off",class:"!h-9 !px-3 !py-1 !rounded-lg",placeholder:`${h.$t("placeholder.searchFields")}...`,name:"nc-form-field-search-input","data-testid":"nc-form-field-search-input"},{prefix:x(()=>[y(bi,{icon:"search",class:"mr-2 h-4 w-4 text-gray-500 group-hover:text-black"})]),suffix:x(()=>[l($e).length>0?(b(),C(bi,{key:0,icon:"close",class:"ml-2 h-4 w-4 text-gray-500 group-hover:text-black","data-testid":"nc-form-field-clear-search",onClick:u[32]||(u[32]=$=>$e.value="")})):T("",!0)]),_:1},8,["value","placeholder"])]),v("div",ar,[l(F).length?T("",!0):(b(),W("div",rr,E(h.$t("title.noFieldsFound")),1)),l(F).length?(b(),W(We,{key:1},[v("div",{key:"nc-form-show-all-fields",class:"w-full flex items-center border-b-1 rounded-t-lg border-gray-200 bg-gray-50 sticky top-0 z-100","data-testid":"nc-form-show-all-fields",onClick:u[34]||(u[34]=re(()=>{},["stop"]))},[lr,v("div",cr,[v("div",hr,E(h.$t("activity.selectAllFields")),1),v("div",dr,[y(Ue,{checked:l(D).length===l(F).length,size:"small",class:"nc-switch",onChange:$n},null,8,["checked"])])])]),y(l(Ii),{list:l(F),"item-key":"id","ghost-class":"nc-form-field-ghost",style:{height:"calc(100% - 64px)"},disabled:l(m)||!l(g),onChange:u[35]||(u[35]=$=>ci($)),onStart:u[36]||(u[36]=$=>lt.value=!0),onEnd:u[37]||(u[37]=$=>lt.value=!1)},Ro({item:x(({element:$})=>{var ge,ce;return[$.title.toLowerCase().includes(l($e).toLowerCase())?(b(),W("div",{key:$.id,class:ze(["w-full px-2 flex flex-row items-center border-b-1 last:border-none border-gray-200",[`nc-form-field-item-${$.title.replaceAll(" ","")}`,`${l(z)===$.id?"bg-brand-50 font-medium":"hover:bg-gray-50"}`]]),"data-testid":`nc-form-field-item-${$.title}`},[v("div",mr,[(b(),C(ye(("iconMap"in h?h.iconMap:l(Ze)).drag),{class:"flex-none cursor-move !h-4 !w-4 text-gray-600 mr-1"}))]),v("div",fr,[v("div",{class:"flex-1 flex items-center cursor-pointer max-w-[calc(100%_-_40px)]",onClick:re(k=>ut($,!0),["prevent"])},[$&&l(Ne)($)?(b(),C(fi,{key:0,"column-meta":$},null,8,["column-meta"])):(b(),C(pi,{key:1,"column-meta":$},null,8,["column-meta"])),v("div",gr,[v("div",vr,[v("div",{class:ze(["ml-1 inline-flex",(ge=$.label)!=null&&ge.trim()?"max-w-1/2":"max-w-[95%]"])},[y(xe,{class:"truncate text-sm",disabled:l(lt),"show-on-truncate-only":""},{title:x(()=>[v("div",br,E($.title),1)]),default:x(()=>[v("span",wr,E($.title),1)]),_:2},1032,["disabled"])],2),(ce=$.label)!=null&&ce.trim()?(b(),W("div",yr,[_r,y(xe,{class:"truncate",disabled:l(lt),"show-on-truncate-only":""},{title:x(()=>[v("div",xr,E($.label),1)]),default:x(()=>{var k;return[v("span",zr,E((k=$.label)==null?void 0:k.trim()),1)]}),_:2},1032,["disabled"]),Cr])):T("",!0),l(U)($,$.required)?(b(),W("span",Rr," *")):T("",!0)])])],8,pr),y(xe,{disabled:!$.required||l(m)||!l(g),class:"flex",placement:"topRight"},{title:x(()=>[se(" You can't hide a required field.")]),default:x(()=>[y(Ue,{checked:!!$.show,disabled:$.required||l(m)||!l(g),class:"flex-none nc-switch",size:"small",onChange:k=>{hi($,k,!0)}},null,8,["checked","disabled","onChange"])]),_:2},1032,["disabled"])])],10,ur)):T("",!0)]}),_:2},[(N=l(F))!=null&&N.filter($=>$.title.toLowerCase().includes(l($e).toLowerCase())).length?void 0:{name:"footer",fn:x(()=>[v("div",Ar,E(h.$t("title.noFieldsFound"))+" with title `"+E(l($e))+"` ",1)]),key:"0"}]),1032,["list","disabled"])],64)):T("",!0)])]}),_:1}),y(l(_t),{"min-size":"20",size:"50",class:"nc-form-right-splitpane-item !overflow-y-auto nc-form-scrollbar"},{default:x(()=>{var $,ge;return[v("div",Sr,[v("div",Mr,E(h.$t("labels.appearanceSettings")),1),v("div",kr,[v("div",{class:ze(l(m)||!l(g)?"pointer-events-none":"")},[v("div",Er,E(h.$t("labels.backgroundColor")),1),v("div",$r,[y(eo,{"model-value":l(_).meta.background_color,colors:["#FFFFFF","#FFDBD9","#FEE6D6","#FFF0D1","#D4F7E0","#D7F2FF","#FED8F4","#E5D4F5","#FFCFE6"],"color-box-border":"","is-new-design":"",class:"nc-form-theme-color-picker !pb-0 !pl-0 -ml-1",onInput:Bn},null,8,["model-value"])])],2),T("",!0),v("div",Ir,[v("span",null,E(h.$t("general.hide"))+" "+E(h.$t("general.banner")),1),Xe(y(Ue,{checked:($=("parseProp"in h?h.parseProp:l(De))(l(_).meta))==null?void 0:$.hide_banner,size:"small",class:"nc-form-hide-banner","data-testid":"nc-form-hide-banner",disabled:l(m)||!l(g),onChange:u[39]||(u[39]=ce=>{l(m)||!l(g)||(l(_).meta.hide_banner=ce,l(P)())})},null,8,["checked","disabled"]),[[mt,["a:form-view:hide-banner"]]])])])]),v("div",Dr,[v("div",Tr,E(h.$t("msg.info.postFormSubmissionSettings")),1),v("div",Fr,[v("div",Or,[v("span",null,E(h.$t("msg.info.submitAnotherForm")),1),Xe(y(Ue,{checked:l(_).submit_another_form,"onUpdate:checked":u[40]||(u[40]=ce=>l(_).submit_another_form=ce),size:"small",class:"nc-form-checkbox-submit-another-form","data-testid":"nc-form-checkbox-submit-another-form",disabled:l(m)||!l(g),onChange:l(P)},null,8,["checked","disabled","onChange"]),[[mt,["a:form-view:submit-another-form"]]])]),v("div",Lr,[v("span",null,E(h.$t("msg.info.showBlankForm")),1),Xe(y(Ue,{checked:l(_).show_blank_form,"onUpdate:checked":u[41]||(u[41]=ce=>l(_).show_blank_form=ce),size:"small",class:"nc-form-checkbox-show-blank-form","data-testid":"nc-form-checkbox-show-blank-form",disabled:l(m)||!l(g),onChange:l(P)},null,8,["checked","disabled","onChange"]),[[mt,["a:form-view:show-blank-form"]]])]),v("div",Br,[v("span",null,[se(E(h.$t("msg.info.emailForm"))+" ",1),v("span",Wr,E((ge=l(n))==null?void 0:ge.email),1)]),Xe(y(Ue,{checked:l(Be),"onUpdate:checked":u[42]||(u[42]=ce=>Pe(Be)?Be.value=ce:null),size:"small",class:"nc-form-checkbox-send-email","data-testid":"nc-form-checkbox-send-email",disabled:l(m)||!l(g),onChange:Tn},null,8,["checked","disabled"]),[[mt,["a:form-view:email-me"]]])])]),v("div",Pr,[v("div",jr,E(h.$t("msg.info.formDisplayMessage")),1),y(Dt,{class:"!my-0"},{default:x(()=>[!l(m)&&l(g)?(b(),C(I,{key:0,value:l(_).success_msg,"onUpdate:value":[u[43]||(u[43]=ce=>l(_).success_msg=ce),l(P)],class:"nc-form-after-submit-msg editable","is-form-field":"","hidden-bubble-menu-options":o,"data-testid":"nc-form-after-submit-msg"},null,8,["value","onUpdate:value"])):(b(),C(I,{key:1,value:l(_).success_msg,class:"nc-form-after-submit-msg","is-form-field":"","read-only":"","data-testid":"nc-form-after-submit-msg"},null,8,["value"]))]),_:1})])])]}),_:1})]),_:1})):T("",!0)],64))],2)]}),_:1})):T("",!0)]))],64)),(Ri=(Ci=l(n))==null?void 0:Ci.base_roles)!=null&&Ri.viewer||(Si=(Ai=l(n))==null?void 0:Ai.base_roles)!=null&&Si.commenter?(b(),W("div",Vr,[v("div",Hr,[v("div",Ur,[se(E(h.$t("msg.info.yourCurrentRoleIs"))+" '",1),v("span",Nr,E(((Mi=Object.keys(l(n).base_roles))==null?void 0:Mi[0])??l(Ao).NO_ACCESS),1),se("'. ")]),v("div",qr,E(h.$t("msg.info.pleaseRequestAccessForView",{viewName:"form view"})),1)])])):T("",!0)])}}}),Xr=ei(Yr,[["__scopeId","data-v-29887755"]]),Rl=Object.freeze(Object.defineProperty({__proto__:null,default:Xr},Symbol.toStringTag,{value:"Module"}));export{Rl as F,Cl as u};
