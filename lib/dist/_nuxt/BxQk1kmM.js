import{f as ne,ai as ue,N as oe,bL as f,fH as re,r as u,hf as ie,hp as ce,aw as de,ay as ve,ht as fe,az as me,gs as pe,gx as ye,g as $,d4 as ke,hR as ge,ce as I,F as be,ae as T,H as A,cV as De,hO as he,i as $e,cp as Ie,aA as Ve,iy as we,o as V,c as H,b as Ce,w as L,a as N,P as t,U as S,Q as _,a7 as Me,Y as B,S as q,T as je,al as Ee,$ as Ye,_ as xe}from"./B2hUoZAs.js";import{_ as Fe}from"./xq9YlIVR.js";import{_ as Pe}from"./e4fIiYA_.js";import"./CjZLV3bP.js";import"./C80dkAHb.js";const Ue=["title"],ze=["value","placeholder","readonly"],Ne={class:"w-[256px]"},Se={key:0,class:"absolute inset-0 z-90 cursor-pointer"},_e=ne({__name:"DatePicker",props:{modelValue:{},isPk:{type:Boolean}},emits:["update:modelValue"],setup(p,{emit:Q}){const K=Q,{t:O}=ue(),{showNull:P,isMobileMode:J}=oe(),w=f(re,null),D=f(ie,u(!1)),C=f(ce,u(!1)),M=f(de,u(!1)),c=f(ve,u(!1)),y=f(fe,u(!1)),W=f(me,u(!1)),X=f(pe,u(!1)),j=f(ye,u(!1)),E=u(!1),d=u(),b=$(()=>{var e,a;return((a=ke((e=w==null?void 0:w.value)==null?void 0:e.meta))==null?void 0:a.date_format)??"YYYY-MM-DD"}),U=$(()=>ge(b.value)?"month":""),Y=u(!1),l=u(!1),r=u(),n=$({get(){if(!p.modelValue||Y.value)return;if(!I(p.modelValue).isValid()){E.value=!0;return}const e=U.value==="month"?b:"YYYY-MM-DD";return I(/^\d+$/.test(p.modelValue)?+p.modelValue:p.modelValue,e)},set(e){if(Y.value=!1,!e){K("update:modelValue",null);return}U.value==="month"&&(e=I(e).date(1)),e.isValid()&&K("update:modelValue",e==null?void 0:e.format("YYYY-MM-DD")),l.value=!1}});be(()=>{n.value&&(r.value=n.value)});const v=`picker_${Math.floor(Math.random()*99999)}`;T(d,e=>{var a,s,o;(a=e.target)!=null&&a.closest(`.${v}, .nc-${v}`)||((o=(s=d.value)==null?void 0:s.blur)==null||o.call(s),l.value=!1)});const Z=e=>{var a,s;(a=e==null?void 0:e.relatedTarget)!=null&&a.closest(`.${v}, .nc-${v}`)||(s=e==null?void 0:e.target)!=null&&s.closest(`.${v}, .nc-${v}`)||(l.value=!1)},ee=()=>{l.value=!0};A(l,e=>{var a,s;e?(c.value=!0,(s=(a=d.value)==null?void 0:a.focus)==null||s.call(a),T(document.querySelector(`.${v}`),o=>{var m;(m=o==null?void 0:o.target)!=null&&m.closest(`.nc-${v}`)||(l.value=!1)})):Y.value=!1},{flush:"post"}),A(c,e=>{y.value&&e&&!l.value&&(l.value=!0)});const ae=$(()=>(W.value||j.value)&&!E.value||y.value&&!P.value&&!E.value&&!De(w.value)&&M.value||C.value?b.value:p.modelValue===null&&P.value?O("general.null").toUpperCase():E.value?O("msg.invalidDate"):""),x=$(()=>D.value||(D.value||n.value&&p.isPk)&&!M.value&&!c.value?!1:l.value),k=f(he,null),z=()=>{D.value||l.value||(l.value=M.value||c.value)};$e(()=>{k==null||k.on(z)}),Ie(()=>{k==null||k.on(z)});const te=()=>{k||z()},le=(e,a)=>{var s,o,m,i,g,h,F,G;switch(e.key!=="Enter"&&e.key!=="Tab"&&e.stopPropagation(),e.key){case"Enter":e.preventDefault(),X.value&&e.stopPropagation(),n.value=r.value,l.value=!a,l.value||(c.value=!1,y.value&&!j.value&&!C.value&&((o=(s=d.value)==null?void 0:s.blur)==null||o.call(s)));return;case"Escape":a?(l.value=!1,c.value=!1,y.value&&!j.value&&!C.value&&((i=(m=d.value)==null?void 0:m.blur)==null||i.call(m))):(c.value=!1,(h=(g=d.value)==null?void 0:g.blur)==null||h.call(g));return;case"Tab":l.value=!1,y.value&&(c.value=!1,(G=(F=d.value)==null?void 0:F.blur)==null||G.call(F));return;default:!a&&/^[0-9a-z]$/i.test(e.key)&&(l.value=!0)}};Ve(document,"keydown",e=>{if(M.value&&!(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey||!y.value||j.value||C.value||we()))switch(e.key){case";":n.value=I(new Date),e.preventDefault();break;default:!x.value&&d.value&&/^[0-9a-z]$/i.test(e.key)&&(Y.value=!0,d.value.focus(),c.value=!0,l.value=!0)}});const se=e=>{const a=e.target.value;if(!a){r.value=void 0;return}const s=I(a,b.value);s.isValid()&&(r.value=s)};function R(e){r.value=e,n.value=e,l.value=!1}return(e,a)=>{const s=Ye,o=Fe,m=Pe;return V(),H(Ee,null,[Ce(m,{visible:t(x),"auto-close":!1,trigger:["click"],class:je(["nc-cell-field",[`nc-${v}`,{"nc-null":e.modelValue===null&&t(P)}]]),"overlay-class-name":`${v} nc-picker-date ${t(l)?"active":""} !min-w-[260px]`},{overlay:L(()=>[N("div",Ne,[t(U)==="month"?(V(),S(o,{key:0,"page-date":t(r),"onUpdate:pageDate":a[4]||(a[4]=i=>_(r)?r.value=i:null),"selected-date":t(n),"onUpdate:selectedDate":a[5]||(a[5]=i=>_(n)?n.value=i:null),"is-open":t(x),type:"month",size:"medium"},null,8,["page-date","selected-date","is-open"])):(V(),S(o,{key:1,"page-date":t(r),"onUpdate:pageDate":a[6]||(a[6]=i=>_(r)?r.value=i:null),"is-open":t(x),"selected-date":t(n),type:"date",size:"medium","onUpdate:selectedDate":R},null,8,["page-date","is-open","selected-date"]))])]),default:L(()=>{var i,g;return[N("div",Me(e.$attrs,{title:(i=t(n))==null?void 0:i.format(t(b)),class:"nc-date-picker h-full flex items-center justify-between ant-picker-input relative"}),[N("input",{ref_key:"datePickerRef",ref:d,type:"text",value:((g=t(n))==null?void 0:g.format(t(b)))??"",placeholder:t(ae),class:"nc-date-input border-none outline-none !text-current bg-transparent !focus:border-none !focus:outline-none !focus:ring-transparent",readonly:t(D)||!!t(J),onBlur:Z,onFocus:ee,onKeydown:a[0]||(a[0]=h=>le(h,t(l))),onMouseup:a[1]||(a[1]=B(()=>{},["stop"])),onMousedown:a[2]||(a[2]=B(()=>{},["stop"])),onClick:te,onInput:se},null,40,ze),t(n)&&!t(D)?(V(),S(s,{key:0,icon:"closeCircle",class:"nc-clear-date-icon nc-action-icon absolute right-0 top-[50%] transform -translate-y-1/2 invisible cursor-pointer",onClick:a[3]||(a[3]=B(h=>R(),["stop"]))})):q("",!0)],16,Ue)]}),_:1},8,["visible","class","overlay-class-name"]),!t(c)&&t(y)?(V(),H("div",Se)):q("",!0)],64)}}}),Te=xe(_e,[["__scopeId","data-v-a99de8f6"]]);export{Te as default};
