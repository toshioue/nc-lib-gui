import{f as oe,ai as ue,N as re,bN as f,fP as ie,r as o,hq as ce,hG as de,aC as ve,aE as fe,hK as me,aF as pe,gP as ye,gU as ke,g as b,de as De,i2 as ge,cr as C,F as he,af as q,H as A,d2 as we,i0 as be,i as Ce,cB as $e,aG as Ie,iM as Ve,o as $,c as H,b as Me,w as L,a as O,P as t,S,Q as K,a9 as Ee,Y as z,T as Q,U as Pe,aq as je,$ as Fe,_ as Ye}from"./3QBYHahY.js";import{_ as xe}from"./6yFCeHM-.js";import{_ as Ue}from"./Kma333Sh.js";import"./CRLT1BlI.js";import"./cW5_x0lr.js";const Be=["title"],Ne=["value","placeholder","readonly"],Oe={class:"w-[256px]"},Se={key:0,class:"absolute inset-0 z-90 cursor-pointer"},Ke=oe({__name:"DatePicker",props:{modelValue:{},isPk:{type:Boolean},showCurrentDateOption:{type:[Boolean,String]}},emits:["update:modelValue","currentDate"],setup(p,{emit:J}){const x=J,{t:G}=ue(),{showNull:U,isMobileMode:W}=re(),I=f(ie,null),h=f(ce,o(!1)),V=f(de,o(!1)),M=f(ve,o(!1)),c=f(fe,o(!1)),y=f(me,o(!1)),X=f(pe,o(!1)),Z=f(ye,o(!1)),E=f(ke,o(!1)),P=o(!1),d=o(),g=b(()=>{var e,a;return((a=De((e=I==null?void 0:I.value)==null?void 0:e.meta))==null?void 0:a.date_format)??"YYYY-MM-DD"}),B=b(()=>ge(g.value)?"month":""),j=o(!1),l=o(!1),r=o(),s=b({get(){if(!p.modelValue||j.value)return;if(!C(p.modelValue).isValid()){P.value=!0;return}const e=B.value==="month"?g:"YYYY-MM-DD";return C(/^\d+$/.test(p.modelValue)?+p.modelValue:p.modelValue,e)},set(e){if(j.value=!1,!e){x("update:modelValue",null);return}B.value==="month"&&(e=C(e).date(1)),e.isValid()&&x("update:modelValue",e==null?void 0:e.format("YYYY-MM-DD")),l.value=!1}});he(()=>{s.value&&(r.value=s.value)});const v=`picker_${Math.floor(Math.random()*99999)}`;q(d,e=>{var a,n,u;(a=e.target)!=null&&a.closest(`.${v}, .nc-${v}`)||((u=(n=d.value)==null?void 0:n.blur)==null||u.call(n),l.value=!1)});const ee=e=>{var a,n;(a=e==null?void 0:e.relatedTarget)!=null&&a.closest(`.${v}, .nc-${v}`)||(n=e==null?void 0:e.target)!=null&&n.closest(`.${v}, .nc-${v}`)||(l.value=!1)},ae=()=>{l.value=!0};A(l,e=>{var a,n;e?(c.value=!0,(n=(a=d.value)==null?void 0:a.focus)==null||n.call(a),q(document.querySelector(`.${v}`),u=>{var m;(m=u==null?void 0:u.target)!=null&&m.closest(`.nc-${v}`)||(l.value=!1)})):j.value=!1},{flush:"post"}),A(c,e=>{y.value&&e&&!l.value&&(l.value=!0)});const te=b(()=>(X.value||E.value)&&!P.value||y.value&&!U.value&&!P.value&&!we(I.value)&&M.value||V.value?g.value:p.modelValue===null&&U.value?G("general.null").toUpperCase():P.value?G("msg.invalidDate"):""),F=b(()=>h.value||(h.value||s.value&&p.isPk)&&!M.value&&!c.value?!1:l.value),k=f(be,null),N=()=>{h.value||l.value||(l.value=M.value||c.value)};Ce(()=>{k==null||k.on(N)}),$e(()=>{k==null||k.on(N)});const le=()=>{k||N()},ne=(e,a)=>{var n,u,m,i,D,w,Y,T;switch(e.key!=="Enter"&&e.key!=="Tab"&&e.stopPropagation(),e.key){case"Enter":e.preventDefault(),Z.value&&e.stopPropagation(),s.value=r.value,l.value=!a,l.value||(c.value=!1,y.value&&!E.value&&!V.value&&((u=(n=d.value)==null?void 0:n.blur)==null||u.call(n)));return;case"Escape":a?(l.value=!1,c.value=!1,y.value&&!E.value&&!V.value&&((i=(m=d.value)==null?void 0:m.blur)==null||i.call(m))):(c.value=!1,(w=(D=d.value)==null?void 0:D.blur)==null||w.call(D));return;case"Tab":l.value=!1,y.value&&(c.value=!1,(T=(Y=d.value)==null?void 0:Y.blur)==null||T.call(Y));return;default:!a&&/^[0-9a-z]$/i.test(e.key)&&(l.value=!0)}};Ie(document,"keydown",e=>{if(M.value&&!(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey||!y.value||E.value||V.value||Ve()))switch(e.key){case";":s.value=C(new Date),e.preventDefault();break;default:!F.value&&d.value&&/^[0-9a-z]$/i.test(e.key)&&(j.value=!0,d.value.focus(),c.value=!0,l.value=!0)}});const se=e=>{const a=e.target.value;if(!a){r.value=void 0;return}const n=C(a,g.value);n.isValid()&&(r.value=n)};function _(e){r.value=e,s.value=e,l.value=!1}const R=e=>{x("currentDate",e),l.value=!1};return(e,a)=>{const n=Fe,u=xe,m=Ue;return $(),H(je,null,[Me(m,{visible:t(F),"auto-close":!1,trigger:["click"],class:Pe(["nc-cell-field",[`nc-${v}`,{"nc-null":e.modelValue===null&&t(U)}]]),"overlay-class-name":`${v} nc-picker-date ${t(l)?"active":""} !min-w-[260px]`},{overlay:L(()=>[O("div",Oe,[t(B)==="month"?($(),S(u,{key:0,"page-date":t(r),"onUpdate:pageDate":a[4]||(a[4]=i=>K(r)?r.value=i:null),"selected-date":t(s),"onUpdate:selectedDate":a[5]||(a[5]=i=>K(s)?s.value=i:null),"is-open":t(F),type:"month",size:"medium","show-current-date-option":e.showCurrentDateOption,onCurrentDate:R},null,8,["page-date","selected-date","is-open","show-current-date-option"])):($(),S(u,{key:1,"page-date":t(r),"onUpdate:pageDate":a[6]||(a[6]=i=>K(r)?r.value=i:null),"is-open":t(F),"selected-date":t(s),type:"date",size:"medium","show-current-date-option":e.showCurrentDateOption,"onUpdate:selectedDate":_,onCurrentDate:R},null,8,["page-date","is-open","selected-date","show-current-date-option"]))])]),default:L(()=>{var i,D;return[O("div",Ee(e.$attrs,{title:(i=t(s))==null?void 0:i.format(t(g)),class:"nc-date-picker h-full flex items-center justify-between ant-picker-input relative"}),[O("input",{ref_key:"datePickerRef",ref:d,type:"text",value:((D=t(s))==null?void 0:D.format(t(g)))??"",placeholder:t(te),class:"nc-date-input border-none outline-none !text-current bg-transparent !focus:border-none !focus:outline-none !focus:ring-transparent",readonly:t(h)||!!t(W),onBlur:ee,onFocus:ae,onKeydown:a[0]||(a[0]=w=>ne(w,t(l))),onMouseup:a[1]||(a[1]=z(()=>{},["stop"])),onMousedown:a[2]||(a[2]=z(()=>{},["stop"])),onClick:le,onInput:se},null,40,Ne),t(s)&&!t(h)?($(),S(n,{key:0,icon:"closeCircle",class:"nc-clear-date-icon nc-action-icon absolute right-0 top-[50%] transform -translate-y-1/2 invisible cursor-pointer",onClick:a[3]||(a[3]=z(w=>_(),["stop"]))})):Q("",!0)],16,Be)]}),_:1},8,["visible","class","overlay-class-name"]),!t(c)&&t(y)?($(),H("div",Se)):Q("",!0)],64)}}}),qe=Ye(Ke,[["__scopeId","data-v-12321df5"]]);export{qe as default};
