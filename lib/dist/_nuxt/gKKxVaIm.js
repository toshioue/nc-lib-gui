import{o as c,c as p,a,f as F,r as h,i as H,l as T,b as i,w as l,d as u,t as n,P as t,U as A,R as v,aH as g,S as G,V as O,W as U,aq as M,$ as W,a0 as q,a1 as E,_ as L}from"./3QBYHahY.js";import{a as P}from"./B5EXVDS7.js";import{u as Y}from"./C_wbqn43.js";import"./C9Sjn86N.js";import"./C726Gdw3.js";import"./BteOdwRG.js";import"./CSl6euFG.js";import"./BqSRViGZ.js";import"./T74iQZdg.js";import"./Bj2FvocX.js";import"./DPqnb67u.js";import"./boyBAVNN.js";import"./BYmqikBK.js";import"./CL-Lp6PG.js";import"./DGM-hiY9.js";import"./C00NHga8.js";import"./D4iSzjWt.js";import"./BVQBF9Vn.js";import"./CJ26qO3d.js";import"./kHOslGNR.js";import"./CmN9vPg3.js";import"./BQQOEPN4.js";import"./xnDaHwV-.js";import"./DPgYHC40.js";import"./BsWDDIqE.js";import"./ceYq-xax.js";import"./DAKhk9t6.js";import"./Bk0xUMNV.js";import"./CGxepfeV.js";import"./wEQwkVjR.js";import"./C0-Qcoum.js";const J={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},K=a("path",{fill:"currentColor",d:"M4 4h3l2-2h6l2 2h3a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2m8 3a5 5 0 0 0-5 5a5 5 0 0 0 5 5a5 5 0 0 0 5-5a5 5 0 0 0-5-5m0 2a3 3 0 0 1 3 3a3 3 0 0 1-3 3a3 3 0 0 1-3-3a3 3 0 0 1 3-3"},null,-1),Q=[K];function X(z,x){return c(),p("svg",J,[...Q])}const Z={name:"mdi-camera",render:X},ee={class:"w-full relative h-full"},te={key:0,class:"w-full h-full flex bg-gray-50 items-center justify-center"},ae={class:"p-5 bg-white rounded-md shadow-sm"},oe={class:"text-gray-800 font-semibold text-center text-xl"},se={class:"w-full gap-3 h-full flex-col flex items-center justify-between"},ie={class:"flex group flex-col gap-1"},le={class:"relative text-[12px] font-semibold text-gray-800 flex"},ne={class:"flex-auto truncate line-height-4"},re={class:"flex-none hide-ui transition-all transition-ease-in-out !h-4 flex items-center bg-white"},ce={class:"flex-none text-[10px] font-semibold text-gray-500"},me={class:"flex gap-2 pr-2 bottom-1 relative w-full items-center justify-end"},de=F({__name:"Camera",emits:["update:visible","upload"],setup(z,{emit:x}){const y=x,{isLoading:f,startCamera:D,stopCamera:N,videoStream:w,permissionGranted:R}=Y(),s=h(null),m=h(),b=h(),_=async()=>{try{if(await D(),!m.value||!w.value)return;m.value.srcObject=w.value}catch{}},C=()=>{N(),m.value&&(m.value.srcObject=null)},S=()=>{s.value=null,_()},V=()=>{const e=m.value,o=b.value;if(!e||!o)return;o.width=e.videoWidth,o.height=e.videoHeight;const d=o.getContext("2d");d&&(o.style.display="block",d.translate(o.width,0),d.scale(-1,1),d.drawImage(e,0,0,o.width,o.height),o.toBlob(r=>{r&&(s.value=new File([r],`${new Date().toDateString()}.png`,{type:"image/png"}))},"image/png"),C())},k=()=>{y("update:visible",!1)};return H(()=>{_()}),T(()=>{C()}),(e,o)=>{var j,I;const d=W,r=q,$=E,B=Z;return c(),p("div",ee,[i($,{class:"absolute top-3 right-2"},{title:l(()=>[u(n(e.$t("general.close")),1)]),default:l(()=>[i(r,{type:"text",class:"!border-0",size:"xsmall",onClick:k},{default:l(()=>[i(d,{icon:"close"})]),_:1})]),_:1}),t(R)?(c(),p("div",{key:1,class:A([{"py-8":!t(s),"pt-8 pb-2":t(s)},"w-full gap-3 h-full flex-col flex items-center justify-between"])},[v(a("div",se,[a("video",{ref_key:"videoRef",ref:m,class:"rounded-md",style:{width:"400px"},autoplay:""},null,512),i(r,{class:"!rounded-full !px-0",onClick:V},{default:l(()=>[i(B,{class:"text-xl"})]),_:1})],512),[[g,!t(s)]]),v(a("div",ie,[a("canvas",{ref_key:"canvasRef",ref:b,class:"rounded-md",style:{width:"400px",display:"none"}},null,512),a("div",le,[a("div",ne,n((j=t(s))==null?void 0:j.name),1),a("div",re,[i($,{placement:"bottom"},{title:l(()=>[u(n(e.$t("title.removeFile")),1)]),default:l(()=>[(c(),G(O(("iconMap"in e?e.iconMap:t(U)).delete),{class:"!text-red-500 cursor-pointer",onClick:S}))]),_:1})])]),a("div",ce,n(("formatBytes"in e?e.formatBytes:t(P))((I=t(s))==null?void 0:I.size,0)),1)],512),[[g,t(s)]]),v(a("div",me,[i(r,{disabled:t(f),type:"secondary",size:"small",onClick:k},{default:l(()=>[u(n(e.$t("labels.cancel")),1)]),_:1},8,["disabled"]),i(r,{loading:t(f),size:"small",onClick:o[0]||(o[0]=pe=>y("upload",[t(s)]))},{default:l(()=>[t(f)?(c(),p(M,{key:1},[u(n(e.$t("labels.uploading")),1)],64)):(c(),p(M,{key:0},[u(n(e.$t("labels.uploadImage")),1)],64))]),_:1},8,["loading"])],512),[[g,t(s)]])],2)):(c(),p("div",te,[a("div",{class:"flex flex-col hover:bg-white p-2 cursor-pointer rounded-md !transition-all transition-ease-in-out duration-300 gap-2 items-center justify-center",onClick:_},[a("div",ae,[i(B,{class:"text-4xl text-gray-800"})]),a("h1",oe,n(e.$t("labels.allowAccessToYourCamera")),1)])]))])}}}),qe=L(de,[["__scopeId","data-v-c9628cfa"]]);export{qe as default};
