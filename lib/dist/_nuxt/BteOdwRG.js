import{u as C}from"./CSl6euFG.js";import{gJ as F,az as b,cQ as I,cM as K,g as t,d6 as l,r as f,P as g,H as k,A as U,gh as z}from"./3QBYHahY.js";function H(){const u={field:"",query:""},s=F("field-query-search-map",()=>({})),i=F("field-query-search",()=>({...u}));return{search:i,loadFieldQuery:o=>{o&&(o in s.value||(s.value[o]={...u}),i.value=s.value[o])}}}const[X,J]=C((u,s,i=!1,m,o)=>{const{$api:P}=U(),{activeView:a,activeNestedFilters:M,activeSorts:N}=b(I()),Q=K(),{sqlUis:h}=b(Q),v=t(()=>{var e;return(e=s.value)!=null&&e.source_id?h.value[s.value.source_id]:Object.values(h.value)[0]}),{search:n}=H(),R=z(Symbol("SmartsheetStore")),V=t(()=>{var e;return((e=a.value)==null?void 0:e.lock_type)==="locked"}),_=t(()=>{var e,r;return(r=(e=s.value)==null?void 0:e.columns)==null?void 0:r.some(c=>c.pk)}),$=t(()=>{var e;return((e=a.value)==null?void 0:e.type)===l.GRID}),S=t(()=>{var e;return((e=a.value)==null?void 0:e.type)===l.FORM}),x=t(()=>{var e;return((e=a.value)==null?void 0:e.type)===l.GALLERY}),B=t(()=>{var e;return((e=a.value)==null?void 0:e.type)===l.CALENDAR}),E=t(()=>{var e;return((e=a.value)==null?void 0:e.type)===l.KANBAN}),G=t(()=>{var e;return((e=a.value)==null?void 0:e.type)===l.MAP}),L=t(()=>S.value&&i),O=t(()=>{var e;return(e=a.value)==null?void 0:e.is_default}),T=t(()=>{var c,w,q,A;let e;const r=((w=(c=s.value)==null?void 0:c.columns)==null?void 0:w.find(({id:y})=>y===n.value.field))||((A=(q=s.value)==null?void 0:q.columns)==null?void 0:A.find(y=>y.pv));if(r&&n.value.query.trim())return v.value&&["text","string"].includes(v.value.getAbstractType(r))&&r.dt!=="bigint"?e=`(${r.title},like,%${n.value.query.trim()}%)`:e=`(${r.title},eq,${n.value.query.trim()})`,e}),j=t(()=>{var e;return((e=s.value)==null?void 0:e.type)==="view"}),p=f(g(m)??[]),d=f(g(o)??[]),D=f([]);return k(p,()=>{N.value=p.value},{immediate:!0}),k(d,()=>{M.value=d.value},{immediate:!0}),{view:a,meta:s,isLocked:V,$api:P,xWhere:T,isPkAvail:_,isForm:S,isGrid:$,isGallery:x,isKanban:E,isMap:G,isCalendar:B,isSharedForm:L,sorts:p,nestedFilters:d,isSqlView:j,eventBus:R,sqlUi:v,allFilters:D,isDefaultView:O}},"smartsheet-store");function Z(){const u=J();if(!u)throw new Error("Please call `useProvideSmartsheetStore` on the appropriate parent component");return u}export{Z as a,H as b,X as u};
