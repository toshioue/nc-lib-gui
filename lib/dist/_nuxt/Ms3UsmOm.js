import{cM as y,r as a,L as m,ar as p,g as w,cA as M,y as T,cq as v}from"./DZZ6t_j4.js";const I=y(()=>{const f=a("recents"),{$api:g}=T(),{appInfo:k}=m(),u=a([]),r=a([]),t=a([]),o=a([]),s=p({youtube:!1,github:!1,social:!1,cloud:!1}),d=async({loadMore:c,type:l})=>{try{let e=1;if(c)switch(l){case"youtube":e=Math.ceil(u.value.length/10)+1;break;case"github":e=Math.ceil(r.value.length/10)+1;break;case"all":e=Math.ceil(t.value.length/10)+1;break;case"cloud":e=Math.ceil(o.value.length/10)+1;break}const n=await g.utils.feed({page:e,per_page:10,type:l});switch(l){case"youtube":u.value=[...u.value,...n];break;case"github":r.value=[...r.value,...n];break;case"all":t.value=[...t.value,...n];break;case"cloud":o.value=[...o.value,...n];break}}catch(e){switch(l){case"youtube":s.youtube=!0;break;case"github":s.github=!0;break;case"all":s.social=!0;break;case"cloud":s.cloud=!0;break}return console.error(e),[]}},b=a(!1),F=async()=>{try{if(await d({type:"all",loadMore:!1}),!t.value.length)return;const[c]=t.value,l=localStorage.getItem("lastFeedPublishedTime"),e=v(l);(!e.isValid()||v(c["Published Time"]).isAfter(e))&&(b.value=!0)}catch(c){console.error("Error while checking new feed",c)}},i=a(),h=async()=>{await F(),i.value=setTimeout(h,3*60*60*1e3)};return w(()=>{k.value.feedEnabled&&h()}),M(()=>{i.value&&(clearTimeout(i.value),i.value=null)}),{isErrorOccurred:s,activeTab:f,youtubeFeed:u,githubFeed:r,socialFeed:t,cloudFeed:o,loadFeed:d,isNewFeedAvailable:b}});export{I as u};
