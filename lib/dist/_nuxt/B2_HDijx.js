import{o as a,c as b,a as l,e as Z,ba as oe,bL as V,r as B,h_ as le,f as F,aK as X,b as r,w as o,t as f,N as e,S as M,Q as T,R as w,h$ as H,d as j,ao as J,Z as ue,$ as me,Y as he,i0 as ve,g as ae,cA as fe,ha as pe,i1 as be,hK as ke,aD as _e,i2 as xe,h5 as ge,i3 as ye,i4 as $e,cU as Le,ab as Me,F as te,a$ as we,aE as ne,ad as Ae,W as Y,aJ as se}from"./DZZ6t_j4.js";import{B as Te,N as ce,m as re,w as Be,T as Ce,S as He,U as ze,L as Ie,P as Ve,u as Ee,E as Se,g as Oe,_ as Fe}from"./BmNyaTYf.js";import{B as Re}from"./C4K5fdHe.js";import{m as ie}from"./Dwil3It4.js";import"./Cy50pBgZ.js";import"./DKN1hQ6S.js";import"./BQuyMdA-.js";import"./BQQOEPN4.js";import"./vll-Pnjv.js";import"./B5RRVMt5.js";import"./DGj1ycqW.js";import"./DyDFI6NE.js";const qe={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ne=l("path",{fill:"currentColor",d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5a5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5a5 5 0 0 0-5-5"},null,-1),je=[Ne];function Ke(c,k){return a(),b("svg",qe,[...je])}const De={name:"mdi-link",render:Ke},Ue={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},We=l("path",{fill:"currentColor",d:"M5 21h14v-2H5zm7-4a6 6 0 0 0 6-6V3h-2.5v8a3.5 3.5 0 0 1-3.5 3.5A3.5 3.5 0 0 1 8.5 11V3H6v8a6 6 0 0 0 6 6"},null,-1),Pe=[We];function Qe(c,k){return a(),b("svg",Ue,[...Pe])}const Ge={name:"mdi-format-underline",render:Qe},Xe={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ye=l("path",{fill:"currentColor",d:"M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4z"},null,-1),Je=[Ye];function Ze(c,k){return a(),b("svg",Xe,[...Je])}const et={name:"mdi-format-italic",render:Ze},tt={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},nt=l("path",{fill:"currentColor",d:"M13.5 15.5H10v-3h3.5A1.5 1.5 0 0 1 15 14a1.5 1.5 0 0 1-1.5 1.5m-3.5-9h3A1.5 1.5 0 0 1 14.5 8A1.5 1.5 0 0 1 13 9.5h-3m5.6 1.29c.97-.68 1.65-1.79 1.65-2.79c0-2.26-1.75-4-4-4H7v14h7.04c2.1 0 3.71-1.7 3.71-3.79c0-1.52-.86-2.82-2.15-3.42"},null,-1),st=[nt];function it(c,k){return a(),b("svg",tt,[...st])}const ot={name:"mdi-format-bold",render:it},lt={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},at=l("path",{fill:"currentColor",d:"M7 5h14v2H7zm0 8v-2h14v2zM4 4.5A1.5 1.5 0 0 1 5.5 6A1.5 1.5 0 0 1 4 7.5A1.5 1.5 0 0 1 2.5 6A1.5 1.5 0 0 1 4 4.5m0 6A1.5 1.5 0 0 1 5.5 12A1.5 1.5 0 0 1 4 13.5A1.5 1.5 0 0 1 2.5 12A1.5 1.5 0 0 1 4 10.5M7 19v-2h14v2zm-3-2.5A1.5 1.5 0 0 1 5.5 18A1.5 1.5 0 0 1 4 19.5A1.5 1.5 0 0 1 2.5 18A1.5 1.5 0 0 1 4 16.5"},null,-1),ct=[at];function rt(c,k){return a(),b("svg",lt,[...ct])}const dt={name:"mdi-format-list-bulleted",render:rt},ut={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},mt=l("path",{fill:"currentColor",d:"M3 14h18v-2H3m2-8v3h5v3h4V7h5V4m-9 15h4v-3h-4z"},null,-1),ht=[mt];function vt(c,k){return a(),b("svg",ut,[...ht])}const ft={name:"mdi-format-strikethrough",render:vt},pt={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},bt=l("path",{fill:"currentColor",d:"M7 13v-2h14v2zm0 6v-2h14v2zM7 7V5h14v2zM3 8V5H2V4h2v4zm-1 9v-1h3v4H2v-1h2v-.5H3v-1h1V17zm2.25-7a.75.75 0 0 1 .75.75c0 .2-.08.39-.21.52L3.12 13H5v1H2v-.92L4 11H2v-1z"},null,-1),kt=[bt];function _t(c,k){return a(),b("svg",pt,[...kt])}const xt={name:"mdi-format-list-numbered",render:_t},gt={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},yt=l("path",{fill:"currentColor",d:"M21 19v-2H8v2zm0-6v-2H8v2zM8 7h13V5H8zM4 5v2h2V5zM3 5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1zm1 6v2h2v-2zm-1 0a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1zm1 6v2h2v-2zm-1 0a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1z"},null,-1),$t=[yt];function Lt(c,k){return a(),b("svg",gt,[...$t])}const Mt={name:"mdi-format-list-checkbox",render:Lt},wt={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},At=l("path",{fill:"currentColor",d:"M5 17V7h2v4h4V7h2v10h-2v-4H7v4zm12 0V9h-2V7h4v10z"},null,-1),Tt=[At];function Bt(c,k){return a(),b("svg",wt,[...Tt])}const Ct={name:"material-symbols-format-h1",render:Bt},Ht={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},zt=l("path",{fill:"currentColor",d:"M3 17V7h2v4h4V7h2v10H9v-4H5v4zm10 0v-4q0-.825.588-1.412T15 11h4V9h-6V7h6q.825 0 1.413.588T21 9v2q0 .825-.587 1.413T19 13h-4v2h6v2z"},null,-1),It=[zt];function Vt(c,k){return a(),b("svg",Ht,[...It])}const Et={name:"material-symbols-format-h2",render:Vt},St={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ot=l("path",{fill:"currentColor",d:"M3 17V7h2v4h4V7h2v10H9v-4H5v4zm10 0v-2h6v-2h-4v-2h4V9h-6V7h6q.825 0 1.413.588T21 9v6q0 .825-.587 1.413T19 17z"},null,-1),Ft=[Ot];function Rt(c,k){return a(),b("svg",St,[...Ft])}const qt={name:"material-symbols-format-h3",render:Rt},Nt={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},jt=l("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 15h15m0 4H6m9-8h6m0-4h-6M9 9h1a1 1 0 1 1-1 1V7.5a2 2 0 0 1 2-2M3 9h1a1 1 0 1 1-1 1V7.5a2 2 0 0 1 2-2"},null,-1),Kt=[jt];function Dt(c,k){return a(),b("svg",Nt,[...Kt])}const Ut={name:"tabler-blockquote",render:Dt},Wt={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Pt=l("path",{fill:"currentColor",d:"m8 18l-6-6l6-6l1.425 1.425l-4.6 4.6L9.4 16.6zm8 0l-1.425-1.425l4.6-4.6L14.6 7.4L16 6l6 6z"},null,-1),Qt=[Pt];function Gt(c,k){return a(),b("svg",Wt,[...Qt])}const Xt={name:"material-symbols-code",render:Gt},Yt={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Jt=l("path",{fill:"currentColor",d:"M5.7 18L8 14q-1.65 0-2.825-1.175T4 10t1.175-2.825T8 6t2.825 1.175T12 10q0 .575-.137 1.063T11.45 12L8 18zm9 0l2.3-4q-1.65 0-2.825-1.175T13 10t1.175-2.825T17 6t2.825 1.175T21 10q0 .575-.137 1.063T20.45 12L17 18z"},null,-1),Zt=[Jt];function en(c,k){return a(),b("svg",Yt,[...Zt])}const tn={name:"material-symbols-format-quote",render:en},nn={class:"flex flex-col items-center"},sn={class:"text-xs"},on={class:"flex flex-col items-center"},ln={class:"flex flex-col items-center"},an={class:"flex flex-col items-center"},cn={class:"flex flex-col items-center"},rn={class:"flex flex-col items-center"},dn={class:"flex flex-col items-center"},un={key:8,class:"divider"},mn={key:1,class:"flex flex-row items-center px-0.5"},hn={class:"!text-xs !ml-1"},de=Z({__name:"SelectedBubbleMenu",props:{editor:{},embedMode:{type:Boolean,default:!1},isFormField:{type:Boolean,default:!1},hiddenOptions:{default:()=>[]}},setup(c){const k=c,{editor:t,embedMode:x,isFormField:m,hiddenOptions:_}=oe(k),z=V(le,B(!1)),d=F(()=>X()?"⌘":"CTRL"),E=F(()=>X()?"⇧":"Shift"),y=F(()=>X()?"⌥":"Alt"),u=F(()=>{if(m.value)return"bottom"}),h=F(()=>m.value?-1:0),S=()=>{var $,L,I,K,R,q,g,D,v,U,Q,n;const p=((K=(I=(L=($=t.value)==null?void 0:$.state)==null?void 0:L.selection)==null?void 0:I.$from)==null?void 0:K.nodeBefore)||((D=(g=(q=(R=t.value)==null?void 0:R.state)==null?void 0:q.selection)==null?void 0:g.$from)==null?void 0:D.nodeAfter),i=(Q=(U=(v=t.value)==null?void 0:v.state)==null?void 0:U.storedMarks)==null?void 0:Q.some(s=>s.type.name==="link");((n=p==null?void 0:p.marks)==null?void 0:n.some(s=>s.type.name==="link"))||i?t.value.chain().focus().unsetLink().run():(t.value.state.selection.empty?t.value.chain().focus().insertContent(" ").setTextSelection({from:t.value.state.selection.$from.pos,to:t.value.state.selection.$from.pos+1}).toggleLink({href:""}).setTextSelection({from:t.value.state.selection.$from.pos,to:t.value.state.selection.$from.pos+1}).deleteSelection().run():t.value.chain().focus().setLink({href:""}).selectTextblockEnd().run(),setTimeout(()=>{const s=document.querySelector(".nc-text-area-rich-link-option-input");s&&s.focus()},100))},C=p=>m.value?!_.value.includes(p):!0,G=p=>!m.value||p.some(i=>!_.value.includes(i));return(p,i)=>{const P=ot,$=ue,L=me,I=et,K=Ge,R=he,q=De;return a(),b("div",{class:M(["bubble-menu flex-row gap-x-1 rounded-lg",{"nc-form-field-bubble-menu inline-flex py-0":e(m),"flex bg-gray-100 px-1 py-1":!e(m),"embed-mode":e(x),"full-mode":!e(x),"edit-column-mode":e(z)}])},[r(L,{placement:e(u),disabled:e(t).isActive("codeBlock")},{title:o(()=>[l("div",nn,[l("div",null,f(p.$t("labels.bold")),1),l("div",sn,f(e(d))+" B",1)])]),default:o(()=>[r($,{size:"small",type:"text",class:M({"is-active":e(t).isActive("bold")}),disabled:e(t).isActive("codeBlock"),tabindex:e(h),onClick:i[0]||(i[0]=g=>e(t).chain().focus().toggleBold().run())},{default:o(()=>[r(P)]),_:1},8,["class","disabled","tabindex"])]),_:1},8,["placement","disabled"]),r(L,{placement:e(u),disabled:e(t).isActive("codeBlock")},{title:o(()=>[l("div",on,[l("div",null,f(p.$t("labels.italic")),1),l("div",null,f(e(d))+" I",1)])]),default:o(()=>[r($,{size:"small",type:"text",disabled:e(t).isActive("codeBlock"),class:M({"is-active":e(t).isActive("italic")}),tabindex:e(h),onClick:i[1]||(i[1]=g=>{e(t).chain().focus().toggleItalic().run()})},{default:o(()=>[r(I)]),_:1},8,["disabled","class","tabindex"])]),_:1},8,["placement","disabled"]),r(L,{placement:e(u),disabled:e(t).isActive("codeBlock")},{title:o(()=>[l("div",ln,[l("div",null,f(p.$t("labels.underline")),1),l("div",null,f(e(d))+" U",1)])]),default:o(()=>[r($,{size:"small",type:"text",class:M({"is-active":e(t).isActive("underline")}),disabled:e(t).isActive("codeBlock"),tabindex:e(h),onClick:i[2]||(i[2]=g=>e(t).chain().focus().toggleUnderline().run())},{default:o(()=>[r(K)]),_:1},8,["class","disabled","tabindex"])]),_:1},8,["placement","disabled"]),e(x)&&!e(z)?(a(),T(L,{key:0,placement:e(u),disabled:e(t).isActive("codeBlock")},{title:o(()=>[l("div",an,[l("div",null,f(p.$t("labels.strike")),1),l("div",null,f(e(E))+" "+f(e(d))+" S",1)])]),default:o(()=>[r($,{size:"small",type:"text",class:M({"is-active":e(t).isActive("strike")}),disabled:e(t).isActive("codeBlock"),tabindex:e(h),onClick:i[3]||(i[3]=g=>e(t).chain().focus().toggleStrike().run())},{default:o(()=>[r(e(ft))]),_:1},8,["class","disabled","tabindex"])]),_:1},8,["placement","disabled"])):w("",!0),e(x)&&C(e(H).code)?(a(),T(L,{key:1,placement:e(u)},{title:o(()=>[j(f(p.$t("general.code")),1)]),default:o(()=>[r($,{size:"small",type:"text",tabindex:e(h),class:M({"is-active":e(t).isActive("codeBlock")}),onClick:i[4]||(i[4]=g=>e(t).chain().focus().toggleCodeBlock().run())},{default:o(()=>[r(e(Xt))]),_:1},8,["tabindex","class"])]),_:1},8,["placement"])):w("",!0),(e(m)?C(e(H).quote):!e(x))?(a(),T(L,{key:2,placement:e(u),disabled:e(t).isActive("codeBlock")},{title:o(()=>[j(f(p.$t("general.quote")),1)]),default:o(()=>[r($,{size:"small",type:"text",tabindex:e(h),class:M({"is-active":e(t).isActive("code")}),disabled:e(t).isActive("codeBlock"),onClick:i[5]||(i[5]=g=>e(t).chain().focus().toggleCode().run())},{default:o(()=>[r(e(tn))]),_:1},8,["tabindex","class","disabled"])]),_:1},8,["placement","disabled"])):w("",!0),i[14]||(i[14]=l("div",{class:"divider"},null,-1)),e(x)&&!e(m)?(a(),b(J,{key:3},[r(L,null,{title:o(()=>[l("div",cn,[l("div",null,f(p.$t("labels.heading1")),1),l("div",null,f(e(d))+" "+f(e(y))+" 1",1)])]),default:o(()=>[r($,{size:"small",type:"text",class:M({"is-active":e(t).isActive("heading",{level:1})}),onClick:i[6]||(i[6]=g=>e(t).chain().focus().toggleHeading({level:1}).run())},{default:o(()=>[r(e(Ct))]),_:1},8,["class"])]),_:1}),r(L,null,{title:o(()=>[l("div",rn,[l("div",null,f(p.$t("labels.heading2")),1),l("div",null,f(e(d))+" "+f(e(y))+" 2",1)])]),default:o(()=>[r($,{size:"small",type:"text",class:M({"is-active":e(t).isActive("heading",{level:2})}),onClick:i[7]||(i[7]=g=>e(t).chain().focus().toggleHeading({level:2}).run())},{default:o(()=>[r(e(Et))]),_:1},8,["class"])]),_:1}),r(L,null,{title:o(()=>[l("div",dn,[l("div",null,f(p.$t("labels.heading3")),1),l("div",null,f(e(d))+" "+f(e(y))+" 3",1)])]),default:o(()=>[r($,{size:"small",type:"text",class:M({"is-active":e(t).isActive("heading",{level:3})}),onClick:i[8]||(i[8]=g=>e(t).chain().focus().toggleHeading({level:3}).run())},{default:o(()=>[r(e(qt))]),_:1},8,["class"])]),_:1}),i[13]||(i[13]=l("div",{class:"divider"},null,-1))],64)):w("",!0),e(x)&&!e(z)&&C(e(H).blockQuote)?(a(),T(L,{key:4,placement:e(u)},{title:o(()=>[j(f(p.$t("labels.blockQuote")),1)]),default:o(()=>[r($,{size:"small",type:"text",tabindex:e(h),class:M({"is-active":e(t).isActive("blockquote")}),onClick:i[9]||(i[9]=g=>e(t).chain().focus().toggleBlockquote().run())},{default:o(()=>[r(e(Ut),{class:"-mt-0.25"})]),_:1},8,["tabindex","class"])]),_:1},8,["placement"])):w("",!0),C(e(H).bulletList)?(a(),T(L,{key:5,placement:e(u)},{title:o(()=>[j(f(p.$t("labels.bulletList")),1)]),default:o(()=>[r($,{size:"small",type:"text",tabindex:e(h),class:M({"is-active":e(t).isActive("bulletList")}),onClick:i[10]||(i[10]=g=>e(t).chain().focus().toggleBulletList().run())},{default:o(()=>[r(e(dt))]),_:1},8,["tabindex","class"])]),_:1},8,["placement"])):w("",!0),C(e(H).numberedList)?(a(),T(L,{key:6,placement:e(u)},{title:o(()=>[j(f(p.$t("labels.numberedList")),1)]),default:o(()=>[r($,{size:"small",type:"text",tabindex:e(h),class:M({"is-active":e(t).isActive("orderedList")}),onClick:i[11]||(i[11]=g=>e(t).chain().focus().toggleOrderedList().run())},{default:o(()=>[r(e(xt))]),_:1},8,["tabindex","class"])]),_:1},8,["placement"])):w("",!0),C(e(H).taskList)?(a(),T(L,{key:7,placement:e(u)},{title:o(()=>[j(f(p.$t("labels.taskList")),1)]),default:o(()=>[r($,{size:"small",type:"text",tabindex:e(h),class:M({"is-active":e(t).isActive("taskList")}),onClick:i[12]||(i[12]=g=>e(t).chain().focus().toggleTaskList().run())},{default:o(()=>[r(e(Mt))]),_:1},8,["tabindex","class"])]),_:1},8,["placement"])):w("",!0),G([e(H).blockQuote,e(H).bulletList,e(H).numberedList,e(H).taskList])?(a(),b("div",un)):w("",!0),C(e(H).link)?(a(),T(L,{key:9,placement:e(u),disabled:e(t).isActive("codeBlock")},{title:o(()=>[j(f(p.$t("general.link")),1)]),default:o(()=>[r($,{size:"small",type:"text",class:M({"is-active":e(t).isActive("link")}),disabled:e(t).isActive("codeBlock"),tabindex:e(h),onClick:S},{default:o(()=>[e(m)?(a(),T(R,{key:0,icon:"link2"})):(a(),b("div",mn,[r(q),l("div",hn,f(p.$t("general.link")),1)]))]),_:1},8,["class","disabled","tabindex"])]),_:1},8,["placement","disabled"])):w("",!0)],2)}}}),vn=Z({__name:"SelectedBubbleMenuPopup",props:{editor:{}},setup(c){const k=c,t=F(()=>k.editor),x=F(()=>t?!t.value.state.selection.empty:!1),m=B(!1);ve(()=>x.value,d=>{m.value=d},{debounce:200,maxWait:800,immediate:!0});const _=d=>{if(document.elementsFromPoint(d.clientX,d.clientY).some(h=>{var S;return(S=h==null?void 0:h.classList)==null?void 0:S.contains("bubble-menu")}))return;const u=document.querySelector(".nc-textarea-rich-editor");u==null||u.classList.add("bubble-menu-hidden")},z=d=>{document.elementsFromPoint(d.clientX,d.clientY).some(u=>{var h;return(h=u==null?void 0:u.classList)==null?void 0:h.contains("bubble-menu")})||setTimeout(()=>{const u=document.querySelector(".nc-textarea-rich-editor");u==null||u.classList.remove("bubble-menu-hidden")},100)};return ae(()=>{document.addEventListener("mouseup",z),document.addEventListener("mousedown",_)}),fe(()=>{document.removeEventListener("mouseup",z),document.removeEventListener("mousedown",_)}),(d,E)=>{const y=de;return a(),T(e(Te),{editor:e(t),"update-delay":300,"tippy-options":{duration:100,maxWidth:600}},{default:o(()=>[e(m)?(a(),T(y,{key:0,editor:e(t)},null,8,["editor"])):w("",!0)]),_:1},8,["editor"])}}}),fn=ce.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:c}){return["ul",re(this.options.HTMLAttributes,c,{"data-type":this.name}),0]},addCommands(){return{toggleTaskList:()=>({commands:c})=>c.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}}),pn=/^\s*\[( |x)?\]\s$/i,bn=ce.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList"}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:c=>c.getAttribute("data-checked")==="true",renderHTML:c=>({"data-checked":c.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:c,HTMLAttributes:k}){return["li",re(this.options.HTMLAttributes,k,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:c.attrs.checked?"checked":null}],["span"]],["div",0]]},addKeyboardShortcuts(){const c={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...c,Tab:()=>this.editor.commands.sinkListItem(this.name)}:c},addNodeView(){return({node:c,HTMLAttributes:k,getPos:t,editor:x})=>{const m=document.createElement("li"),_=document.createElement("label"),z=document.createElement("span"),d=document.createElement("input"),E=document.createElement("div");return _.contentEditable="false",d.type="checkbox",d.addEventListener("change",y=>{if(!x.isEditable&&!this.options.onReadOnlyChecked){d.checked=!d.checked;return}const{checked:u}=y.target;x.isEditable&&typeof t=="function"&&x.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:h})=>{const S=t(),C=h.doc.nodeAt(S);return h.setNodeMarkup(S,void 0,{...C==null?void 0:C.attrs,checked:u}),!0}).run(),!x.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(c,u)||(d.checked=!d.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([y,u])=>{m.setAttribute(y,u)}),m.dataset.checked=c.attrs.checked,c.attrs.checked&&d.setAttribute("checked","checked"),_.append(d,z),m.append(_,E),Object.entries(k).forEach(([y,u])=>{m.setAttribute(y,u)}),{dom:m,contentDOM:E,update:y=>y.type!==this.type?!1:(m.dataset.checked=y.attrs.checked,y.attrs.checked?d.setAttribute("checked","checked"):d.removeAttribute("checked"),!0)}}},addInputRules(){return[Be({find:pn,type:this.type,getAttributes:c=>({checked:c[c.length-1].toLowerCase()==="x"})})]}}),kn=["tabindex"],_n={key:0,class:"truncate"},xn={key:0},gn={class:"scrollbar-thin scrollbar-thumb-gray-200 hover:scrollbar-thumb-gray-300 scrollbar-track-transparent"},yn={key:3,class:"nc-form-field-bubble-menu-wrapper overflow-hidden"},En=Z({__name:"RichText",props:{value:{},readOnly:{type:Boolean},syncValueChange:{type:Boolean},showMenu:{type:Boolean},fullMode:{type:Boolean},isFormField:{type:Boolean,default:!1},autofocus:{type:Boolean},placeholder:{},renderAsText:{type:Boolean},hiddenBubbleMenuOptions:{default:()=>[]}},emits:["update:value","focus","blur"],setup(c,{emit:k}){const t=c,x=k,{fullMode:m,isFormField:_,hiddenBubbleMenuOptions:z}=oe(t),d=V(pe,B(!1)),E=V(be,B(1)),y=V(ke,B(!1)),u=V(le,B(!1)),h=V(_e,B(!1)),S=V(xe,B(!1)),C=V(ge,B(!1)),G=V(ye,B(!1)),p=V($e,B(!1)),i=B(!1),P=Le(),$=F(()=>y.value&&!d.value&&(G.value||p.value)?6:E.value),L=F(()=>_.value?i.value:!0),I=new Ce({});I.addRule("lineBreak",{filter:n=>n.nodeName==="BR",replacement:()=>"<br />"}),I.addRule("taskList",{filter:n=>n.nodeName==="LI"&&!!n.getAttribute("data-checked"),replacement:(n,s)=>{const A=n.replace(/^\n\n/,"").replace(/\n\n$/,"");return`[${s.getAttribute("data-checked")==="true"?"x":" "}] ${A}

`}}),I.addRule("strikethrough",{filter:["s"],replacement:n=>`~${n}~`}),I.keep(["u","del"]);const K={name:"checkListItem",level:"block",tokenizer(n){if(n=n.split(`

`)[0],n.startsWith("[ ]")||n.startsWith("[x]")||n.startsWith("[X]")){const A=n.startsWith("[ ]");let O=n.slice(3);O[0]===" "&&(O=O.slice(1));const N={type:"checkListItem",raw:n,text:O,tokens:[],checked:!A};return this.lexer.inline(N.text,N.tokens),N}return!1},renderer(n){return`<ul data-type="taskList"><li data-checked="${n.checked?"true":"false"}" data-type="taskItem"><label><input type="checkbox" ${n.checked?'checked="checked"':""}><span></span></label><div>${this.parser.parseInline(n.tokens)}</div></li></ul>`}};ie.use({extensions:[K]});const R=B(null),q=B(null),g=Me(t,"value",x,{defaultValue:""}),D=[He.configure({heading:_.value?!1:void 0}),fn,bn.configure({nested:!0}),ze,Ie,Ve.configure({emptyEditorClass:"is-editor-empty",placeholder:t.placeholder})],v=Ee({extensions:D,onUpdate:({editor:n})=>{const s=I.turndown(n.getHTML().replaceAll(/<p><\/p>/g,"<br />")).replaceAll(/\n\n<br \/>\n\n/g,`<br>

`);g.value=s==="<br />"?"":s},editable:!t.readOnly,autofocus:t.autofocus,onFocus:()=>{i.value=!0,x("focus")},onBlur:n=>{var s,A;(A=(s=n==null?void 0:n.event)==null?void 0:s.relatedTarget)!=null&&A.closest(".bubble-menu, .nc-textarea-rich-editor, .nc-rich-text")||(i.value=!1,x("blur"))}}),U=(n,s)=>{if(!v.value)return;const A=v.value.view.state.selection,O=n?ie.parse(n):"<p></p>",N=Oe(O,D);v.value.chain().setContent(N).setTextSelection(A.to).run(),setTimeout(()=>{var W;if(s){const ee=v.value.state.doc.nodeSize;(W=v.value)==null||W.chain().setTextSelection(ee-1).run()}v.value.state.history$.prevRanges=null,v.value.state.history$.done.eventCount=0},100)},Q=()=>{var n;h.value&&!_.value&&!t.readOnly&&!P.shift.value&&((n=v.value)==null||n.chain().focus().run())};return t.syncValueChange&&te([g,v],()=>{var n;U(_.value?(n=g.value||"")==null?void 0:n.replace(/(<br \/>)+$/g,""):g.value)}),_.value&&te([t,v],()=>{var n,s;t.readOnly?(n=v.value)==null||n.setEditable(!1):(s=v.value)==null||s.setEditable(!0)}),ae(()=>{(m.value||_.value||h.value||u.value)&&(U(g.value,!0),(m.value||C.value)&&we(()=>{var n;(n=v.value)==null||n.chain().focus().run()}))}),ne(R,"focusout",n=>{var A;const s=n==null?void 0:n.relatedTarget;((A=s==null?void 0:s.classList)!=null&&A.contains("tiptap")||!(s!=null&&s.closest(".bubble-menu, .tippy-content, .nc-textarea-rich-editor")))&&(i.value=!1,x("blur"))},!0),ne(q,"focusout",n=>{var A;const s=n==null?void 0:n.relatedTarget;!s&&((A=n.target)!=null&&A.closest(".bubble-menu, .tippy-content, .nc-textarea-rich-editor"))||s!=null&&s.closest(".bubble-menu, .tippy-content, .nc-textarea-rich-editor")||(i.value=!1,x("blur"))},!0),Ae(R,n=>{if(!i.value)return;const s=n==null?void 0:n.target;s!=null&&s.closest(".bubble-menu,.tippy-content, .nc-textarea-rich-editor")||(i.value=!1,x("blur"))}),(n,s)=>{var W;const A=de,O=vn,N=Fe;return a(),b("div",{class:M(["nc-rich-text h-full focus:outline-none",{"flex flex-col flex-grow nc-rich-text-full":e(m),"nc-rich-text-embed flex flex-col pl-1 w-full":!e(m),readonly:n.readOnly,"nc-form-rich-text-field !p-0 relative":e(_),"nc-rich-text-grid":e(S)}]),tabindex:e(y)||e(_)?-1:0,onFocus:Q},[n.renderAsText?(a(),b("div",_n,[e(v)?(a(),b("span",xn,f(((W=e(v))==null?void 0:W.getText())??""),1)):w("",!0)])):(a(),b(J,{key:1},[n.showMenu&&!n.readOnly&&!e(_)?(a(),b("div",{key:0,class:M(["absolute top-0 right-0.5",{"flex rounded-tr-2xl overflow-hidden w-full":e(m)||e(h),"max-w-[calc(100%_-_198px)]":e(m),"justify-start left-0.5":e(h),"justify-end xs:hidden":!e(h)}])},[l("div",gn,[e(v)?(a(),T(A,{key:0,editor:e(v),"embed-mode":"","is-form-field":e(_)},null,8,["editor","is-form-field"])):w("",!0)])],2)):w("",!0),e(v)&&!e(_)&&!e(h)?(a(),T(O,{key:1,editor:e(v)},null,8,["editor"])):w("",!0),e(L)?(a(),b(J,{key:2},[e(v)?(a(),T(N,{key:0,ref_key:"richTextLinkOptionRef",ref:q,editor:e(v),"is-form-field":e(_),onBlur:s[0]||(s[0]=ee=>i.value=!1)},null,8,["editor","is-form-field"])):w("",!0)],64)):w("",!0),r(e(Se),{ref_key:"editorDom",ref:R,editor:e(v),class:M(["flex flex-col nc-textarea-rich-editor w-full",{"mt-2.5 flex-grow":e(m),"scrollbar-thin scrollbar-thumb-gray-200 scrollbar-track-transparent":!e(m)||!e(m)&&e(d),"flex-grow":e(d),[`!overflow-hidden nc-truncate nc-line-clamp-${("rowHeightTruncateLines"in n?n.rowHeightTruncateLines:e(Re))(e($))}`]:!e(m)&&n.readOnly&&e($)&&!e(d)&&!e(h)}]),onKeydown:[s[1]||(s[1]=Y(()=>{},["alt","stop"])),s[2]||(s[2]=se(Y(()=>{},["alt","stop"]),["enter"])),s[3]||(s[3]=se(Y(()=>{},["shift","stop"]),["enter"]))]},null,8,["editor","class"]),e(_)&&!n.readOnly?(a(),b("div",yn,[l("div",{class:M(e(i)?"max-h-[50px]":"max-h-0"),style:{transition:"max-height 0.2s ease-in-out"}},[e(v)?(a(),T(A,{key:0,editor:e(v),"embed-mode":"","is-form-field":"","hidden-options":e(z)},null,8,["editor","hidden-options"])):w("",!0)],2)])):w("",!0)],64))],42,kn)}}});export{En as default};
