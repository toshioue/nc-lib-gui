const __vite__fileDeps=["./B2_HDijx.js","./DZZ6t_j4.js","./entry.DIDWwc7m.css","./BmNyaTYf.js","./Cy50pBgZ.js","./DKN1hQ6S.js","./BQuyMdA-.js","./BQQOEPN4.js","./vll-Pnjv.js","./B5RRVMt5.js","./DGj1ycqW.js","./DyDFI6NE.js","./links.C8uCzV-l.css","./C4K5fdHe.js","./Dwil3It4.js","./RichText.M7uMQ9pA.css","./BIhr-Z4C.js","./ByVBARmO.js","./VirtualCell.BYk4C8Tn.css","./DG2ZH8TR.js","./CA74dF2b.js","./GMLocJHP.js","./qW2V2r_p.js","./boyBAVNN.js","./BDAIZopQ.js","./Cell.DUBzJZSm.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{o as a,c as d,a as n,e as Je,h4 as et,ax as tt,r as h,az as Fe,h5 as st,f as B,h6 as ot,ac as N,g as at,h7 as nt,N as e,ao as Ce,dc as j,Q as k,R as c,t as l,b as r,cm as lt,w as m,d as v,a7 as it,W as rt,f$ as dt,S as T,c$ as ut,ce as mt,a8 as ct,dg as Te,O as ft,X as Q,Y as _t,Z as pt,$ as vt,h8 as yt,h9 as gt,a4 as W,_ as bt}from"./DZZ6t_j4.js";import{_ as ht,a as xt}from"./CEmZpw8Z.js";import kt from"./B9n4-CGo.js";import{_ as wt}from"./Bdv7ru7D.js";import{a as $t}from"./bNr_om_C.js";import{u as St}from"./DS_HXCWn.js";import{F as zt}from"./BYINaHrJ.js";import{_ as Ft}from"./CXD-Dj4T.js";import{_ as Ct}from"./dfem9Uc_.js";import"./RXURfzjs.js";import"./DQfemegE.js";import"./8DEek4Fb.js";import"./GMLocJHP.js";import"./qW2V2r_p.js";import"./ByVBARmO.js";import"./boyBAVNN.js";import"./BDAIZopQ.js";import"./CA74dF2b.js";import"./BCU2uY6p.js";import"./C3jLTHF4.js";import"./C4K5fdHe.js";import"./CMIIcM5i.js";import"./D9tFZoTQ.js";import"./vll-Pnjv.js";import"./BCJFTkwv.js";const Tt={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},At=n("path",{fill:"currentColor",d:"m9 18l-6-6l6-6l1.4 1.4L6.8 11H19V7h2v6H6.8l3.6 3.6z"},null,-1),Dt=[At];function Lt(f,I){return a(),d("svg",Tt,[...Dt])}const Vt={name:"material-symbols-keyboard-return",render:Lt},Rt={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Pt=n("path",{fill:"currentColor",d:"M15 18v-6h2.17L12 6.83L6.83 12H9v6zM12 4l10 10h-5v6H7v-6H2z"},null,-1),Mt=[Pt];function Bt(f,I){return a(),d("svg",Rt,[...Mt])}const Nt={name:"mdi-apple-keyboard-shift",render:Bt},jt=Q(()=>W(()=>import("./B2_HDijx.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]),import.meta.url).then(f=>f.default||f)),It=Q(()=>W(()=>import("./BIhr-Z4C.js"),__vite__mapDeps([16,1,2,17,13,18]),import.meta.url).then(f=>f.default||f)),qt=Q(()=>W(()=>import("./DG2ZH8TR.js"),__vite__mapDeps([19,1,2,20,21,22,17,23,24,13,25]),import.meta.url).then(f=>f.default||f)),Et={class:"h-full"},Ht={class:"survey md:p-0 w-full h-full flex flex-col max-w-[max(33%,688px)] mx-auto mb-4rem lg:mb-10rem"},Ot={key:0,class:"my-auto"},Ut={class:"rounded-3xl border-1 border-gray-200 p-6 lg:p-12 bg-white"},Gt={class:"text-2xl font-bold text-gray-900 mb-4","data-testid":"nc-survey-form__heading"},Kt={key:0,class:"flex flex-col justify-center items-center text-center"},Yt={key:1},Zt={key:0,class:"mt-16 w-full flex justify-between items-center flex-wrap gap-3"},Qt={key:0,class:"text-sm text-gray-500 dark:text-slate-300 m-0"},Wt={class:"flex-1 self-end flex justify-end"},Xt={key:0},Jt={class:"flex justify-end mt-12"},es={class:"flex items-center gap-3"},ts={class:"hidden md:flex text-sm items-center gap-1 text-gray-800"},ss={key:1,class:"px-6 lg:px-12"},os={class:"text-2xl font-bold text-gray-900 line-clamp-2 text-center mb-2rem md:mb-4rem"},as={class:"select-none text-gray-500 mb-4 md:mb-2","data-testid":"nc-survey-form__footer"},ns={key:0,class:"flex flex-col gap-2"},ls={class:"nc-form-column-label text-sm font-semibold text-gray-800","data-testid":"nc-form-column-label"},is={key:0,class:"text-red-500 text-base leading-[18px]"},rs={key:0,class:"nc-form-column-description text-gray-500 text-sm","data-testid":"nc-survey-form__field-description"},ds={class:"flex flex-col gap-2 text-slate-500 dark:text-slate-300 text-xs my-2 px-1"},us={key:0,class:"hidden text-sm text-gray-500 md:flex flex-wrap items-center"},ms={class:"ml-1 mt-4 flex w-full text-lg"},cs={class:"flex-1 flex justify-end"},fs={key:0},_s={key:1,class:"flex items-center gap-3"},ps={class:"md:absolute md:bottom-0 md:left-0 md:right-0 md:px-4 md:pb-4 lg:px-10 lg:pb-10"},vs={class:"flex justify-end items-center gap-4"},ys={class:"flex justify-center"},gs={key:0,class:"flex items-center gap-3"},bs={class:"text-lg font-bold"},hs={class:"mt-1 text-sm"},xs={class:"flex justify-end mt-7 gap-x-2"},ks=Je({__name:"survey",setup(f){const{md:I}=et(yt),{formState:$,formColumns:A,submitForm:Ae,submitted:y,secondsRemain:De,sharedFormView:u,sharedViewMeta:Le,onReset:Ve,validateInfos:X,validate:Re,clearValidate:Pe,isRequired:Me,handleAddMissingRequiredFieldDefaultState:Be,fieldMappings:w}=$t(),{isMobileMode:_}=tt(St()),q=h(!1),D=h("left"),E=h("arrow-right"),L=h(!1),g=h(!1),b=h(!1),H=h(),J=h();Fe(gt,H),Fe(st,h(!0));const V=B(()=>Le.value.transitionDuration||100),ee=B(()=>A.value?A.value.reduce((t,s)=>{const i=s.label||s.title;return i&&t.push(i),t},[]):[]),{index:te,goToPrevious:Ne,goToNext:je,isFirst:se,isLast:R,goTo:Ie}=ot(ee),o=B(()=>{var t;return(t=A.value)==null?void 0:t[te.value]}),P=B(()=>{var t,s;return(t=o.value)!=null&&t.title?((s=X[w.value[o.value.title]])==null?void 0:s.validateStatus)==="error":!1});function O(t){q.value=!0,D.value=t,setTimeout(()=>{D.value=D.value==="left"?"right":"left"},V.value/2),setTimeout(()=>{q.value=!1,setTimeout(G,100)},V.value)}function oe(t){E.value=t,L.value=!0,setTimeout(()=>{L.value=!1},V.value/2)}const M=async t=>{if(w.value[t]===void 0)return console.warn("Missing mapping field for:",t),!1;try{return await Re(w.value[t]),!0}catch{return!1}};async function S(t){var s;R.value||!g.value||y.value||b.value||!o.value||!o.value.title||(s=o.value)!=null&&s.title&&!await M(o.value.title)||(oe(t||"arrow-right"),setTimeout(()=>{O("left"),je()},t==="ok-button"?300:0))}async function U(t){se.value||!g.value||y.value||b.value||(oe(t||"arrow-left"),O("right"),Ne())}function G(){var t,s;if(document&&typeof document<"u"){const i=document.querySelector(".nc-cell input")||document.querySelector(".nc-cell textarea")||document.querySelector('.nc-cell [tabindex="0"]');i&&(J.value=i,(t=i==null?void 0:i.select)==null||t.call(i),(s=i==null?void 0:i.focus)==null||s.call(i))}}function ae(){Pe(),y.value=!1,g.value=!1,O("right"),Ie(ee.value[0])}async function ne(){y.value||(b.value=!1,Ae())}Ve(ae);const le=()=>{g.value=!0,Be(),setTimeout(()=>{G()},100)},qe=()=>{(document==null?void 0:document.activeElement)!==J.value&&G()},ie=async()=>{var t;(t=o.value)!=null&&t.title&&!await M(o.value.title)||(b.value=!0,setTimeout(()=>{var s,i;(s=document.querySelector('.nc-survery-form__confirmation_modal div[tabindex="0"]'))==null||s.focus(),(i=document.querySelector(".nc-survey-form-btn-submit.nc-button"))==null||i.focus()},50))};return N(["ArrowLeft","ArrowDown"],()=>{_.value||U("arrow-left")}),N(["ArrowRight","ArrowUp"],()=>{_.value||S("arrow-right")}),N(["Enter"],async t=>{if(!(_.value||y.value)){if(!g.value&&!y.value)le();else if(g.value)if(R.value)b.value?ne():(t.preventDefault(),ie());else{const s=document.activeElement;if(s!=null&&s.classList&&s.classList.contains("nc-survey-form__btn-next"))return;S("ok-button")}}}),N("Escape",()=>{var t,s;document&&((s=(t=document.activeElement)==null?void 0:t.blur)==null||s.call(t))}),at(()=>{if(!I.value){const{direction:t}=nt(H,{onSwipe:()=>{q.value||(t.value==="left"?S():t.value==="right"&&U())}})}}),(t,s)=>{var re,de,ue,me,ce,fe,_e,pe,ve,ye,ge;const i=ht,K=jt,Y=_t,Ee=Ft,x=pt,He=It,Oe=qt,Ue=kt,Ge=Ct,Ke=Nt,Ye=Vt,Ze=vt,Qe=zt,We=xt,Xe=wt;return a(),d("div",Et,[n("div",Ht,[e(u)?(a(),d("div",Ot,[!e(g)||e(y)?(a(),d(Ce,{key:0},[e(u)&&!("parseProp"in t?t.parseProp:e(j))((re=e(u))==null?void 0:re.meta).hide_banner?(a(),k(i,{key:0,"banner-image-url":e(u).banner_image_url,class:"flex-none mb-4"},null,8,["banner-image-url"])):c("",!0),n("div",Ut,[n("h1",Gt,l(e(u).heading),1),e(y)?(a(),d("div",Kt,[r(Ee,{class:"nc-survey-form__success-msg !p-4 !rounded-lg text-left w-full !bg-white !border-gray-200 !items-start",type:"success","data-testid":"nc-survey-form__success-msg",outlined:"","show-icon":""},lt({message:m(()=>{var p,z,F;return[(z=(p=e(u))==null?void 0:p.success_msg)!=null&&z.trim()?(a(),k(K,{key:0,value:(F=e(u))==null?void 0:F.success_msg,class:"!h-auto -ml-1","is-form-field":"","read-only":"","sync-value-change":""},null,8,["value"])):(a(),d("span",Yt,l(t.$t("msg.info.thankYou")),1))]}),icon:m(()=>[n("div",null,[r(Y,{icon:"circleCheck2",class:"text-[#27D665]"})])]),_:2},[(ue=(de=e(u))==null?void 0:de.success_msg)!=null&&ue.trim()?void 0:{name:"description",fn:m(()=>[v(l(t.$t("msg.info.submittedFormData")),1)]),key:"0"}]),1024),typeof((me=e(u))==null?void 0:me.redirect_url)!="string"&&(e(u).show_blank_form||e(u).submit_another_form)?(a(),d("div",Zt,[(ce=e(u))!=null&&ce.show_blank_form?(a(),d("p",Qt,l(t.$t("labels.newFormLoaded"))+" "+l(e(De))+" "+l(t.$t("general.seconds").toLowerCase()),1)):c("",!0),n("div",Wt,[(fe=e(u))!=null&&fe.submit_another_form?(a(),k(x,{key:0,type:"secondary",size:e(_)?"medium":"small","data-testid":"nc-survey-form__btn-submit-another-form",onClick:ae},{default:m(()=>[v(l(t.$t("activity.submitAnotherForm")),1)]),_:1},8,["size"])):c("",!0)])])):c("",!0)])):e(g)?c("",!0):(a(),d(Ce,{key:1},[(_e=e(u).subheading)!=null&&_e.trim()?(a(),d("div",Xt,[r(K,{value:e(u).subheading,class:"font-medium text-base text-gray-500 dark:text-slate-300 !h-auto mb-4 -ml-1","is-form-field":"","read-only":"","sync-value-change":"","data-testid":"nc-survey-form__sub-heading"},null,8,["value"])])):c("",!0),n("div",Jt,[n("div",es,[n("div",ts,[n("span",null,l(t.$t("labels.pressEnter"))+" ↵ ",1)]),r(x,{size:e(_)?"medium":"small","data-testid":"nc-survey-form__fill-form-btn",onClick:s[0]||(s[0]=p=>le())},{default:m(()=>s[10]||(s[10]=[v(" Fill Form ")])),_:1},8,["size"])])])],64))])],64)):(a(),d("div",ss,[n("h1",os,l(e(u).heading),1)])),e(g)&&!e(y)?(a(),k(mt,{key:2,name:`slide-${e(D)}`,duration:e(V),mode:"out-in"},{default:m(()=>[r(Qe,{model:e($)},{default:m(()=>{var p,z,F,be,he;return[(a(),d("div",{ref_key:"el",ref:H,key:(p=e(o))==null?void 0:p.title,class:"flex flex-col gap-4 w-full m-auto rounded-xl border-1 border-gray-200 bg-white p-6 lg:p-12"},[n("div",as,l(e(te)+1)+" / "+l((z=e(A))==null?void 0:z.length),1),e(o)?(a(),d("div",ns,[n("div",ls,[n("span",null,l(e(o).label||e(o).title),1),e(Me)(e(o))?(a(),d("span",is," *")):c("",!0)]),(F=e(o))!=null&&F.description?(a(),d("div",rs,[r(K,{value:(be=e(o))==null?void 0:be.description,class:"!h-auto -ml-1","is-form-field":"","read-only":"","sync-value-change":""},null,8,["value"])])):c("",!0),r(Ze,{disabled:!((he=e(o))!=null&&he.read_only)},{title:m(()=>[v(l(t.$t("activity.preFilledFields.lockedFieldTooltip")),1)]),default:m(()=>[e(o).title&&e(w)[e(o).title]?(a(),k(Ge,it({key:0,name:e(w)[e(o).title],class:"!my-0 nc-input-required-error"},e(X)[e(w)[e(o).title]]),{default:m(()=>[r(Ue,{class:"relative nc-form-data-cell",onClick:rt(qe,["stop"])},{default:m(()=>{var Z,xe,ke,we,$e,Se,ze;return[e(dt)(e(o))?(a(),k(He,{key:0,modelValue:e($)[e(o).title],"onUpdate:modelValue":[s[1]||(s[1]=C=>e($)[e(o).title]=C),s[2]||(s[2]=C=>M(e(o).title))],class:T(["mt-0 nc-input h-auto",{readonly:(Z=e(o))==null?void 0:Z.read_only}]),row:{row:{},oldRow:{},rowMeta:{}},"data-testid":`nc-survey-form__input-${e(o).title.replaceAll(" ","")}`,column:e(o),"read-only":(xe=e(o))==null?void 0:xe.read_only},null,8,["modelValue","class","data-testid","column","read-only"])):(a(),k(Oe,{key:1,modelValue:e($)[e(o).title],"onUpdate:modelValue":[s[3]||(s[3]=C=>e($)[e(o).title]=C),s[4]||(s[4]=C=>M(e(o).title))],class:T(["nc-input h-auto",{"layout-list":(we=("parseProp"in t?t.parseProp:e(j))((ke=e(o))==null?void 0:ke.meta))==null?void 0:we.isList,readonly:($e=e(o))==null?void 0:$e.read_only}]),"data-testid":`nc-survey-form__input-${e(o).title.replaceAll(" ","")}`,column:e(o),"edit-enabled":!((Se=e(o))!=null&&Se.read_only),"read-only":(ze=e(o))==null?void 0:ze.read_only},null,8,["modelValue","class","data-testid","column","edit-enabled","read-only"]))]}),_:1})]),_:1},16,["name"])):c("",!0),n("div",ds,[e(o).uidt===e(ut).LongText?(a(),d("div",us,[v(l(t.$t("general.shift"))+" ",1),r(Ke,{class:"mx-1 text-primary"}),v(" + "+l(t.$t("general.enter"))+" ",1),r(Ye,{class:"mx-1 text-primary"}),v(" "+l(t.$t("msg.info.makeLineBreak")),1)])):c("",!0)])]),_:1},8,["disabled"])])):c("",!0),n("div",ms,[n("div",cs,[e(R)?(a(),d("div",fs,[r(x,{size:e(_)?"medium":"small",class:T(e(E)==="submit-button"&&e(L)?"transform translate-y-[1px] translate-x-[1px] ring ring-accent ring-opacity-100":""),disabled:e(P),"data-testid":"nc-survey-form__btn-submit-confirm",onClick:ie},{default:m(()=>[v(l(t.$t("general.submit"))+" form ",1)]),_:1},8,["size","class","disabled"])])):(a(),d("div",_s,[n("div",{class:T(["hidden md:flex text-sm items-center gap-1",e(P)?"text-gray-200":"text-gray-800"])},[n("span",null,l(t.$t("labels.pressEnter"))+" ↵ ",1)],2),r(x,{size:e(_)?"medium":"small","data-testid":"nc-survey-form__btn-next",class:T(["nc-survey-form__btn-next",[e(E)==="ok-button"&&e(L)?"transform translate-y-[2px] translate-x-[2px] !after:ring !after:ring-accent !after:ring-opacity-100":""]]),disabled:e(P),onClick:s[5]||(s[5]=Z=>S())},{default:m(()=>[v(l(t.$t("labels.next")),1)]),_:1},8,["size","class","disabled"])]))])])]))]}),_:1},8,["model"])]),_:1},8,["name","duration"])):c("",!0)])):c("",!0),n("div",ps,[n("div",vs,[n("div",ys,[r(We,{class:"inline-flex mx-auto",style:ct({color:e(Te).isReadable(((ve=("parseProp"in t?t.parseProp:e(j))((pe=e(u))==null?void 0:pe.meta))==null?void 0:ve.background_color)||"#F9F9FA","#D5D5D9",{level:"AA",size:"large"})?"#fff":e(Te).mostReadable(((ge=("parseProp"in t?t.parseProp:e(j))((ye=e(u))==null?void 0:ye.meta))==null?void 0:ge.background_color)||"#F9F9FA",["#374151","#D5D5D9"]).toHex8String()})},null,8,["style"])]),e(g)&&!e(y)?(a(),d("div",gs,[r(x,{type:"secondary",size:e(_)?"medium":"small","data-testid":"nc-survey-form__icon-prev",disabled:e(se),onClick:s[6]||(s[6]=p=>U())},{default:m(()=>[r(Y,{icon:"ncArrowLeft"})]),_:1},8,["size","disabled"]),r(x,{size:e(_)?"medium":"small",type:"secondary","data-testid":"nc-survey-form__icon-next",disabled:e(R)||e(P),onClick:s[7]||(s[7]=p=>S())},{default:m(()=>[r(Y,{icon:"ncArrowRight"})]),_:1},8,["size","disabled"])])):c("",!0)])])]),r(Xe,{visible:e(b),"onUpdate:visible":s[9]||(s[9]=p=>ft(b)?b.value=p:null),size:"small",class:"nc-survery-form__confirmation_modal"},{default:m(()=>[n("div",null,[n("div",bs,l(t.$t("general.submit"))+" "+l(t.$t("objects.viewType.form")),1),n("div",hs,l(t.$t("title.surveyFormSubmitConfirmMsg")),1),n("div",xs,[r(x,{type:"secondary",size:e(_)?"medium":"small",onClick:s[8]||(s[8]=p=>b.value=!1)},{default:m(()=>[v(l(t.$t("general.back")),1)]),_:1},8,["size"]),r(x,{type:"primary",size:e(_)?"medium":"small","data-testid":"nc-survey-form__btn-submit",class:"nc-survey-form-btn-submit",onClick:ne},{default:m(()=>[v(l(t.$t("general.submit")),1)]),_:1},8,["size"])])])]),_:1},8,["visible"])])}}}),Ys=bt(ks,[["__scopeId","data-v-917250fd"]]);export{Ys as default};
