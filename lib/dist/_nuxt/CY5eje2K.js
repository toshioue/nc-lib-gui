import{f as U,ar as V,ai as q,N as B,r as F,at as M,o as g,c as v,b as s,w as t,a as l,t as f,cg as N,P as r,d as y,T as k,S as j,V as z,W as T,aj as E,B as G,$ as I,aV as S}from"./3QBYHahY.js";import{_ as D}from"./DEDKhbvL.js";import{_ as W}from"./CIDCbbCH.js";import{F as A}from"./DAKhk9t6.js";import{_ as H}from"./ceYq-xax.js";import{_ as L}from"./Bk0xUMNV.js";import"./wEQwkVjR.js";import"./xnDaHwV-.js";import"./CmN9vPg3.js";import"./BQQOEPN4.js";import"./CGxepfeV.js";const O={class:"flex flex-col"},J={"data-rec":"true"},K={class:"nc-content-max-w p-6 h-[calc(100vh_-_100px)] flex flex-col gap-6 overflow-auto nc-scrollbar-thin"},Q={class:"mx-auto relative flex flex-col justify-start gap-2 w-full md:bg-white max-w-[900px]"},X={key:0,class:"mx-auto mb-4 bg-red-500 text-white rounded-lg w-3/4 p-1"},Y={"data-testid":"nc-user-settings-form__error",class:"flex items-center gap-2 justify-center","data-rec":"true"},Z={class:"text-right"},ee={class:"flex justify-center items-center gap-2","data-rec":"true"},me=U({__name:"ResetPassword",setup(se){const{api:R,error:d}=V({useGlobalInstance:!0}),{t:o}=q(),{signOut:b}=B(),h=F(),a=M({currentPassword:"",password:"",passwordRepeat:""}),p={currentPassword:[{required:!0,message:o("msg.error.signUpRules.passwdRequired")}],password:[{required:!0,message:o("msg.error.signUpRules.passwdRequired")},{min:8,message:o("msg.error.signUpRules.passwdLength")}],passwordRepeat:[{required:!0,message:o("msg.error.signUpRules.passwdRequired")},{validator:(e,n)=>new Promise((u,m)=>{if(a.password===a.passwordRepeat)return u(!0);m(new Error(o("msg.error.signUpRules.passwdMismatch")))}),message:o("msg.error.signUpRules.passwdMismatch")}]},x=async()=>{h.value.validate()&&(d.value=null,await R.auth.passwordChange({currentPassword:a.currentPassword,newPassword:a.password}),E.success(o("msg.success.passwordChanged")),await b(),await G("/signin"))},c=()=>{d.value&&(d.value=null)};return(e,n)=>{const u=I,m=D,P=W,w=H,_=L,$=S,C=A;return g(),v("div",O,[s(m,null,{icon:t(()=>[s(u,{icon:"passwordChange",class:"flex-none text-gray-700 text-[20px] h-5 w-5"})]),title:t(()=>[l("span",J,f(e.$t("activity.changePwd")),1)]),_:1}),l("div",K,[l("div",Q,[s(C,{ref_key:"formValidator",ref:h,"data-testid":"nc-user-settings-form",layout:"vertical",class:"change-password lg:max-w-3/4 w-full","no-style":"",model:r(a),onFinish:x},{default:t(()=>[s(N,{name:"layout"},{default:t(()=>[r(d)?(g(),v("div",X,[l("div",Y,[s(P),y(" "+f(r(d)),1)])])):k("",!0)]),_:1}),s(_,{label:e.$t("placeholder.password.current"),"data-rec":"true",name:"currentPassword",rules:p.currentPassword},{default:t(()=>[s(w,{value:r(a).currentPassword,"onUpdate:value":n[0]||(n[0]=i=>r(a).currentPassword=i),"data-testid":"nc-user-settings-form__current-password",size:"large",class:"password",placeholder:e.$t("placeholder.password.current"),onFocus:c},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),s(_,{label:e.$t("placeholder.password.new"),"data-rec":"true",name:"password",rules:p.password},{default:t(()=>[s(w,{value:r(a).password,"onUpdate:value":n[1]||(n[1]=i=>r(a).password=i),"data-testid":"nc-user-settings-form__new-password",size:"large",class:"password",placeholder:e.$t("placeholder.password.new"),onFocus:c},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),s(_,{label:e.$t("placeholder.password.confirm"),"data-rec":"true",name:"passwordRepeat",rules:p.passwordRepeat},{default:t(()=>[s(w,{value:r(a).passwordRepeat,"onUpdate:value":n[2]||(n[2]=i=>r(a).passwordRepeat=i),"data-testid":"nc-user-settings-form__new-password-repeat",size:"large",class:"password",placeholder:e.$t("placeholder.password.confirm"),onFocus:c},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),l("div",Z,[s($,{size:"middle","data-testid":"nc-user-settings-form__submit",class:"!rounded-md !h-[2.5rem]",type:"primary","html-type":"submit"},{default:t(()=>[l("div",ee,[(g(),j(z(("iconMap"in e?e.iconMap:r(T)).passwordChange))),y(" "+f(e.$t("activity.changePwd")),1)])]),_:1})])]),_:1},8,["model"])])])])}}});export{me as default};
