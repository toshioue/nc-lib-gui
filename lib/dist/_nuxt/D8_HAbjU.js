const __vite__fileDeps=["./D9nJWJUA.js","./3QBYHahY.js","./entry.Ic44fwRn.css","./Bczc_1bi.js","./Cy50pBgZ.js","./kHOslGNR.js","./CmN9vPg3.js","./BQQOEPN4.js","./xnDaHwV-.js","./DPgYHC40.js","./BsWDDIqE.js","./ceYq-xax.js","./links.C8uCzV-l.css","./D4iSzjWt.js","./Dwil3It4.js","./RichText.M7uMQ9pA.css","./DWGVxFka.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{f as ue,bN as c,fP as de,r as a,aE as pe,hG as me,hJ as ce,aF as ve,hK as fe,hL as ye,hM as xe,hq as ge,N as we,ad as he,gU as be,g as G,H as N,af as Ee,o as u,c as g,a as I,P as e,U as w,b as M,Q as C,aa as P,aL as v,R as ke,dm as _e,Y as m,t as S,S as R,w as U,d as Le,V as Te,W as Ce,T as A,Z as J,a6 as Q,a0 as He,a1 as Ie,cc as Me,_ as Re}from"./3QBYHahY.js";import $e from"./CtMydB5S.js";import{B as $}from"./D4iSzjWt.js";import{_ as Ve}from"./BsWDDIqE.js";import"./CmN9vPg3.js";import"./BQQOEPN4.js";import"./xnDaHwV-.js";const ze=J(()=>Q(()=>import("./D9nJWJUA.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]),import.meta.url).then(h=>h.default||h)),je=J(()=>Q(()=>import("./DWGVxFka.js"),__vite__mapDeps([16,1,2]),import.meta.url).then(h=>h.default||h)),Be={key:0,class:"w-full"},Ne=["rows","disabled"],Pe={key:3,class:"nc-null uppercase"},Se={key:5},Ue={class:"flex max-w-38"},Ke={class:"truncate"},De={key:1,class:"p-3 pb-0 h-full"},Oe=ue({__name:"TextArea",props:{modelValue:{},isFocus:{type:Boolean},virtual:{type:Boolean}},emits:["update:modelValue"],setup(h,{emit:Z}){const Y=h,ee=Z,d=c(de),E=c(pe,a(!1)),H=c(me,a(!1)),p=c(ce,a(1)),l=c(ve,a(!1)),K=c(fe,a(!1)),te=c(ye,a(!1)),ne=c(xe,a(!1)),y=c(ge,a(!1)),{showNull:oe}=we(),o=he(Y,"modelValue",ee,{shouldEmit:()=>!y.value}),r=c(be,a(!1)),x=a(),k=a(),_=a(!1),le=t=>!r.value&&!H.value&&!l.value&&(t==null?void 0:t.focus()),D=G(()=>r.value?36*4:!p.value||p.value===1||H.value?36:p.value*36),L=G(()=>y.value&&!r.value&&(te.value||ne.value)?6:p.value),s=a(!1),O=a(null),q=a(null);N(s,()=>{s.value&&setTimeout(()=>{var t;(t=q.value)==null||t.focus()},100)}),Ee(O,t=>{var n;(n=t.target)!=null&&n.className.includes("nc-long-text-toggle-expand")||(s.value=!1)});const ae=()=>{Y.virtual&&(s.value=!0,E.value=!0)},V=G(()=>{var n,f,b;let t={};return typeof((n=d==null?void 0:d.value)==null?void 0:n.meta)=="string"?t=JSON.parse((f=d==null?void 0:d.value)==null?void 0:f.meta):t=((b=d==null?void 0:d.value)==null?void 0:b.meta)??{},t==null?void 0:t.richMode}),F=()=>{s.value=!0},W=t=>{var n,f,b,z,j,B;_.value&&(t.stopPropagation(),x.value={top:t.clientY-(((n=k.value)==null?void 0:n.top)||0)>0?t.clientY-(((f=k.value)==null?void 0:f.top)||0):((b=x.value)==null?void 0:b.top)||0,left:t.clientX-(((z=k.value)==null?void 0:z.left)||0)>-16?t.clientX-(((j=k.value)==null?void 0:j.left)||0):((B=x.value)==null?void 0:B.left)||0})},X=t=>{_.value&&(t.stopPropagation(),_.value=!1,x.value=void 0,k.value=void 0,document.removeEventListener("mousemove",W),document.removeEventListener("mouseup",X))};N(x,()=>{const t=document.querySelector(".nc-long-text-expanded-modal .ant-modal-content");!t||!x.value||(t.style.transform="none",t.style.left=`${x.value.left}px`,t.style.top=`${x.value.top}px`)},{deep:!0});const se=t=>{if(H.value)return;const n=document.querySelector(".nc-long-text-expanded-modal .ant-modal-content");k.value={top:t.clientY-n.getBoundingClientRect().top,left:t.clientX-n.getBoundingClientRect().left+16},document.addEventListener("mousemove",W),document.addEventListener("mouseup",X),_.value=!0};N(E,()=>{E.value&&V.value&&(s.value=!0)});const T=t=>{t.stopPropagation()};return N(O,()=>{if(!H.value)return;const t=document.querySelector(".nc-long-text-expanded-modal");s.value&&(t!=null&&t.parentElement)?(t.parentElement.addEventListener("click",T),t.parentElement.addEventListener("mousedown",T),t.parentElement.addEventListener("mouseup",T)):t!=null&&t.parentElement&&(t.parentElement.removeEventListener("click",T),t.parentElement.removeEventListener("mousedown",T),t.parentElement.removeEventListener("mouseup",T))}),(t,n)=>{const f=ze,b=je,z=He,j=Ie,B=$e,re=Ve,ie=Me;return u(),g("div",null,[I("div",{class:w(["flex flex-row w-full long-text-wrapper",{"min-h-10":e(p)!==1||e(r),"min-h-5.5":e(p)===1&&!e(r),"h-full w-full":e(l)}])},[e(l)&&e(V)?(u(),g("div",Be,[I("div",{class:w(["w-full relative w-full px-0",{"pt-11":!e(y)}])},[M(f,{value:e(o),"onUpdate:value":n[0]||(n[0]=i=>C(o)?o.value=i:null),class:w({"border-t-1 border-gray-100 allow-vertical-resize":!e(y)}),autofocus:!1,"show-menu":"","read-only":e(y)},null,8,["value","class","read-only"])],2)])):e(V)?(u(),g("div",{key:1,class:w(["w-full cursor-pointer nc-readonly-rich-text-wrapper",{"nc-readonly-rich-text-grid ":!e(r)&&!e(l),"nc-readonly-rich-text-sort-height":e(L)===1&&!e(r)&&!e(l)}]),style:P({maxHeight:e(l)?void 0:e(r)?`${e(D)}px`:`${21*("rowHeightTruncateLines"in t?t.rowHeightTruncateLines:e($))(e(L))}px`,minHeight:e(l)?void 0:e(r)?`${e(D)}px`:`${21*("rowHeightTruncateLines"in t?t.rowHeightTruncateLines:e($))(e(L))}px`}),onDblclick:F,onKeydown:v(F,["enter"])},[M(f,{value:e(o),"onUpdate:value":n[1]||(n[1]=i=>C(o)?o.value=i:null),"sync-value-change":"","read-only":""},null,8,["value"])],38)):e(E)&&!e(s)||e(l)?ke((u(),g("textarea",{key:2,ref:le,"onUpdate:modelValue":n[2]||(n[2]=i=>C(o)?o.value=i:null),rows:e(l)?5:4,class:w(["h-full w-full outline-none border-none nc-longtext-scrollbar",{"p-2":e(E),"py-1 h-full":e(l),"px-2":e(r)}]),style:P({minHeight:e(l)?"117px":`${e(D)}px`,maxHeight:"min(800px, calc(100vh - 200px))"}),disabled:e(y),onBlur:n[3]||(n[3]=i=>E.value=!1),onKeydown:[n[4]||(n[4]=v(m(()=>{},["alt","stop"]),["enter"])),n[5]||(n[5]=v(m(()=>{},["shift","stop"]),["enter"])),n[6]||(n[6]=v(m(()=>{},["stop"]),["down"])),n[7]||(n[7]=v(m(()=>{},["stop"]),["left"])),n[8]||(n[8]=v(m(()=>{},["stop"]),["right"])),n[9]||(n[9]=v(m(()=>{},["stop"]),["up"])),n[10]||(n[10]=v(m(()=>{},["stop"]),["delete"]))],onSelectstartCapture:n[11]||(n[11]=m(()=>{},["stop"])),onMousedown:n[12]||(n[12]=m(()=>{},["stop"]))},null,46,Ne)),[[_e,e(o)]]):e(o)===null&&e(oe)?(u(),g("span",Pe,S(t.$t("general.null")),1)):e(p)?(u(),R(b,{key:4,value:e(o),lines:("rowHeightTruncateLines"in t?t.rowHeightTruncateLines:e($))(e(L)),class:"nc-text-area-clamped-text",style:P({"word-break":"break-word","max-height":`${25*("rowHeightTruncateLines"in t?t.rowHeightTruncateLines:e($))(e(L))}px`,"my-auto":("rowHeightTruncateLines"in t?t.rowHeightTruncateLines:e($))(e(L))===1}),onClick:ae},null,8,["value","lines","style"])):(u(),g("span",Se,S(e(o)),1)),!e(s)&&!e(l)?(u(),R(j,{key:6,placement:"bottom",class:w(["nc-action-icon !absolute !hidden nc-text-area-expand-btn group-hover:block z-3",{"right-1":e(l),"right-0":!e(l),"top-0":e(K)&&!e(r)&&!e(l)&&!(!e(p)||e(p)===1),"top-1":!(e(K)&&!e(r)&&!e(l))}]),style:P(e(K)&&!e(r)&&!e(l)&&(!e(p)||e(p)===1)?{top:"50%",transform:"translateY(-50%)"}:void 0)},{title:U(()=>[Le(S(t.$t("title.expand")),1)]),default:U(()=>[M(z,{type:"secondary",size:"xsmall","data-testid":"attachment-cell-file-picker-button",class:"!p-0 !w-5 !h-5 !min-w-[fit-content]",onClick:m(F,["stop"])},{default:U(()=>[(u(),R(Te(("iconMap"in t?t.iconMap:e(Ce)).expand),{class:"transform !group-hover:text-grey-800 text-gray-700 text-xs"}))]),_:1})]),_:1},8,["class","style"])):A("",!0)],2),e(s)?(u(),R(ie,{key:0,visible:e(s),"onUpdate:visible":n[17]||(n[17]=i=>C(s)?s.value=i:null),closable:!1,footer:null,"wrap-class-name":"nc-long-text-expanded-modal",mask:!0,"mask-closable":!1,"mask-style":{zIndex:1051},"z-index":1052},{default:U(()=>[I("div",{ref_key:"inputWrapperRef",ref:O,class:w(["flex flex-col py-3 w-full expanded-cell-input relative",{"cursor-move":e(_)}]),onKeydown:n[16]||(n[16]=v(m(()=>{},["stop"]),["enter"]))},[e(d)?(u(),g("div",{key:0,class:w(["flex flex-row gap-x-1 items-center font-medium pl-3 pb-2.5 border-b-1 border-gray-100 overflow-hidden",{"select-none":e(_),"cursor-move":!e(H)}]),onMousedown:se},[M(B,{class:"flex"}),I("div",Ue,[I("span",Ke,S(e(d).title),1)])],34)):A("",!0),e(V)?(u(),R(f,{key:2,value:e(o),"onUpdate:value":n[15]||(n[15]=i=>C(o)?o.value=i:null),"show-menu":"","full-mode":"","read-only":e(y)},null,8,["value","read-only"])):(u(),g("div",De,[M(re,{ref_key:"inputRef",ref:q,value:e(o),"onUpdate:value":n[13]||(n[13]=i=>C(o)?o.value=i:null),class:"nc-text-area-expanded !py-1 !px-3 !text-black !cursor-text !min-h-[210px] !rounded-lg focus:border-brand-500 disabled:!bg-gray-50 nc-longtext-scrollbar",placeholder:t.$t("activity.enterText"),style:{resize:"both"},disabled:e(y),onKeydown:n[14]||(n[14]=v(i=>s.value=!1,["escape"]))},null,8,["value","placeholder","disabled"])]))],34)]),_:1},8,["visible"])):A("",!0)])}}}),Je=Re(Oe,[["__scopeId","data-v-11052f39"]]);export{Je as default};
