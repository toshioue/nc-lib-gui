const __vite__fileDeps=["./CF2HExrO.js","./Cgw6cdOy.js","./entry.DxI7QTvq.css","./DGBAbsZ-.js","./Cy50pBgZ.js","./Bcy-XIkn.js","./DPaOlBFV.js","./BQQOEPN4.js","./hvq8FVej.js","./C8c9012h.js","./BIsWr_mR.js","./BZz6iAla.js","./links.C8uCzV-l.css","./BBXMuneh.js","./Dwil3It4.js","./RichText.M7uMQ9pA.css","./DXof0zKo.js","./D51uA4Lq.js","./DpDIhxXu.js","./VirtualCell.BYk4C8Tn.css","./DQfYvTkb.js","./r2PN1Hfg.js","./CO8XXsKl.js","./vIgbYHAs.js","./boyBAVNN.js","./D7yS5JAk.js","./Cell.DUBzJZSm.css","./H9SMaBKT.js","./DivDataCell.1yCNpUg3.css","./CCQiMKiG.js","./Dn4WscrN.js","./JP8ePeTV.js","./S1x-kZdE.js","./DeleteModal.SEMJ_gSK.css","./DuIfwTrz.js","./C0xV_Bo1.js","./Cj4l15BV.js","./Dqwep-0C.js","./ChdiWx0E.js","./CiTH7PYd.js","./DCaZaUH5.js","./DpYA1Dpy.js","./dmcxUY_0.js","./BcZAlRJW.js","./LSbsNkd9.js","./F-dFAGVG.js","./tqKkZMzS.js","./BRorwQ1i.js","./SelectOptions.JaHDUZhn.css","./Dzlf0Q89.js","./toggleHighContrast.wojAGmRG.css","./Dxcud087.js","./DCR3b-PJ.js","./DBJzESM9.js","./D8rpj5Lr.js","./BohSct8s.js","./D933wnC7.js","./CgtJdY-6.js","./DQEz7g1o.js","./BiBN5Lxt.js","./Switch.CEh6YzqD.css","./BttyO-T4.js","./CitraFSq.js","./CAuyt8bq.js","./Tabs.DaLSLYpn.css","./BcpeJQoi.js","./C9Sjn86N.js","./CpJUN2HL.js","./BLvTi2Ht.js","./CJBRTPd8.js","./Select.C8Fy0-eI.css","./5xpACL64.js","./ListWithSearch.PmKyjXoQ.css","./Dsqwjc9N.js","./P9ghmVPN.js","./ahvdY77A.js","./index.E0_BHHK8.css","./VVwMOds3.js","./Ciml79M9.js","./DbRkwnd8.js","./EditOrAddProvider.K7iYHan9.css","./D1QYX3xc.js","./Byr5kx_z.js","./BcWX645D.js","./CrGEZ_O2.js","./GgEYsA5W.js","./DBOeGHNL.js","./MenuItem.C7h59s4s.css","./Bxm040c6.js","./Menu.CQ8GNWeI.css","./BPLrYayE.js","./WttlrBnq.js","./DFiWgQ57.js","./KNudlHpk.js","./Cw6_lRNR.js","./Badge.D0-UrqG9.css","./DvfxijkH.js","./OF3g5mdA.js","./splitpanes.Ckqx9aWT.css","./CrH1vpRf.js","./B1jnz4_u.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{o as v,S as A,a8 as Me,q as ke,b as x,w as R,aq as Fe,av as Li,V as _e,R as He,aH as Ki,a9 as St,Y as le,T as O,f as Mt,cY as go,ad as Ji,ar as vo,r as F,H as Ge,a as g,P as l,c as B,d as se,Q as Le,a0 as ni,$ as en,p as tn,e as nn,aj as Ze,ak as oi,_ as si,bc as bo,bN as Ae,gD as on,da as sn,d9 as an,db as rn,aB as Yt,fQ as wo,ai,cZ as ln,g as me,W as Qe,t as $,d2 as j,b1 as Ct,ag as cn,A as ri,hk as yo,az as Xt,aa as Gt,df as Te,dK as dn,dd as Zt,fs as Rt,fR as ct,aF as _o,hM as xo,hI as lt,N as zo,L as Co,cN as Ro,dB as Ao,cR as So,gg as ko,io as Mo,fP as Ue,i as Eo,gF as $o,d7 as Io,aG as Bi,aM as Do,O as To,X as Pi,U as Ce,aL as Oo,co as Fo,g3 as Lo,Z as Ee,a6 as $e,dj as Bo,gL as Po,aN as Wo,a1 as jo,ft as Vo}from"./Cgw6cdOy.js";import{_ as Uo,a as Ho}from"./Byr5kx_z.js";import{_ as No}from"./ahvdY77A.js";import qo from"./Cj4l15BV.js";import Yo from"./Dqwep-0C.js";import{_ as Xo}from"./DBOeGHNL.js";import{_ as Go}from"./Bxm040c6.js";import{_ as Zo,a as Qo}from"./BPLrYayE.js";import{a as Ko}from"./DFiWgQ57.js";import{k as Jo,i as Wi,e as es}from"./D7yS5JAk.js";import{_ as hn}from"./VVwMOds3.js";import{_ as ts}from"./Cw6_lRNR.js";import{u as is}from"./DvfxijkH.js";import{g as kt,M as un}from"./OF3g5mdA.js";import{u as ns}from"./BcWX645D.js";import{a as os}from"./CrH1vpRf.js";import{u as ss}from"./CO8XXsKl.js";import{g as as,e as rs,r as ls}from"./B1jnz4_u.js";import{F as mn}from"./DpYA1Dpy.js";import{a as cs}from"./BcpeJQoi.js";import{u as ds}from"./r2PN1Hfg.js";import{i as hs}from"./BBXMuneh.js";import{D as ji}from"./tqKkZMzS.js";import"./Bcy-XIkn.js";import{I as us}from"./DPaOlBFV.js";import{_ as ms}from"./CpJUN2HL.js";import{_ as fs}from"./BIsWr_mR.js";import{_ as ps}from"./dmcxUY_0.js";import{_ as gs}from"./BiBN5Lxt.js";function Vi(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),i.push.apply(i,o)}return i}function L(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Vi(Object(i),!0).forEach(function(o){pe(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Vi(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function pe(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function vs(e,t){if(e==null)return{};var i,o,s=function(r,c){if(r==null)return{};var a,u,m={},f=Object.keys(r);for(u=0;u<f.length;u++)a=f[u],c.indexOf(a)>=0||(m[a]=r[a]);return m}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(o=0;o<n.length;o++)i=n[o],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(s[i]=e[i])}return s}function Ne(e){return function(t){if(Array.isArray(t))return jt(t)}(e)||function(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}(e)||function(t,i){if(t){if(typeof t=="string")return jt(t,i);var o=Object.prototype.toString.call(t).slice(8,-1);if(o==="Object"&&t.constructor&&(o=t.constructor.name),o==="Map"||o==="Set")return Array.from(t);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return jt(t,i)}}(e)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function jt(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,o=new Array(t);i<t;i++)o[i]=e[i];return o}var Ui,bs,wt,X=(Ui=function(e){/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(){var t={}.hasOwnProperty;function i(){for(var o=[],s=0;s<arguments.length;s++){var n=arguments[s];if(n){var r=typeof n;if(r==="string"||r==="number")o.push(n);else if(Array.isArray(n)){if(n.length){var c=i.apply(null,n);c&&o.push(c)}}else if(r==="object")if(n.toString===Object.prototype.toString)for(var a in n)t.call(n,a)&&n[a]&&o.push(a);else o.push(n.toString())}}return o.join(" ")}e.exports?(i.default=i,e.exports=i):window.classNames=i})()},Ui(wt={path:bs,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(t==null&&wt.path)}},wt.exports),wt.exports),be=function(e){return function(t,i){if(!t)return e;var o;typeof t=="string"?o=t:i=t;var s=e;return o&&(s+="__"+o),s+(i?Object.keys(i).reduce(function(n,r){var c=i[r];return c&&(n+=" "+(typeof c=="boolean"?s+"--"+r:s+"--"+r+"_"+c)),n},""):"")}};function Qt(e,t,i){var o,s,n,r,c;function a(){var m=Date.now()-r;m<t&&m>=0?o=setTimeout(a,t-m):(o=null,i||(c=e.apply(n,s),n=s=null))}t==null&&(t=100);var u=function(){n=this,s=arguments,r=Date.now();var m=i&&!o;return o||(o=setTimeout(a,t)),m&&(c=e.apply(n,s),n=s=null),c};return u.clear=function(){o&&(clearTimeout(o),o=null)},u.flush=function(){o&&(c=e.apply(n,s),n=s=null,clearTimeout(o),o=null)},u}Qt.debounce=Qt;var Kt=Qt,M=function(){return M=Object.assign||function(e){for(var t,i=1,o=arguments.length;i<o;i++)for(var s in t=arguments[i])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},M.apply(this,arguments)};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function fn(e,t){var i,o;return e&&t?(i=""+e+t[0].toUpperCase()+t.slice(1),o=e+"-"+t):(i=e||t,o=e||t),{name:i,classname:o}}function pn(e){return/^blob:/.test(e)}function Hi(e){return pn(e)||function(t){return/^data:/.test(t)}(e)}function Xe(e){return!!(e&&e.constructor&&e.call&&e.apply)}function Q(e){return e===void 0}function At(e){return typeof e=="object"&&e!==null}function Jt(e,t,i){var o={};return At(e)?(Object.keys(t).forEach(function(s){Q(e[s])?o[s]=t[s]:At(t[s])?At(e[s])?o[s]=Jt(e[s],t[s],i[s]):o[s]=e[s]?t[s]:i[s]:t[s]===!0||t[s]===!1?o[s]=!!e[s]:o[s]=e[s]}),o):e?t:i}function yt(e){var t=Number(e);return Number.isNaN(t)?e:t}function Ni(e){return typeof(e=="number"||function(t){return typeof t=="object"&&t!==null}(e)&&toString.call(e)=="[object Number]")&&!gn(e)}function gn(e){return e!=e}function vn(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}var dt=function(e,t){e===void 0&&(e={}),t===void 0&&(t={}),this.type="manipulateImage",this.move=e,this.scale=t},ws=function(e,t){t===void 0&&(t={}),this.type="resize",this.directions=e,this.params=t},li=function(e){this.type="move",this.directions=e},ys=function(){function e(t,i,o,s,n){this.type="drag",this.nativeEvent=t,this.position=o,this.previousPosition=s,this.element=i,this.anchor=n}return e.prototype.shift=function(){var t=this,i=t.element,o=t.anchor,s=t.position;if(i){var n=i.getBoundingClientRect(),r=n.left,c=n.top;return{left:s.left-r-o.left,top:s.top-c-o.top}}return{left:0,top:0}},e}(),ci={name:"DraggableElement",props:{classname:{type:String}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},mounted:function(){if(!this.$refs.draggable)throw new Error('You should add ref "draggable" to your root element to use draggable mixin');this.touches=[],this.hovered=!1},methods:{onMouseOver:function(){this.hovered||(this.hovered=!0,this.$emit("enter"))},onMouseLeave:function(){this.hovered&&!this.touches.length&&(this.hovered=!1,this.$emit("leave"))},onTouchStart:function(e){e.cancelable&&!this.disabled&&e.touches.length===1&&(this.touches=Ne(e.touches),this.hovered||(this.$emit("enter"),this.hovered=!0),e.touches.length&&this.initAnchor(this.touches.reduce(function(t,i){return{clientX:t.clientX+i.clientX/e.touches.length,clientY:t.clientY+i.clientY/e.touches.length}},{clientX:0,clientY:0})),e.preventDefault&&e.preventDefault(),e.stopPropagation())},onTouchEnd:function(){this.processEnd()},onTouchMove:function(e){this.touches.length&&(this.processMove(e,e.touches),e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation())},onMouseDown:function(e){if(!this.disabled){var t={fake:!0,clientX:e.clientX,clientY:e.clientY};this.touches=[t],this.initAnchor(t),e.stopPropagation()}},onMouseMove:function(e){this.touches.length&&(this.processMove(e,[{fake:!0,clientX:e.clientX,clientY:e.clientY}]),e.preventDefault&&e.preventDefault())},onMouseUp:function(){this.processEnd()},initAnchor:function(e){var t=this.$refs.draggable.getBoundingClientRect(),i=t.left,o=t.right,s=t.bottom,n=t.top;this.anchor={left:e.clientX-i,top:e.clientY-n,bottom:s-e.clientY,right:o-e.clientX}},processMove:function(e,t){var i=Ne(t);if(this.touches.length){if(this.touches.length===1&&i.length===1){var o=this.$refs.draggable;this.$emit("drag",new ys(e,o,{left:i[0].clientX,top:i[0].clientY},{left:this.touches[0].clientX,top:this.touches[0].clientY},this.anchor))}this.touches=i}},processEnd:function(){this.touches.length&&this.$emit("drag-end"),this.hovered&&(this.$emit("leave"),this.hovered=!1),this.touches=[]}},emits:["drag","drag-end","leave","enter"]};ci.render=function(e,t,i,o,s,n){return v(),A("div",{ref:"draggable",class:i.classname,onTouchstart:t[1]||(t[1]=function(){return n.onTouchStart&&n.onTouchStart.apply(n,arguments)}),onMousedown:t[2]||(t[2]=function(){return n.onMouseDown&&n.onMouseDown.apply(n,arguments)}),onMouseover:t[3]||(t[3]=function(){return n.onMouseOver&&n.onMouseOver.apply(n,arguments)}),onMouseleave:t[4]||(t[4]=function(){return n.onMouseLeave&&n.onMouseLeave.apply(n,arguments)})},[Me(e.$slots,"default")],34)};var Vt=be("vue-handler-wrapper"),bn={name:"HandlerWrapper",components:{DraggableElement:ci},props:{horizontalPosition:{type:String},verticalPosition:{type:String},disabled:{type:Boolean,default:!1}},computed:{classes:function(){var e;if(this.horizontalPosition||this.verticalPosition){var t,i=fn(this.horizontalPosition,this.verticalPosition);e=Vt((pe(t={},i.classname,!0),pe(t,"disabled",this.disabled),t))}else e=Vt({disabled:this.disabled});return{root:e,draggable:Vt("draggable")}}},emits:["leave","enter","drag","drag-end"]};bn.render=function(e,t,i,o,s,n){var r=ke("DraggableElement");return v(),A("div",{class:n.classes.root},[x(r,{class:n.classes.draggable,onDrag:t[1]||(t[1]=function(c){return e.$emit("drag",c)}),onDragEnd:t[2]||(t[2]=function(c){return e.$emit("drag-end")}),onLeave:t[3]||(t[3]=function(c){return e.$emit("leave")}),onEnter:t[4]||(t[4]=function(c){return e.$emit("enter")})},{default:R(function(){return[Me(e.$slots,"default")]}),_:3},8,["class"])],2)};var _s=be("vue-line-wrapper"),wn={name:"LineWrapper",components:{DraggableElement:ci},props:{position:{type:String,required:!0},disabled:{type:Boolean,default:!1}},computed:{classname:function(){var e;return _s((pe(e={},this.position,!0),pe(e,"disabled",this.disabled),e))}},emits:["leave","enter","drag","drag-end"]};wn.render=function(e,t,i,o,s,n){var r=ke("DraggableElement");return v(),A(r,{class:n.classname,onDrag:t[1]||(t[1]=function(c){return e.$emit("drag",c)}),onDragEnd:t[2]||(t[2]=function(c){return e.$emit("drag-end")}),onLeave:t[3]||(t[3]=function(c){return e.$emit("leave")}),onEnter:t[4]||(t[4]=function(c){return e.$emit("enter")})},{default:R(function(){return[Me(e.$slots,"default")]}),_:3},8,["class"])};var ye=["left","right","top","bottom"],xs=["left","right"],zs=["top","bottom"],Cs=["left","top"],Rs=["fill-area","fit-area","stencil","none"],qi={left:0,top:0,width:0,height:0};function Yi(e,t,i){return!(i=i||["width","height","left","top"]).some(function(o){return e[o]!==t[o]})}function xe(e){return{left:e.left,top:e.top,right:e.left+e.width,bottom:e.top+e.height}}function Ke(e,t){return{left:e.left-t.left,top:e.top-t.top}}function ee(e){return{left:e.left+e.width/2,top:e.top+e.height/2}}function ht(e,t){var i={left:0,top:0,right:0,bottom:0};return ye.forEach(function(o){var s=t[o],n=xe(e)[o];i[o]=s!==void 0&&n!==void 0?o==="left"||o==="top"?Math.max(0,s-n):Math.max(0,n-s):0}),i}function we(e,t){return{left:e.left-t.left,top:e.top-t.top,width:e.width+t.left+t.right,height:e.height+t.top+t.bottom}}function Et(e){return{left:-e.left,top:-e.top}}function ce(e,t){return M(M({},e),{left:e.left+t.left,top:e.top+t.top})}function ge(e,t,i,o){if(t!==1){if(i){var s=ee(e);return{width:e.width*t,height:e.height*t,left:e.left+e.width*(1-t)/2+(i.left-s.left)*(1-t),top:e.top+e.height*(1-t)/2+(i.top-s.top)*(1-t)}}return{width:e.width*t,height:e.height*t,left:e.left+e.width*(1-t)/2,top:e.top+e.height*(1-t)/2}}return e}function P(e){return e.width/e.height}function Je(e,t){return Math.min(t.right!==void 0&&t.left!==void 0?(t.right-t.left)/e.width:1/0,t.bottom!==void 0&&t.top!==void 0?(t.bottom-t.top)/e.height:1/0)}function et(e,t){var i={left:0,top:0},o=ht(e,t);return o.left&&o.left>0?i.left=o.left:o.right&&o.right>0&&(i.left=-o.right),o.top&&o.top>0?i.top=o.top:o.bottom&&o.bottom>0&&(i.top=-o.bottom),i}function Ut(e,t){var i;return t.minimum&&e<t.minimum?i=t.minimum:t.maximum&&e>t.maximum&&(i=t.maximum),i}function yn(e,t){var i=P(e),o=P(t);return t.width<1/0&&t.height<1/0?i>o?{width:t.width,height:t.width/i}:{width:t.height*i,height:t.height}:t.width<1/0?{width:t.width,height:t.width/i}:t.height<1/0?{width:t.height*i,height:t.height}:e}function _n(e,t){var i=t*Math.PI/180;return{width:Math.abs(e.width*Math.cos(i))+Math.abs(e.height*Math.sin(i)),height:Math.abs(e.width*Math.sin(i))+Math.abs(e.height*Math.cos(i))}}function Oe(e,t){var i=t*Math.PI/180;return{left:e.left*Math.cos(i)-e.top*Math.sin(i),top:e.left*Math.sin(i)+e.top*Math.cos(i)}}function $t(e,t){var i=ht(te(e,t),t);return i.left+i.right+i.top+i.bottom?i.left+i.right>i.top+i.bottom?Math.min((e.width+i.left+i.right)/e.width,Je(e,t)):Math.min((e.height+i.top+i.bottom)/e.height,Je(e,t)):1}function te(e,t,i){i===void 0&&(i=!1);var o=et(e,t);return ce(e,i?Et(o):o)}function ei(e){return{width:e.right!==void 0&&e.left!==void 0?e.right-e.left:1/0,height:e.bottom!==void 0&&e.top!==void 0?e.bottom-e.top:1/0}}function As(e,t){return M(M({},e),{minWidth:Math.min(t.width,e.minWidth),minHeight:Math.min(t.height,e.minHeight),maxWidth:Math.min(t.width,e.maxWidth),maxHeight:Math.min(t.height,e.maxHeight)})}function xn(e,t,i){i===void 0&&(i=!0);var o={};return ye.forEach(function(s){var n=e[s],r=t[s];n!==void 0&&r!==void 0?o[s]=s==="left"||s==="top"?i?Math.max(n,r):Math.min(n,r):i?Math.min(n,r):Math.max(n,r):r!==void 0?o[s]=r:n!==void 0&&(o[s]=n)}),o}function It(e,t){return xn(e,t,!0)}function Xi(e){var t=e.size,i=e.aspectRatio,o=e.ignoreMinimum,s=e.sizeRestrictions;return!!((t.correctRatio||P(t)>=i.minimum&&P(t)<=i.maximum)&&t.height<=s.maxHeight&&t.width<=s.maxWidth&&t.width&&t.height&&(o||t.height>=s.minHeight&&t.width>=s.minWidth))}function Gi(e,t){return Math.pow(e.width-t.width,2)+Math.pow(e.height-t.height,2)}function Se(e){var t=e.width,i=e.height,o=e.sizeRestrictions,s={minimum:e.aspectRatio&&e.aspectRatio.minimum||0,maximum:e.aspectRatio&&e.aspectRatio.maximum||1/0},n={width:Math.max(o.minWidth,Math.min(o.maxWidth,t)),height:Math.max(o.minHeight,Math.min(o.maxHeight,i))};function r(u,m){return m===void 0&&(m=!1),u.reduce(function(f,p){return Xi({size:p,aspectRatio:s,sizeRestrictions:o,ignoreMinimum:m})&&(!f||Gi(p,{width:t,height:i})<Gi(f,{width:t,height:i}))?p:f},null)}var c=[];s&&[s.minimum,s.maximum].forEach(function(u){u&&c.push({width:n.width,height:n.width/u,correctRatio:!0},{width:n.height*u,height:n.height,correctRatio:!0})}),Xi({size:n,aspectRatio:s,sizeRestrictions:o})&&c.push(n);var a=r(c)||r(c,!0);return a&&{width:a.width,height:a.height}}function ti(e){var t=e.event,i=e.coordinates,o=e.positionRestrictions,s=o===void 0?{}:o,n=ce(i,t.directions);return ce(n,et(n,s))}function Ss(e){var t=e.coordinates,i=e.transform,o=e.imageSize,s=e.sizeRestrictions,n=e.positionRestrictions,r=e.aspectRatio,c=e.visibleArea,a=function(m,f){return ti({coordinates:m,positionRestrictions:n,event:new li({left:f.left-m.left,top:f.top-m.top})})},u=M({},t);return(Array.isArray(i)?i:[i]).forEach(function(m){var f={};Q((f=typeof m=="function"?m({coordinates:u,imageSize:o,visibleArea:c}):m).width)&&Q(f.height)||(u=function(p,_){var y=M(M(M({},p),Se({width:_.width,height:_.height,sizeRestrictions:s,aspectRatio:r})),{left:0,top:0});return a(y,{left:p.left,top:p.top})}(u,M(M({},u),f))),Q(f.left)&&Q(f.top)||(u=a(u,M(M({},u),f)))}),u}function ks(e){e.event;var t=e.getAreaRestrictions,i=e.boundaries,o=e.coordinates,s=e.visibleArea;e.aspectRatio;var n=e.stencilSize,r=e.sizeRestrictions,c=e.positionRestrictions;e.stencilReference;var a,u,m,f=M({},o),p=M({},s),_=M({},n);a=P(_),u=P(f),m===void 0&&(m=.001),(a===0||u===0?Math.abs(u-a)<m:Math.abs(u/a)<1+m&&Math.abs(u/a)>1-m)||(f=M(M({},f),Se({sizeRestrictions:r,width:f.width,height:f.height,aspectRatio:{minimum:P(_),maximum:P(_)}})));var y=$t(p=ge(p,f.width*i.width/(p.width*_.width)),t({visibleArea:p,type:"resize"}));return y!==1&&(p=ge(p,y),f=ge(f,y)),p=te(p=ce(p,Ke(ee(f),ee(p))),t({visibleArea:p,type:"move"})),{coordinates:f=te(f,It(xe(p),c)),visibleArea:p}}function Ms(e){var t=e.event,i=e.getAreaRestrictions,o=e.boundaries,s=e.coordinates,n=e.visibleArea;e.aspectRatio,e.stencilSize,e.sizeRestrictions;var r=e.positionRestrictions;e.stencilReference;var c=M({},s),a=M({},n);if(s&&n&&t.type!=="manipulateImage"){var u={width:0,height:0};a.width,o.width,P(o)>P(c)?(u.height=.8*o.height,u.width=u.height*P(c)):(u.width=.8*o.width,u.height=u.width*P(c));var m=$t(a=ge(a,c.width*o.width/(a.width*u.width)),i({visibleArea:a,type:"resize"}));a=ge(a,m),m!==1&&(u.height/=m,u.width/=m),a=te(a=ce(a,Ke(ee(c),ee(a))),i({visibleArea:a,type:"move"})),c=te(c,It(xe(a),r))}return{coordinates:c,visibleArea:a}}function Es(e){var t=e.event,i=e.coordinates,o=e.visibleArea,s=e.getAreaRestrictions,n=M({},o),r=M({},i);if(t.type==="setCoordinates"){var c=Math.max(0,r.width-n.width),a=Math.max(0,r.height-n.height);c>a?n=ge(n,Math.min(r.width/n.width,Je(n,s({visibleArea:n,type:"resize"})))):a>c&&(n=ge(n,Math.min(r.height/n.height,Je(n,s({visibleArea:n,type:"resize"}))))),n=te(n=ce(n,Et(et(r,xe(n)))),s({visibleArea:n,type:"move"}))}return{visibleArea:n,coordinates:r}}function $s(e){var t=e.imageSize,i=e.visibleArea,o=e.coordinates,s=i||t;return{left:(i?i.left:0)+s.width/2-o.width/2,top:(i?i.top:0)+s.height/2-o.height/2}}function Is(e){var t=e.imageSize,i=e.visibleArea,o=e.aspectRatio,s=e.sizeRestrictions,n=i||t,r=Math.min(o.maximum||1/0,Math.max(o.minimum||0,P(n))),c=n.width<n.height?{width:.8*n.width,height:.8*n.width/r}:{height:.8*n.height,width:.8*n.height*r};return Se(M(M({},c),{aspectRatio:o,sizeRestrictions:s}))}function Ds(e){var t,i,o=e.imageSize,s=e.visibleArea,n=e.boundaries,r=e.aspectRatio,c=e.sizeRestrictions,a=e.stencilSize,u=s||o;return P(u)>P(n)?i=(t=a.height*u.height/n.height)*P(a):t=(i=a.width*u.width/n.width)/P(a),Se({width:i,height:t,aspectRatio:r,sizeRestrictions:c})}function Ts(e){var t=e.getAreaRestrictions,i=e.coordinates,o=e.imageSize,s=P(e.boundaries);if(i){var n={height:Math.max(i.height,o.height),width:Math.max(i.width,o.width)},r=yn({width:P(n)>s?n.width:n.height*s,height:P(n)>s?n.width/s:n.height},ei(t())),c={left:i.left+i.width/2-r.width/2,top:i.top+i.height/2-r.height/2,width:r.width,height:r.height},a=ht(i,xe(M({left:0,top:0},o))),u={};return!a.left&&!a.right&&c.width<=o.width&&(u.left=0,u.right=o.width),!a.top&&!a.bottom&&c.height<=o.height&&(u.top=0,u.bottom=o.height),te(c,u)}var m=P(o);return r={height:m>s?o.height:o.width/s,width:m>s?o.height*s:o.width},{left:o.width/2-r.width/2,top:o.height/2-r.height/2,width:r.width,height:r.height}}function _t(e,t){return xn(e,xe(t))}function Os(e){var t=e.event,i=e.coordinates,o=e.visibleArea,s=e.sizeRestrictions,n=e.getAreaRestrictions,r=e.positionRestrictions,c=e.adjustStencil,a=t.scale,u=t.move,m=M({},o),f=M({},i),p=1,_=1,y=a.factor&&Math.abs(a.factor-1)>.001;m=ce(m,{left:u.left||0,top:u.top||0});var b={stencil:{minimum:Math.max(s.minWidth?s.minWidth/f.width:0,s.minHeight?s.minHeight/f.height:0),maximum:Math.min(s.maxWidth?s.maxWidth/f.width:1/0,s.maxHeight?s.maxHeight/f.height:1/0,Je(f,r))},area:{maximum:Je(m,n({visibleArea:m,type:"resize"}))}};a.factor&&y&&(a.factor<1?(_=Math.max(a.factor,b.stencil.minimum))>1&&(_=1):a.factor>1&&(_=Math.min(a.factor,Math.min(b.area.maximum,b.stencil.maximum)))<1&&(_=1)),_&&(m=ge(m,_,a.center));var W=i.left-o.left,V=o.width+o.left-(i.width+i.left),K=i.top-o.top,re=o.height+o.top-(i.height+i.top);return m=te(m=ce(m,et(m,{left:r.left!==void 0?r.left-W*_:void 0,top:r.top!==void 0?r.top-K*_:void 0,bottom:r.bottom!==void 0?r.bottom+re*_:void 0,right:r.right!==void 0?r.right+V*_:void 0})),n({visibleArea:m,type:"move"})),f.width=f.width*_,f.height=f.height*_,f.left=m.left+W*_,f.top=m.top+K*_,f=te(f,It(xe(m),r)),a.factor&&y&&c&&(a.factor>1?p=Math.min(b.area.maximum,a.factor)/_:a.factor<1&&(p=Math.max(f.height/m.height,f.width/m.width,a.factor/_)),p!==1&&(m=ce(m=te(m=ge(m,p,a.factor>1?a.center:ee(f)),n({visibleArea:m,type:"move"})),Et(et(f,xe(m)))))),{coordinates:f,visibleArea:m}}function Fs(e){var t=e.aspectRatio,i=e.getAreaRestrictions,o=e.coordinates,s=e.visibleArea,n=e.sizeRestrictions,r=e.positionRestrictions,c=e.imageSize,a=e.previousImageSize,u=e.angle,m=M({},o),f=M({},s),p=Oe(ee(M({left:0,top:0},a)),u);return(m=M(M({},Se({sizeRestrictions:n,aspectRatio:t,width:m.width,height:m.height})),Oe(ee(m),u))).left-=p.left-c.width/2+m.width/2,m.top-=p.top-c.height/2+m.height/2,f=ge(f,$t(f,i({visibleArea:f,type:"resize"}))),{coordinates:m=te(m,r),visibleArea:f=te(f=ce(f,Ke(ee(m),ee(o))),i({visibleArea:f,type:"move"}))}}function Ls(e){var t=e.flip,i=e.previousFlip,o=e.rotate,s=e.getAreaRestrictions,n=e.coordinates,r=e.visibleArea,c=e.imageSize,a=M({},n),u=M({},r),m=i.horizontal!==t.horizontal,f=i.vertical!==t.vertical;if(m||f){var p=Oe({left:c.width/2,top:c.height/2},-o),_=Oe(ee(a),-o),y=Oe({left:m?p.left-(_.left-p.left):_.left,top:f?p.top-(_.top-p.top):_.top},o);a=ce(a,Ke(y,ee(a))),_=Oe(ee(u),-o),u=te(u=ce(u,Ke(y=Oe({left:m?p.left-(_.left-p.left):_.left,top:f?p.top-(_.top-p.top):_.top},o),ee(u))),s({visibleArea:u,type:"move"}))}return{coordinates:a,visibleArea:u}}function Zi(e){var t=e.directions,i=e.coordinates,o=e.positionRestrictions,s=o===void 0?{}:o,n=e.sizeRestrictions,r=e.preserveRatio,c=e.compensate,a=M({},t),u=we(i,a).width,m=we(i,a).height;u<0&&(a.left<0&&a.right<0?(a.left=-(i.width-n.minWidth)/(a.left/a.right),a.right=-(i.width-n.minWidth)/(a.right/a.left)):a.left<0?a.left=-(i.width-n.minWidth):a.right<0&&(a.right=-(i.width-n.minWidth))),m<0&&(a.top<0&&a.bottom<0?(a.top=-(i.height-n.minHeight)/(a.top/a.bottom),a.bottom=-(i.height-n.minHeight)/(a.bottom/a.top)):a.top<0?a.top=-(i.height-n.minHeight):a.bottom<0&&(a.bottom=-(i.height-n.minHeight)));var f=ht(we(i,a),s);c&&(f.left&&f.left>0&&f.right===0?(a.right+=f.left,a.left-=f.left):f.right&&f.right>0&&f.left===0&&(a.left+=f.right,a.right-=f.right),f.top&&f.top>0&&f.bottom===0?(a.bottom+=f.top,a.top-=f.top):f.bottom&&f.bottom>0&&f.top===0&&(a.top+=f.bottom,a.bottom-=f.bottom),f=ht(we(i,a),s));var p={width:1/0,height:1/0,left:1/0,right:1/0,top:1/0,bottom:1/0};if(ye.forEach(function(b){var W=f[b];W&&a[b]&&(p[b]=Math.max(0,1-W/a[b]))}),r){var _=Math.min.apply(null,ye.map(function(b){return p[b]}));_!==1/0&&ye.forEach(function(b){a[b]*=_})}else ye.forEach(function(b){p[b]!==1/0&&(a[b]*=p[b])});if(u=we(i,a).width,m=we(i,a).height,a.right+a.left&&(u>n.maxWidth?p.width=(n.maxWidth-i.width)/(a.right+a.left):u<n.minWidth&&(p.width=(n.minWidth-i.width)/(a.right+a.left))),a.bottom+a.top&&(m>n.maxHeight?p.height=(n.maxHeight-i.height)/(a.bottom+a.top):m<n.minHeight&&(p.height=(n.minHeight-i.height)/(a.bottom+a.top))),r){var y=Math.min(p.width,p.height);y!==1/0&&ye.forEach(function(b){a[b]*=y})}else p.width!==1/0&&xs.forEach(function(b){a[b]*=p.width}),p.height!==1/0&&zs.forEach(function(b){a[b]*=p.height});return a}function xt(e,t,i){return t==0&&i==0?e/2:t==0?0:i==0?e:e*Math.abs(t/(t+i))}var Bs=be("vue-simple-handler"),Ps=be("vue-simple-handler-wrapper"),di={name:"SimpleHandler",components:{HandlerWrapper:bn},props:{defaultClass:{type:String},hoverClass:{type:String},wrapperClass:{type:String},horizontalPosition:{type:String},verticalPosition:{type:String},disabled:{type:Boolean,default:!1}},data:function(){return{hover:!1}},computed:{classes:function(){var e,t=(pe(e={},this.horizontalPosition,!!this.horizontalPosition),pe(e,this.verticalPosition,!!this.verticalPosition),pe(e,"".concat(this.horizontalPosition,"-").concat(this.verticalPosition),!!(this.verticalPosition&&this.horizontalPosition)),pe(e,"hover",this.hover),e);return{default:X(Bs(t),this.defaultClass,this.hover&&this.hoverClass),wrapper:X(Ps(t),this.wrapperClass)}}},methods:{onDrag:function(e){this.$emit("drag",e)},onEnter:function(){this.hover=!0},onLeave:function(){this.hover=!1},onDragEnd:function(){this.$emit("drag-end")}},emits:["drag","drag-end"]};di.render=function(e,t,i,o,s,n){var r=ke("HandlerWrapper");return v(),A(r,{class:n.classes.wrapper,"vertical-position":i.verticalPosition,"horizontal-position":i.horizontalPosition,disabled:i.disabled,onDrag:n.onDrag,onDragEnd:n.onDragEnd,onEnter:n.onEnter,onLeave:n.onLeave},{default:R(function(){return[x("div",{class:n.classes.default},null,2)]}),_:1},8,["class","vertical-position","horizontal-position","disabled","onDrag","onDragEnd","onEnter","onLeave"])};var Ws=be("vue-simple-line"),js=be("vue-simple-line-wrapper"),hi={name:"SimpleLine",components:{LineWrapper:wn},props:{defaultClass:{type:String},hoverClass:{type:String},wrapperClass:{type:String},position:{type:String},disabled:{type:Boolean,default:!1}},data:function(){return{hover:!1}},computed:{classes:function(){return{root:X(Ws(pe({},this.position,!0)),this.defaultClass,this.hover&&this.hoverClass),wrapper:X(js(pe({},this.position,!0)),this.wrapperClass)}}},methods:{onDrag:function(e){this.$emit("drag",e)},onEnter:function(){this.hover=!0},onLeave:function(){this.hover=!1},onDragEnd:function(){this.$emit("drag-end")}},emits:["drag","drag-end"]};hi.render=function(e,t,i,o,s,n){var r=ke("LineWrapper");return v(),A(r,{class:n.classes.wrapper,position:i.position,disabled:i.disabled,onDrag:n.onDrag,onDragEnd:n.onDragEnd,onEnter:n.onEnter,onLeave:n.onLeave},{default:R(function(){return[x("div",{class:n.classes.root},null,2)]}),_:1},8,["class","position","disabled","onDrag","onDragEnd","onEnter","onLeave"])};var Ht=be("vue-bounding-box"),Vs=["east","west",null],Us=["south","north",null],zn={name:"BoundingBox",props:{width:{type:Number},height:{type:Number},transitions:{type:Object},handlers:{type:Object,default:function(){return{eastNorth:!0,north:!0,westNorth:!0,west:!0,westSouth:!0,south:!0,eastSouth:!0,east:!0}}},handlersComponent:{type:[Object,String],default:function(){return di}},handlersClasses:{type:Object,default:function(){return{}}},handlersWrappersClasses:{type:Object,default:function(){return{}}},lines:{type:Object,default:function(){return{west:!0,north:!0,east:!0,south:!0}}},linesComponent:{type:[Object,String],default:function(){return hi}},linesClasses:{type:Object,default:function(){return{}}},linesWrappersClasses:{type:Object,default:function(){return{}}},resizable:{type:Boolean,default:!0}},data:function(){var e=[];return Vs.forEach(function(t){Us.forEach(function(i){if(t!==i){var o=fn(t,i),s=o.name,n=o.classname;e.push({name:s,classname:n,verticalDirection:i,horizontalDirection:t})}})}),{points:e}},computed:{style:function(){var e={};return this.width&&this.height&&(e.width="".concat(this.width,"px"),e.height="".concat(this.height,"px"),this.transitions&&this.transitions.enabled&&(e.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction))),e},classes:function(){var e=this.handlersClasses,t=this.handlersWrappersClasses,i=this.linesClasses,o=this.linesWrappersClasses;return{root:Ht(),handlers:e,handlersWrappers:t,lines:i,linesWrappers:o}},lineNodes:function(){var e=this,t=[];return this.points.forEach(function(i){i.horizontalDirection&&i.verticalDirection||!e.lines[i.name]||t.push({name:i.name,component:e.linesComponent,class:X(e.classes.lines.default,e.classes.lines[i.name],!e.resizable&&e.classes.lines.disabled),wrapperClass:X(e.classes.linesWrappers.default,e.classes.linesWrappers[i.name],!e.resizable&&e.classes.linesWrappers.disabled),hoverClass:e.classes.lines.hover,verticalDirection:i.verticalDirection,horizontalDirection:i.horizontalDirection,disabled:!e.resizable})}),t},handlerNodes:function(){var e=this,t=[],i=this.width,o=this.height;return this.points.forEach(function(s){if(e.handlers[s.name]){var n={name:s.name,component:e.handlersComponent,class:X(e.classes.handlers.default,e.classes.handlers[s.name]),wrapperClass:X(e.classes.handlersWrappers.default,e.classes.handlersWrappers[s.name]),hoverClass:e.classes.handlers.hover,verticalDirection:s.verticalDirection,horizontalDirection:s.horizontalDirection,disabled:!e.resizable};if(i&&o){var r=s.horizontalDirection,c=s.verticalDirection,a=r==="east"?i:r==="west"?0:i/2,u=c==="south"?o:c==="north"?0:o/2;n.wrapperClass=Ht("handler"),n.wrapperStyle={transform:"translate(".concat(a,"px, ").concat(u,"px)")},e.transitions&&e.transitions.enabled&&(n.wrapperStyle.transition="".concat(e.transitions.time,"ms ").concat(e.transitions.timingFunction))}else n.wrapperClass=Ht("handler",pe({},s.classname,!0));t.push(n)}}),t}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},mounted:function(){this.touches=[]},methods:{onEnd:function(){this.$emit("resize-end")},onHandlerDrag:function(e,t,i){var o,s=e.shift(),n=s.left,r=s.top,c={left:0,right:0,top:0,bottom:0};t==="west"?c.left-=n:t==="east"&&(c.right+=n),i==="north"?c.top-=r:i==="south"&&(c.bottom+=r),!i&&t?o="width":i&&!t&&(o="height"),this.resizable&&this.$emit("resize",new ws(c,{allowedDirections:{left:t==="west"||!t,right:t==="east"||!t,bottom:i==="south"||!i,top:i==="north"||!i},preserveAspectRatio:e.nativeEvent&&e.nativeEvent.shiftKey,respectDirection:o}))}},emits:["resize","resize-end"]};zn.render=function(e,t,i,o,s,n){return v(),A("div",{ref:"box",class:n.classes.root,style:n.style},[Me(e.$slots,"default"),x("div",null,[(v(!0),A(Fe,null,Li(n.lineNodes,function(r){return v(),A(_e(r.component),{key:r.name,"default-class":r.class,"hover-class":r.hoverClass,"wrapper-class":r.wrapperClass,position:r.name,disabled:r.disabled,onDrag:function(c){return n.onHandlerDrag(c,r.horizontalDirection,r.verticalDirection)},onDragEnd:t[1]||(t[1]=function(c){return n.onEnd()})},null,8,["default-class","hover-class","wrapper-class","position","disabled","onDrag"])}),128))]),(v(!0),A(Fe,null,Li(n.handlerNodes,function(r){return v(),A("div",{key:r.name,style:r.wrapperStyle,class:r.wrapperClass},[(v(),A(_e(r.component),{"default-class":r.class,"hover-class":r.hoverClass,"wrapper-class":r.wrapperClass,"horizontal-position":r.horizontalDirection,"vertical-position":r.verticalDirection,disabled:r.disabled,onDrag:function(c){return n.onHandlerDrag(c,r.horizontalDirection,r.verticalDirection)},onDragEnd:t[2]||(t[2]=function(c){return n.onEnd()})},null,8,["default-class","hover-class","wrapper-class","horizontal-position","vertical-position","disabled","onDrag"]))],6)}),128))],6)};var Hs=be("vue-draggable-area"),Cn={name:"DraggableArea",props:{movable:{type:Boolean,default:!0},activationDistance:{type:Number,default:20}},computed:{classnames:function(){return{default:Hs()}}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},mounted:function(){this.touches=[],this.touchStarted=!1},methods:{onTouchStart:function(e){if(e.cancelable){var t=this.movable&&e.touches.length===1;t&&(this.touches=Ne(e.touches)),(this.touchStarted||t)&&(e.preventDefault(),e.stopPropagation())}},onTouchEnd:function(){this.touchStarted=!1,this.processEnd()},onTouchMove:function(e){this.touches.length>=1&&(this.touchStarted?(this.processMove(e,e.touches),e.preventDefault(),e.stopPropagation()):vn({x:this.touches[0].clientX,y:this.touches[0].clientY},{x:e.touches[0].clientX,y:e.touches[0].clientY})>this.activationDistance&&(this.initAnchor({clientX:e.touches[0].clientX,clientY:e.touches[0].clientY}),this.touchStarted=!0))},onMouseDown:function(e){if(this.movable&&e.button===0){var t={fake:!0,clientX:e.clientX,clientY:e.clientY};this.touches=[t],this.initAnchor(t),e.stopPropagation()}},onMouseMove:function(e){this.touches.length&&(this.processMove(e,[{fake:!0,clientX:e.clientX,clientY:e.clientY}]),e.preventDefault&&e.cancelable&&e.preventDefault(),e.stopPropagation())},onMouseUp:function(){this.processEnd()},initAnchor:function(e){var t=this.$refs.container.getBoundingClientRect(),i=t.left,o=t.top;this.anchor={x:e.clientX-i,y:e.clientY-o}},processMove:function(e,t){var i=Ne(t);if(this.touches.length){var o=this.$refs.container.getBoundingClientRect(),s=o.left,n=o.top;this.touches.length===1&&i.length===1&&this.$emit("move",new li({left:i[0].clientX-(s+this.anchor.x),top:i[0].clientY-(n+this.anchor.y)}))}},processEnd:function(){this.touches.length&&this.$emit("move-end"),this.touches=[]}},emits:["move","move-end"]};Cn.render=function(e,t,i,o,s,n){return v(),A("div",{ref:"container",onTouchstart:t[1]||(t[1]=function(){return n.onTouchStart&&n.onTouchStart.apply(n,arguments)}),onMousedown:t[2]||(t[2]=function(){return n.onMouseDown&&n.onMouseDown.apply(n,arguments)})},[Me(e.$slots,"default")],544)};function Nt(e){var t,i;return{rotate:e.rotate||0,flip:{horizontal:((t=e==null?void 0:e.flip)===null||t===void 0?void 0:t.horizontal)||!1,vertical:((i=e==null?void 0:e.flip)===null||i===void 0?void 0:i.vertical)||!1}}}function Ns(e){return new Promise(function(t,i){try{if(e)if(/^data:/i.test(e))t(function(a){a=a.replace(/^data:([^;]+);base64,/gim,"");for(var u=atob(a),m=u.length,f=new ArrayBuffer(m),p=new Uint8Array(f),_=0;_<m;_++)p[_]=u.charCodeAt(_);return f}(e));else if(/^blob:/i.test(e)){var o=new FileReader;o.onload=function(a){t(a.target.result)},n=e,r=function(a){o.readAsArrayBuffer(a)},(c=new XMLHttpRequest).open("GET",n,!0),c.responseType="blob",c.onload=function(){this.status!=200&&this.status!==0||r(this.response)},c.send()}else{var s=new XMLHttpRequest;s.onreadystatechange=function(){s.readyState===4&&(s.status===200||s.status===0?t(s.response):i("Warning: could not load an image to parse its orientation"),s=null)},s.onprogress=function(){s.getResponseHeader("content-type")!=="image/jpeg"&&s.abort()},s.withCredentials=!1,s.open("GET",e,!0),s.responseType="arraybuffer",s.send(null)}else i("Error: the image is empty")}catch(a){i(a)}var n,r,c})}function Rn(e){var t=e.rotate,i=e.flip,o=e.scaleX,s=e.scaleY,n="";return n+=" rotate("+t+"deg) ",n+=" scaleX("+o*(i.horizontal?-1:1)+") ",n+=" scaleY("+s*(i.vertical?-1:1)+") "}function qs(e){try{var t,i=new DataView(e),o=void 0,s=void 0,n=void 0,r=void 0;if(i.getUint8(0)===255&&i.getUint8(1)===216)for(var c=i.byteLength,a=2;a+1<c;){if(i.getUint8(a)===255&&i.getUint8(a+1)===225){n=a;break}a++}if(n&&(o=n+10,function(_,y,b){var W,V="";for(W=y,b+=y;W<b;W++)V+=String.fromCharCode(_.getUint8(W));return V}(i,n+4,4)==="Exif")){var u=i.getUint16(o);if(((s=u===18761)||u===19789)&&i.getUint16(o+2,s)===42){var m=i.getUint32(o+4,s);m>=8&&(r=o+m)}}if(r){for(var f=i.getUint16(r,s),p=0;p<f;p++)if(a=r+12*p+2,i.getUint16(a,s)===274){a+=8,t=i.getUint16(a,s),i.setUint16(a,1,s);break}}return t}catch{return null}}function Qi(e,t){var i=t.getBoundingClientRect(),o=i.left,s=i.top,n={left:0,top:0},r=0;return e.forEach(function(c){n.left+=(c.clientX-o)/e.length,n.top+=(c.clientY-s)/e.length}),e.forEach(function(c){r+=vn({x:n.left,y:n.top},{x:c.clientX-o,y:c.clientY-s})}),{centerMass:n,spread:r,count:e.length}}var An={props:{touchMove:{type:Boolean,required:!0},mouseMove:{type:Boolean,required:!0},touchResize:{type:Boolean,required:!0},wheelResize:{type:[Boolean,Object],required:!0},eventsFilter:{type:Function,required:!1}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},created:function(){this.transforming=!1,this.debouncedProcessEnd=Kt(this.processEnd),this.touches=[]},methods:{processMove:function(e,t){if(this.touches.length){if(this.touches.length===1&&t.length===1)this.$emit("move",new dt({left:this.touches[0].clientX-t[0].clientX,top:this.touches[0].clientY-t[0].clientY}));else if(this.touches.length>1&&this.touchResize){var i=Qi(t,this.$refs.container),o=this.oldGeometricProperties;o.count===i.count&&o.count>1&&this.$emit("resize",new dt({left:o.centerMass.left-i.centerMass.left,top:o.centerMass.top-i.centerMass.top},{factor:o.spread/i.spread,center:i.centerMass})),this.oldGeometricProperties=i}this.touches=t}},processEnd:function(){this.transforming&&(this.transforming=!1,this.$emit("transform-end"))},processStart:function(){this.transforming=!0,this.debouncedProcessEnd.clear()},processEvent:function(e){return this.eventsFilter?this.eventsFilter(e,this.transforming)!==!1:(e.preventDefault(),e.stopPropagation(),!0)},onTouchStart:function(e){if(e.cancelable&&(this.touchMove||this.touchResize&&e.touches.length>1)&&this.processEvent(e)){var t=this.$refs.container,i=t.getBoundingClientRect(),o=i.left,s=i.top,n=i.bottom,r=i.right;this.touches=Ne(e.touches).filter(function(c){return c.clientX>o&&c.clientX<r&&c.clientY>s&&c.clientY<n}),this.oldGeometricProperties=Qi(this.touches,t)}},onTouchEnd:function(e){e.touches.length===0&&(this.touches=[],this.processEnd())},onTouchMove:function(e){var t=this;if(this.touches.length){var i=Ne(e.touches).filter(function(o){return!o.identifier||t.touches.find(function(s){return s.identifier===o.identifier})});this.processEvent(e)&&(this.processMove(e,i),this.processStart())}},onMouseDown:function(e){if(this.mouseMove&&"buttons"in e&&e.buttons===1&&this.processEvent(e)){var t={fake:!0,clientX:e.clientX,clientY:e.clientY};this.touches=[t],this.processStart()}},onMouseMove:function(e){this.touches.length&&this.processEvent(e)&&this.processMove(e,[{clientX:e.clientX,clientY:e.clientY}])},onMouseUp:function(){this.touches=[],this.processEnd()},onWheel:function(e){if(this.wheelResize&&this.processEvent(e)){var t=this.$refs.container.getBoundingClientRect(),i=t.left,o=t.top,s=1+this.wheelResize.ratio*(r=e.deltaY||e.detail||e.wheelDelta,(c=+r)==0||gn(c)?c:c>0?1:-1),n={left:e.clientX-i,top:e.clientY-o};this.$emit("resize",new dt({},{factor:s,center:n})),this.touches.length||this.debouncedProcessEnd()}var r,c}},emits:["resize","move","transform-end"]};An.render=function(e,t,i,o,s,n){return v(),A("div",{ref:"container",onTouchstart:t[1]||(t[1]=function(){return n.onTouchStart&&n.onTouchStart.apply(n,arguments)}),onMousedown:t[2]||(t[2]=function(){return n.onMouseDown&&n.onMouseDown.apply(n,arguments)}),onWheel:t[3]||(t[3]=function(){return n.onWheel&&n.onWheel.apply(n,arguments)})},[Me(e.$slots,"default")],544)};var ii={components:{TransformableImage:An},props:{touchMove:{type:Boolean,required:!0},mouseMove:{type:Boolean,required:!0},touchResize:{type:Boolean,required:!0},wheelResize:{type:[Boolean,Object],required:!0}},emits:["resize","move"]};ii.render=function(e,t,i,o,s,n){var r=ke("transformable-image");return v(),A(r,{"touch-move":i.touchMove,"touch-resize":i.touchResize,"mouse-move":i.mouseMove,"wheel-resize":i.wheelResize,onMove:t[1]||(t[1]=function(c){return e.$emit("move",c)}),onResize:t[2]||(t[2]=function(c){return e.$emit("resize",c)})},{default:R(function(){return[Me(e.$slots,"default")]}),_:3},8,["touch-move","touch-resize","mouse-move","wheel-resize"])};var zt=be("vue-preview"),Sn={props:{coordinates:{type:Object},transitions:{type:Object},image:{type:Object,default:function(){return{}}},imageClass:{type:String},width:{type:Number},height:{type:Number},fill:{type:Boolean}},data:function(){return{calculatedImageSize:{width:0,height:0},calculatedSize:{width:0,height:0}}},computed:{classes:function(){return{root:zt({fill:this.fill}),wrapper:zt("wrapper"),imageWrapper:zt("image-wrapper"),image:X(zt("image"),this.imageClass)}},style:function(){if(this.fill)return{};var e={};return this.width&&(e.width="".concat(this.size.width,"px")),this.height&&(e.height="".concat(this.size.height,"px")),this.transitions&&this.transitions.enabled&&(e.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),e},wrapperStyle:function(){var e={width:"".concat(this.size.width,"px"),height:"".concat(this.size.height,"px"),left:"calc(50% - ".concat(this.size.width/2,"px)"),top:"calc(50% - ".concat(this.size.height/2,"px)")};return this.transitions&&this.transitions.enabled&&(e.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),e},imageStyle:function(){if(this.coordinates&&this.image){var e=this.coordinates.width/this.size.width,t=L(L({rotate:0,flip:{horizontal:!1,vertical:!1}},this.image.transforms),{},{scaleX:1/e,scaleY:1/e}),i=this.imageSize.width,o=this.imageSize.height,s=_n({width:i,height:o},t.rotate),n={width:"".concat(i,"px"),height:"".concat(o,"px"),left:"0px",top:"0px"},r={rotate:{left:(i-s.width)*t.scaleX/2,top:(o-s.height)*t.scaleY/2},scale:{left:(1-t.scaleX)*i/2,top:(1-t.scaleY)*o/2}};return n.transform=`translate(
				`.concat(-this.coordinates.left/e-r.rotate.left-r.scale.left,"px,").concat(-this.coordinates.top/e-r.rotate.top-r.scale.top,"px) ")+Rn(t),this.transitions&&this.transitions.enabled&&(n.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),n}return{}},size:function(){return{width:this.width||this.calculatedSize.width,height:this.height||this.calculatedSize.height}},imageSize:function(){return{width:this.image.width||this.calculatedImageSize.width,height:this.image.height||this.calculatedImageSize.height}}},watch:{image:function(e){(e.width||e.height)&&this.onChangeImage()}},mounted:function(){var e=this;this.onChangeImage(),this.$refs.image.addEventListener("load",function(){e.refreshImage()}),window.addEventListener("resize",this.refresh),window.addEventListener("orientationchange",this.refresh)},unmounted:function(){window.removeEventListener("resize",this.refresh),window.removeEventListener("orientationchange",this.refresh)},methods:{refreshImage:function(){var e=this.$refs.image;this.calculatedImageSize.height=e.naturalHeight,this.calculatedImageSize.width=e.naturalWidth},refresh:function(){var e=this.$refs.root;this.width||(this.calculatedSize.width=e.clientWidth),this.height||(this.calculatedSize.height=e.clientHeight)},onChangeImage:function(){var e=this.$refs.image;e&&e.complete&&this.refreshImage(),this.refresh()}}};Sn.render=function(e,t,i,o,s,n){return v(),A("div",{ref:"root",class:n.classes.root,style:n.style},[x("div",{ref:"wrapper",class:n.classes.wrapper,style:n.wrapperStyle},[He(x("img",{ref:"image",src:i.image&&i.image.src,class:n.classes.image,style:n.imageStyle},null,14,["src"]),[[Ki,i.image&&i.image.src]])],6)],6)};var kn={components:{Preview:Sn},inheritAttrs:!1};kn.render=function(e,t,i,o,s,n){var r=ke("preview");return v(),A(r,St(e.$attrs,{fill:!0}),null,16)};var qt=be("vue-rectangle-stencil"),Mn={name:"RectangleStencil",components:{StencilPreview:kn,BoundingBox:zn,DraggableArea:Cn},props:{image:{type:Object},coordinates:{type:Object},stencilCoordinates:{type:Object},handlers:{type:Object},handlersComponent:{type:[Object,String],default:function(){return di}},lines:{type:Object},linesComponent:{type:[Object,String],default:function(){return hi}},aspectRatio:{type:[Number,String]},minAspectRatio:{type:[Number,String]},maxAspectRatio:{type:[Number,String]},movable:{type:Boolean,default:!0},resizable:{type:Boolean,default:!0},transitions:{type:Object},movingClass:{type:String},resizingClass:{type:String},previewClass:{type:String},boundingBoxClass:{type:String},linesClasses:{type:Object,default:function(){return{}}},linesWrappersClasses:{type:Object,default:function(){return{}}},handlersClasses:{type:Object,default:function(){return{}}},handlersWrappersClasses:{type:Object,default:function(){return{}}}},data:function(){return{moving:!1,resizing:!1}},computed:{classes:function(){return{stencil:X(qt({movable:this.movable,moving:this.moving,resizing:this.resizing}),this.moving&&this.movingClass,this.resizing&&this.resizingClass),preview:X(qt("preview"),this.previewClass),boundingBox:X(qt("bounding-box"),this.boundingBoxClass)}},style:function(){var e=this.stencilCoordinates,t=e.height,i=e.width,o=e.left,s=e.top,n={width:"".concat(i,"px"),height:"".concat(t,"px"),transform:"translate(".concat(o,"px, ").concat(s,"px)")};return this.transitions&&this.transitions.enabled&&(n.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),n}},methods:{onMove:function(e){this.$emit("move",e),this.moving=!0},onMoveEnd:function(){this.$emit("move-end"),this.moving=!1},onResize:function(e){this.$emit("resize",e),this.resizing=!0},onResizeEnd:function(){this.$emit("resize-end"),this.resizing=!1},aspectRatios:function(){return{minimum:this.aspectRatio||this.minAspectRatio,maximum:this.aspectRatio||this.maxAspectRatio}}},emits:["resize","resize-end","move","move-end"]};Mn.render=function(e,t,i,o,s,n){var r=ke("stencil-preview"),c=ke("draggable-area"),a=ke("bounding-box");return v(),A("div",{class:n.classes.stencil,style:n.style},[x(a,{width:i.stencilCoordinates.width,height:i.stencilCoordinates.height,transitions:i.transitions,class:n.classes.boundingBox,handlers:i.handlers,"handlers-component":i.handlersComponent,"handlers-classes":i.handlersClasses,"handlers-wrappers-classes":i.handlersWrappersClasses,lines:i.lines,"lines-component":i.linesComponent,"lines-classes":i.linesClasses,"lines-wrappers-classes":i.linesWrappersClasses,resizable:i.resizable,onResize:n.onResize,onResizeEnd:n.onResizeEnd},{default:R(function(){return[x(c,{movable:i.movable,onMove:n.onMove,onMoveEnd:n.onMoveEnd},{default:R(function(){return[x(r,{image:i.image,coordinates:i.coordinates,width:i.stencilCoordinates.width,height:i.stencilCoordinates.height,class:n.classes.preview,transitions:i.transitions},null,8,["image","coordinates","width","height","class","transitions"])]}),_:1},8,["movable","onMove","onMoveEnd"])]}),_:1},8,["width","height","transitions","class","handlers","handlers-component","handlers-classes","handlers-wrappers-classes","lines","lines-component","lines-classes","lines-wrappers-classes","resizable","onResize","onResizeEnd"])],6)};var Ys=["transitions"],Re=be("vue-advanced-cropper"),En={name:"Cropper",components:{BackgroundWrapper:ii},props:{src:{type:String,default:null},stencilComponent:{type:[Object,String],default:function(){return Mn}},backgroundWrapperComponent:{type:[Object,String],default:function(){return ii}},stencilProps:{type:Object,default:function(){return{}}},autoZoom:{type:Boolean,default:!1},imageClass:{type:String},boundariesClass:{type:String},backgroundClass:{type:String},foregroundClass:{type:String},minWidth:{type:[Number,String]},minHeight:{type:[Number,String]},maxWidth:{type:[Number,String]},maxHeight:{type:[Number,String]},debounce:{type:[Boolean,Number],default:500},transitions:{type:Boolean,default:!0},checkOrientation:{type:Boolean,default:!0},canvas:{type:[Object,Boolean],default:!0},crossOrigin:{type:[Boolean,String],default:void 0},transitionTime:{type:Number,default:300},imageRestriction:{type:String,default:"fit-area",validator:function(e){return Rs.indexOf(e)!==-1}},roundResult:{type:Boolean,default:!0},defaultSize:{type:[Function,Object]},defaultPosition:{type:[Function,Object]},defaultVisibleArea:{type:[Function,Object]},defaultTransforms:{type:[Function,Object]},defaultBoundaries:{type:[Function,String],validator:function(e){return!(typeof e=="string"&&e!=="fill"&&e!=="fit")}},priority:{type:String,default:"coordinates"},stencilSize:{type:[Object,Function]},resizeImage:{type:[Boolean,Object],default:!0},moveImage:{type:[Boolean,Object],default:!0},autoZoomAlgorithm:{type:Function},resizeAlgorithm:{type:Function,default:function(e){var t=e.event,i=e.coordinates,o=e.aspectRatio,s=e.positionRestrictions,n=e.sizeRestrictions,r=M(M({},i),{right:i.left+i.width,bottom:i.top+i.height}),c=t.params||{},a=M({},t.directions),u=c.allowedDirections||{left:!0,right:!0,bottom:!0,top:!0};n.widthFrozen&&(a.left=0,a.right=0),n.heightFrozen&&(a.top=0,a.bottom=0),ye.forEach(function(de){u[de]||(a[de]=0)});var m=we(r,a=Zi({coordinates:r,directions:a,sizeRestrictions:n,positionRestrictions:s})).width,f=we(r,a).height,p=c.preserveRatio?P(r):Ut(m/f,o);if(p){var _=c.respectDirection;if(_||(_=r.width>=r.height||p===1?"width":"height"),_==="width"){var y=m/p-r.height;if(u.top&&u.bottom){var b=a.top,W=a.bottom;a.bottom=xt(y,W,b),a.top=xt(y,b,W)}else u.bottom?a.bottom=y:u.top?a.top=y:u.right?a.right=0:u.left&&(a.left=0)}else if(_==="height"){var V=r.width-f*p;if(u.left&&u.right){var K=a.left,re=a.right;a.left=-xt(V,K,re),a.right=-xt(V,re,K)}else u.left?a.left=-V:u.right?a.right=-V:u.top?a.top=0:u.bottom&&(a.bottom=0)}a=Zi({directions:a,coordinates:r,sizeRestrictions:n,positionRestrictions:s,preserveRatio:!0,compensate:c.compensate})}return m=we(r,a).width,f=we(r,a).height,(p=c.preserveRatio?P(r):Ut(m/f,o))&&Math.abs(p-m/f)>.001&&ye.forEach(function(de){u[de]||(a[de]=0)}),ti({event:new li({left:-a.left,top:-a.top}),coordinates:{width:i.width+a.right+a.left,height:i.height+a.top+a.bottom,left:i.left,top:i.top},positionRestrictions:s})}},moveAlgorithm:{type:Function,default:ti},initStretcher:{type:Function,default:function(e){var t=e.stretcher,i=e.imageSize,o=P(i);t.style.width=i.width+"px",t.style.height=t.clientWidth/o+"px",t.style.width=t.clientWidth+"px"}},fitCoordinates:{type:Function,default:function(e){var t=e.visibleArea,i=e.coordinates,o=e.aspectRatio,s=e.sizeRestrictions,n=e.positionRestrictions,r=M(M({},i),Se({width:i.width,height:i.height,aspectRatio:o,sizeRestrictions:{maxWidth:t.width,maxHeight:t.height,minHeight:Math.min(t.height,s.minHeight),minWidth:Math.min(t.width,s.minWidth)}}));return r=te(r=ce(r,Ke(ee(i),ee(r))),It(xe(t),n))}},fitVisibleArea:{type:Function,default:function(e){var t=e.visibleArea,i=e.boundaries,o=e.getAreaRestrictions,s=e.coordinates,n=M({},t);n.height=n.width/P(i),n.top+=(t.height-n.height)/2,(s.height-n.height>0||s.width-n.width>0)&&(n=ge(n,Math.max(s.height/n.height,s.width/n.width)));var r=Et(et(s,xe(n=ge(n,$t(n,o({visibleArea:n,type:"resize"}))))));return n.width<s.width&&(r.left=0),n.height<s.height&&(r.top=0),n=te(n=ce(n,r),o({visibleArea:n,type:"move"}))}},areaRestrictionsAlgorithm:{type:Function,default:function(e){var t=e.visibleArea,i=e.boundaries,o=e.imageSize,s=e.imageRestriction,n=e.type,r={};return s==="fill-area"?r={left:0,top:0,right:o.width,bottom:o.height}:s==="fit-area"&&(P(i)>P(o)?(r={top:0,bottom:o.height},t&&n==="move"&&(t.width>o.width?(r.left=-(t.width-o.width)/2,r.right=o.width-r.left):(r.left=0,r.right=o.width))):(r={left:0,right:o.width},t&&n==="move"&&(t.height>o.height?(r.top=-(t.height-o.height)/2,r.bottom=o.height-r.top):(r.top=0,r.bottom=o.height)))),r}},sizeRestrictionsAlgorithm:{type:Function,default:function(e){return{minWidth:e.minWidth,minHeight:e.minHeight,maxWidth:e.maxWidth,maxHeight:e.maxHeight}}},positionRestrictionsAlgorithm:{type:Function,default:function(e){var t=e.imageSize,i={};return e.imageRestriction!=="none"&&(i={left:0,top:0,right:t.width,bottom:t.height}),i}}},data:function(){return{transitionsActive:!1,imageLoaded:!1,imageAttributes:{width:null,height:null,crossOrigin:null,src:null},defaultImageTransforms:{rotate:0,flip:{horizontal:!1,vertical:!1}},appliedImageTransforms:{rotate:0,flip:{horizontal:!1,vertical:!1}},boundaries:{width:0,height:0},visibleArea:null,coordinates:L({},qi)}},computed:{image:function(){return{src:this.imageAttributes.src,width:this.imageAttributes.width,height:this.imageAttributes.height,transforms:this.imageTransforms}},imageTransforms:function(){return{rotate:this.appliedImageTransforms.rotate,flip:{horizontal:this.appliedImageTransforms.flip.horizontal,vertical:this.appliedImageTransforms.flip.vertical},translateX:this.visibleArea?this.visibleArea.left/this.coefficient:0,translateY:this.visibleArea?this.visibleArea.top/this.coefficient:0,scaleX:1/this.coefficient,scaleY:1/this.coefficient}},imageSize:function(){var e=function(t){return t*Math.PI/180}(this.imageTransforms.rotate);return{width:Math.abs(this.imageAttributes.width*Math.cos(e))+Math.abs(this.imageAttributes.height*Math.sin(e)),height:Math.abs(this.imageAttributes.width*Math.sin(e))+Math.abs(this.imageAttributes.height*Math.cos(e))}},initialized:function(){return!!(this.visibleArea&&this.imageLoaded)},settings:function(){var e=Jt(this.resizeImage,{touch:!0,wheel:{ratio:.1},adjustStencil:!0},{touch:!1,wheel:!1,adjustStencil:!1});return{moveImage:Jt(this.moveImage,{touch:!0,mouse:!0},{touch:!1,mouse:!1}),resizeImage:e}},coefficient:function(){return this.visibleArea?this.visibleArea.width/this.boundaries.width:0},areaRestrictions:function(){return this.imageLoaded?this.areaRestrictionsAlgorithm({imageSize:this.imageSize,imageRestriction:this.imageRestriction,boundaries:this.boundaries}):{}},transitionsOptions:function(){return{enabled:this.transitionsActive,timingFunction:"ease-in-out",time:350}},sizeRestrictions:function(){if(this.boundaries.width&&this.boundaries.height&&this.imageSize.width&&this.imageSize.height){var e=this.sizeRestrictionsAlgorithm({imageSize:this.imageSize,minWidth:Q(this.minWidth)?0:yt(this.minWidth),minHeight:Q(this.minHeight)?0:yt(this.minHeight),maxWidth:Q(this.maxWidth)?1/0:yt(this.maxWidth),maxHeight:Q(this.maxHeight)?1/0:yt(this.maxHeight)});if(e=function(o){var s=o.areaRestrictions,n=o.sizeRestrictions,r=o.boundaries,c=o.positionRestrictions,a=M(M({},n),{minWidth:n.minWidth!==void 0?n.minWidth:0,minHeight:n.minHeight!==void 0?n.minHeight:0,maxWidth:n.maxWidth!==void 0?n.maxWidth:1/0,maxHeight:n.maxHeight!==void 0?n.maxHeight:1/0});c.left!==void 0&&c.right!==void 0&&(a.maxWidth=Math.min(a.maxWidth,c.right-c.left)),c.bottom!==void 0&&c.top!==void 0&&(a.maxHeight=Math.min(a.maxHeight,c.bottom-c.top));var u=ei(s),m=yn(r,u);return u.width<1/0&&(!a.maxWidth||a.maxWidth>m.width)&&(a.maxWidth=Math.min(a.maxWidth,m.width)),u.height<1/0&&(!a.maxHeight||a.maxHeight>m.height)&&(a.maxHeight=Math.min(a.maxHeight,m.height)),a.minWidth>a.maxWidth&&(a.minWidth=a.maxWidth,a.widthFrozen=!0),a.minHeight>a.maxHeight&&(a.minHeight=a.maxHeight,a.heightFrozen=!0),a}({sizeRestrictions:e,areaRestrictions:this.getAreaRestrictions({visibleArea:this.visibleArea,type:"resize"}),imageSize:this.imageSize,boundaries:this.boundaries,positionRestrictions:this.positionRestrictions,imageRestriction:this.imageRestriction,visibleArea:this.visibleArea,stencilSize:this.getStencilSize()}),this.visibleArea&&this.stencilSize){var t=this.getStencilSize(),i=ei(this.getAreaRestrictions({visibleArea:this.visibleArea,type:"resize"}));e.maxWidth=Math.min(e.maxWidth,i.width*t.width/this.boundaries.width),e.maxHeight=Math.min(e.maxHeight,i.height*t.height/this.boundaries.height),e.maxWidth<e.minWidth&&(e.minWidth=e.maxWidth),e.maxHeight<e.minHeight&&(e.minHeight=e.maxHeight)}return e}return{minWidth:0,minHeight:0,maxWidth:0,maxHeight:0}},positionRestrictions:function(){return this.positionRestrictionsAlgorithm({imageSize:this.imageSize,imageRestriction:this.imageRestriction})},classes:function(){return{cropper:Re(),image:X(Re("image"),this.imageClass),stencil:Re("stencil"),boundaries:X(Re("boundaries"),this.boundariesClass),stretcher:X(Re("stretcher")),background:X(Re("background"),this.backgroundClass),foreground:X(Re("foreground"),this.foregroundClass),imageWrapper:X(Re("image-wrapper")),cropperWrapper:X(Re("cropper-wrapper"))}},stencilCoordinates:function(){if(this.initialized){var e=this.coordinates,t=e.width,i=e.height,o=e.left,s=e.top;return{width:t/this.coefficient,height:i/this.coefficient,left:(o-this.visibleArea.left)/this.coefficient,top:(s-this.visibleArea.top)/this.coefficient}}return this.defaultCoordinates()},boundariesStyle:function(){var e={width:this.boundaries.width?"".concat(Math.round(this.boundaries.width),"px"):"auto",height:this.boundaries.height?"".concat(Math.round(this.boundaries.height),"px"):"auto",transition:"opacity ".concat(this.transitionTime,"ms"),pointerEvents:this.imageLoaded?"all":"none"};return this.imageLoaded||(e.opacity="0"),e},imageStyle:function(){var e=this.imageAttributes.width>this.imageAttributes.height?{width:Math.min(1024,this.imageAttributes.width),height:Math.min(1024,this.imageAttributes.width)/(this.imageAttributes.width/this.imageAttributes.height)}:{height:Math.min(1024,this.imageAttributes.height),width:Math.min(1024,this.imageAttributes.height)*(this.imageAttributes.width/this.imageAttributes.height)},t={left:(e.width-this.imageSize.width)/(2*this.coefficient),top:(e.height-this.imageSize.height)/(2*this.coefficient)},i={left:(1-1/this.coefficient)*e.width/2,top:(1-1/this.coefficient)*e.height/2},o=L(L({},this.imageTransforms),{},{scaleX:this.imageTransforms.scaleX*(this.imageAttributes.width/e.width),scaleY:this.imageTransforms.scaleY*(this.imageAttributes.height/e.height)}),s={width:"".concat(e.width,"px"),height:"".concat(e.height,"px"),left:"0px",top:"0px",transform:"translate(".concat(-t.left-i.left-this.imageTransforms.translateX,"px, ").concat(-t.top-i.top-this.imageTransforms.translateY,"px)")+Rn(o)};return this.transitionsOptions.enabled&&(s.transition="".concat(this.transitionsOptions.time,"ms ").concat(this.transitionsOptions.timingFunction)),s}},watch:{src:function(){this.onChangeImage()},stencilComponent:function(){var e=this;this.$nextTick(function(){e.resetCoordinates(),e.runAutoZoom("setCoordinates"),e.onChange()})},minWidth:function(){this.onPropsChange()},maxWidth:function(){this.onPropsChange()},minHeight:function(){this.onPropsChange()},maxHeight:function(){this.onPropsChange()},imageRestriction:function(){this.reset()},stencilProps:function(e,t){["aspectRatio","minAspectRatio","maxAspectRatio"].find(function(i){return e[i]!==t[i]})&&this.$nextTick(this.onPropsChange)}},created:function(){this.debouncedUpdate=Kt(this.update,this.debounce),this.debouncedDisableTransitions=Kt(this.disableTransitions,this.transitionsOptions.time),this.awaiting=!1},mounted:function(){this.$refs.image.addEventListener("load",this.onSuccessLoadImage),this.$refs.image.addEventListener("error",this.onFailLoadImage),this.onChangeImage(),window.addEventListener("resize",this.refresh),window.addEventListener("orientationchange",this.refresh)},unmounted:function(){window.removeEventListener("resize",this.refresh),window.removeEventListener("orientationchange",this.refresh),this.imageAttributes.revoke&&this.imageAttributes.src&&URL.revokeObjectURL(this.imageAttributes.src),this.debouncedUpdate.clear(),this.debouncedDisableTransitions.clear()},methods:{getResult:function(){var e=this.initialized?this.prepareResult(L({},this.coordinates)):this.defaultCoordinates(),t={rotate:this.imageTransforms.rotate%360,flip:L({},this.imageTransforms.flip)};if(this.src&&this.imageLoaded){var i=this;return{image:this.image,coordinates:e,visibleArea:this.visibleArea?L({},this.visibleArea):null,imageTransforms:t,get canvas(){return i.canvas?i.getCanvas():void 0}}}return{image:this.image,coordinates:e,visibleArea:this.visibleArea?L({},this.visibleArea):null,canvas:void 0,imageTransforms:t}},zoom:function(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=i.transitions,s=o===void 0||o;this.onManipulateImage(new dt({},{factor:1/e,center:t}),{normalize:!1,transitions:s})},move:function(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=i.transitions,s=o===void 0||o;this.onManipulateImage(new dt({left:e||0,top:t||0}),{normalize:!1,transitions:s})},setCoordinates:function(e){var t=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=i.autoZoom,s=o===void 0||o,n=i.transitions,r=n===void 0||n;this.$nextTick(function(){t.imageLoaded?(t.transitionsActive||(r&&t.enableTransitions(),t.coordinates=t.applyTransform(e),s&&t.runAutoZoom("setCoordinates"),r&&t.debouncedDisableTransitions()),t.onChange()):t.delayedTransforms=e})},refresh:function(){var e=this,t=this.$refs.image;if(this.src&&t)return this.initialized?this.updateVisibleArea().then(function(){e.onChange()}):this.resetVisibleArea().then(function(){e.onChange()})},reset:function(){var e=this;return this.resetVisibleArea().then(function(){e.onChange(!1)})},awaitRender:function(e){var t=this;this.awaiting||(this.awaiting=!0,this.$nextTick(function(){e(),t.awaiting=!1}))},prepareResult:function(e){return this.roundResult?function(t){var i=t.coordinates,o=t.sizeRestrictions,s=t.positionRestrictions,n={width:Math.round(i.width),height:Math.round(i.height),left:Math.round(i.left),top:Math.round(i.top)};return n.width>o.maxWidth?n.width=Math.floor(i.width):n.width<o.minWidth&&(n.width=Math.ceil(i.width)),n.height>o.maxHeight?n.height=Math.floor(i.height):n.height<o.minHeight&&(n.height=Math.ceil(i.height)),te(n,s)}(L(L({},this.getPublicProperties()),{},{positionRestrictions:_t(this.positionRestrictions,this.visibleArea),coordinates:e})):e},processAutoZoom:function(e,t,i,o){var s=this.autoZoomAlgorithm;s||(s=this.stencilSize?ks:this.autoZoom?Ms:Es);var n=s({event:{type:e,params:o},visibleArea:t,coordinates:i,boundaries:this.boundaries,aspectRatio:this.getAspectRatio(),positionRestrictions:this.positionRestrictions,getAreaRestrictions:this.getAreaRestrictions,sizeRestrictions:this.sizeRestrictions,stencilSize:this.getStencilSize()});return L(L({},n),{},{changed:!Yi(n.visibleArea,t)||!Yi(n.coordinates,i)})},runAutoZoom:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=t.transitions,o=i!==void 0&&i,s=vs(t,Ys),n=this.processAutoZoom(e,this.visibleArea,this.coordinates,s),r=n.visibleArea,c=n.coordinates,a=n.changed;o&&a&&this.enableTransitions(),this.visibleArea=r,this.coordinates=c,o&&a&&this.debouncedDisableTransitions()},normalizeEvent:function(e){return function(t){var i=t.event,o=t.visibleArea,s=t.coefficient;if(i.type==="manipulateImage")return M(M({},i),{move:{left:i.move&&i.move.left?s*i.move.left:0,top:i.move&&i.move.top?s*i.move.top:0},scale:{factor:i.scale&&i.scale.factor?i.scale.factor:1,center:i.scale&&i.scale.center?{left:i.scale.center.left*s+o.left,top:i.scale.center.top*s+o.top}:null}});if(i.type==="resize"){var n=M(M({},i),{directions:M({},i.directions)});return ye.forEach(function(c){n.directions[c]*=s}),n}if(i.type==="move"){var r=M(M({},i),{directions:M({},i.directions)});return Cs.forEach(function(c){r.directions[c]*=s}),r}return i}(L(L({},this.getPublicProperties()),{},{event:e}))},getCanvas:function(){if(this.$refs.canvas){var e=this.$refs.canvas,t=this.$refs.image,i=this.imageTransforms.rotate!==0||this.imageTransforms.flip.horizontal||this.imageTransforms.flip.vertical?function(c,a,u){var m=u.rotate,f=u.flip,p={width:a.naturalWidth,height:a.naturalHeight},_=_n(p,m),y=c.getContext("2d");c.height=_.height,c.width=_.width,y.save();var b=Oe(ee(M({left:0,top:0},p)),m);return y.translate(-(b.left-_.width/2),-(b.top-_.height/2)),y.rotate(m*Math.PI/180),y.translate(f.horizontal?p.width:0,f.vertical?p.height:0),y.scale(f.horizontal?-1:1,f.vertical?-1:1),y.drawImage(a,0,0,p.width,p.height),y.restore(),c}(this.$refs.sourceCanvas,t,this.imageTransforms):t,o=L({minWidth:0,minHeight:0,maxWidth:1/0,maxHeight:1/0,maxArea:this.maxCanvasSize,imageSmoothingEnabled:!0,imageSmoothingQuality:"high",fillColor:"transparent"},this.canvas),s=function(c){return c.find(function(a){return u=a,!Number.isNaN(parseFloat(u))&&isFinite(u);var u})},n=Se({sizeRestrictions:{minWidth:s([o.width,o.minWidth])||0,minHeight:s([o.height,o.minHeight])||0,maxWidth:s([o.width,o.maxWidth])||1/0,maxHeight:s([o.height,o.maxHeight])||1/0},width:this.coordinates.width,height:this.coordinates.height,aspectRatio:{minimum:this.coordinates.width/this.coordinates.height,maximum:this.coordinates.width/this.coordinates.height}});if(o.maxArea&&n.width*n.height>o.maxArea){var r=Math.sqrt(o.maxArea/(n.width*n.height));n={width:Math.round(r*n.width),height:Math.round(r*n.height)}}return function(c,a,u,m,f){c.width=m?m.width:u.width,c.height=m?m.height:u.height;var p=c.getContext("2d");p.clearRect(0,0,c.width,c.height),f&&(f.imageSmoothingEnabled&&(p.imageSmoothingEnabled=f.imageSmoothingEnabled),f.imageSmoothingQuality&&(p.imageSmoothingQuality=f.imageSmoothingQuality),f.fillColor&&(p.fillStyle=f.fillColor,p.fillRect(0,0,c.width,c.height),p.save()));var _=u.left<0?-u.left:0,y=u.top<0?-u.top:0;p.drawImage(a,u.left+_,u.top+y,u.width,u.height,_,y,c.width,c.height)}(e,i,this.coordinates,n,o),e}},update:function(){this.$emit("change",this.getResult())},applyTransform:function(e){var t=arguments.length>1&&arguments[1]!==void 0&&arguments[1],i=this.visibleArea&&t?As(this.sizeRestrictions,this.visibleArea):this.sizeRestrictions,o=this.visibleArea&&t?_t(this.positionRestrictions,this.visibleArea):this.positionRestrictions;return Ss({transform:e,coordinates:this.coordinates,imageSize:this.imageSize,sizeRestrictions:i,positionRestrictions:o,aspectRatio:this.getAspectRatio(),visibleArea:this.visibleArea})},resetCoordinates:function(){var e=this;if(this.$refs.image){this.$refs.cropper,this.$refs.image;var t=this.defaultSize;t||(t=this.stencilSize?Ds:Is);var i=this.sizeRestrictions;i.minWidth,i.minHeight,i.maxWidth,i.maxHeight;var o=Xe(t)?t({boundaries:this.boundaries,imageSize:this.imageSize,aspectRatio:this.getAspectRatio(),sizeRestrictions:this.sizeRestrictions,stencilSize:this.getStencilSize(),visibleArea:this.visibleArea}):t,s=this.defaultPosition||$s,n=[o,function(r){var c=r.coordinates;return L({},Xe(s)?s({coordinates:c,imageSize:e.imageSize,visibleArea:e.visibleArea}):e.defaultPosition)}];this.delayedTransforms&&n.push.apply(n,Ne(Array.isArray(this.delayedTransforms)?this.delayedTransforms:[this.delayedTransforms])),this.coordinates=this.applyTransform(n,!0),this.delayedTransforms=null}},clearImage:function(){var e=this;this.imageLoaded=!1,setTimeout(function(){var t=e.$refs.stretcher;t&&(t.style.height="auto",t.style.width="auto"),e.coordinates=e.defaultCoordinates(),e.boundaries={width:0,height:0}},this.transitionTime)},enableTransitions:function(){this.transitions&&(this.transitionsActive=!0)},disableTransitions:function(){this.transitionsActive=!1},updateBoundaries:function(){var e=this,t=this.$refs.stretcher,i=this.$refs.cropper;return this.initStretcher({cropper:i,stretcher:t,imageSize:this.imageSize}),this.$nextTick().then(function(){var o={cropper:i,imageSize:e.imageSize};if(Xe(e.defaultBoundaries)?e.boundaries=e.defaultBoundaries(o):e.defaultBoundaries==="fit"?e.boundaries=function(s){var n=s.cropper,r=s.imageSize,c=n.clientHeight,a=n.clientWidth,u=c,m=r.width*c/r.height;return m>a&&(m=a,u=r.height*a/r.width),{width:m,height:u}}(o):e.boundaries=function(s){var n=s.cropper;return{width:n.clientWidth,height:n.clientHeight}}(o),!e.boundaries.width||!e.boundaries.height)throw new Error("It's impossible to fit the cropper in the current container")})},resetVisibleArea:function(){var e=this;return this.appliedImageTransforms=L(L({},this.defaultImageTransforms),{},{flip:L({},this.defaultImageTransforms.flip)}),this.updateBoundaries().then(function(){e.priority!=="visible-area"&&(e.visibleArea=null,e.resetCoordinates());var t,i,o,s,n,r,c=e.defaultVisibleArea||Ts;e.visibleArea=Xe(c)?c({imageSize:e.imageSize,boundaries:e.boundaries,coordinates:e.priority!=="visible-area"?e.coordinates:null,getAreaRestrictions:e.getAreaRestrictions,stencilSize:e.getStencilSize()}):e.defaultVisibleArea,e.visibleArea=(t={visibleArea:e.visibleArea,boundaries:e.boundaries,getAreaRestrictions:e.getAreaRestrictions},i=t.visibleArea,o=t.boundaries,s=t.getAreaRestrictions,n=M({},i),r=P(o),n.width/n.height!==r&&(n.height=n.width/r),te(n,s({visibleArea:n,type:"move"}))),e.priority==="visible-area"?e.resetCoordinates():e.coordinates=e.fitCoordinates({visibleArea:e.visibleArea,coordinates:e.coordinates,aspectRatio:e.getAspectRatio(),positionRestrictions:e.positionRestrictions,sizeRestrictions:e.sizeRestrictions}),e.runAutoZoom("resetVisibleArea")}).catch(function(){e.visibleArea=null})},updateVisibleArea:function(){var e=this;return this.updateBoundaries().then(function(){e.visibleArea=e.fitVisibleArea({imageSize:e.imageSize,boundaries:e.boundaries,visibleArea:e.visibleArea,coordinates:e.coordinates,getAreaRestrictions:e.getAreaRestrictions}),e.coordinates=e.fitCoordinates({visibleArea:e.visibleArea,coordinates:e.coordinates,aspectRatio:e.getAspectRatio(),positionRestrictions:e.positionRestrictions,sizeRestrictions:e.sizeRestrictions}),e.runAutoZoom("updateVisibleArea")}).catch(function(){e.visibleArea=null})},onChange:function(){var e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];e&&this.debounce?this.debouncedUpdate():this.update()},onChangeImage:function(){var e,t=this;if(this.imageLoaded=!1,this.delayedTransforms=null,this.src){if(function(s){if(Hi(s))return!1;var n=window.location,r=/(\w+:)?(?:\/\/)([\w.-]+)?(?::(\d+))?\/?/.exec(s)||[],c={protocol:r[1]||"",host:r[2]||"",port:r[3]||""},a=function(u){return u.port||((u.protocol||n.protocol)==="http"?80:433)};return!(!c.protocol&&!c.host&&!c.port||c.protocol&&c.protocol==n.protocol&&c.host&&c.host==n.host&&c.host&&a(c)==a(n))}(this.src)){var i=Q(this.crossOrigin)?this.canvas:this.crossOrigin;i===!0&&(i="anonymous"),this.imageAttributes.crossOrigin=i||null}if(this.checkOrientation){var o=(e=this.src,new Promise(function(s){Ns(e).then(function(n){var r=qs(n);s(n?{source:e,arrayBuffer:n,orientation:r}:{source:e,arrayBuffer:null,orientation:null})}).catch(function(n){console.warn(n),s({source:e,arrayBuffer:null,orientation:null})})}));setTimeout(function(){o.then(t.onParseImage)},this.transitionTime)}else setTimeout(function(){t.onParseImage({source:t.src})},this.transitionTime)}else this.clearImage()},onFailLoadImage:function(){this.imageAttributes.src&&(this.clearImage(),this.$emit("error"))},onSuccessLoadImage:function(){var e=this,t=this.$refs.image;t&&!this.imageLoaded&&(this.imageAttributes.height=t.naturalHeight,this.imageAttributes.width=t.naturalWidth,this.imageLoaded=!0,this.resetVisibleArea().then(function(){e.$emit("ready"),e.onChange(!1)}))},onParseImage:function(e){var t=this,i=e.source,o=e.arrayBuffer,s=e.orientation;this.imageAttributes.revoke&&this.imageAttributes.src&&URL.revokeObjectURL(this.imageAttributes.src),this.imageAttributes.revoke=!1,o&&s&&s>1?pn(i)||!Hi(i)?(this.imageAttributes.src=URL.createObjectURL(new Blob([o])),this.imageAttributes.revoke=!0):this.imageAttributes.src=function(n){for(var r=[],c=new Uint8Array(n);c.length>0;){var a=c.subarray(0,8192);r.push(String.fromCharCode.apply(null,Array.from?Array.from(a):a.slice())),c=c.subarray(8192)}return"data:image/jpeg;base64,"+btoa(r.join(""))}(o):this.imageAttributes.src=i,Xe(this.defaultTransforms)?this.appliedImageTransforms=Nt(this.defaultTransforms()):At(this.defaultTransforms)?this.appliedImageTransforms=Nt(this.defaultTransforms):this.appliedImageTransforms=function(n){var r=Nt({});if(n)switch(n){case 2:r.flip.horizontal=!0;break;case 3:r.rotate=-180;break;case 4:r.flip.vertical=!0;break;case 5:r.rotate=90,r.flip.vertical=!0;break;case 6:r.rotate=90;break;case 7:r.rotate=90,r.flip.horizontal=!0;break;case 8:r.rotate=-90}return r}(s),this.defaultImageTransforms=L(L({},this.appliedImageTransforms),{},{flip:L({},this.appliedImageTransforms.flip)}),this.$nextTick(function(){var n=t.$refs.image;n&&n.complete&&(function(r){return!!r.naturalWidth}(n)?t.onSuccessLoadImage():t.onFailLoadImage())})},onResizeEnd:function(){this.runAutoZoom("resize",{transitions:!0})},onMoveEnd:function(){this.runAutoZoom("move",{transitions:!0})},onMove:function(e){var t=this;this.transitionsOptions.enabled||this.awaitRender(function(){t.coordinates=t.moveAlgorithm(L(L({},t.getPublicProperties()),{},{positionRestrictions:_t(t.positionRestrictions,t.visibleArea),coordinates:t.coordinates,event:t.normalizeEvent(e)})),t.onChange()})},onResize:function(e){var t=this;this.transitionsOptions.enabled||this.stencilSize&&!this.autoZoom||this.awaitRender(function(){var i=t.sizeRestrictions,o=Math.min(t.coordinates.width,t.coordinates.height,20*t.coefficient);t.coordinates=t.resizeAlgorithm(L(L({},t.getPublicProperties()),{},{positionRestrictions:_t(t.positionRestrictions,t.visibleArea),sizeRestrictions:{maxWidth:Math.min(i.maxWidth,t.visibleArea.width),maxHeight:Math.min(i.maxHeight,t.visibleArea.height),minWidth:Math.max(i.minWidth,o),minHeight:Math.max(i.minHeight,o)},event:t.normalizeEvent(e)})),t.onChange(),t.ticking=!1})},onManipulateImage:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.transitionsOptions.enabled){var i=t.transitions,o=i!==void 0&&i,s=t.normalize,n=s===void 0||s;o&&this.enableTransitions();var r=Os(L(L({},this.getPublicProperties()),{},{event:n?this.normalizeEvent(e):e,getAreaRestrictions:this.getAreaRestrictions,imageRestriction:this.imageRestriction,adjustStencil:!this.stencilSize&&this.settings.resizeImage.adjustStencil})),c=r.visibleArea,a=r.coordinates;this.visibleArea=c,this.coordinates=a,this.runAutoZoom("manipulateImage"),this.onChange(),o&&this.debouncedDisableTransitions()}},onPropsChange:function(){this.coordinates=this.applyTransform(this.coordinates,!0),this.onChange(!1)},getAreaRestrictions:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.visibleArea,i=e.type,o=i===void 0?"move":i;return this.areaRestrictionsAlgorithm({boundaries:this.boundaries,imageSize:this.imageSize,imageRestriction:this.imageRestriction,visibleArea:t,type:o})},getAspectRatio:function(e){var t,i,o=this.stencilProps,s=o.aspectRatio,n=o.minAspectRatio,r=o.maxAspectRatio;if(this.$refs.stencil&&this.$refs.stencil.aspectRatios){var c=this.$refs.stencil.aspectRatios();t=c.minimum,i=c.maximum}if(Q(t)&&(t=Q(s)?n:s),Q(i)&&(i=Q(s)?r:s),!e&&(Q(t)||Q(i))){var a=this.getStencilSize(),u=a?P(a):null;Q(t)&&(t=Ni(u)?u:void 0),Q(i)&&(i=Ni(u)?u:void 0)}return{minimum:t,maximum:i}},getStencilSize:function(){if(this.stencilSize)return e={currentStencilSize:{width:this.stencilCoordinates.width,height:this.stencilCoordinates.height},stencilSize:this.stencilSize,boundaries:this.boundaries,coefficient:this.coefficient,coordinates:this.coordinates,aspectRatio:this.getAspectRatio(!0)},t=e.boundaries,i=e.stencilSize,o=e.aspectRatio,Ut(P(s=Xe(i)?i({boundaries:t,aspectRatio:o}):i),o)&&(s=Se({sizeRestrictions:{maxWidth:t.width,maxHeight:t.height,minWidth:0,minHeight:0},width:s.width,height:s.height,aspectRatio:{minimum:o.minimum,maximum:o.maximum}})),(s.width>t.width||s.height>t.height)&&(s=Se({sizeRestrictions:{maxWidth:t.width,maxHeight:t.height,minWidth:0,minHeight:0},width:s.width,height:s.height,aspectRatio:{minimum:P(s),maximum:P(s)}})),s;var e,t,i,o,s},getPublicProperties:function(){return{coefficient:this.coefficient,visibleArea:this.visibleArea,coordinates:this.coordinates,boundaries:this.boundaries,sizeRestrictions:this.sizeRestrictions,positionRestrictions:this.positionRestrictions,aspectRatio:this.getAspectRatio(),imageRestriction:this.imageRestriction}},defaultCoordinates:function(){return L({},qi)},flip:function(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=i.transitions,s=o===void 0||o;if(!this.transitionsActive){s&&this.enableTransitions();var n=L({},this.imageTransforms.flip),r=Ls({flip:{horizontal:e?!n.horizontal:n.horizontal,vertical:t?!n.vertical:n.vertical},previousFlip:n,rotate:this.imageTransforms.rotate,visibleArea:this.visibleArea,coordinates:this.coordinates,imageSize:this.imageSize,positionRestrictions:this.positionRestrictions,sizeRestrictions:this.sizeRestrictions,getAreaRestrictions:this.getAreaRestrictions,aspectRatio:this.getAspectRatio()}),c=r.visibleArea,a=r.coordinates;e&&(this.appliedImageTransforms.flip.horizontal=!this.appliedImageTransforms.flip.horizontal),t&&(this.appliedImageTransforms.flip.vertical=!this.appliedImageTransforms.flip.vertical),this.visibleArea=c,this.coordinates=a,this.onChange(),s&&this.debouncedDisableTransitions()}},rotate:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=t.transitions,o=i===void 0||i;if(!this.transitionsActive){o&&this.enableTransitions();var s=L({},this.imageSize);this.appliedImageTransforms.rotate+=e;var n=Fs({visibleArea:this.visibleArea,coordinates:this.coordinates,previousImageSize:s,imageSize:this.imageSize,angle:e,positionRestrictions:this.positionRestrictions,sizeRestrictions:this.sizeRestrictions,getAreaRestrictions:this.getAreaRestrictions,aspectRatio:this.getAspectRatio()}),r=n.visibleArea,c=n.coordinates,a=this.processAutoZoom("rotateImage",r,c);r=a.visibleArea,c=a.coordinates,this.visibleArea=r,this.coordinates=c,this.onChange(),o&&this.debouncedDisableTransitions()}}},emits:["change","error","ready"]},Xs={key:0,ref:"canvas",style:{display:"none"}},Gs={key:1,ref:"sourceCanvas",style:{display:"none"}};En.render=function(e,t,i,o,s,n){return v(),A("div",{ref:"cropper",class:n.classes.cropper},[x("div",{ref:"stretcher",class:n.classes.stretcher},null,2),x("div",{class:n.classes.boundaries,style:n.boundariesStyle},[(v(),A(_e(i.backgroundWrapperComponent),{class:n.classes.cropperWrapper,"wheel-resize":n.settings.resizeImage.wheel,"touch-resize":n.settings.resizeImage.touch,"touch-move":n.settings.moveImage.touch,"mouse-move":n.settings.moveImage.mouse,onMove:n.onManipulateImage,onResize:n.onManipulateImage},{default:R(function(){return[x("div",{class:n.classes.background,style:n.boundariesStyle},null,6),x("div",{class:n.classes.imageWrapper},[x("img",{ref:"image",crossorigin:s.imageAttributes.crossOrigin,src:s.imageAttributes.src,class:n.classes.image,style:n.imageStyle,onMousedown:t[1]||(t[1]=le(function(){},["prevent"]))},null,46,["crossorigin","src"])],2),x("div",{class:n.classes.foreground,style:n.boundariesStyle},null,6),He((v(),A(_e(i.stencilComponent),St({ref:"stencil",image:n.image,coordinates:s.coordinates,"stencil-coordinates":n.stencilCoordinates,transitions:n.transitionsOptions},i.stencilProps,{onResize:n.onResize,onResizeEnd:n.onResizeEnd,onMove:n.onMove,onMoveEnd:n.onMoveEnd}),null,16,["image","coordinates","stencil-coordinates","transitions","onResize","onResizeEnd","onMove","onMoveEnd"])),[[Ki,s.imageLoaded]]),i.canvas?(v(),A("canvas",Xs,null,512)):O("",!0),i.canvas?(v(),A("canvas",Gs,null,512)):O("",!0)]}),_:1},8,["class","wheel-resize","touch-resize","touch-move","mouse-move","onMove","onResize"]))],6)],2)};const Zs=e=>(tn("data-v-bec7f64d"),e=e(),nn(),e),Qs={class:"nc-image-cropper-wrapper relative"},Ks={key:0,class:"result_preview"},Js=["src"],ea={class:"flex justify-between items-center space-x-4 mt-4"},ta={class:"flex items-center space-x-4"},ia={class:"flex items-center space-x-4"},na=Zs(()=>g("span",{class:"ml-2"},"Crop",-1)),oa=Mt({__name:"ImageCropper",props:{imageConfig:{},cropperConfig:{},uploadConfig:{},showCropper:{type:Boolean}},emits:["update:showCropper","submit"],setup(e,{emit:t}){const i=go(e,["imageConfig","cropperConfig","uploadConfig"]),o=t,s=Ji(i,"showCropper",o),{api:n,isLoading:r}=vo(),c=F(),a=F({canvas:{},src:""}),u=()=>{const{canvas:p}=c.value.getResult();a.value={canvas:p,src:p.toDataURL()}},m=async p=>{var _,y;if((_=e.uploadConfig)!=null&&_.path)try{const b=await n.storage.uploadByUrl({path:(y=e.uploadConfig)==null?void 0:y.path},p);b!=null&&b[0]?o("submit",{...b[0],data:p[0].data}):o("submit",p[0])}catch(b){console.error(b),Ze.error(await oi(b))}else o("submit",p[0]);s.value=!1},f=async()=>{a.value.canvas&&a.value.canvas.toBlob(async p=>{await m([{title:e.imageConfig.name,fileName:e.imageConfig.name,mimetype:e.imageConfig.type,size:p.size,url:a.value.src,data:a.value.src}])},e.imageConfig.type)};return Ge(s,()=>{s.value||(a.value={canvas:{},src:""})}),(p,_)=>{const y=ni,b=en,W=No;return v(),A(W,{visible:l(s),"onUpdate:visible":_[1]||(_[1]=V=>Le(s)?s.value=V:null),"mask-closable":!1},{default:R(()=>{var V,K,re,de;return[g("div",Qs,[x(l(En),{ref_key:"cropperRef",ref:c,class:"nc-cropper relative",src:p.imageConfig.src,"auto-zoom":!0,"stencil-props":((V=p.cropperConfig)==null?void 0:V.stencilProps)||{},"min-height":(K=p.cropperConfig)==null?void 0:K.minHeight,"min-width":(re=p.cropperConfig)==null?void 0:re.minWidth,"image-restriction":(de=p.cropperConfig)==null?void 0:de.imageRestriction},null,8,["src","stencil-props","min-height","min-width","image-restriction"]),l(a).src?(v(),B("div",Ks,[g("img",{src:l(a).src,alt:"Preview Image"},null,8,Js)])):O("",!0)]),g("div",ea,[g("div",ta,[x(y,{type:"secondary",size:"small",disabled:l(r),onClick:_[0]||(_[0]=ze=>s.value=!1)},{default:R(()=>[se(" Cancel ")]),_:1},8,["disabled"])]),g("div",ia,[x(y,{type:"secondary",size:"small",disabled:l(r),onClick:u},{default:R(()=>[x(b,{icon:"crop"}),na]),_:1},8,["disabled"]),x(y,{size:"small",loading:l(r),disabled:!l(a).src,onClick:f},{default:R(()=>[se(" Save ")]),_:1},8,["loading","disabled"])])])]}),_:1},8,["visible"])}}}),sa=si(oa,[["__scopeId","data-v-bec7f64d"]]);const aa={class:"nc-column-insert-before nc-form-header-menu-item"},ra={class:"nc-column-delete nc-form-header-menu-item text-red-600"},la=Mt({__name:"FieldMenu",props:{column:{},formColumn:{},isRequired:{type:Boolean},isOpen:{type:Boolean},onDelete:{type:Function}},emits:["hideField","update:isOpen","delete"],setup(e,{emit:t}){const i=e,o=t,{column:s,isRequired:n}=bo(i),r=Ji(i,"isOpen",o),{eventBus:c}=Ko(),a=Ae(on),u=Ae(sn,F()),m=Ae(an,F()),f=Ae(rn);Yt(wo,s);const{$api:p}=ri(),{t:_}=ai(),{getMeta:y}=ln(),b=F(!1),W=F(!1),V=F(),K=F(),re=async()=>{var E;let w={};const k=Jo(`${s.value.title} copy`,u.value.columns);w={...s.value,...s.value.colOptions??{},title:k,column_name:k.replace(/\s/g,"_"),id:void 0,colOptions:void 0,order:void 0,system:!1};try{const S=(await p.dbViewColumn.list((E=m.value)==null?void 0:E.id)).list,q=S.findIndex(Y=>Y.fk_column_id===s.value.id);let ie;q===S.length-1?ie=S[q].order+1:ie=(S[q].order+S[q+1].order)/2,await p.dbTableColumn.create(u.value.id,{...w,pv:!1,view_id:m.value.id,column_order:{order:ie,view_id:m.value.id}}),await y(u.value.id,!0),c.emit(yo.FIELD_RELOAD),a==null||a.trigger()}catch(S){Ze.error(await oi(S))}r.value=!1},de=async()=>{var w;if(s!=null&&s.value)if(s.value.uidt&&[j.Lookup,j.Rollup,j.CreatedTime,j.LastModifiedTime,j.CreatedBy,j.LastModifiedBy].includes(s.value.uidt))re();else{const k=(await p.dbViewColumn.list((w=m.value)==null?void 0:w.id)).list,E=k.findIndex(q=>q.fk_column_id===s.value.id);let S;E===k.length-1?S=k[E].order+1:S=(k[E].order+k[E+1].order)/2,V.value={pv:!1,view_id:m.value.id,column_order:{order:S,view_id:m.value.id}},s.value.uidt===j.Formula?Ct(()=>{var q;(q=K==null?void 0:K.value)==null||q.duplicate()}):W.value=!0,r.value=!1}},ze=async()=>{n.value||(r.value=!1,o("hideField"))},C=()=>{r.value=!1,b.value=!0},it=me(()=>(s==null?void 0:s.value)&&!s.value.system),N=me(()=>(s==null?void 0:s.value)&&!s.value.system);return(w,k)=>{const E=ni,S=Xo,q=hn,ie=Go,Y=cn,Be=Zo,Dt=Qo;return v(),B(Fe,null,[l(f)?O("",!0):(v(),A(Y,{key:0,visible:l(r),"onUpdate:visible":k[1]||(k[1]=he=>Le(r)?r.value=he:null),trigger:["click"],placement:"bottomLeft","overlay-class-name":"nc-dropdown-form-column-operations !border-1 rounded-lg !shadow-xl",onClick:k[2]||(k[2]=le(he=>r.value=!l(r),["stop"]))},{overlay:R(()=>[x(ie,{class:"flex flex-col gap-1 border-gray-200 nc-column-options"},{default:R(()=>{var he;return[O("",!0),x(S,{disabled:l(n),onClick:ze},{default:R(()=>[g("div",aa,[(v(),A(_e(("iconMap"in w?w.iconMap:l(Qe)).eye),{class:"!w-3.75 !h-3.75"})),se(" "+$(w.$t("general.hideField")),1)])]),_:1},8,["disabled"]),(he=l(s))!=null&&he.pv?O("",!0):(v(),B(Fe,{key:1},[x(q,{class:"!my-0"}),x(S,{disabled:!it.value,class:"!hover:bg-red-50",onClick:C},{default:R(()=>[g("div",ra,[(v(),A(_e(("iconMap"in w?w.iconMap:l(Qe)).delete))),se(" "+$(w.$t("general.delete")),1)])]),_:1},8,["disabled"])],64))]}),_:1})]),default:R(()=>[x(E,{type:"secondary",size:"small",class:"nc-form-add-field","data-testid":"nc-form-add-field",onClick:k[0]||(k[0]=le(he=>w.showAddColumnDropdown=!0,["stop"]))},{default:R(()=>[(v(),A(_e(("iconMap"in w?w.iconMap:l(Qe)).threeDotVertical),{class:"flex-none w-4 h-4"}))]),_:1})]),_:1},8,["visible"])),x(Be,{visible:l(b),"onUpdate:visible":k[3]||(k[3]=he=>Le(b)?b.value=he:null),class:"nc-form-column-delete-dropdown","on-delete-column":w.onDelete},null,8,["visible","on-delete-column"]),l(s)?(v(),A(Dt,{key:1,ref_key:"duplicateDialogRef",ref:K,modelValue:l(W),"onUpdate:modelValue":k[4]||(k[4]=he=>Le(W)?W.value=he:null),column:l(s),extra:l(V)},null,8,["modelValue","column","extra"])):O("",!0)],64)}}}),ca=si(la,[["__scopeId","data-v-4aab5ffe"]]),da=Mt({__name:"Layout",setup(e){const{leftSidebarWidth:t,windowSize:i,formRightSidebarState:o,formRightSidebarWidthPercent:s}=Xt(is()),n=me(()=>100-s.value);function r(a){const u=a*(i.value-t.value)/100;u>o.value.maxWidth?o.value.width=o.value.maxWidth:u<o.value.minWidth?o.value.width=o.value.minWidth:o.value.width=u}const c=me(()=>o.value.width>o.value.maxWidth?o.value.maxWidth:o.value.width<o.value.minWidth?o.value.minWidth:o.value.width);return(a,u)=>(v(),A(l(un),{class:"nc-form-right-sidebar-content-resizable-wrapper w-full h-full",onResize:u[0]||(u[0]=m=>r(m[1].size))},{default:R(()=>[x(l(kt),{size:l(n),class:"flex-1 h-full"},{default:R(()=>[Me(a.$slots,"preview")]),_:3},8,["size"]),x(l(kt),{"min-size":"15%",class:"nc-sidebar-splitpane relative",size:l(s),style:Gt({minWidth:`${l(o).minWidth}px !important`,maxWidth:`${l(c)}px !important`})},{default:R(()=>[Me(a.$slots,"sidebar")]),_:3},8,["size","style"])]),_:3}))}}),ha=mn.useForm,[ua,ma]=ss((e,t,i,o,s)=>{const{$api:n}=ri(),{t:r}=ai(),c=dn(),a=F({}),u=F([]),m=F(""),f=me(()=>u.value.filter(w=>w.show).sort((w,k)=>w.order-k.order)),p=me(()=>f.value.find(w=>w.id===m.value)||null),_=me(()=>{var w;if(e.value&&p.value){if(e.value.columnsById&&e.value.columnsById[(w=p.value)==null?void 0:w.fk_column_id])return e.value.columnsById[p.value.fk_column_id];if(e.value.columns)return e.value.columns.find(k=>{var E;return k.id===((E=p.value)==null?void 0:E.fk_column_id)})??null}return null}),y=me(()=>{const w=new Set;return f.value.reduce((k,E)=>(k[E.title]=as(E.title,w),k),{})}),b=me(()=>{const w={};if(!f.value||!Object.keys(y.value).length)return w;for(const k of f.value){let E=[{validator:(q,ie)=>new Promise((Y,Be)=>N(k,k.required)&&(typeof ie=="string"&&(ie=ie.trim()),k.uidt===j.Checkbox&&!ie||k.uidt!==j.Checkbox&&!ls(ie))?Be(r("msg.error.fieldRequired")):Y())}];const S=rs(Te(k.meta).validators??[],k);E=[...E,...S],E.length&&(w[y.value[k.title]]=E)}return w}),W=me(()=>Object.keys(y.value).length?Object.keys(a.value).reduce((w,k)=>(w[y.value[k]]=a.value[k],w),{}):{}),{validate:V,validateInfos:K,clearValidate:re}=ha(W,b),de=async w=>{if(w.title){if(y.value[w.title]===void 0){console.warn("Missing mapping field for:",w.title);return}try{await V(y.value[w.title])}catch{}}},ze=()=>{var k,E,S;if(typeof((k=i.value)==null?void 0:k.redirect_url)!="string")return{validateStatus:"",help:void 0};const w=((S=(E=i.value)==null?void 0:E.redirect_url)==null?void 0:S.trim())??"";return!w.startsWith("http://")&&!w.startsWith("https://")?{validateStatus:"error",help:"Redirect url must starts with `http://` or `https://`"}:{validateStatus:"",help:void 0}},C=Zt(()=>{ze().validateStatus==="error"&&(i.value={...i.value,redirect_url:""}),o(i.value)},300,{maxWait:2e3}),it=Zt(async w=>{if(w.id&&s){de(w);try{await n.dbView.formColumnUpdate(w.id,w)}catch(k){Ze.error(await oi(k))}}},250);function N(w,k=!1){var S;let E=w;return Rt(E.uidt)&&E.colOptions&&E.colOptions.type===ct.BELONGS_TO&&(E=(((S=e==null?void 0:e.value)==null?void 0:S.columns)||[]).find(q=>q.id===E.colOptions.fk_child_column_id)),k||E&&E.rqd&&!E.cdf}return{onReset:c.on,formState:a,localColumns:u,visibleColumns:f,activeRow:m,activeField:p,activeColumn:_,isRequired:N,updateView:C,updateColMeta:it,validate:V,validateInfos:K,clearValidate:re,fieldMappings:y,isValidRedirectUrl:ze,formViewData:i}},"form-view-store");function Ul(){const e=ma();if(e==null)throw new Error("Please call `useProvideFormViewStore` on the appropriate parent component");return e}const fa=Ee(()=>$e(()=>import("./CF2HExrO.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]),import.meta.url).then(e=>e.default||e)),pa=Ee(()=>$e(()=>import("./DXof0zKo.js"),__vite__mapDeps([16,1,2]),import.meta.url).then(e=>e.default||e)),ga=Ee(()=>$e(()=>import("./D51uA4Lq.js"),__vite__mapDeps([17,1,2,18,13,19]),import.meta.url).then(e=>e.default||e)),va=Ee(()=>$e(()=>import("./DQfYvTkb.js"),__vite__mapDeps([20,1,2,21,22,23,18,24,25,13,26]),import.meta.url).then(e=>e.default||e)),ba=Ee(()=>$e(()=>import("./H9SMaBKT.js"),__vite__mapDeps([27,1,2,28]),import.meta.url).then(e=>e.default||e)),wa=Ee(()=>$e(()=>import("./CCQiMKiG.js"),__vite__mapDeps([29,1,2]),import.meta.url).then(e=>e.default||e)),ya=Ee(()=>$e(()=>import("./Dn4WscrN.js"),__vite__mapDeps([30,31,1,2,32,33,34,35,5,6,7,8,9,10,11,36,18,37,13,38,39,40,41,42,43,44,45,46,47,48,25,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,22,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80]),import.meta.url).then(e=>e.default||e)),_a=Ee(()=>$e(()=>import("./D1QYX3xc.js"),__vite__mapDeps([81,1,2,78,61,62,8,59,82,83,84,85,75,33,36,18,37,13,86,87,88,89,90,91,32,67,92,22,93,77,25,94,95,96,97,98,99,100,40,41,42,43,44,65,21,23,24,46,5,6,7,9,10,11]),import.meta.url).then(e=>e.default||e)),xa=Ee(()=>$e(()=>import("./Cgw6cdOy.js").then(e=>e.ja),__vite__mapDeps([1,2]),import.meta.url).then(e=>e.default||e)),tt=e=>(tn("data-v-4699d277"),e=e(),nn(),e),za={class:"h-full relative"},Ca={key:0,class:"pl-6 pr-[120px] py-6 bg-white flex-col justify-start items-start gap-2.5 inline-flex"},Ra={class:"text-gray-500 text-5xl font-semibold leading-16"},Aa=tt(()=>g("br",null,null,-1)),Sa={class:"text-gray-500 text-base font-medium leading-normal"},ka={class:"max-w-[max(33%,688px)] mx-auto"},Ma={class:"transition-all duration-300 ease-in relative my-6 bg-white rounded-3xl border-1 border-gray-200 px-4 py-8 lg:p-12 md:p-8 md:dark:bg-slate-700"},Ea={key:0,class:"items-center justify-center text-left mt-2"},$a={class:"text-2xl font-bold text-gray-900 mb-4"},Ia={key:0},Da={class:"flex justify-center"},Ta={class:"w-full"},Oa={key:1},Fa={class:"mt-16 w-full flex justify-between items-center gap-3"},La={key:0,class:"text-gray-400"},Ba={key:1,class:"flex-1 flex justify-end"},Pa={key:1,class:"nc-form-wrapper h-full w-full flex relative","data-testid":"nc-form-wrapper"},Wa={key:0,class:"flex-1 flex items-center justify-center text-center h-full"},ja={class:"mt-2"},Va={class:"min-w-[616px] overflow-x-auto nc-form-scrollbar"},Ua={key:1,class:"group relative max-w-[max(33%,688px)] mx-auto"};const Ha={class:"flex flex-col px-4 lg:px-6"};const Na={key:1,class:"font-bold text-2xl text-gray-900"},qa=["data-title","onClick"],Ya={key:0,class:"absolute -left-3 top-6"},Xa={class:"text-sm font-semibold text-gray-800"},Ga={"data-testid":"nc-form-input-label"},Za={key:0,class:"text-red-500 text-base leading-[18px]"},Qa={class:"nc-form-field-body"},Ka={class:"mt-2"},Ja={key:0,class:"mt-4 border-dashed border-2 border-gray-400 py-3 text-gray-400 text-center"},er={class:"flex justify-between items-center mt-6 !px-8 !lg:px-12"},tr={key:0,class:"px-8 lg:px-12"},ir={class:"inline-block"},nr={class:"px-3 pt-4 pb-2 flex items-center justify-between border-b border-gray-200 font-medium"},or={class:"flex items-center"},sr=tt(()=>g("div",{class:"px-1.75 text-gray-500 text-xl font-normal"},"/",-1)),ar={class:"flex items-center pr-1 py-1.5 text-gray-800"},rr={class:"text-center"},lr={"data-testid":"nc-form-input-label"},cr={class:"flex items-center space-x-2"},dr={class:"nc-edit-or-add-provider-wrapper"},hr={class:"nc-form-field-text p-4 flex flex-col gap-4 border-b border-gray-200"},ur={class:"text-sm font-bold text-gray-800"},mr={class:"flex flex-wrap justify-between items-center gap-2"},fr={class:"flex items-center gap-3"},pr={class:"text-sm font-bold text-gray-800"},gr={class:"flex gap-2 items-center"},vr={class:"nc-edit-or-add-provider-wrapper"},br={autocomplete:"off"},wr={class:"nc-form-fields-list border-1 border-gray-200 rounded-lg overflow-y-auto nc-form-scrollbar"},yr={key:0,class:"px-0.5 py-2 text-gray-500 text-center"},_r=tt(()=>g("div",{class:"w-4 h-4 flex-none mx-2"},null,-1)),xr={class:"flex-1 flex flex-row items-center truncate cursor-pointer"},zr={class:"flex-1 font-base my-1.5"},Cr={class:"flex items-center px-2"},Rr=["data-testid"],Ar={class:"py-1.5 flex items-center"},Sr={class:"flex-1 flex items-center justify-between cursor-pointer max-w-[calc(100%_-_20px)] py-1.5"},kr=["onClick"],Mr={class:"flex-1 flex items-center justify-start max-w-[calc(100%_-_28px)]"},Er={class:"w-full flex items-center"},$r={class:"text-center"},Ir={"data-testid":"nc-field-title"},Dr={key:0,class:"truncate inline-flex text-xs font-normal text-gray-700"},Tr=tt(()=>g("span",null,"(",-1)),Or={class:"text-center"},Fr={"data-testid":"nc-field-title "},Lr=tt(()=>g("span",null,")",-1)),Br={key:1,class:"text-red-500 text-sm align-top"},Pr={class:"px-0.5 py-2 text-gray-500 text-center"},Wr={class:"p-4 flex flex-col space-y-4 border-b border-gray-200"},jr={class:"text-sm font-bold text-gray-800"},Vr={class:"flex flex-col space-y-3"},Ur={class:"text-gray-800"},Hr={class:"flex justify-start"};const Nr={class:"flex items-center justify-between gap-3"},qr={class:"p-4 flex flex-col space-y-4"},Yr={class:"text-sm font-bold text-gray-800"},Xr={class:"flex flex-col gap-3"},Gr={class:"flex flex-col gap-3"},Zr={class:"flex items-center justify-between gap-3"},Qr={key:0,class:"flex flex-col gap-2 max-w-[calc(100%_-_40px)]"},Kr=tt(()=>g("div",{class:"text-small leading-[18px] text-gray-400 pl-3"},[se(" Use {record_id} to get ID of the newly created record. "),g("a",{href:"https://docs.nocodb.com/views/view-types/form/#redirect-url",target:"_blank",rel:"noopener noreferrer",class:"!no-underline !hover:underline"}," Learn more ")],-1)),Jr={class:"flex items-center justify-between gap-3"},el={class:"flex items-center justify-between gap-3"},tl={class:"flex items-center justify-between gap-3"},il={class:"text-bold text-gray-600 underline"},nl={key:0,class:"pb-10"},ol={class:"text-gray-800 mb-2"},sl={key:2,class:"absolute inset-0 bg-black/40 z-500 grid place-items-center"},al={class:"text-center bg-white px-6 py-8 rounded-xl max-w-lg"},rl={class:"text-2xl text-gray-800 font-bold"},ll={class:"capitalize"},cl={class:"text-sm text-gray-700 pt-6"},dl=Mt({__name:"Form",setup(e){Yt(_o,F(!0)),Yt(xo,F(!1));const t=["created_at","updated_at"],i=[j.Rollup,j.Lookup,j.Formula,j.QrCode,j.Barcode,j.Button,j.SpecificDBType,j.CreatedTime,j.LastModifiedTime,j.CreatedBy,j.LastModifiedBy],o=[lt.code,lt.blockQuote,lt.bulletList,lt.numberedList,lt.taskList],{isMobileMode:s,user:n}=zo(),{$api:r,$e:c}=ri(),{isUIAllowed:a}=Co(),{metas:u,getMeta:m}=ln(),{base:f}=Xt(Ro()),{getPossibleAttachmentSrc:p}=ns(),_=F(0),y=Ae(rn,F(!1)),b=a("viewFieldEdit"),W=Ae(sn,F()),V=Ae(an,F()),K=Ae(Ao,F(!1)),{loadFormView:re,insertRow:de,formColumnData:ze,formViewData:C,updateFormView:it}=os(W,V),{formState:N,localColumns:w,visibleColumns:k,activeRow:E,activeField:S,activeColumn:q,isRequired:ie,updateView:Y,updateColMeta:Be,validateInfos:Dt,validate:he,clearValidate:$n,fieldMappings:nt,isValidRedirectUrl:In}=ua(W,V,C,it,b),{preFillFormSearchParams:ui}=Xt(So()),Pe=Ae(on,dn());Pe.on(async()=>{await Promise.all([re(),yi()]),vi()});const{fields:qe,showAll:Dn,hideAll:Tn}=cs(),{state:We,row:On}=ds(F({row:N.value,oldRow:{},rowMeta:{new:!0}})),mi=me(()=>{var d;return((d=W==null?void 0:W.value)==null?void 0:d.columns)||[]}),Tt=F(),Ot=F([]),ne=F({showColumnMenu:!1,showEditColumn:!1,showAddColumn:!1}),ut=F(!1),je=F(!1),ot=F(!1),Ft=F(!1),mt=F(!1),oe=F({imageConfig:{src:"",type:"",name:""},cropperConfig:{stencilProps:{},minHeight:0,minWidth:0,imageRestriction:"none"},uploadConfig:{path:""},cropFor:"banner"}),ft=F(),Ie=F(""),Lt=F(!1),{t:Bt}=ai(),{open:Fn,onChange:Ln}=ko({accept:"image/*",multiple:!1,reset:!0}),pt=F(),fi=d=>{var h;ne.value[d]=!0,pt.value&&!((h=pt.value)!=null&&h.isWebHookModalOpen())&&(ne.value[d]=!1)},ul=me(()=>{var d;return p(Te((d=C.value)==null?void 0:d.logo_url))}),Bn=F(!1),Pt=F({validateStatus:"",help:void 0}),Ye=me({get:()=>{var d;return typeof((d=C.value)==null?void 0:d.redirect_url)=="string"},set:d=>{Bn.value=d,d?C.value={...C.value,redirect_url:""}:(C.value={...C.value,redirect_url:null},Pt.value={validateStatus:"",help:void 0}),Y()}}),Pn=()=>{const d=In();Pt.value={...d},d.validateStatus!=="error"&&Y()},Wn=(d,h)=>{var D,ae,G;let z;switch(d.uidt){case j.LinkToAnotherRecord:case j.Links:{const ue=Array.isArray(h)?h:[h],Z=(D=d==null?void 0:d.colOptions)==null?void 0:D.fk_related_model_id;if(!Z)return;const fe=ue.map(U=>es(U,u.value[Z].columns||[])).filter(U=>!!U).join(",");z=fe||void 0,(((ae=d.colOptions)==null?void 0:ae.type)===ct.BELONGS_TO||((G=d.colOptions)==null?void 0:G.type)===ct.ONE_TO_ONE)&&(z=fe[0]);break}default:return h}return z},jn=Zt(()=>{if(y.value||!a("dataInsert"))return;const d={...N.value,...We.value},h=new URLSearchParams;for(const z of k.value){if(!z.title||!Wi(d[z.title])||Ue(z)&&!Rt(z)||hs(z)||z.uidt===j.SpecificDBType)continue;const D=Wn(z,d[z.title]);D!==void 0&&h.append(z.title,D)}ui.value=h.toString()},250);async function Vn(){var d;if(!(y.value||!a("dataInsert"))){for(const h of k.value)ie(h,h.required)&&N.value[h.title]===void 0&&(N.value[h.title]=null);try{await he(Object.keys(N.value).map(h=>nt.value[h]).filter(h=>h!==void 0))}catch(h){if(console.error(h),(d=h==null?void 0:h.errorFields)!=null&&d.length){Ze.error(Bt("msg.error.someOfTheRequiredFieldsAreEmpty"));return}}await de({row:{...N.value,...We.value},oldRow:{},rowMeta:{new:!0}}),ot.value=!0}}async function Wt(){y.value||!a("dataInsert")||(N.value={},We.value={},$n(),Pe.trigger())}function Un(d){if(t.includes(d.fk_column_id))return!1;let h=!Ue(d)&&d.rqd&&!Wi(d==null?void 0:d.cdf)&&!mi.value.some(z=>{var D;return Rt(z.uidt)&&((D=z==null?void 0:z.colOptions)==null?void 0:D.type)===ct.BELONGS_TO&&d.fk_column_id===z.colOptions.fk_child_column_id})||d.pk&&!d.ai&&!d.cdf;if(d.uidt===j.LinkToAnotherRecord&&d.colOptions.type===ct.BELONGS_TO){const z=mi.value.find(D=>D.id===d.colOptions.fk_child_column_id);z.rqd&&!z.default&&(h=!0)}return h}function Hn(d){if(d.from!==d.to&&gt(d.draggedContext.element))return!1}async function pi(d,h=!1){var G,ue,Z,fe;if(y.value||!b)return;let{newIndex:z,element:D}=d.moved;const ae=(G=qe.value)==null?void 0:G.findIndex(U=>(U==null?void 0:U.fk_column_id)===D.fk_column_id);ae===-1||ae===void 0||!((ue=qe.value)!=null&&ue[ae])||(h&&(D=w.value[(Z=w.value)==null?void 0:Z.findIndex(U=>U.fk_column_id===D.fk_column_id)],z=w.value.findIndex(U=>U.fk_column_id===k.value[z].fk_column_id)),!w.value.length||w.value.length===1?D.order=1:w.value.length-1===z?D.order=Math.max(...w.value.map(U=>(U==null?void 0:U.order)??0))+1:z===0?D.order=Math.min(...w.value.map(U=>(U==null?void 0:U.order)??0))/2:D.order=((((fe=w.value[z-1])==null?void 0:fe.order)??0)+(w.value[z+1].order??0))/2,await r.dbView.formColumnUpdate(D.id,D),qe.value[ae]=D,w.value=[...w.value].sort((U,st)=>U.order!==void 0&&st.order!==void 0?U.order-st.order:0),c("a:form-view:reorder"))}async function gi(d,h,z=!1){var ae,G;if(y.value||!b)return;if(gt(d)){!z&&Ze.info(Bt("msg.info.requriedFieldsCantBeMoved"));return}const D=(ae=qe.value)==null?void 0:ae.findIndex(ue=>(ue==null?void 0:ue.fk_column_id)===d.fk_column_id);D!==-1&&D!==void 0&&((G=qe.value)!=null&&G[D])&&(d.show=h,await r.dbView.formColumnUpdate(d.id,d),qe.value[D]=d,Pe.trigger(),c(h?"a:form-view:show-columns":"a:form-view:hide-columns")),!h&&!z&&E.value&&(E.value="")}function gt(d){return Un(d)||!!d.required||!!d.rqd&&!d.cdf||d.uidt===j.QrCode||d.uidt===j.Barcode}async function Nn(d){if(!(y.value||!b))if(d){for(const h of w==null?void 0:w.value)h.show=!0;await Dn(Ot.value),c("a:form-view:add-all")}else{for(const h of w==null?void 0:w.value)gt(h)||(h.show=!1);await Tn(w==null?void 0:w.value.filter(h=>gt(h)).map(h=>h.fk_column_id)),c("a:form-view:remove-all")}}async function qn(){return je.value&&!Pi&&!await r.plugin.status("SMTP")?(je.value=!1,Ze.info(Bt("msg.toast.formEmailSMTP")),!1):!0}function vi(){var z,D,ae,G,ue;const d=(ze==null?void 0:ze.value)||[];Ot.value=Mo(d).map(Z=>Z.fk_column_id),C.value={banner_image_url:null,logo_url:null,...C.value,submit_another_form:!!(((z=C.value)==null?void 0:z.submit_another_form)??0),show_blank_form:!!(((D=C.value)==null?void 0:D.show_blank_form)??0),meta:{hide_branding:!1,background_color:"#F9F9FA",hide_banner:!1,...Te((ae=C.value)==null?void 0:ae.meta)??{}}};let h={};try{h=JSON.parse(((G=C.value)==null?void 0:G.email)||"")||{}}catch{}je.value=h[(ue=n.value)==null?void 0:ue.email],w.value=d.filter(Z=>!i.includes(Z.uidt)&&!Ot.value.includes(Z.fk_column_id)).sort((Z,fe)=>Z.order-fe.order).map(Z=>({...Z,required:!!Z.required}))}async function Yn(){var d,h,z;try{if(!await qn())return;const D=(d=C.value)!=null&&d.email?JSON.parse((h=C.value)==null?void 0:h.email):{};D[(z=n.value)==null?void 0:z.email]=je.value,C.value.email=JSON.stringify(D)}catch{}}function Xn(){Yn(),Y()}function bi(){S.value&&(delete N.value[S.value.title],Ue(S.value)&&delete We.value[S.value.title])}async function Gn(){ne.value.showAddColumn=!1,Pe.trigger()}async function Zn(){var d;ne.value.showEditColumn=!1,S.value&&S.value.uidt!==((d=q.value)==null?void 0:d.uidt)&&bi(),Pe.trigger()}async function Qn(){bi(),Pe.trigger()}const vt=(d,h=!1)=>{y.value||!b||(h&&(Lt.value=!0),E.value=d.id)},Kn=d=>{var z;if(y.value||!b)return;Bo(d).isValid()&&(((z=C.value)==null?void 0:z.meta).background_color=d,Y())},ml=d=>{var h,z;!b||!Pi||(oe.value.uploadConfig={path:[Po,f.value.id,(h=W.value)==null?void 0:h.id,(z=C.value)==null?void 0:z.id].join("/")},d?(oe.value.cropperConfig={...oe.value.cropperConfig,stencilProps:{aspectRatio:4/1},minHeight:100,minWidth:0},oe.value.cropFor="banner"):(oe.value.cropperConfig={...oe.value.cropperConfig,stencilProps:{aspectRatio:void 0},minHeight:150,minWidth:150},oe.value.cropFor="logo"),Fn())};Ln(d=>{if(d&&d[0]){oe.value.imageConfig.src&&URL.revokeObjectURL(oe.value.imageConfig.src);const h=URL.createObjectURL(d[0]);oe.value.imageConfig={src:h,type:d[0].type,name:d[0].name},mt.value=!0}});const Jn=(d=null)=>{oe.value.cropFor==="banner"?C.value.banner_image_url=d:C.value.logo_url=d,Y()},eo=d=>{d.target.select()},to=d=>{S.value&&(S.value.title===d?S.value.label=null:S.value.label=d)},wi=(d,h)=>{const z=document.querySelector(`${h?".nc-form-field-item-":".nc-form-drag-"}${CSS.escape(d==null?void 0:d.replaceAll(" ",""))}`);z&&setTimeout(()=>{z==null||z.scrollIntoView({behavior:"smooth",block:"center"})},50)};async function yi(){await Promise.all((w.value||[]).map(async d=>{var z;const h=(z=d==null?void 0:d.colOptions)==null?void 0:z.fk_related_model_id;return Ue(d)&&Rt(d)&&h&&await m(h),d}))}return Eo(async()=>{oe.value.src&&URL.revokeObjectURL(oe.value.imageConfig.src),ui.value="",Ft.value=!0,await Promise.all([re(),yi()]),vi(),Ft.value=!1}),Ge(ot,d=>{var h;if(d&&((h=C.value)!=null&&h.show_blank_form)){_.value=5;const z=$o(()=>{--_.value<0&&(ot.value=!1,Wt(),clearInterval(z))},1e3)}}),Ge(V,d=>{(d==null?void 0:d.type)===Io.FORM&&Pe.trigger()}),Ge([N,We],async()=>{for(const d in We.value)N.value[d]=We.value[d];jn();try{await he(Object.keys(N.value).map(d=>nt.value[d]).filter(d=>d!==void 0))}catch{}},{deep:!0}),Ge(S,(d,h)=>{d&&Lt.value?Ct(()=>{wi(d.title,!1)}):h&&Ct(()=>{wi(h.title,!0)}),Lt.value=!1,ne.value={...ne.value,showColumnMenu:!1,showEditColumn:!1}}),Ge([ft,S],()=>{S&&ft.value&&Ct(()=>{var d;(d=ft.value)==null||d.focus()})}),Bi(document,"keydown",d=>{var z,D;const h=Do()?d.metaKey:d.ctrlKey;switch((z=d.key)==null?void 0:z.toLowerCase()){case"s":h&&!(["input","textarea"].includes(d.target.nodeName.toLowerCase())||(D=d.target)!=null&&D.getAttribute("contenteditable"))&&(d.preventDefault(),Y());break}},!0),Bi(document,"mousedown",d=>{var h,z,D;(h=Tt.value)!=null&&h.targetDomElement&&((z=Tt.value)!=null&&z.targetDomElement.contains(d.target))||(D=d.target)!=null&&D.closest('.nc-form-right-panel, [class*="dropdown"], .nc-form-rich-text-field, .ant-modal, .ant-modal-wrap, .nc-share-base-button, .nc-form-right-sidebar-content-resizable-wrapper .splitpanes__splitter')||(E.value="")},!0),(d,h)=>{var Si,ki,Mi,Ei,$i,Ii,Di,Ti,Oi,Fi;const z=Uo,D=fa,ae=ms,G=ni,ue=Wo,Z=sa,fe=jo,U=pa,st=fs,bt=ps,io=ga,no=va,oo=ba,so=wa,ao=mn,ro=hn,lo=Ho,co=Vo,_i=qo,xi=Yo,zi=ya,Ci=cn,ho=ca,uo=_a,mo=ts,Ri=en,Ai=us,Ve=gs,fo=xa,po=da,at=To("e");return v(),B("div",za,[l(s)?(v(),B("div",Ca,[g("div",Ra,[se($(d.$t("general.available")),1),Aa,se($(d.$t("title.inDesktop")),1)]),g("div",Sa,$(d.$t("msg.formViewNotSupportedOnMobile")),1)])):(v(),B(Fe,{key:1},[l(ot)?(v(),B("div",{key:0,class:"h-full p-6 overflow-auto nc-form-scrollbar",style:Gt({background:((ki=("parseProp"in d?d.parseProp:l(Te))((Si=l(C))==null?void 0:Si.meta))==null?void 0:ki.background_color)||"#F9F9FA"}),"data-testid":"nc-form-wrapper-submit"},[g("div",ka,[("parseProp"in d?d.parseProp:l(Te))((Mi=l(C))==null?void 0:Mi.meta).hide_banner?O("",!0):(v(),A(z,{key:0,"banner-image-url":(Ei=l(C))==null?void 0:Ei.banner_image_url},null,8,["banner-image-url"])),g("div",Ma,[l(C)?(v(),B("div",Ea,[g("div",null,[g("h1",$a,$(l(C).heading),1),($i=l(C).subheading)!=null&&$i.trim()?(v(),B("div",Ia,[x(D,{value:l(C).subheading,class:"font-medium text-base text-gray-500 !h-auto mb-4 -ml-1","is-form-field":"","read-only":"","sync-value-change":""},null,8,["value"])])):O("",!0)]),g("div",Da,[g("div",Ta,[x(ae,{class:"nc-form-success-msg !my-4 !py-4 text-left !rounded-lg",type:"success",outlined:""},{message:R(()=>{var De,H,T;return[(H=(De=l(C))==null?void 0:De.success_msg)!=null&&H.trim()?(v(),A(D,{key:0,value:(T=l(C))==null?void 0:T.success_msg,class:"!h-auto -ml-1","is-form-field":"","read-only":"","sync-value-change":""},null,8,["value"])):(v(),B("span",Oa,$(d.$t("msg.successfullySubmittedFormData")),1))]}),_:1}),g("div",Fa,[l(C).show_blank_form?(v(),B("div",La,$(d.$t("msg.newFormWillBeLoaded",{seconds:l(_)})),1)):O("",!0),l(C).submit_another_form||!l(K)?(v(),B("div",Ba,[x(G,{type:"primary",size:"small",onClick:h[0]||(h[0]=()=>{ot.value=!1,Wt()})},{default:R(()=>[se($(d.$t("activity.submitAnotherForm")),1)]),_:1})])):O("",!0)])])])])):O("",!0)])])],4)):(v(),B("div",Pa,[l(Ft)?(v(),B("div",Wa,[g("div",null,[x(ue,{size:"xlarge"}),g("div",ja,$(d.$t("general.loading")),1)])])):l(C)?(v(),A(po,{key:1},{preview:R(()=>{var De,H,T;return[g("div",{class:"w-full h-full overflow-auto nc-form-scrollbar p-6",style:Gt({background:((De=l(C))==null?void 0:De.meta).background_color||"#F9F9FA"})},[g("div",Va,[l(b)?(v(),A(Z,{key:0,"show-cropper":l(mt),"onUpdate:showCropper":h[1]||(h[1]=ve=>Le(mt)?mt.value=ve:null),"image-config":l(oe).imageConfig,"cropper-config":l(oe).cropperConfig,"upload-config":l(oe).uploadConfig,onSubmit:Jn},null,8,["show-cropper","image-config","cropper-config","upload-config"])):O("",!0),("parseProp"in d?d.parseProp:l(Te))((H=l(C))==null?void 0:H.meta).hide_banner?O("",!0):(v(),B("div",Ua,[(v(),A(z,{key:(T=l(C).banner_image_url)==null?void 0:T.path,"banner-image-url":l(C).banner_image_url},null,8,["banner-image-url"])),O("",!0)])),x(co,{class:"!py-8 !lg:py-12 !border-gray-200 !rounded-3xl !mt-6 !max-w-[max(33%,688px)] !mx-auto","body-style":{margin:"0 auto",padding:"0px !important"}},{default:R(()=>{var ve;return[x(ao,{model:l(N),class:"nc-form","no-style":""},{default:R(()=>[g("div",Ha,[O("",!0),g("div",{class:Ce(["border-transparent px-4 lg:px-6",[{"rounded-2xl overflow-hidden border-2 cursor-pointer mb-1 py-4 lg:py-6 focus-within:bg-gray-50":l(b)},{"mb-4 py-0 lg:py-0":!l(b)},{"hover:bg-gray-50":l(E)!=="nc-form-heading"&&l(b)},{"bg-gray-50":l(E)==="nc-form-heading"&&l(b)},{"!hover:bg-white !ring-0 !cursor-auto":l(y)}]]),onClick:h[9]||(h[9]=le(I=>vt({id:"nc-form-heading"}),["stop"]))},[l(b)?(v(),A(bt,{key:0,class:"!my-0"},{default:R(()=>[x(st,{value:l(C).heading,"onUpdate:value":h[6]||(h[6]=I=>l(C).heading=I),class:"nc-form-focus-element !p-0 !m-0 w-full !font-bold !text-2xl !border-0 !rounded-none !text-gray-900",style:{borderRightWidth:"0px !important",height:"70px","max-height":"250px",resize:"vertical"},"auto-size":"",size:"large","hide-details":"",disabled:l(y),placeholder:"Form Title",bordered:!1,"data-testid":"nc-form-heading","data-title":"nc-form-heading",onInput:l(Y),onFocus:h[7]||(h[7]=I=>E.value="nc-form-heading"),onBlur:h[8]||(h[8]=I=>E.value="")},null,8,["value","disabled","data-testid","data-title","onInput"])]),_:1})):(v(),B("div",Na,$(l(C).heading),1))],2),g("div",{class:Ce(["border-transparent px-4 lg:px-6",[{"rounded-2xl border-2 cursor-pointer mb-1 py-4 lg:py-6 focus-within:bg-gray-50":l(b)},{"mb-4 py-0 lg:py-0":!l(b)},{"hover:bg-gray-50":l(E)!=="nc-form-sub-heading"&&l(b)},{"bg-gray-50":l(E)==="nc-form-sub-heading"&&l(b)},{"!hover:bg-white !ring-0 !cursor-auto":l(y)}]]),onClick:h[13]||(h[13]=le(I=>vt({id:"nc-form-sub-heading"}),["stop"]))},[l(b)&&!l(y)?(v(),A(D,{key:0,value:l(C).subheading,"onUpdate:value":[h[10]||(h[10]=I=>l(C).subheading=I),l(Y)],placeholder:d.$t("msg.info.formDesc"),class:"nc-form-description nc-form-focus-element font-medium text-base !text-gray-500 -ml-1","is-form-field":"",autofocus:l(E)==="nc-form-sub-heading","data-testid":"nc-form-sub-heading","data-title":"nc-form-sub-heading",onFocus:h[11]||(h[11]=I=>E.value="nc-form-sub-heading"),onBlur:h[12]||(h[12]=I=>E.value="")},null,8,["value","placeholder","autofocus","data-testid","data-title","onUpdate:value"])):l(C).subheading?(v(),A(D,{key:1,value:l(C).subheading,class:"font-medium text-base !text-gray-500 -ml-1","is-form-field":"","read-only":"","sync-value-change":""},null,8,["value"])):O("",!0)],2)]),x(l(ji),{ref_key:"draggableRef",ref:Tt,"model-value":l(k),"item-key":"fk_column_id",draggable:".item",handle:".nc-form-field-drag-handler",group:"form-inputs","ghost-class":"nc-form-field-ghost",class:"h-full px-4 lg:px-6",move:Hn,disabled:l(y)||!l(b),onChange:h[15]||(h[15]=I=>pi(I,!0))},{item:R(({element:I})=>[(v(),B("div",{key:I.id,class:Ce(["nc-editable nc-form-focus-element item relative bg-white p-4 lg:p-6",[`nc-form-drag-${I.title.replaceAll(" ","")}`,{"rounded-2xl border-2 my-1":l(b)},{"border-transparent my-0":!l(b)},{"nc-form-field-drag-handler border-transparent hover:bg-gray-50 cursor-pointer":l(E)!==I.id&&l(b)},{"border-brand-500":l(E)===I.id},{"!hover:bg-white !ring-0 !cursor-auto":l(y)}]]),"data-title":I.title,"data-testid":"nc-form-fields",onClick:le(rt=>vt(I),["stop"])},[l(E)===I.id?(v(),B("div",Ya,[x(G,{type:"primary",size:"small",class:"nc-form-field-drag-handler !cursor-move !p-1 !min-w-6 !h-auto !rounded"},{default:R(()=>[(v(),A(_e(("iconMap"in d?d.iconMap:l(Qe)).drag),{class:"nc-form-field-drag-handler flex-none !h-4 !w-4 text-white font-bold"}))]),_:1})])):O("",!0),g("div",Xa,[g("span",Ga,$(I.label||I.title),1),l(ie)(I,I.required)?(v(),B("span",Za,"*")):O("",!0)]),I.description?(v(),A(D,{key:1,value:I.description,"is-form-field":"","read-only":"","sync-value-change":"",class:"nc-form-help-text text-gray-500 text-sm mt-2 -ml-1","data-testid":"nc-form-help-text","onUpdate:value":rt=>l(Be)(I)},null,8,["value","onUpdate:value"])):O("",!0),g("div",Qa,[g("div",Ka,[l(nt)[I.title]?(v(),A(bt,St({key:0,name:l(nt)[I.title],class:"!my-0 nc-input-required-error nc-form-input-item"},l(Dt)[l(nt)[I.title]]),{default:R(()=>[x(oo,{class:"relative",onClick:h[14]||(h[14]=le(()=>{},["stop"]))},{default:R(()=>[l(Ue)(I)?(v(),A(io,{key:0,modelValue:l(N)[I.title],"onUpdate:modelValue":rt=>l(N)[I.title]=rt,row:l(On),class:Ce(["nc-input",`nc-form-input-${I.title.replaceAll(" ","")}`]),"data-testid":`nc-form-input-${I.title.replaceAll(" ","")}`,column:I},null,8,["modelValue","onUpdate:modelValue","row","class","data-testid","column"])):(v(),A(no,{key:1,modelValue:l(N)[I.title],"onUpdate:modelValue":rt=>l(N)[I.title]=rt,class:Ce(["nc-input truncate",[`nc-form-input-${I.title.replaceAll(" ","")}`,{"layout-list":I.meta.isList}]]),"data-testid":`nc-form-input-${I.title.replaceAll(" ","")}`,column:I,"edit-enabled":!0},null,8,["modelValue","onUpdate:modelValue","class","data-testid","column"]))]),_:2},1024)]),_:2},1040,["name"])):O("",!0),x(so,{column:I},null,8,["column"])])])],10,qa))]),footer:R(()=>[!l(k).length&&l(b)?(v(),B("div",Ja,$(d.$t("title.selectFieldsFromRightPannelToAddHere")),1)):O("",!0)]),_:1},8,["model-value","disabled"]),g("div",er,[x(G,{type:"secondary",size:"small",disabled:!l(a)("dataInsert")||!l(k).length,class:"nc-form-clear nc-form-focus-element","data-testid":"nc-form-clear","data-title":"nc-form-clear",onClick:Wt},{default:R(()=>[se($(d.$t("activity.clearForm")),1)]),_:1},8,["disabled"]),x(G,{type:"primary",size:"small",disabled:!l(a)("dataInsert")||!l(k).length,class:"nc-form-submit nc-form-focus-element","data-testid":"nc-form-submit","data-title":"nc-form-submit",onClick:Vn},{default:R(()=>[se($(d.$t("general.submit")),1)]),_:1},8,["disabled"])])]),_:1},8,["model"]),("parseProp"in d?d.parseProp:l(Te))((ve=l(C))==null?void 0:ve.meta).hide_branding?O("",!0):(v(),B("div",tr,[l(y)?O("",!0):(v(),A(ro,{key:0,class:"!my-8"})),g("div",ir,[x(lo)])]))]}),_:1})])],4)]}),sidebar:R(()=>{var De;return[g("div",{class:Ce(["nc-form-right-panel h-full flex-grow max-w-full",{"overflow-y-auto nc-form-scrollbar":l(S)}])},[l(S)&&l(q)?(v(),B("div",{key:(De=l(S))==null?void 0:De.id,class:"nc-form-field-right-panel"},[g("div",nr,[g("div",or,[g("div",{class:"text-gray-600 font-medium cursor-pointer select-none hover:underline",onClick:h[16]||(h[16]=H=>E.value="")},$(d.$t("objects.viewType.form")),1),sr,g("div",ar,[l(Ue)(l(S))?(v(),A(_i,{key:0,"column-meta":l(S),class:"flex-none"},null,8,["column-meta"])):(v(),A(xi,{key:1,"column-meta":l(S),class:"flex-none"},null,8,["column-meta"])),x(fe,{class:"truncate max-w-[120px] text-sm font-semibold","show-on-truncate-only":""},{title:R(()=>[g("div",rr,$(l(S).title),1)]),default:R(()=>[g("span",lr,$(l(S).title),1)]),_:1})])]),g("div",cr,[x(Ci,{visible:l(ne).showEditColumn,"onUpdate:visible":h[20]||(h[20]=H=>l(ne).showEditColumn=H),trigger:["click"],"overlay-class-name":"nc-dropdown-form-edit-column",disabled:!l(a)("fieldEdit"),onVisibleChange:h[21]||(h[21]=H=>fi("showEditColumn"))},{overlay:R(()=>[g("div",dr,[l(ne).showEditColumn?(v(),A(zi,{key:0,ref_key:"editOrAddProviderRef",ref:pt,column:l(q),onSubmit:Zn,onCancel:h[17]||(h[17]=H=>l(ne).showEditColumn=!1),onClick:h[18]||(h[18]=le(()=>{},["stop"])),onKeydown:h[19]||(h[19]=le(()=>{},["stop"]))},null,8,["column"])):O("",!0)])]),default:R(()=>[x(G,{type:"secondary",size:"small",class:"nc-form-add-field","data-testid":"nc-form-add-field"},{default:R(()=>[se($(d.$t("general.edit"))+" "+$(d.$t("objects.field")),1)]),_:1})]),_:1},8,["visible","disabled"]),x(ho,{"is-open":l(ne).showColumnMenu,"onUpdate:isOpen":h[22]||(h[22]=H=>l(ne).showColumnMenu=H),column:l(q),"form-column":l(S),"is-required":l(ie)(l(S),l(S).required),"on-delete":()=>{Qn()},onHideField:h[23]||(h[23]=H=>gi(l(S),!1,!1))},null,8,["is-open","column","form-column","is-required","on-delete"])])]),g("div",hr,[g("div",ur,$(d.$t("objects.field"))+" "+$(d.$t("general.text").toLowerCase()),1),x(st,{ref_key:"focusLabel",ref:ft,value:l(S).label||l(S).title,rows:1,"auto-size":"","hide-details":"",class:"form-meta-input nc-form-input-label !max-h-7.5rem nc-form-scrollbar","data-testid":"nc-form-input-label",placeholder:d.$t("msg.info.formInput"),onFocus:eo,onKeydown:h[24]||(h[24]=Oo(le(()=>{},["prevent"]),["enter"])),onInput:h[25]||(h[25]=H=>to(H.target.value)),onChange:h[26]||(h[26]=H=>l(Be)(l(S)))},null,8,["value","placeholder"]),x(D,{value:l(S).description,"onUpdate:value":[h[27]||(h[27]=H=>l(S).description=H),h[28]||(h[28]=H=>l(Be)(l(S)))],placeholder:d.$t("msg.info.formHelpText"),class:"form-meta-input nc-form-input-help-text","is-form-field":"","hidden-bubble-menu-options":o,"data-testid":"nc-form-input-help-text"},null,8,["value","placeholder"])]),l(S)?(v(),A(uo,{key:0})):O("",!0)])):(v(),B(Fe,{key:1},[l(C)?(v(),A(l(un),{key:0,horizontal:"",class:"nc-form-settings w-full nc-form-right-splitpane"},{default:R(()=>[x(l(kt),{"min-size":"30",size:"50",class:"nc-form-right-splitpane-item p-4 flex flex-col space-y-4 !min-h-200px"},{default:R(()=>{var H;return[g("div",mr,[g("div",fr,[g("div",pr,$(d.$t("objects.viewType.form"))+" "+$(d.$t("objects.fields")),1),x(mo,{color:"border-gray-200"},{default:R(()=>[se($(l(k).length)+"/"+$(l(w).length)+" "+$(d.$t("objects.field")),1)]),_:1})]),l(a)("fieldAdd")?(v(),A(Ci,{key:0,visible:l(ne).showAddColumn,"onUpdate:visible":h[32]||(h[32]=T=>l(ne).showAddColumn=T),trigger:["click"],"overlay-class-name":"nc-dropdown-form-add-column",onVisibleChange:h[33]||(h[33]=T=>fi("showAddColumn"))},{overlay:R(()=>[g("div",vr,[l(ne).showAddColumn?(v(),A(zi,{key:0,ref_key:"editOrAddProviderRef",ref:pt,onSubmit:Gn,onCancel:h[29]||(h[29]=T=>l(ne).showAddColumn=!1),onClick:h[30]||(h[30]=le(()=>{},["stop"])),onKeydown:h[31]||(h[31]=le(()=>{},["stop"]))},null,512)):O("",!0)])]),default:R(()=>[x(G,{type:"secondary",size:"small",class:"nc-form-add-field","data-testid":"nc-form-add-field"},{default:R(()=>[g("div",gr,[(v(),A(_e(("iconMap"in d?d.iconMap:l(Qe)).plus),{class:"w-4 h-4"})),g("span",null,$(d.$t("activity.addFieldFromFormView")),1)])]),_:1})]),_:1},8,["visible"])):O("",!0)]),g("form",br,[x(Ai,{key:"nc-form-field-search-input",value:l(Ie),"onUpdate:value":h[35]||(h[35]=T=>Le(Ie)?Ie.value=T:null),type:"text",autocomplete:"off",class:"!h-9 !px-3 !py-1 !rounded-lg",placeholder:`${d.$t("placeholder.searchFields")}...`,name:"nc-form-field-search-input","data-testid":"nc-form-field-search-input"},{prefix:R(()=>[x(Ri,{icon:"search",class:"mr-2 h-4 w-4 text-gray-500 group-hover:text-black"})]),suffix:R(()=>[l(Ie).length>0?(v(),A(Ri,{key:0,icon:"close",class:"ml-2 h-4 w-4 text-gray-500 group-hover:text-black","data-testid":"nc-form-field-clear-search",onClick:h[34]||(h[34]=T=>Ie.value="")})):O("",!0)]),_:1},8,["value","placeholder"])]),g("div",wr,[l(w).length?O("",!0):(v(),B("div",yr,$(d.$t("title.noFieldsFound")),1)),l(w).length?(v(),B(Fe,{key:1},[g("div",{key:"nc-form-show-all-fields",class:"w-full flex items-center border-b-1 rounded-t-lg border-gray-200 bg-gray-50 sticky top-0 z-100","data-testid":"nc-form-show-all-fields",onClick:h[36]||(h[36]=le(()=>{},["stop"]))},[_r,g("div",xr,[g("div",zr,$(d.$t("activity.selectAllFields")),1),g("div",Cr,[x(Ve,{checked:l(k).length===l(w).length,size:"small",class:"nc-switch",onChange:Nn},null,8,["checked"])])])]),x(l(ji),{list:l(w),"item-key":"id","ghost-class":"nc-form-field-ghost",style:{height:"calc(100% - 64px)"},disabled:l(y)||!l(b),onChange:h[37]||(h[37]=T=>pi(T)),onStart:h[38]||(h[38]=T=>ut.value=!0),onEnd:h[39]||(h[39]=T=>ut.value=!1)},Fo({item:R(({element:T})=>{var ve,J;return[T.title.toLowerCase().includes(l(Ie).toLowerCase())?(v(),B("div",{key:T.id,class:Ce(["w-full px-2 flex flex-row items-center border-b-1 last:border-none border-gray-200",[`nc-form-field-item-${T.title.replaceAll(" ","")}`,`${l(E)===T.id?"bg-brand-50 font-medium":"hover:bg-gray-50"}`]]),"data-testid":`nc-form-field-item-${T.title}`},[g("div",Ar,[(v(),A(_e(("iconMap"in d?d.iconMap:l(Qe)).drag),{class:"flex-none cursor-move !h-4 !w-4 text-gray-600 mr-1"}))]),g("div",Sr,[g("div",{class:"flex-1 flex items-center cursor-pointer max-w-[calc(100%_-_40px)]",onClick:le(I=>vt(T,!0),["prevent"])},[T&&l(Ue)(T)?(v(),A(_i,{key:0,"column-meta":T},null,8,["column-meta"])):(v(),A(xi,{key:1,"column-meta":T},null,8,["column-meta"])),g("div",Mr,[g("div",Er,[g("div",{class:Ce(["ml-1 inline-flex",(ve=T.label)!=null&&ve.trim()?"max-w-1/2":"max-w-[95%]"])},[x(fe,{class:"truncate text-sm",disabled:l(ut),"show-on-truncate-only":""},{title:R(()=>[g("div",$r,$(T.title),1)]),default:R(()=>[g("span",Ir,$(T.title),1)]),_:2},1032,["disabled"])],2),(J=T.label)!=null&&J.trim()?(v(),B("div",Dr,[Tr,x(fe,{class:"truncate",disabled:l(ut),"show-on-truncate-only":""},{title:R(()=>[g("div",Or,$(T.label),1)]),default:R(()=>{var I;return[g("span",Fr,$((I=T.label)==null?void 0:I.trim()),1)]}),_:2},1032,["disabled"]),Lr])):O("",!0),l(ie)(T,T.required)?(v(),B("span",Br,"*")):O("",!0)])])],8,kr),x(fe,{disabled:!T.required||l(y)||!l(b),class:"flex",placement:"topRight"},{title:R(()=>[se(" You can't hide a required field.")]),default:R(()=>[x(Ve,{checked:!!T.show,disabled:T.required||l(y)||!l(b),class:"flex-none nc-switch",size:"small",onChange:I=>{gi(T,I,!0)}},null,8,["checked","disabled","onChange"])]),_:2},1032,["disabled"])])],10,Rr)):O("",!0)]}),_:2},[(H=l(w))!=null&&H.filter(T=>T.title.toLowerCase().includes(l(Ie).toLowerCase())).length?void 0:{name:"footer",fn:R(()=>[g("div",Pr,$(d.$t("title.noFieldsFound"))+" with title `"+$(l(Ie))+"` ",1)]),key:"0"}]),1032,["list","disabled"])],64)):O("",!0)])]}),_:1}),x(l(kt),{"min-size":"20",size:"50",class:"nc-form-right-splitpane-item !overflow-y-auto nc-form-scrollbar"},{default:R(()=>{var T,ve;return[g("div",Wr,[g("div",jr,$(d.$t("labels.appearanceSettings")),1),g("div",Vr,[g("div",{class:Ce(l(y)||!l(b)?"pointer-events-none":"")},[g("div",Ur,$(d.$t("labels.backgroundColor")),1),g("div",Hr,[x(fo,{"model-value":l(C).meta.background_color,colors:["#FFFFFF","#FFDBD9","#FEE6D6","#FFF0D1","#D4F7E0","#D7F2FF","#FED8F4","#E5D4F5","#FFCFE6"],"color-box-border":"","is-new-design":"",class:"nc-form-theme-color-picker !pb-0 !pl-0 -ml-1",onInput:Kn},null,8,["model-value"])])],2),O("",!0),g("div",Nr,[g("span",null,$(d.$t("general.hide"))+" "+$(d.$t("general.banner")),1),He(x(Ve,{checked:(T=("parseProp"in d?d.parseProp:l(Te))(l(C).meta))==null?void 0:T.hide_banner,size:"small",class:"nc-form-hide-banner","data-testid":"nc-form-hide-banner",disabled:l(y)||!l(b),onChange:h[41]||(h[41]=J=>{l(y)||!l(b)||(l(C).meta.hide_banner=J,l(Y)())})},null,8,["checked","disabled"]),[[at,["a:form-view:hide-banner"]]])])])]),g("div",qr,[g("div",Yr,$(d.$t("msg.info.postFormSubmissionSettings")),1),g("div",Xr,[g("div",Gr,[g("div",Zr,[g("span",null,$(d.$t("labels.redirectToUrl")),1),He(x(Ve,{checked:l(Ye),"onUpdate:checked":h[42]||(h[42]=J=>Le(Ye)?Ye.value=J:null),size:"small",class:"nc-form-checkbox-redirect-url","data-testid":"nc-form-checkbox-redirect-url",disabled:l(y)||!l(b),onChange:l(Y)},null,8,["checked","disabled","onChange"]),[[at,["a:form-view:redirect-url"]]])]),l(Ye)?(v(),B("div",Qr,[x(bt,St({class:"!my-0"},l(Pt)),{default:R(()=>[x(Ai,{value:l(C).redirect_url,"onUpdate:value":h[43]||(h[43]=J=>l(C).redirect_url=J),type:"text",class:"!h-8 !px-3 !py-1 !rounded-lg",placeholder:"Paste redirect URL here","data-testid":"nc-form-redirect-url-input",onInput:Pn},null,8,["value"])]),_:1},16),Kr])):O("",!0)]),l(Ye)?O("",!0):(v(),B(Fe,{key:0},[g("div",Jr,[g("span",null,$(d.$t("msg.info.submitAnotherForm")),1),He(x(Ve,{checked:l(C).submit_another_form,"onUpdate:checked":h[44]||(h[44]=J=>l(C).submit_another_form=J),size:"small",class:"nc-form-checkbox-submit-another-form","data-testid":"nc-form-checkbox-submit-another-form",disabled:l(y)||!l(b),onChange:l(Y)},null,8,["checked","disabled","onChange"]),[[at,["a:form-view:submit-another-form"]]])]),g("div",el,[g("span",null,$(d.$t("msg.info.showBlankForm")),1),He(x(Ve,{checked:l(C).show_blank_form,"onUpdate:checked":h[45]||(h[45]=J=>l(C).show_blank_form=J),size:"small",class:"nc-form-checkbox-show-blank-form","data-testid":"nc-form-checkbox-show-blank-form",disabled:l(y)||!l(b),onChange:l(Y)},null,8,["checked","disabled","onChange"]),[[at,["a:form-view:show-blank-form"]]])])],64)),g("div",tl,[g("span",null,[se($(d.$t("msg.info.emailForm"))+" ",1),g("span",il,$((ve=l(n))==null?void 0:ve.email),1)]),He(x(Ve,{checked:l(je),"onUpdate:checked":h[46]||(h[46]=J=>Le(je)?je.value=J:null),size:"small",class:"nc-form-checkbox-send-email","data-testid":"nc-form-checkbox-send-email",disabled:l(y)||!l(b),onChange:Xn},null,8,["checked","disabled"]),[[at,["a:form-view:email-me"]]])])]),l(Ye)?O("",!0):(v(),B("div",nl,[g("div",ol,$(d.$t("msg.info.formDisplayMessage")),1),x(bt,{class:"!my-0"},{default:R(()=>[!l(y)&&l(b)?(v(),A(D,{key:0,value:l(C).success_msg,"onUpdate:value":[h[47]||(h[47]=J=>l(C).success_msg=J),l(Y)],class:"nc-form-after-submit-msg editable","is-form-field":"","hidden-bubble-menu-options":o,"data-testid":"nc-form-after-submit-msg"},null,8,["value","onUpdate:value"])):(v(),A(D,{key:1,value:l(C).success_msg,class:"nc-form-after-submit-msg","is-form-field":"","read-only":"","data-testid":"nc-form-after-submit-msg"},null,8,["value"]))]),_:1})]))])]}),_:1})]),_:1})):O("",!0)],64))],2)]}),_:1})):O("",!0)]))],64)),(Di=(Ii=l(n))==null?void 0:Ii.base_roles)!=null&&Di.viewer||(Oi=(Ti=l(n))==null?void 0:Ti.base_roles)!=null&&Oi.commenter?(v(),B("div",sl,[g("div",al,[g("div",rl,[se($(d.$t("msg.info.yourCurrentRoleIs"))+" '",1),g("span",ll,$(((Fi=Object.keys(l(n).base_roles))==null?void 0:Fi[0])??l(Lo).NO_ACCESS),1),se("'. ")]),g("div",cl,$(d.$t("msg.info.pleaseRequestAccessForView",{viewName:"form view"})),1)])])):O("",!0)])}}}),hl=si(dl,[["__scopeId","data-v-4699d277"]]),Hl=Object.freeze(Object.defineProperty({__proto__:null,default:hl},Symbol.toStringTag,{value:"Module"}));export{Hl as F,Ul as u};
