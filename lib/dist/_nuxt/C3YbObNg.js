const __vite__fileDeps=["./CP3oy1y9.js","./B2hUoZAs.js","./entry.B8GgT5QA.css","./CPfhWhp2.js","./EmojiPicker.B3qwzTNG.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{f as re,at as B,cH as H,N as ce,cB as J,ai as pe,cI as ve,cG as W,r as I,H as Z,O as fe,o as n,c as m,P as e,T as f,R as ne,dd as we,a as y,Q as le,aF as ie,U as $,w as r,d as M,t as b,b as d,S as x,al as C,$ as xe,ap as ue,Z as me,a5 as de,A as ye,g as he,aH as be,c_ as ge}from"./B2hUoZAs.js";import{_ as Ve}from"./LH0AgEEv.js";import{b as ke,a as Te}from"./DrD81ZAJ.js";import{_ as De}from"./e4fIiYA_.js";import{u as Ie}from"./BKCMEtlO.js";import{u as Be}from"./C0IYadH8.js";import"./BjshTetX.js";import"./DFYMF386.js";import"./B4WiVz4N.js";import"./CGFlARNL.js";import"./fS-pjH0A.js";import"./DSjSw5ad.js";import"./BXXS6TCz.js";import"./BeKg4PXl.js";import"./CaxUP45y.js";import"./1orNHd0L.js";import"./BQQOEPN4.js";import"./R1pHeCcp.js";import"./BGKYJ52S.js";import"./C9qKCFvP.js";import"./BWYzyVlv.js";import"./CwHJfKcC.js";import"./i4toF4kp.js";import"./kd0F6MQ0.js";import"./By21eAqY.js";import"./cvW-uYte.js";import"./fKrvpb1C.js";import"./BQN-xhuP.js";import"./7hPDkg8v.js";import"./DerldqwU.js";import"./BCTq0LyZ.js";import"./DfZ7_DBQ.js";const $e=me(()=>de(()=>import("./CP3oy1y9.js"),__vite__mapDeps([0,1,2]),import.meta.url).then(h=>h.default||h)),Se=re({__name:"OpenedViewAction",setup(h){const{activeTable:t}=B(H()),{isMobileMode:l}=ce(),{isSharedBase:_,base:p}=B(J()),{t:S}=pe(),{$api:v}=ye(),{refreshCommandPalette:F}=ve(),{activeView:a,views:K,openedViewsTab:X,viewsByTable:Y}=B(W()),{loadViews:q,removeFromRecentViews:A}=W(),{navigateToTable:O}=H(),w=I(!1),P=I(!1),g=I(!1),V=I(),i=I(""),c=I(),U=()=>{g.value=!0,w.value=!1,i.value=a.value.title,setTimeout(()=>{V.value.focus()})};Z(V,()=>{var s;(s=V.value)==null||s.focus()});const N=async()=>{var s;L()?(a.value.title=i.value,g.value=!1,c.value=void 0,await v.dbView.update(a.value.id,{title:i.value})):(s=V.value)==null||s.focus()};function L(){return!i.value||i.value.trim().length<0?(c.value=S("msg.error.viewNameRequired"),!1):i.value.trim().length>255?(c.value=S("msg.error.nameMaxLength256"),!1):K.value.some(s=>s.title===i.value&&s.id!==a.value.id)?(c.value=S("msg.error.viewNameDuplicate"),!1):!0}Z(i,()=>{c.value&&(c.value=void 0)}),Z(w,()=>{setTimeout(()=>{P.value=!1},250)});const j=()=>{i.value=a.value.title,g.value=!1};function E(){const s=I(!0);w.value=!1;const{close:o}=Ie(ke,{modelValue:s,view:a.value,"onUpdate:modelValue":u,onDeleted:async()=>{var T,G;u(),A({viewId:a.value.id,tableId:a.value.fk_model_id,baseId:p.value.id}),F(),((T=a.value)==null?void 0:T.id)===a.value.id&&O({tableId:t.value.id,baseId:p.value.id}),await q({tableId:t.value.id,force:!0});const k=((G=Y.value.get(t.value.id))==null?void 0:G.filter(Q=>!Q.is_default))??[];t.value.meta={...t.value.meta,hasNonDefaultViews:k.length>1}}});function u(){s.value=!1,o(1e3)}}return(s,o)=>{var ee,te;const u=xe,k=ue,T=Te,G=De,Q=$e,_e=fe("e");return n(),m(C,null,[e(g)?(n(),m("div",{key:0,class:f(["h-6 relative",{"max-w-2/5":!e(_)&&!e(l)&&((ee=e(a))==null?void 0:ee.is_default),"max-w-3/5":!e(_)&&!e(l)&&!((te=e(a))!=null&&te.is_default)}])},[ne(y("input",{ref_key:"renameInputDom",ref:V,"onUpdate:modelValue":o[0]||(o[0]=D=>le(i)?i.value=D:null),class:f(["ml-0.25 w-full px-1 py-0.5 rounded-md font-medium text-gray-800",{"outline-brand-500":!e(c),"outline-red-500 pr-6":e(c)}]),onBlur:N,onKeydown:[ie(N,["enter"]),ie(j,["esc"])]},null,34),[[we,e(i)]]),e(c)?(n(),$(k,{key:0,class:"absolute top-0.25 right-0.5 bg-white rounded-lg"},{title:r(()=>[M(b(e(c)),1)]),default:r(()=>[d(u,{icon:"info",class:"cursor-pointer"})]),_:1})):x("",!0)],2)):(n(),$(G,{key:1,visible:e(w),"onUpdate:visible":o[2]||(o[2]=D=>le(w)?w.value=D:null),class:"!xs:pointer-events-none nc-actions-menu-btn nc-view-context-btn","overlay-class-name":"nc-dropdown-actions-menu"},{overlay:r(()=>[d(T,{table:e(t),view:e(a),onCloseModal:o[1]||(o[1]=D=>w.value=!1),onRename:U,onDelete:E},null,8,["table","view"])]),default:r(()=>{var D,ae,oe,se;return[ne((n(),m("div",{class:f(["truncate nc-active-view-title flex gap-1 items-center !hover:bg-gray-100 !hover:text-gray-800 ml-1 pl-1 pr-0.25 rounded-md py-1 cursor-pointer",{"max-w-2/5":!e(_)&&!e(l)&&((D=e(a))==null?void 0:D.is_default),"max-w-3/5":!e(_)&&!e(l)&&!((ae=e(a))!=null&&ae.is_default),"max-w-1/2":e(l),"text-gray-500":(oe=e(a))==null?void 0:oe.is_default,"text-gray-800 font-medium":!((se=e(a))!=null&&se.is_default)}])},[d(k,{class:"truncate xs:pl-1.25 flex-1 text-inherit","show-on-truncate-only":""},{title:r(()=>{var R,z;return[M(b((R=e(a))!=null&&R.is_default?s.$t("title.defaultView"):(z=e(a))==null?void 0:z.title),1)]}),default:r(()=>{var R,z;return[y("span",{class:f({"max-w-28/100":!e(l)})},b((R=e(a))!=null&&R.is_default?s.$t("title.defaultView"):(z=e(a))==null?void 0:z.title),3)]}),_:1}),d(u,{icon:"chevronDown",class:"!text-gray-500 mt-0.5"})],2)),[[_e,["c:breadcrumb:view-actions"]]])]}),_:1},8,["visible"])),e(X)==="view"&&!e(l)&&!e(g)?(n(),$(Q,{key:2})):x("",!0)],64)}}}),Ne={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Re=y("path",{fill:"currentColor",d:"M5 4h14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2m0 4v4h6V8zm8 0v4h6V8zm-8 6v4h6v-4zm8 0v4h6v-4z"},null,-1),ze=[Re];function Ce(h,t){return n(),m("svg",Ne,[...ze])}const Me={name:"mdi-table",render:Ce},Ae=me(()=>de(()=>import("./CPfhWhp2.js"),__vite__mapDeps([3,1,2,4]),import.meta.url).then(h=>h.default||h)),Oe={class:"capitalize"},Pe={class:"flex flex-row items-center gap-x-1.5"},Ue={class:"truncate !text-inherit capitalize"},Le=y("div",{class:"px-1.75 text-gray-500"},">",-1),je={key:2,class:"pl-1.25 text-gray-500"},ht=re({__name:"ViewInfo",setup(h){const{isMobileMode:t}=ce(),{activeView:l}=B(W()),{base:_,isSharedBase:p}=B(J()),{baseUrl:S}=J(),{activeTable:v}=B(H()),{tableUrl:F}=H(),{isLeftSidebarOpen:a}=B(Be()),K=he(()=>_.value?`${window.location.origin}/#${S({id:_.value.id,type:"database",isSharedBase:p.value})}`:"");return(X,Y)=>{var i,c,U,N,L,j,E,s;const q=be,A=ue,O=Ve,w=Me,P=Ae,g=ge,V=Se;return n(),m("div",{class:f(["ml-0.25 flex flex-row font-medium items-center border-gray-50 transition-all duration-100",{"min-w-36/100 max-w-36/100":!e(t)&&e(a),"min-w-39/100 max-w-39/100":!e(t)&&!e(a),"w-2/3 text-base ml-1.5":e(t),"!max-w-3/4":e(p)&&!e(t)}])},[e(t)?x("",!0):(n(),m(C,{key:0},[d(O,{class:f(["!hover:text-black !hover:underline-gray-600 !underline-transparent ml-0.75 max-w-1/4",{"!max-w-none":e(p)&&!e(t),"!text-gray-500":e(v),"!text-gray-700":!e(v)}]),to:e(K)},{default:r(()=>[d(A,{class:"!text-inherit"},{title:r(()=>{var o;return[y("span",Oe,b((o=e(_))==null?void 0:o.title),1)]}),default:r(()=>{var o,u;return[y("div",Pe,[d(q,{type:(o=e(_))==null?void 0:o.type,class:"!grayscale min-w-4",style:{filter:"grayscale(100%) brightness(115%)"}},null,8,["type"]),y("div",{class:f(["hidden !2xl:flex !2xl:truncate !2xl:ml-1",{"!flex":e(p)&&!e(t)}])},[y("span",Ue,b((u=e(_))==null?void 0:u.title),1)],2)])]}),_:1})]),_:1},8,["class","to"]),Le],64)),e(t)&&!((i=e(l))!=null&&i.is_default)?x("",!0):(n(),m(C,{key:1},[e(t)?(n(),$(P,{key:0,emoji:(U=(c=e(v))==null?void 0:c.meta)==null?void 0:U.icon,readonly:"",size:"xsmall"},{default:r(()=>[d(w,{class:f(["min-w-5",{"!text-gray-500":!e(t),"!text-gray-700":e(t)}])},null,8,["class"])]),_:1},8,["emoji"])):x("",!0),e(v)?(n(),m("div",{key:1,class:f({"max-w-1/2":e(t)||((N=e(l))==null?void 0:N.is_default),"max-w-20/100":!e(p)&&!e(t)&&!((L=e(l))!=null&&L.is_default),"max-w-none":e(p)&&!e(t)})},[d(A,{class:"truncate nc-active-table-title max-w-full","show-on-truncate-only":""},{title:r(()=>{var o;return[M(b((o=e(v))==null?void 0:o.title),1)]}),default:r(()=>{var o,u,k;return[y("span",{class:f(["text-ellipsis overflow-hidden text-gray-500 xs:ml-2",{"text-gray-500":!e(t),"text-gray-800 font-medium":e(t)||((o=e(l))==null?void 0:o.is_default)}]),style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},[(u=e(l))!=null&&u.is_default?(n(),m(C,{key:0},[M(b((k=e(v))==null?void 0:k.title),1)],64)):(n(),$(O,{key:1,class:"!text-inherit !underline-transparent !hover:text-black !hover:underline-gray-600",to:e(F)({table:e(v),completeUrl:!0,isSharedBase:e(p)})},{default:r(()=>{var T;return[M(b((T=e(v))==null?void 0:T.title),1)]}),_:1},8,["to"]))],2)]}),_:1})],2)):x("",!0)],64)),e(t)?x("",!0):(n(),m("div",je,">")),e(t)&&((j=e(l))!=null&&j.is_default)?x("",!0):(n(),m(C,{key:3},[e(t)?(n(),$(P,{key:0,emoji:(s=(E=e(l))==null?void 0:E.meta)==null?void 0:s.icon,readonly:"",size:"xsmall"},{default:r(()=>{var o;return[d(g,{meta:{type:(o=e(l))==null?void 0:o.type},class:"min-w-4.5 text-lg flex"},null,8,["meta"])]}),_:1},8,["emoji"])):x("",!0),d(V)],64))],2)}}});export{ht as default};
