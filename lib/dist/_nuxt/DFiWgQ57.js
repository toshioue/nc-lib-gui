import{u as K}from"./CO8XXsKl.js";import{gK as F,az as b,cR as C,cN as I,g as t,d7 as l,r as f,P as g,H as k,A as U,gi as z}from"./Cgw6cdOy.js";function H(){const u={field:"",query:""},s=F("field-query-search-map",()=>({})),i=F("field-query-search",()=>({...u}));return{search:i,loadFieldQuery:o=>{o&&(o in s.value||(s.value[o]={...u}),i.value=s.value[o])}}}const[X,W]=K((u,s,i=!1,m,o)=>{const{$api:N}=U(),{activeView:a,activeNestedFilters:P,activeSorts:R}=b(C()),V=I(),{sqlUis:h}=b(V),v=t(()=>{var e;return(e=s.value)!=null&&e.source_id?h.value[s.value.source_id]:Object.values(h.value)[0]}),{search:n}=H(),_=z(Symbol("SmartsheetStore")),$=t(()=>{var e;return((e=a.value)==null?void 0:e.lock_type)==="locked"}),x=t(()=>{var e,r;return(r=(e=s.value)==null?void 0:e.columns)==null?void 0:r.some(c=>c.pk)}),B=t(()=>{var e;return((e=a.value)==null?void 0:e.type)===l.GRID}),S=t(()=>{var e;return((e=a.value)==null?void 0:e.type)===l.FORM}),E=t(()=>{var e;return((e=a.value)==null?void 0:e.type)===l.GALLERY}),G=t(()=>{var e;return((e=a.value)==null?void 0:e.type)===l.CALENDAR}),L=t(()=>{var e;return((e=a.value)==null?void 0:e.type)===l.KANBAN}),M=t(()=>{var e;return((e=a.value)==null?void 0:e.type)===l.MAP}),O=t(()=>S.value&&i),Q=t(()=>{var e;return(e=a.value)==null?void 0:e.is_default}),T=t(()=>{var c,w,q,A;let e;const r=((w=(c=s.value)==null?void 0:c.columns)==null?void 0:w.find(({id:y})=>y===n.value.field))||((A=(q=s.value)==null?void 0:q.columns)==null?void 0:A.find(y=>y.pv));if(r&&n.value.query.trim())return v.value&&["text","string"].includes(v.value.getAbstractType(r))&&r.dt!=="bigint"?e=`(${r.title},like,%${n.value.query.trim()}%)`:e=`(${r.title},eq,${n.value.query.trim()})`,e}),j=t(()=>{var e;return((e=s.value)==null?void 0:e.type)==="view"}),p=f(g(m)??[]),d=f(g(o)??[]),D=f([]);return k(p,()=>{R.value=p.value},{immediate:!0}),k(d,()=>{P.value=d.value},{immediate:!0}),{view:a,meta:s,isLocked:$,$api:N,xWhere:T,isPkAvail:x,isForm:S,isGrid:B,isGallery:E,isKanban:L,isMap:M,isCalendar:G,isSharedForm:O,sorts:p,nestedFilters:d,isSqlView:j,eventBus:_,sqlUi:v,allFilters:D,isDefaultView:Q}},"smartsheet-store");function Z(){const u=W();if(!u)throw new Error("Please call `useProvideSmartsheetStore` on the appropriate parent component");return u}export{Z as a,H as b,X as u};
