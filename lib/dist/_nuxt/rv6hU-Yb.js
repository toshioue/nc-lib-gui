import{o as a,c as r,a as t,f as K,ai as X,cN as Y,az as Z,as as ee,r as k,i as te,b as s,w as o,d as x,t as i,P as c,Q as V,U as se,S as _,V as g,W as T,aq as oe,av as le,T as ne,aj as v,ak as B,hV as ae,aV as ie,cc as ce,a3 as re,ab as de,ac as pe,ag as ue,A as fe}from"./Cgw6cdOy.js";import{_ as me}from"./BPpt0-9t.js";import{T as _e}from"./D7Mj6For.js";import"./Bcy-XIkn.js";import{I as ve}from"./DPaOlBFV.js";import{F as ye}from"./DpYA1Dpy.js";import"./BIsWr_mR.js";import"./BQQOEPN4.js";import"./hvq8FVej.js";import"./BohSct8s.js";import"./C8c9012h.js";import"./BZz6iAla.js";import"./dmcxUY_0.js";import"./BcZAlRJW.js";import"./LSbsNkd9.js";const xe={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},he=t("path",{fill:"currentColor",d:"M12 16q1.875 0 3.188-1.312T16.5 11.5t-1.312-3.187T12 7T8.813 8.313T7.5 11.5t1.313 3.188T12 16m0-1.8q-1.125 0-1.912-.788T9.3 11.5t.788-1.912T12 8.8t1.913.788t.787 1.912t-.787 1.913T12 14.2m0 4.8q-3.65 0-6.65-2.037T1 11.5q1.35-3.425 4.35-5.462T12 4t6.65 2.038T23 11.5q-1.35 3.425-4.35 5.463T12 19"},null,-1),we=[he];function ke(M,y){return a(),r("svg",xe,[...we])}const ge={name:"material-symbols-visibility",render:ke},Te={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},be=t("path",{fill:"currentColor",d:"m19.8 22.6l-4.2-4.15q-.875.275-1.762.413T12 19q-3.775 0-6.725-2.087T1 11.5q.525-1.325 1.325-2.463T4.15 7L1.4 4.2l1.4-1.4l18.4 18.4zM12 16q.275 0 .513-.025t.512-.1l-5.4-5.4q-.075.275-.1.513T7.5 11.5q0 1.875 1.313 3.188T12 16m7.3.45l-3.175-3.15q.175-.425.275-.862t.1-.938q0-1.875-1.312-3.187T12 7q-.5 0-.937.1t-.863.3L7.65 4.85q1.025-.425 2.1-.637T12 4q3.775 0 6.725 2.088T23 11.5q-.575 1.475-1.513 2.738T19.3 16.45m-4.625-4.6l-3-3q.7-.125 1.288.113t1.012.687t.613 1.038t.087 1.162"},null,-1),$e=[be];function Me(M,y){return a(),r("svg",Te,[...$e])}const Ce={name:"material-symbols-visibility-off",render:Me},qe={class:"relative flex flex-col h-full"},je={class:"flex flex-row justify-start w-full -mt-1 mb-3"},Ve={class:"flex flex-row justify-end"},Be={class:"flex flex-col h-full"},ze=t("div",{class:"flex flex-row justify-center mt-2 text-center w-full text-base"},"This action will remove this API Token",-1),Ne={class:"flex mt-6 justify-end space-x-2"},De={class:"flex flex-col px-10"},Se={class:"flex flex-row justify-end"},Ie={class:"flex flex-row space-x-1"},Ae={class:"flex flex-row justify-center items-center caption capitalize space-x-1"},Re={class:"text-gray-500"},Fe={class:"flex flex-row justify-center items-center caption capitalize space-x-1"},Ue={key:0,class:"w-full flex flex-col mt-2 px-1"},Le={class:"flex flex-row border-b-1 text-gray-600 text-xs pb-2 pt-2"},Ee={class:"flex w-4/10 pl-2"},Pe={class:"flex w-4/10 justify-center"},Ge={class:"flex w-2/10 justify-end pr-2"},Oe={class:"flex flex-row border-b-1 items-center px-2 py-2"},Qe={class:"flex flex-row w-4/10 flex-wrap overflow-ellipsis"},We={class:"flex w-4/10 justify-center flex-wrap overflow-ellipsis"},He={key:0},Je={key:1},Ke={class:"flex flex-row w-2/10 justify-end"},Xe={key:0},Ye={key:1},Ze={class:"flex flex-row items-center"},et={class:"flex flex-row items-center h-[1.2rem]"},tt=["onClick"],st={class:"text-xs pl-2"},xt=K({__name:"ApiTokenManagement",setup(M){const{t:y}=X(),{$api:b,$e:h}=fe(),z=Y(),{base:f}=Z(z),{copy:N}=ee(),$=k([]),u=k(!1),m=k(!1),p=k({}),w=async()=>{var e;(e=f.value)!=null&&e.id&&($.value=(await b.apiToken.list(f.value.id)).list)},D=()=>{u.value=!0,h("c:api-token:generate")},S=async e=>{if(e){try{await N(e),v.info(y("msg.info.copiedToClipboard"))}catch(l){v.error(l.message)}h("c:api-token:copy")}},I=async()=>{var e;try{if(!((e=f.value)!=null&&e.id))return;await b.apiToken.create(f.value.id,p.value),u.value=!1,v.success(y("msg.success.tokenGenerated")),p.value={},await w()}catch(l){v.error(await B(l))}h("a:api-token:generate")},A=async()=>{var e;try{if(!((e=f.value)!=null&&e.id)||!p.value.token)return;await b.apiToken.delete(f.value.id,p.value.token),v.success(y("msg.success.tokenDeleted")),await w(),m.value=!1}catch(l){v.error(await B(l))}h("a:api-token:delete")},R=e=>{p.value=e,m.value=!0};return te(()=>{w()}),(e,l)=>{const F=ae,d=ie,U=_e,L=ve,E=ye,C=ce,P=Ce,G=ge,q=re,O=me,Q=de,W=pe,H=ue;return a(),r("div",null,[s(C,{visible:c(u),"onUpdate:visible":l[2]||(l[2]=n=>V(u)?u.value=n:null),class:se({active:c(u)}),closable:!1,width:"28rem",centered:"",footer:null,"wrap-class-name":"nc-modal-generate-token"},{default:o(()=>[t("div",qe,[s(d,{type:"text",class:"!absolute top-0 right-0 rounded-md -mt-2 -mr-3",onClick:l[0]||(l[0]=n=>u.value=!1)},{icon:o(()=>[s(F,{class:"flex mx-auto"})]),_:1}),t("div",je,[s(U,{level:5},{default:o(()=>[x(i(e.$t("title.generateToken")),1)]),_:1})]),s(E,{ref:"form",model:c(p),name:"basic",layout:"vertical",class:"flex flex-col justify-center space-y-3","no-style":"",autocomplete:"off",onFinish:I},{default:o(()=>[s(L,{value:c(p).description,"onUpdate:value":l[1]||(l[1]=n=>c(p).description=n),size:"middle",placeholder:e.$t("labels.description")},null,8,["value","placeholder"]),t("div",Ve,[s(d,{type:"primary","html-type":"submit",class:"!rounded-md"},{default:o(()=>[x(i(e.$t("general.generate")),1)]),_:1})])]),_:1},8,["model"])])]),_:1},8,["visible","class"]),s(C,{visible:c(m),"onUpdate:visible":l[5]||(l[5]=n=>V(m)?m.value=n:null),closable:!1,width:"28rem",centered:"",footer:null,"wrap-class-name":"nc-modal-delete-token"},{default:o(()=>[t("div",Be,[ze,t("div",Ne,[s(d,{class:"!rounded-md",onClick:l[3]||(l[3]=n=>m.value=!1)},{default:o(()=>[x(i(e.$t("general.cancel")),1)]),_:1}),s(d,{class:"!rounded-md",type:"primary",danger:"",onClick:l[4]||(l[4]=n=>A())},{default:o(()=>[x(i(e.$t("general.confirm")),1)]),_:1})])])]),_:1},8,["visible"]),t("div",De,[t("div",Se,[t("div",Ie,[s(d,{size:"middle",type:"text",onClick:l[6]||(l[6]=n=>w())},{default:o(()=>[t("div",Ae,[(a(),_(g(("iconMap"in e?e.iconMap:c(T)).reload),{class:"text-gray-500"})),t("div",Re,i(e.$t("general.reload")),1)])]),_:1}),s(d,{type:"primary",size:"middle",class:"!rounded-md",onClick:D},{default:o(()=>[t("div",Fe,[(a(),_(g(("iconMap"in e?e.iconMap:c(T)).plus))),t("div",null,i(e.$t("activity.newToken")),1)])]),_:1})])]),c($)?(a(),r("div",Ue,[t("div",Le,[t("div",Ee,i(e.$t("labels.description")),1),t("div",Pe,i(e.$t("labels.token")),1),t("div",Ge,i(e.$t("labels.action")),1)]),(a(!0),r(oe,null,le(c($),(n,J)=>(a(),r("div",{key:J,class:"flex flex-col"},[t("div",Oe,[t("div",Qe,i(n.description),1),t("div",We,[n.show?(a(),r("span",He,i(n.token),1)):(a(),r("span",Je,"****************************************"))]),t("div",Ke,[s(q,{placement:"bottom"},{title:o(()=>[n.show?(a(),r("span",Xe,i(e.$t("general.hide")),1)):(a(),r("span",Ye,i(e.$t("general.show")),1))]),default:o(()=>[s(d,{type:"text",class:"!rounded-md",onClick:j=>n.show=!n.show},{icon:o(()=>[n.show?(a(),_(P,{key:0,class:"flex mx-auto h-[1.1rem]"})):(a(),_(G,{key:1,class:"flex mx-auto h-[1rem]"}))]),_:2},1032,["onClick"])]),_:2},1024),s(q,{placement:"bottom"},{title:o(()=>[x(i(e.$t("general.copy")),1)]),default:o(()=>[s(d,{type:"text",class:"!rounded-md",onClick:j=>S(n.token)},{icon:o(()=>[(a(),_(g(("iconMap"in e?e.iconMap:c(T)).copy),{class:"flex mx-auto h-[1rem]"}))]),_:2},1032,["onClick"])]),_:2},1024),s(H,{trigger:["click"],class:"flex",placement:"bottomRight","overlay-class-name":"nc-dropdown-api-token-mgmt"},{overlay:o(()=>[s(W,null,{default:o(()=>[s(Q,null,{default:o(()=>[t("div",{class:"flex flex-row items-center py-4 h-[1rem]",onClick:j=>R(n)},[(a(),_(g(("iconMap"in e?e.iconMap:c(T)).delete),{class:"flex"})),t("div",st,i(e.$t("general.remove")),1)],8,tt)]),_:2},1024)]),_:2},1024)]),default:o(()=>[t("div",Ze,[s(d,{type:"text",class:"!px-0"},{default:o(()=>[t("div",et,[s(O)])]),_:1})])]),_:2},1024)])])]))),128))])):ne("",!0)])])}}});export{xt as default};
