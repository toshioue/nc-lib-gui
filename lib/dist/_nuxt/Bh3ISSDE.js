import{f as x,ag as $,ai as C,N as V,r as q,aj as B,o as _,c as h,a as p,t as g,b as a,w as n,cD as F,P as r,d as v,S as M,U as k,V as N,W as j,an as z,B as S,aS as D}from"./nEPQs079.js";import{_ as E}from"./CCibdk3O.js";import{F as T}from"./BzWD3wIg.js";import{_ as G}from"./QHUCxglU.js";import{_ as I}from"./5fs2TD9N.js";import"./DYYbRAhI.js";import"./COktFmkf.js";import"./ByzT15Y-.js";import"./BQQOEPN4.js";import"./BTGvCRQH.js";const W={class:"mx-auto relative flex flex-col justify-start gap-2 w-full px-8 md:bg-white max-w-[900px]"},A={class:"text-xl my-4 text-left font-weight-bold"},L={key:0,class:"mx-auto mb-4 bg-red-500 text-white rounded-lg w-3/4 p-1"},O={"data-testid":"nc-user-settings-form__error",class:"flex items-center gap-2 justify-center","data-rec":"true"},H={class:"text-right"},J={class:"flex justify-center items-center gap-2","data-rec":"true"},ne=x({__name:"ResetPassword",setup(K){const{api:y,error:l}=$({useGlobalInstance:!0}),{t}=C(),{signOut:R}=V(),f=q(),s=B({currentPassword:"",password:"",passwordRepeat:""}),u={currentPassword:[{required:!0,message:t("msg.error.signUpRules.passwdRequired")}],password:[{required:!0,message:t("msg.error.signUpRules.passwdRequired")},{min:8,message:t("msg.error.signUpRules.passwdLength")}],passwordRepeat:[{required:!0,message:t("msg.error.signUpRules.passwdRequired")},{validator:(e,o)=>new Promise((m,d)=>{if(s.password===s.passwordRepeat)return m(!0);d(new Error(t("msg.error.signUpRules.passwdMismatch")))}),message:t("msg.error.signUpRules.passwdMismatch")}]},b=async()=>{f.value.validate()&&(l.value=null,await y.auth.passwordChange({currentPassword:s.currentPassword,newPassword:s.password}),z.success(t("msg.success.passwordChanged")),await R(),await S("/signin"))},c=()=>{l.value&&(l.value=null)};return(e,o)=>{const m=E,d=G,w=I,P=D,U=T;return _(),h("div",W,[p("div",A,g(e.$t("activity.changePwd")),1),a(U,{ref_key:"formValidator",ref:f,"data-testid":"nc-user-settings-form",layout:"vertical",class:"change-password lg:max-w-3/4 w-full","no-style":"",model:r(s),onFinish:b},{default:n(()=>[a(F,{name:"layout"},{default:n(()=>[r(l)?(_(),h("div",L,[p("div",O,[a(m),v(" "+g(r(l)),1)])])):M("",!0)]),_:1}),a(w,{label:e.$t("placeholder.password.current"),"data-rec":"true",name:"currentPassword",rules:u.currentPassword},{default:n(()=>[a(d,{value:r(s).currentPassword,"onUpdate:value":o[0]||(o[0]=i=>r(s).currentPassword=i),"data-testid":"nc-user-settings-form__current-password",size:"large",class:"password",placeholder:e.$t("placeholder.password.current"),onFocus:c},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),a(w,{label:e.$t("placeholder.password.new"),"data-rec":"true",name:"password",rules:u.password},{default:n(()=>[a(d,{value:r(s).password,"onUpdate:value":o[1]||(o[1]=i=>r(s).password=i),"data-testid":"nc-user-settings-form__new-password",size:"large",class:"password",placeholder:e.$t("placeholder.password.new"),onFocus:c},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),a(w,{label:e.$t("placeholder.password.confirm"),"data-rec":"true",name:"passwordRepeat",rules:u.passwordRepeat},{default:n(()=>[a(d,{value:r(s).passwordRepeat,"onUpdate:value":o[2]||(o[2]=i=>r(s).passwordRepeat=i),"data-testid":"nc-user-settings-form__new-password-repeat",size:"large",class:"password",placeholder:e.$t("placeholder.password.confirm"),onFocus:c},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),p("div",H,[a(P,{size:"middle","data-testid":"nc-user-settings-form__submit",class:"!rounded-md !h-[2.5rem]",type:"primary","html-type":"submit"},{default:n(()=>[p("div",J,[(_(),k(N(("iconMap"in e?e.iconMap:r(j)).passwordChange))),v(" "+g(e.$t("activity.changePwd")),1)])]),_:1})])]),_:1},8,["model"])])}}});export{ne as default};
