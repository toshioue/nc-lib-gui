import{e as N,bL as p,r,d8 as S,d6 as T,f as u,ij as A,L as E,F as U,az as V,jf as z,hD as O,M as R,o as a,Q as c,w as d,b as $,N as o,O as f,P as G,a as _,T as P,U as Q,c as v,t as b,R as h,Z as W}from"./DZZ6t_j4.js";import{u as Z,_ as q}from"./DqAHSrWO.js";import{_ as H}from"./vK-WmZ7a.js";import{a as J}from"./B05h-4V9.js";import{u as K}from"./BlrQG98t.js";import"./sz1d3zjm.js";import"./BLgccLvp.js";import"./DnSVh-oD.js";import"./D_MsYLkT.js";import"./BCJFTkwv.js";import"./BQQOEPN4.js";import"./CB1aB6F1.js";import"./B5RRVMt5.js";import"./vll-Pnjv.js";import"./BtLb9F6G.js";import"./hZgTYrdl.js";import"./ByVBARmO.js";import"./37hePIet.js";import"./C4K5fdHe.js";import"./i4aLU0Nw.js";import"./GMLocJHP.js";import"./BC4FfNUJ.js";import"./EqBqqo9-.js";import"./DKoVb009.js";import"./CFvUUxCy.js";import"./eX8_g88K.js";import"./BfEabL6Z.js";import"./DO2z7KR_.js";import"./DNgdBwTe.js";import"./_UtSxoDP.js";import"./CdfAcTJv.js";import"./CToWLgER.js";import"./jD721dGr.js";import"./8CPSAnYl.js";import"./wnVheyFD.js";import"./CbkSs5Gy.js";import"./B_hXH8Ph.js";import"./BDAIZopQ.js";import"./CwCOKBa8.js";import"./C9Sjn86N.js";import"./ZFfr47_V.js";import"./CmWcz5yS.js";import"./Dw0oE3Jr.js";import"./Cj0Ygd-o.js";import"./DXGe1EHQ.js";import"./BL8INA0H.js";import"./bWYzyg0p.js";import"./BGrG97ky.js";import"./DnwRMKX3.js";const X={class:"flex items-center gap-1"},Y={class:"flex items-center gap-2"},tt={key:0,class:"text-capitalize !text-[13px] font-medium"},et={key:0,class:"bg-brand-50 text-brand-500 py-1 px-2 text-md rounded-md"},Xt=N({__name:"ColumnFilterMenu",setup(ot){const y=p(S,r(!1)),n=p(T,r()),F=p(A,u(()=>!1)),{isMobileMode:k}=E(),w=r(),{nestedFilters:x,eventBus:M}=J(),{nonDeletedFilters:g,loadFilters:C}=Z(n,void 0,u(()=>!0),()=>!1,x.value,!0),l=r(0);U(()=>{var t;return(t=n==null?void 0:n.value)==null?void 0:t.id},async t=>{t&&(await C({hookId:void 0,isWebhook:!1,loadAllFilters:!0}),l.value=g.value.length||0)},{immediate:!0});const i=r(!1),D=r({});V(z,D),K(i);const m=r({});return M.on(async(t,e)=>{e&&t===O.FILTER_ADD&&(m.value={fk_column_id:e.id},i.value=!0)}),(t,e)=>{const I=W,L=q,j=H,B=R("e");return a(),c(j,{visible:o(i),"onUpdate:visible":e[2]||(e[2]=s=>f(i)?i.value=s:null),trigger:["click"],"overlay-class-name":"nc-dropdown-filter-menu nc-toolbar-dropdown",class:"!xs:hidden"},{overlay:d(()=>[$(L,{ref_key:"filterComp",ref:w,"draft-filter":o(m),"onUpdate:draftFilter":e[0]||(e[0]=s=>f(m)?m.value=s:null),class:"nc-table-toolbar-menu","auto-save":!0,"data-testid":"nc-filter-menu","is-open":o(i),"onUpdate:filtersLength":e[1]||(e[1]=s=>l.value=s)},null,8,["draft-filter","is-open"])]),default:d(()=>[G((a(),c(I,{disabled:o(y),class:"nc-filter-menu-btn nc-toolbar-btn !border-0 !h-7",size:"small",type:"secondary"},{default:d(()=>[_("div",X,[_("div",Y,[(a(),c(P(("iconMap"in t?t.iconMap:o(Q)).filter),{class:"h-4 w-4"})),!o(k)&&!o(F)?(a(),v("span",tt,b(t.$t("activity.filter")),1)):h("",!0)]),o(l)?(a(),v("span",et,b(o(l)),1)):h("",!0)])]),_:1},8,["disabled"])),[[B,["c:filter"]]])]),_:1},8,["visible"])}}});export{Xt as default};
