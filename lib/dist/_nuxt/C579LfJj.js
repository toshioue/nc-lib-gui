const __vite__fileDeps=["./BVHyv0aP.js","./DZZ6t_j4.js","./entry.DIDWwc7m.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{e as ce,J as re,r as E,j3 as pe,fY as de,ar as me,aE as ue,o as l,Q as c,w as a,a as n,t as r,N as e,b as i,d as m,R as h,T as y,U as F,c as M,S as D,ao as fe,at as _e,W as N,O as U,X as he,a4 as ve,F as ge,Y as xe,Z as ye,$ as be,fF as ke}from"./DZZ6t_j4.js";import{_ as we}from"./DfeSAprs.js";import{_ as Ce}from"./BqKQ8afS.js";import{_ as $e}from"./Bdv7ru7D.js";import{a as Fe}from"./B05h-4V9.js";import{u as Me}from"./RXURfzjs.js";import{i as De}from"./C00NHga8.js";import{u as Ie,a as Se,_ as ze,b as Ae}from"./TIQ2_Moa.js";import{S as Re}from"./BLzs_b5A.js";import"./DNgdBwTe.js";import"./eX8_g88K.js";import"./vll-Pnjv.js";import"./DgixBgIx.js";import"./CXD-Dj4T.js";import"./GMLocJHP.js";import"./0QUe8GCE.js";import"./CA74dF2b.js";import"./qW2V2r_p.js";import"./ByVBARmO.js";import"./boyBAVNN.js";import"./BDAIZopQ.js";import"./Bgw0NQgX.js";import"./EqBqqo9-.js";import"./C4K5fdHe.js";import"./C3XbZq4f.js";import"./DKN1hQ6S.js";import"./BQuyMdA-.js";import"./BQQOEPN4.js";import"./B5RRVMt5.js";import"./DGj1ycqW.js";import"./DyDFI6NE.js";import"./BYINaHrJ.js";import"./dfem9Uc_.js";import"./BCJFTkwv.js";import"./D9tFZoTQ.js";import"./C0-Qcoum.js";import"./DXQuLwNn.js";const Ee=he(()=>ve(()=>import("./BVHyv0aP.js"),__vite__mapDeps([0,1,2]),import.meta.url).then(I=>I.default||I)),Ne={class:"flex justify-between pb-6 gap-4"},je={class:"font-semibold text-xl"},Oe={class:"flex items-center gap-2"},Ve={class:"flex gap-2 items-center"},Be={class:"flex gap-2 items-center"},Te={key:0,class:"text-white absolute inset-0 bg-white flex flex-col items-center justify-center gap-2 border-dashed border-1 border-gray-700"},Ue={class:"text-gray-800 text-3xl"},Le=["title"],Pe={class:"flex-none hide-ui transition-all transition-ease-in-out !h-5 gap-0.5 flex items-center bg-white"},Ze={key:0,class:"flex flex-col gap-1"},Ge={class:"nc-attachment h-full w-full flex items-center justify-center"},Ye={class:"flex flex-row items-center py-2.25 px-2.5 bg-gray-50 rounded-lg text-gray-700 mb-4"},Je={class:"capitalize text-ellipsis overflow-hidden select-none w-full pl-1.75",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},zt=ce({__name:"Modal",setup(I){const{isUIAllowed:S}=re(),{open:L,isLoading:P,isPublic:z,isReadonly:v,visibleItems:j,modalVisible:p,column:Z,FileIcon:G,removeFile:Y,onDrop:O,downloadAttachment:J,updateModelValue:K,selectedFile:V,selectedVisibleItems:b,bulkDownloadAttachments:Q,renameFile:W}=Ie(),A=E(),B=E(),{dragging:k}=Se(B,j,K,v),{isOverDropZone:T}=pe(A,O),{isSharedForm:w}=Fe(),{getPossibleAttachmentSrc:X}=Me();de("Escape",()=>{p.value=!1,T.value=!1});function R(t){V.value=t,p.value=!1;const s=ge(V,x=>{x||(setTimeout(()=>{p.value=!0},50),s==null||s())})}const g=E(!1),u=me({title:"",i:0});function q(t,s){g.value=!0,u.i=s,u.title=t}ue(A,"paste",t=>{var s;(s=t.clipboardData)!=null&&s.files&&O(t.clipboardData.files)});const H=t=>{Y(t),g.value=!1,u.i=0,u.title=""};return(t,s)=>{const x=xe,f=ye,ee=ze,te=we,oe=Ee,ae=Ae,C=be,le=Re,se=ke,ne=Ce,ie=$e;return l(),c(ie,{visible:e(p),"onUpdate:visible":s[2]||(s[2]=$=>U(p)?p.value=$:null),"wrap-class-name":"nc-modal-attachment-expand-cell",class:D(["nc-attachment-modal",{active:e(p)}]),width:"80%"},{default:a(()=>{var $;return[n("div",Ne,[n("div",je,r(($=e(Z))==null?void 0:$.title),1),n("div",Oe,[e(b).length>0?(l(),c(f,{key:0,size:"small",onClick:e(Q)},{default:a(()=>[n("div",Ve,[i(x,{icon:"download"}),m(" "+r(t.$t("activity.bulkDownload")),1)])]),_:1},8,["onClick"])):h("",!0),e(w)||!e(v)&&e(S)("dataEdit")&&!e(z)?(l(),c(f,{key:1,class:"nc-attach-file group",size:"small","data-testid":"attachment-expand-file-picker-button",onClick:e(L)},{default:a(()=>[n("div",Be,[(l(),c(y(("iconMap"in t?t.iconMap:e(F)).cellAttachment),{class:"w-4 h-4"})),m(" "+r(t.$t("activity.attachFile")),1)])]),_:1},8,["onClick"])):h("",!0),i(f,{type:"secondary",size:"small",onClick:s[0]||(s[0]=o=>p.value=!1)},{default:a(()=>[i(x,{icon:"close"})]),_:1})])]),n("div",{ref_key:"dropZoneRef",ref:A,tabindex:"0",class:"relative"},[e(w)||!e(v)&&!e(k)&&e(T)?(l(),M("div",Te,[i(ee,{class:"text-accent",height:"35",width:"35"}),n("div",Ue,r(t.$t("labels.dropHere")),1)])):h("",!0),n("div",{ref_key:"sortableRef",ref:B,class:D([{dragging:e(k)},"grid max-h-140 overflow-auto nc-scrollbar-md md:grid-cols-3 xl:grid-cols-5 gap-y-8 gap-x-4 relative"])},[(l(!0),M(fe,null,_e(e(j),(o,_)=>(l(),M("div",{key:`${o==null?void 0:o.title}-${_}`,class:"nc-attachment-item group gap-1 flex border-1 rounded-md border-gray-200 flex-col relative"},[i(te,{checked:e(b)[_],"onUpdate:checked":d=>e(b)[_]=d,class:D(["nc-attachment-checkbox absolute top-2 left-2 group-hover:opacity-100",{"!opacity-100":e(b)[_]}])},null,8,["checked","onUpdate:checked","class"]),n("div",{class:D([{"cursor-move":e(k),"cursor-pointer":!e(k)},"nc-attachment h-full flex justify-center items-center overflow-hidden"])},[("isImage"in t?t.isImage:e(De))(o.title,o.mimetype)?(l(),c(oe,{key:0,srcs:e(X)(o,"card_cover"),"object-fit":"cover",class:"!w-full object-cover !m-0 rounded-t-[5px] justify-center",onClick:N(d=>R(o),["stop"])},null,8,["srcs","onClick"])):o.icon?(l(),c(y(e(G)(o.icon)),{key:1,height:45,width:45,onClick:N(d=>R(o),["stop"])},null,8,["onClick"])):(l(),c(ae,{key:2,height:45,width:45,onClick:N(d=>R(o),["stop"])},null,8,["onClick"]))],2),n("div",{class:"relative px-1 pb-1 items-center flex",title:o.title},[i(C,{"show-on-truncate-only":"",class:"flex-auto truncate w-full text-[12px] items-center text-gray-700 text-sm line-height-4"},{title:a(()=>[m(r(o.title),1)]),default:a(()=>[m(r(o.title)+" ",1)]),_:2},1024),n("div",Pe,[i(C,{placement:"bottom"},{title:a(()=>[m(r(t.$t("title.downloadFile")),1)]),default:a(()=>[i(f,{class:"!p-0 !w-5 !h-5 text-gray-500 !min-w-[fit-content]",size:"xsmall",type:"text",onClick:d=>e(J)(o)},{default:a(()=>[(l(),c(y(("iconMap"in t?t.iconMap:e(F)).download),{class:"!text-xs h-13px w-13px"}))]),_:2},1032,["onClick"])]),_:2},1024),!e(w)||!e(v)&&e(S)("dataEdit")&&!e(z)?(l(),c(C,{key:0,placement:"bottom"},{title:a(()=>[m(r(t.$t("title.renameFile")),1)]),default:a(()=>[i(f,{size:"xsmall",class:"!p-0 nc-attachment-rename !h-5 !w-5 !text-gray-500 !min-w-[fit-content] gap-2",type:"text",onClick:d=>e(W)(o,_)},{default:a(()=>[(l(),c(y(("iconMap"in t?t.iconMap:e(F)).rename),{class:"text-xs h-13px w-13px"}))]),_:2},1032,["onClick"])]),_:2},1024)):h("",!0),e(w)||!e(v)&&e(S)("dataEdit")&&!e(z)?(l(),c(C,{key:1,placement:"bottom"},{title:a(()=>[m(r(t.$t("title.removeFile")),1)]),default:a(()=>[i(f,{class:"!p-0 !h-4 !w-4 !text-red-500 nc-attachment-remove !min-w-[fit-content]",size:"xsmall",type:"text",onClick:d=>q(o.title,_)},{default:a(()=>[(l(),c(y(("iconMap"in t?t.iconMap:e(F)).delete),{class:"text-xs h-13px w-13px"}))]),_:2},1032,["onClick"])]),_:2},1024)):h("",!0)])],8,Le)]))),128)),e(P)?(l(),M("div",Ze,[i(se,{class:"nc-attachment-item group"},{default:a(()=>[n("div",Ge,[i(le,{class:""})])]),_:1})])):h("",!0)],2)],512),i(ne,{visible:e(g),"onUpdate:visible":s[1]||(s[1]=o=>U(g)?g.value=o:null),"entity-name":"File","on-delete":()=>H(e(u).i)},{"entity-preview":a(()=>[n("span",null,[n("div",Ye,[i(x,{icon:"file",class:"nc-view-icon"}),n("div",Je,r(e(u).title),1)])])]),_:1},8,["visible","on-delete"])]}),_:1},8,["visible","class"])}}});export{zt as default};
