const __vite__fileDeps=["./DUHtBhHi.js","./nEPQs079.js","./entry.B8GgT5QA.css","./BXbUg_ej.js","./BLh6tVRa.js","./CFgyk-dW.js","./BTGvCRQH.js","./BQQOEPN4.js","./BLe4UTYD.js","./DKtVUO_j.js","./COktFmkf.js","./Select.Ct6CicDJ.css","./eSDe9FnP.js","./CZJAloFU.js","./D4bBQlhl.js","./BzWD3wIg.js","./5fs2TD9N.js","./DYYbRAhI.js","./zSHtI0ZS.js","./DzMAdbS0.js","./ByzT15Y-.js","./BdIpmjdG.js","./QHUCxglU.js","./DGtfac4d.js","./UsersModal.BCbkEr3A.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{o as n,c,a,f as Re,ag as Ie,ai as Le,N as Ee,ah as Se,r as f,g as je,aj as De,d2 as Ve,i as qe,t as i,b as r,w as l,P as s,Q as N,U as u,V as T,W as C,d as M,ak as se,al as z,am as Ne,T as oe,fR as E,S as g,Z as ae,a5 as ne,an as m,ao as U,a2 as ze,aG as Ae,ap as Pe,$ as Be,gQ as Ge,p as Oe,e as We,A as Qe,_ as Ye}from"./nEPQs079.js";import{_ as Fe}from"./D607n3hn.js";import{_ as He}from"./BLh6tVRa.js";import{_ as Ke}from"./BMD-JIxU.js";import{_ as Ze}from"./COUq3J8q.js";import{_ as Je}from"./C6cwFr3C.js";import{_ as Xe}from"./CNqbIxb7.js";import{_ as et}from"./CF0GO8gh.js";import{u as tt}from"./eSDe9FnP.js";import{u as st,_ as ot}from"./CQUDDm8P.js";import"./BdIpmjdG.js";import{I as at}from"./ByzT15Y-.js";import{S as nt}from"./CFgyk-dW.js";import{_ as rt}from"./DJpQD7nd.js";import"./C5mABW8R.js";import"./Gr6cVSxP.js";import"./DKtVUO_j.js";import"./DzMAdbS0.js";import"./BQQOEPN4.js";import"./COktFmkf.js";import"./QHUCxglU.js";import"./BTGvCRQH.js";import"./BLe4UTYD.js";import"./QTd5iuHu.js";import"./B-HMHOhf.js";const it={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},lt=a("path",{fill:"currentColor",d:"M7 21q-.825 0-1.412-.587T5 19V6q-.425 0-.712-.288T4 5t.288-.712T5 4h4q0-.425.288-.712T10 3h4q.425 0 .713.288T15 4h4q.425 0 .713.288T20 5t-.288.713T19 6v13q0 .825-.587 1.413T17 21zM17 6H7v13h10zm-7 11q.425 0 .713-.288T11 16V9q0-.425-.288-.712T10 8t-.712.288T9 9v7q0 .425.288.713T10 17m4 0q.425 0 .713-.288T15 16V9q0-.425-.288-.712T14 8t-.712.288T13 9v7q0 .425.288.713T14 17M7 6v13z"},null,-1),ct=[lt];function dt(p,y){return n(),c("svg",it,[...ct])}const ut={name:"material-symbols-delete-outline-rounded",render:dt},pt=""+new URL("invite-team.Bc8QnPYB.png",import.meta.url).href,mt=ae(()=>ne(()=>import("./DUHtBhHi.js"),__vite__mapDeps([0,1,2]),import.meta.url).then(p=>p.default||p)),_t=ae(()=>ne(()=>import("./BXbUg_ej.js"),__vite__mapDeps([3,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]),import.meta.url).then(p=>p.default||p)),vt=p=>(Oe("data-v-dc331bff"),p=p(),We(),p),ft={"data-testid":"nc-super-user-list",class:"h-full"},gt={class:"max-w-195 mx-auto h-full"},yt={class:"text-2xl text-left font-weight-bold mb-4","data-rec":"true"},ht={class:"py-2 flex gap-4 items-center justify-between"},wt={class:"flex gap-3 items-center justify-center"},bt={class:"flex items-center gap-1","data-rec":"true"},xt={class:"w-full rounded-md max-w-250 h-[calc(100%-12rem)] rounded-md overflow-hidden mt-5"},$t={class:"flex w-full bg-gray-50 border-1 rounded-t-md"},kt={class:"flex py-3.5 text-gray-500 font-medium text-3.5 w-28 justify-end mr-4","data-rec":"true"},Tt={key:0,class:"flex items-center justify-center text-center h-[513px]"},Ct={key:1,class:"flex items-center justify-center text-center h-full"},Mt={key:2,class:"tbody h-[calc(100%-4rem)] nc-scrollbar-md border-t-0 !overflow-auto"},Ut={class:"text-3.5 text-start w-2/3 pl-5 flex items-center"},Rt={class:"text-3.5 text-start w-1/3"},It={key:0,class:"font-weight-bold","data-rec":"true"},Lt={class:"flex items-center gap-1 justify-between"},Et={"data-rec":"true"},St={class:"text-gray-500 text-xs whitespace-normal","data-rec":"true"},jt={class:"flex items-center gap-1 justify-between"},Dt={"data-rec":"true"},Vt={class:"text-gray-500 text-xs whitespace-normal","data-rec":"true"},qt={key:2,class:"font-weight-bold","data-rec":"true"},Nt={class:"w-26 flex items-center justify-end mr-4"},zt={"data-rec":"true"},At={"data-rec":"true"},Pt={key:0,class:"user pt-12 pb-4 px-2 flex flex-col items-center gap-6 text-center border-b-1 border-l-1 border-r-1"},Bt={class:"text-2xl text-gray-800 font-bold"},Gt={class:"text-sm text-gray-700"},Ot=vt(()=>a("img",{src:pt,class:"!w-[30rem] flex-none"},null,-1)),Wt={key:0,class:"flex items-center justify-center mt-4"},Qt={class:"flex flex-row items-center py-2.25 px-2.5 bg-gray-50 rounded-lg text-gray-700 mb-4"},Yt={class:"text-ellipsis overflow-hidden select-none w-full pl-1.75",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},Ft=Re({__name:"UserList",setup(p){const{api:y,isLoading:A}=Ie();A.value=!0;const{$e:h}=Qe(),{t:w}=Le(),{dashboardUrl:re}=tt(),{user:P}=Ee(),{copy:B}=Se(),{sorts:S,loadSorts:ie,handleGetSortedData:le,toggleSort:G}=st("Org"),b=f([]),O=je(()=>le(b.value,S.value)),_=f(1),j=f(10),D=f(!1),W=f(0),x=f(!1),$=f(""),R=De({total:0,pageSize:10,position:["bottomCenter"]}),v=Ve(async(e=_.value,o=j.value)=>{_.value=e;try{const d=await y.orgUsers.list({query:{limit:o,offset:$.value.length===0?(e-1)*o:0,query:$.value}});if(!d)return;R.total=d.pageInfo.totalRows??0,R.pageSize=10,b.value=d.list}catch(d){m.error(await U(d))}},500);qe(()=>{v(),ie()});const ce=async(e,o)=>{try{await y.orgUsers.update(e,{roles:o}),m.success(w("msg.success.roleUpdated")),b.value.forEach(d=>{d.id===e&&(d.roles=o)}),h("a:org-user:role-updated",{role:o})}catch(d){m.error(await U(d))}},I=f(null),de=async()=>{var e;try{await y.orgUsers.delete((e=I.value)==null?void 0:e.id),m.success(w("msg.success.userDeleted")),await v(),!b.value.length&&_.value!==1&&(_.value--,v(_.value)),h("a:org-user:user-deleted")}catch(o){m.error(await U(o))}finally{x.value=!1,I.value=null}},ue=async e=>{try{await y.orgUsers.resendInvite(e.id),m.success(w("msg.success.inviteEmailSent")),await v()}catch(o){m.error(await U(o))}h("a:org-user:resend-invite")},pe=async e=>{if(e.invite_token){try{await B(`${re.value}#/signup/${e.invite_token}`),m.success(w("msg.success.inviteURLCopied"))}catch(o){m.error(o.message)}h("c:user:copy-url")}},me=async e=>{try{const{reset_password_url:o}=await y.orgUsers.generatePasswordResetToken(e.id);await B(o),m.success(w("msg.success.passwordResetURLCopied")),h("c:user:copy-url")}catch(o){m.error(await U(o))}},_e=()=>{D.value=!0,W.value++},ve=e=>{I.value=e,x.value=!0};return(e,o)=>{const d=ot,fe=at,Q=ze,Y=mt,ge=Ae,ye=se,F=Fe,he=Pe,V=Be,H=nt,we=He,be=Ge,L=Ke,xe=Ze,$e=ut,ke=Je,Te=Xe,Ce=rt,Me=et,Ue=_t;return n(),c("div",ft,[a("div",gt,[a("div",yt,i(e.$t("title.userMgmt")),1),a("div",ht,[r(fe,{value:s($),"onUpdate:value":o[0]||(o[0]=t=>N($)?$.value=t:null),class:"!max-w-90 !rounded-md",placeholder:e.$t("title.searchMembers"),onChange:o[1]||(o[1]=t=>s(v)())},{prefix:l(()=>[r(d,{class:"!h-3.5 text-gray-500"})]),_:1},8,["value","placeholder"]),a("div",wt,[(n(),u(T(("iconMap"in e?e.iconMap:s(C)).reload),{class:"cursor-pointer",onClick:o[2]||(o[2]=t=>s(v)(s(_),s(j)))})),r(Q,{"data-testid":"nc-super-user-invite",size:"small",type:"primary",onClick:_e},{default:l(()=>[a("div",bt,[(n(),u(T(("iconMap"in e?e.iconMap:s(C)).plus))),M(" "+i(e.$t("activity.inviteUser")),1)])]),_:1})])]),a("div",xt,[a("div",$t,[r(Y,{class:"py-3.5 text-gray-500 font-medium text-3.5 w-2/3 text-start pl-6",header:e.$t("objects.users"),"active-sort":s(S),field:"email","toggle-sort":s(G)},null,8,["header","active-sort","toggle-sort"]),r(Y,{class:"py-3.5 text-gray-500 font-medium text-3.5 w-1/3 text-start",header:e.$t("general.access"),"active-sort":s(S),field:"roles","toggle-sort":s(G)},null,8,["header","active-sort","toggle-sort"]),a("div",kt,i(e.$t("labels.action")),1)]),s(A)?(n(),c("div",Tt,[r(ge,{size:"xlarge"})])):s(b).length?(n(),c("section",Mt,[(n(!0),c(z,null,Ne(s(O),t=>{var K,Z,J,X;return n(),c("div",{key:t.id,"data-testid":"nc-token-list",class:oe(["user flex py-3 justify-around px-1 border-b-1 border-l-1 border-r-1",{"py-4":(K=t.roles)==null?void 0:K.includes("super")}])},[a("div",Ut,[t.display_name?(n(),u(he,{key:0},{title:l(()=>[M(i(t.email),1)]),default:l(()=>[r(F,{length:29},{default:l(()=>[M(i(t.display_name),1)]),_:2},1024)]),_:2},1024)):(n(),u(F,{key:1,length:29},{default:l(()=>[M(i(t.email),1)]),_:2},1024))]),a("div",Rt,[(Z=t==null?void 0:t.roles)!=null&&Z.includes("super")?(n(),c("div",It,i(e.$t("labels.superAdmin")),1)):t.id!==((J=s(P))==null?void 0:J.id)?(n(),u(we,{key:1,value:t.roles,"onUpdate:value":k=>t.roles=k,class:"w-55 nc-user-roles","dropdown-match-select-width":!1,"dropdown-class-name":"max-w-64",onChange:k=>ce(t.id,t.roles)},{default:l(()=>[r(H,{class:"nc-users-list-role-option",value:s(E).CREATOR,label:e.$t("objects.roleType.orgLevelCreator")},{default:l(()=>[a("div",Lt,[a("div",Et,i(e.$t("objects.roleType.orgLevelCreator")),1),(t==null?void 0:t.roles)===s(E).CREATOR?(n(),u(V,{key:0,id:"nc-selected-item-icon",icon:"check",class:"w-4 h-4 text-primary"})):g("",!0)]),a("div",St,i(e.$t("msg.info.roles.orgCreator")),1)]),_:2},1032,["value","label"]),r(H,{class:"nc-users-list-role-option",value:s(E).VIEWER,label:e.$t("objects.roleType.orgLevelViewer")},{default:l(()=>[a("div",jt,[a("div",Dt,i(e.$t("objects.roleType.orgLevelViewer")),1),t.roles===s(E).VIEWER?(n(),u(V,{key:0,id:"nc-selected-item-icon",icon:"check",class:"w-4 h-4 text-primary"})):g("",!0)]),a("div",Vt,i(e.$t("msg.info.roles.orgViewer")),1)]),_:2},1032,["value","label"])]),_:2},1032,["value","onUpdate:value","onChange"])):(n(),c("div",qt,i(e.$t("objects.roleType.orgLevelCreator")),1))]),a("span",Nt,[a("div",{class:oe(["flex items-center gap-2",{"opacity-0 pointer-events-none":(X=t.roles)==null?void 0:X.includes("super")}])},[r(Te,{trigger:["click"]},{overlay:l(()=>[r(ke,null,{default:l(()=>{var k,ee,te;return[(k=t.roles)!=null&&k.includes("super")?g("",!0):(n(),c(z,{key:0},[r(L,{onClick:q=>ue(t)},{default:l(()=>[(n(),u(T(("iconMap"in e?e.iconMap:s(C)).email),{class:"flex text-gray-600"})),a("div",zt,i(e.$t("activity.resendInvite")),1)]),_:2},1032,["onClick"]),r(L,{onClick:q=>pe(t)},{default:l(()=>[(n(),u(T(("iconMap"in e?e.iconMap:s(C)).copy),{class:"flex text-gray-600"})),a("div",At,i(e.$t("activity.copyInviteURL")),1)]),_:2},1032,["onClick"]),r(L,{onClick:q=>me(t)},{default:l(()=>[(n(),u(T(("iconMap"in e?e.iconMap:s(C)).copy),{class:"flex text-gray-600"})),a("div",null,i(e.$t("activity.copyPasswordResetURL")),1)]),_:2},1032,["onClick"])],64)),t.id!==((ee=s(P))==null?void 0:ee.id)?(n(),c(z,{key:1},[(te=t.roles)!=null&&te.includes("super")?g("",!0):(n(),u(xe,{key:0})),r(L,{"data-rec":"true",class:"!text-red-500 !hover:bg-red-50",onClick:q=>ve(t)},{default:l(()=>[r($e),M(" "+i(e.$t("general.remove"))+" "+i(e.$t("objects.user")),1)]),_:2},1032,["onClick"])],64)):g("",!0)]}),_:2},1024)]),default:l(()=>[r(Q,{size:"xsmall",type:"ghost"},{default:l(()=>[r(be,{class:"text-gray-600 h-5.5 w-5.5 rounded outline-0 p-0.5 nc-workspace-menu transform transition-transform !text-gray-400 cursor-pointer !hover:text-gray-500 hover:bg-gray-100"})]),_:1})]),_:2},1024)],2)])],2)}),128)),s(O).length===1?(n(),c("div",Pt,[a("div",Bt,i(e.$t("placeholder.inviteYourTeam")),1),a("div",Gt,i(e.$t("placeholder.inviteYourTeamLabel")),1),Ot])):g("",!0)])):(n(),c("div",Ct,[r(ye,{image:("Empty"in e?e.Empty:s(se)).PRESENTED_IMAGE_SIMPLE,description:e.$t("labels.noData")},null,8,["image","description"])]))]),s(R).total>10?(n(),c("div",Wt,[r(Ce,{current:s(_),"onUpdate:current":o[3]||(o[3]=t=>N(_)?_.value=t:null),total:s(R).total,"show-less-items":"",onChange:o[4]||(o[4]=t=>s(v)(s(_),s(j)))},null,8,["current","total"])])):g("",!0),r(Me,{visible:s(x),"onUpdate:visible":o[5]||(o[5]=t=>N(x)?x.value=t:null),"entity-name":"User","on-delete":()=>de()},{"entity-preview":l(()=>{var t;return[a("span",null,[a("div",Qt,[r(V,{icon:"account",class:"nc-view-icon"}),a("div",Yt,i((t=s(I))==null?void 0:t.email),1)])])]}),_:1},8,["visible","on-delete"]),(n(),u(Ue,{key:s(W),show:s(D),onClosed:o[6]||(o[6]=t=>D.value=!1),onReload:s(v)},null,8,["show","onReload"]))])])}}}),ws=Ye(Ft,[["__scopeId","data-v-dc331bff"]]);export{ws as default};
