const __vite__fileDeps=["./DmMYhVBH.js","./DgdUBGGc.js","./Cgw6cdOy.js","./entry.DxI7QTvq.css","./BiBN5Lxt.js","./hvq8FVej.js","./DFiWgQ57.js","./CO8XXsKl.js","./BttyO-T4.js","./CitraFSq.js","./BZz6iAla.js","./DPaOlBFV.js","./BQQOEPN4.js","./DoqAS2qD.js","./BRorwQ1i.js","./B2gUw4Rv.js","./D933wnC7.js","./LSbsNkd9.js","./CgtJdY-6.js","./6kmz45LK.js","./D8rpj5Lr.js","./BcZAlRJW.js","./BohSct8s.js","./C8c9012h.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{o as n,c as d,a as s,f as ae,ad as Ie,r as A,as as he,t as u,P as a,b as c,w as g,d as R,U as te,S as D,aq as K,a1 as we,_ as de,N as Ae,cR as ye,cZ as je,ay as Te,bN as Ee,db as Be,g as N,df as re,gI as _e,d7 as P,aj as W,ak as Y,F as Re,O as ze,R as G,Q as q,T as B,cg as Oe,X as De,av as ge,A as be,$ as We,ar as He,az as Q,cN as xe,a9 as Je,ds as $e,aV as ke,p as Se,e as Ce,n as Ge,bV as qe,H as Ke,V as Ye,i8 as fe,aa as Ze,Z as Qe,a6 as Xe,aO as et,a0 as tt,cc as at}from"./Cgw6cdOy.js";import{a as Me}from"./DFiWgQ57.js";import{u as Ue}from"./DgdUBGGc.js";import{R as st,_ as ot}from"./BttyO-T4.js";import{_ as lt}from"./BiBN5Lxt.js";import{_ as nt}from"./BZz6iAla.js";import{u as ce}from"./DoqAS2qD.js";import{u as it}from"./CO8XXsKl.js";import{W as rt}from"./BRorwQ1i.js";import{A as ct}from"./B2gUw4Rv.js";import{_ as dt}from"./D8rpj5Lr.js";const ut={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},vt=s("path",{fill:"currentColor",d:"M19 21H8V7h11m0-2H8a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2m-3-4H4a2 2 0 0 0-2 2v14h2V3h12z"},null,-1),pt=[vt];function mt(p,v){return n(),d("svg",ut,[...pt])}const Fe={name:"mdi-content-copy",render:mt},_t={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ft=s("path",{fill:"currentColor",d:"M21 7L9 19l-5.5-5.5l1.41-1.41L9 16.17L19.59 5.59z"},null,-1),ht=[ft];function wt(p,v){return n(),d("svg",_t,[...ht])}const Ve={name:"mdi-check",render:wt},yt={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},gt=s("path",{fill:"currentColor",d:"m14.6 16.6l4.6-4.6l-4.6-4.6L16 6l6 6l-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6l6 6z"},null,-1),bt=[gt];function xt(p,v){return n(),d("svg",yt,[...bt])}const $t={name:"mdi-code-tags",render:xt},kt={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},St=s("path",{fill:"currentColor",d:"M10 6v2H5v11h11v-5h2v6a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1zm11-3v8h-2V6.413l-7.793 7.794l-1.414-1.414L17.585 5H13V3z"},null,-1),Ct=[St];function Mt(p,v){return n(),d("svg",kt,[...Ct])}const Ut={name:"ri-external-link-line",render:Mt},Ft={class:"flex flex-row items-center justify-end text-gray-600 gap-x-1.5 py-1.5 px-1.5 bg-gray-50 rounded-md border-1 border-gray-200"},Vt={class:"overflow-hidden whitespace-nowrap text-gray-500"},Nt={class:"flex flex-row gap-x-1"},Lt={class:"flex text-xs",style:{fontWeight:500}},Pt=ae({__name:"CopyUrl",props:{url:{}},emits:["update:url"],setup(p,{emit:v}){const M=Ie(p,"url",v),C=A({link:!1,embed:!1}),{copy:L}=he(),U=async()=>{window.open(M.value,"_blank","noopener,noreferrer")},m=async()=>{await L(`<iframe src="${M.value}" width="100%" height="100%" style="border: none;"></iframe>`),C.value.embed=!0},w=async()=>{C.value.link=!1,await L(M.value),setTimeout(()=>{C.value.link=!0},100)};return(x,f)=>{const t=Ut,F=we,j=$t,O=Ve,i=Fe;return n(),d("div",Ft,[s("div",{class:"flex flex-row block flex-1 overflow-hidden pl-3 cursor-pointer",onClick:w},[s("div",Vt,u(a(M)),1)]),s("div",Nt,[c(F,null,{title:g(()=>[R(u(x.$t("activity.openInANewTab")),1)]),default:g(()=>[s("div",{class:"button",onClick:U},[c(t,{class:"h-3.75"})])]),_:1}),c(F,null,{title:g(()=>[R(u(x.$t("activity.copyIFrameCode")),1)]),default:g(()=>[s("div",{class:te(["button",{"!text-gray-300 !border-gray-200 !cursor-not-allowed":a(C).embed}]),onClick:m},[c(j,{class:"h-4"})],2)]),_:1}),s("div",{class:"button","data-testid":"docs-share-page-copy-link",onClick:w},[a(C).link?(n(),D(O,{key:0,class:"h-3.5"})):(n(),D(i,{key:1,class:"h-3.5"})),s("div",Lt,[a(C).link?(n(),d(K,{key:0},[R(u(x.$t("activity.copiedLink")),1)],64)):(n(),d(K,{key:1},[R(u(x.$t("activity.copyUrl")),1)],64))])])])])}}}),It=de(Pt,[["__scopeId","data-v-59632fef"]]),At={class:"flex flex-col py-2 px-3 mb-1"},jt={class:"flex flex-col w-full mt-2.5 px-3 py-2.5 border-gray-200 border-1 rounded-md gap-y-2"},Tt={class:"flex flex-row w-full justify-between py-0.5"},Et={class:"text-gray-900 font-medium"},Bt={class:"mt-0.5 border-t-1 border-gray-100 pt-3"},Rt={class:"flex flex-col justify-between mt-1 py-2 px-3 bg-gray-50 rounded-md"},zt={class:"flex flex-row items-center justify-between"},Ot={class:"flex text-black"},Dt={key:0,class:"flex gap-2 mt-2 w-2/3"},Wt={class:"flex flex-col justify-between gap-y-3 mt-1 py-2 px-3 bg-gray-50 rounded-md"},Ht={key:0,class:"flex flex-row items-center justify-between"},Jt={class:"flex text-black"},Gt={class:"flex flex-row items-center justify-between"},qt={class:"text-black flex items-center space-x-1"},Kt={key:0,class:"flex flex-row items-center justify-between"},Yt={class:"text-black"},Zt={key:0,class:"nc-pre-filled-mode-wrapper flex flex-col justify-between gap-y-3 mt-1 py-2 px-3 bg-gray-50 rounded-md"},Qt={class:"flex flex-row items-center justify-between"},Xt={class:"text-black flex items-center space-x-1"},ea={class:"text-center"},ta={class:"flex-1"},aa=ae({__name:"SharePage",setup(p){const{view:v,$api:z}=Me(),{$e:b}=be(),{getBaseUrl:M,appInfo:C}=Ae(),{dashboardUrl:L}=Ue(),U=ye(),{metas:m}=je(),w=Te(),x=Ee(Be,A(!1)),f=A({public:!1,password:!1,download:!1}),t=N({get:()=>{var e;return typeof((e=v.value)==null?void 0:e.meta)=="string"&&(v.value.meta=JSON.parse(v.value.meta)),v.value},set:e=>{var o;typeof((o=v.value)==null?void 0:o.meta)=="string"&&(v.value.meta=JSON.parse(v.value.meta)),typeof(e==null?void 0:e.meta)=="string"&&(e.meta=JSON.parse(e.meta)),v.value=e}}),F=N(()=>{var e;return!!((e=t.value)!=null&&e.uuid)}),j=N(()=>se()??""),O=A(!1),i=N(()=>{var e;return!!((e=t.value)!=null&&e.password)||O.value}),_=N({get:()=>{var e;return i.value?((e=t.value)==null?void 0:e.password)??"":""},set:async e=>{t.value&&(t.value={...t.value,password:i.value?e:null},E())}}),l=N({get:()=>{var e;return!!((e=t.value)!=null&&e.meta.withTheme)},set:e=>{var o;(o=t.value)!=null&&o.meta&&(t.value.meta={...t.value.meta,withTheme:e},H())}}),r=async()=>{if(O.value=!i.value,!!t.value&&!f.value.password){f.value.password=!0;try{i.value?t.value={...t.value,password:null}:t.value={...t.value,password:""},await E()}finally{f.value.password=!1}}},h=N({get:()=>{var e,o,y,I;return(e=t.value)!=null&&e.meta?(typeof((o=t.value)==null?void 0:o.meta)=="string"&&(t.value.meta=JSON.parse(t.value.meta)),!!((I=(y=t.value)==null?void 0:y.meta)!=null&&I.rtl)):!1},set:e=>{var o,y;(o=t.value)!=null&&o.meta&&(typeof((y=t.value)==null?void 0:y.meta)=="string"&&(t.value.meta=JSON.parse(t.value.meta)),t.value.meta={...t.value.meta,rtl:e},E())}}),V=N({get:()=>{var e,o;return!!((o=(e=t.value)==null?void 0:e.meta)!=null&&o.allowCSVDownload)},set:async e=>{var o;if((o=t.value)!=null&&o.meta){f.value.download=!0;try{t.value.meta={...t.value.meta,allowCSVDownload:e},await X()}finally{f.value.download=!1}}}}),k=N({get:()=>{var e;return!!((e=t.value)!=null&&e.meta.surveyMode)},set:e=>{var o;(o=t.value)!=null&&o.meta&&(t.value.meta={...t.value.meta,surveyMode:e},ne())}}),$=N({get:()=>{var e,o,y,I;return{preFillEnabled:((o=re((e=t.value)==null?void 0:e.meta))==null?void 0:o.preFillEnabled)??!1,preFilledMode:((I=re((y=t.value)==null?void 0:y.meta))==null?void 0:I.preFilledMode)||_e.Default}},set:e=>{var o;(o=t.value)!=null&&o.meta&&($.value.preFillEnabled!==e.preFillEnabled&&b(`a:view:share:prefilled-mode-${e.preFillEnabled?"enabled":"disabled"}`),$.value.preFilledMode!==e.preFilledMode&&b(`a:view:share:${e.preFilledMode}-prefilled-mode`),t.value.meta={...t.value.meta,...e},ee())}}),T=e=>{$.value={...$.value,...e}};function se(){var I;if(!t.value)return;let e;switch(t.value.type){case P.FORM:e="form";break;case P.KANBAN:e="kanban";break;case P.GALLERY:e="gallery";break;case P.MAP:e="map";break;case P.CALENDAR:e="calendar";break;default:e="view"}const o=M(w.activeWorkspaceId);let y=L.value;return o&&(y=`${o}${(I=C.value)==null?void 0:I.dashboardPath}`),encodeURI(`${y}#/nc/${e}/${t.value.uuid}${k.value?"/survey":""}${U.preFillFormSearchParams&&$.value.preFillEnabled?`?${U.preFillFormSearchParams}`:""}`)}const oe=async()=>{var e,o;if((e=t.value)!=null&&e.id)if((o=t.value)!=null&&o.uuid)await z.dbViewShare.delete(t.value.id),t.value={...t.value,uuid:void 0,password:void 0};else{const y=await z.dbViewShare.create(t.value.id);if(t.value={...t.value,...y},t.value.type===P.KANBAN){const I=m.value[U.activeView.fk_model_id].columns.find(ie=>ie.id===U.activeView.view.fk_grp_col_id);t.value.meta={...t.value.meta,groupingFieldColumn:I},await E()}}},le=async()=>{if(!f.value.public){f.value.public=!0;try{return await oe()}catch(e){W.error(await Y(e))}finally{f.value.public=!1}}};async function X(){f.value.download=!0;try{await E(),b(`a:view:share:${V.value?"enable":"disable"}-csv-download`)}catch(e){W.error(await Y(e))}f.value.download=!1}async function ne(){await E(),b(`a:view:share:${k.value?"enable":"disable"}-survey-mode`)}async function H(){await E(),b(`a:view:share:${l.value?"enable":"disable"}-theme`)}async function E(){var e;try{if(!((e=t.value)!=null&&e.meta))return;const o=t.value.meta;await z.dbViewShare.update(t.value.id,{meta:o,password:t.value.password})}catch(o){W.error(await Y(o))}return!0}async function ee(){await E()}return Re(()=>{}),(e,o)=>{var pe,me;const y=lt,I=It,ie=nt,ue=We,ve=we,Le=st,Pe=ot,J=ze("e");return n(),d("div",At,[s("div",jt,[s("div",Tt,[s("div",Et,u(e.$t("activity.enabledPublicViewing")),1),G(c(y,{checked:a(F),disabled:a(x),loading:a(f).public,class:"share-view-toggle !mt-0.25","data-testid":"share-view-toggle",onClick:le},null,8,["checked","disabled","loading"]),[[J,["c:share:view:enable:toggle"]]])]),a(F)?(n(),d(K,{key:0},[s("div",Bt,[c(I,{url:a(j),"onUpdate:url":o[0]||(o[0]=S=>q(j)?j.value=S:null)},null,8,["url"])]),s("div",Rt,[s("div",zt,[s("div",Ot,u(e.$t("activity.restrictAccessWithPassword")),1),G(c(y,{checked:a(i),loading:a(f).password,class:"share-password-toggle !mt-0.25","data-testid":"share-password-toggle",size:"small",onClick:r},null,8,["checked","loading"]),[[J,["c:share:view:password:toggle"]]])]),c(Oe,{mode:"out-in",name:"layout"},{default:g(()=>[a(i)?(n(),d("div",Dt,[c(ie,{value:a(_),"onUpdate:value":o[1]||(o[1]=S=>q(_)?_.value=S:null),placeholder:e.$t("placeholder.password.enter"),class:"!rounded-lg !py-1 !bg-white","data-testid":"nc-modal-share-view__password",size:"small",type:"password"},null,8,["value","placeholder"])])):B("",!0)]),_:1})]),s("div",Wt,[a(t)&&[a(P).GRID,a(P).KANBAN,a(P).GALLERY,a(P).MAP,a(P).CALENDAR].includes(a(t).type)?(n(),d("div",Ht,[s("div",Jt,u(e.$t("activity.allowDownload")),1),G(c(y,{checked:a(V),"onUpdate:checked":o[2]||(o[2]=S=>q(V)?V.value=S:null),loading:a(f).download,class:"public-password-toggle !mt-0.25","data-testid":"share-download-toggle",size:"small"},null,8,["checked","loading"]),[[J,["c:share:view:allow-csv-download:toggle"]]])])):B("",!0),((pe=a(t))==null?void 0:pe.type)===a(P).FORM?(n(),d(K,{key:1},[s("div",Gt,[s("div",qt,[s("div",null,u(e.$t("activity.surveyMode")),1),c(ve,{class:"flex items-center"},{title:g(()=>[R(u(e.$t("tooltip.surveyFormInfo")),1)]),default:g(()=>[c(ue,{icon:"info",class:"flex-none text-gray-600 cursor-pointer"})]),_:1})]),G(c(y,{checked:a(k),"onUpdate:checked":o[3]||(o[3]=S=>q(k)?k.value=S:null),"data-testid":"nc-modal-share-view__surveyMode",size:"small"},null,8,["checked"]),[[J,["c:share:view:surver-mode:toggle"]]])]),("isEeUI"in e?e.isEeUI:a(De))?B("",!0):(n(),d("div",Kt,[s("div",Yt,u(e.$t("activity.rtlOrientation")),1),G(c(y,{checked:a(h),"onUpdate:checked":o[4]||(o[4]=S=>q(h)?h.value=S:null),"data-testid":"nc-modal-share-view__RTL",size:"small"},null,8,["checked"]),[[J,["c:share:view:rtl-orientation:toggle"]]])]))],64)):B("",!0)]),((me=a(t))==null?void 0:me.type)===a(P).FORM?(n(),d("div",Zt,[s("div",Qt,[s("div",Xt,[s("div",null,u(e.$t("activity.preFilledFields.title")),1),c(ve,{class:"flex items-center"},{title:g(()=>[s("div",ea,u(e.$t("tooltip.preFillFormInfo")),1)]),default:g(()=>[c(ue,{icon:"info",class:"flex-none text-gray-600 cursor-pointer"})]),_:1})]),G(c(y,{checked:a($).preFillEnabled,"data-testid":"nc-modal-share-view__preFill",size:"small","onUpdate:checked":o[5]||(o[5]=S=>T({preFillEnabled:S}))},null,8,["checked"]),[[J,["c:share:view:surver-mode:toggle"]]])]),a($).preFillEnabled?(n(),D(Pe,{key:0,value:a($).preFilledMode,class:"nc-modal-share-view-preFillMode","data-testid":"nc-modal-share-view__preFillMode","onUpdate:value":o[6]||(o[6]=S=>T({preFilledMode:S}))},{default:g(()=>[(n(!0),d(K,null,ge(Object.values("PreFilledMode"in e?e.PreFilledMode:a(_e)),S=>(n(),D(Le,{key:S,value:S},{default:g(()=>[s("div",ta,u(e.$t(`activity.preFilledFields.${S}`)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])):B("",!0)])):B("",!0)],64)):B("",!0)])])}}}),sa={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},oa=s("path",{fill:"currentColor",d:"M21 7L9 19l-5.5-5.5l1.41-1.41L9 16.17L19.59 5.59z"},null,-1),la=[oa];function na(p,v){return n(),d("svg",sa,[...la])}const ia={name:"mdi-tick",render:na},[ra,ca]=it(()=>{const{api:p}=He(),{base:v}=Q(xe()),{$e:z}=be(),{formStatus:b,invitationUsersData:M}=Q(ce()),C=A(1),L=A(10),U=A(""),m=A(null),w=A(null),x=A(0),f=A(!1),t=N(()=>!m.value||!w.value?[]:m.value.filter(i=>{var l;const _=(l=w.value)==null?void 0:l.find(r=>r.id===i.id);return _?i.roles!==_.roles:!1})),F=async(i=C.value,_=L.value)=>{var l,r;try{if(!((l=v.value)!=null&&l.id))return;const h=await p.auth.baseUserList((r=v.value)==null?void 0:r.id,{query:{limit:_,offset:(i-1)*_,query:U.value}});if(!h.users)return;const V=h.users.list.filter(k=>!k.roles);x.value=(h.users.pageInfo.totalRows??0)-Number(V==null?void 0:V.length),m.value?m.value=[...m.value,...h.users.list.filter(k=>k.roles)]:m.value=h.users.list.filter(k=>k.roles),w.value=JSON.parse(JSON.stringify(m.value))}catch(h){W.error(await Y(h))}};return{loadUsers:F,inviteUser:async i=>{var l;let _;b.value="base-collaborateSaving";try{if(!((l=v.value)!=null&&l.id))return;_=await p.auth.baseUserAdd(v.value.id,{...i,base_id:v.value.id,baseName:v.value.title}),M.value.invitationToken=_.invite_token,C.value=1,m.value=[],await F()}catch(r){W.error(await Y(r)),b.value="collaborate";return}return b.value="base-collaborateSaved",z("a:user:add"),_},users:m,totalUsers:x,searchText:U,currentPage:C,currentLimit:L,editedUsers:t,updateEditedUsers:async i=>{var _,l;i=i||t.value,f.value=!0;try{await Promise.all(i.filter(r=>r.roles!=="No access").map(async r=>{var V;await p.auth.baseUserUpdate(v.value.id,r.id,{email:r.email,roles:r.roles,base_id:v.value.id,baseName:v.value.title});const h=(V=m.value)==null?void 0:V.find(k=>k.id===r.id);h&&(h.roles=r.roles)})),await Promise.all(i.filter(r=>r.roles==="No access").map(async r=>{await p.auth.baseUserRemove(v.value.id,r.id)})),m.value=((_=m.value)==null?void 0:_.filter(r=>r.roles!=="No access"))??[],x.value=((l=m.value)==null?void 0:l.length)??0,w.value=JSON.parse(JSON.stringify(m.value))}catch(r){W.error(await Y(r))}finally{f.value=!1}},isBatchUpdating:f}},"useManageUsers");function da(){const p=ca();return p||ra()}const ua={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},va=s("path",{fill:"currentColor",d:"M20 11v2H8l5.5 5.5l-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5L8 11z"},null,-1),pa=[va];function ma(p,v){return n(),d("svg",ua,[...pa])}const _a={name:"mdi-arrow-left",render:ma},Z=p=>(Se("data-v-17ab8da9"),p=p(),Ce(),p),fa={class:"flex flex-col mx-4 h-112"},ha=Z(()=>s("div",{class:"flex mt-2.5 mb-2.5 border-b-1 border-gray-50 pb-1.5",style:{fontWeight:500}},"Manage Members",-1)),wa=Z(()=>s("div",{class:"flex mt-2.5 mb-2.5 text-xs font-bold"},"Base Owner",-1)),ya={key:0,class:"flex flex-row px-2 py-2 items-center gap-x-2 border-1 border-gray-100 rounded-md"},ga={class:"flex flex-col justify-center"},ba={class:"flex",style:{fontWeight:500}},xa=Z(()=>s("div",{class:"flex flex-grow"},null,-1)),$a={class:"flex flex-row mt-4 mb-2 pt-3 border-gray-100 border-t-1 gap-x-3 items-center text-xs"},ka=Z(()=>s("div",{style:{fontWeight:500}},"People with access",-1)),Sa={class:"bg-gray-50 border-gray-100 border-1 py-0.5 px-1.5 rounded-md","data-testid":"nc-manage-user-user-count"},Ca={class:"flex flex-col mb-2 pr-0.5 h-96 overflow-y-auto users-list border-b-1 border-gray-100"},Ma={key:0,class:"text-xs mt-2"},Ua=["data-testid"],Fa={class:"flex flex-row items-center gap-x-2"},Va={class:"flex flex-col justify-center"},Na={class:"flex",style:{fontWeight:500}},La=["data-testid"],Pa={key:0,class:"flex"},Ia={key:1,class:"flex text-red-500",style:{fontWeight:500}},Aa={class:"flex flex-row w-full justify-center mt-2"},ja=Z(()=>s("span",null,null,-1)),Ta={class:"flex flex-row justify-between pt-3 pb-2"},Ea=Z(()=>s("div",null,"Back to Share",-1)),Ba=ae({__name:"ManageUsers",emits:["close"],setup(p,{emit:v}){const z=v,{users:b,totalUsers:M,editedUsers:C,currentPage:L,loadUsers:U,updateEditedUsers:m,isBatchUpdating:w}=da(),x=N(()=>{var i;return(i=b.value)==null?void 0:i.find(_=>{var l;return(l=_.roles)==null?void 0:l.includes("owner")})}),f=N(()=>{var i;return((i=b.value)==null?void 0:i.filter(_=>{var l;return!((l=_.roles)!=null&&l.includes("owner"))}))||[]}),t=()=>{z("close",!1)},F=i=>!i.firstname&&!i.lastname,j=async i=>{var l,r,h;const _=((l=b.value)==null?void 0:l.length)||0;if(((r=b.value)==null?void 0:r.length)===M.value){i.complete();return}if(i.loading(),await U(),L.value+=1,_===((h=b.value)==null?void 0:h.length)){i.complete();return}i.loaded()},O=[{id:"Creator",name:"Creator",value:"creator"},{id:"Editor",name:"Editor",value:"editor"},{id:"Commenter",name:"Commenter",value:"commenter"},{id:"Viewer",name:"Viewer",value:"viewer"},{id:"None",name:"Remove",value:"No access"}];return(i,_)=>{const l=ct,r=dt,h=$e,V=_a,k=ke;return n(),d("div",fa,[ha,wa,a(x)?(n(),d("div",ya,[c(l),s("div",ga,[s("div",ba,u(a(x).firstname)+" "+u(a(x).lastname),1),s("div",{class:te(["flex text-xs",{"text-gray-500":!F(a(x))}])},u(a(x).email),3)])])):B("",!0),xa,s("div",$a,[ka,s("div",Sa,u(a(M)-1)+" users ",1)]),s("div",Ca,[a(f).length===0?(n(),d("div",Ma,"No users have access to this base")):B("",!0),(n(!0),d(K,null,ge(a(f),$=>(n(),d("div",{key:$.id,class:"flex flex-row mb-1.5 px-2 py-1.5 items-center border-1 border-gray-100 rounded-md justify-between","data-testid":`nc-manage-users-${$.email}`},[s("div",Fa,[c(l),s("div",Va,[s("div",Na,u($.firstname)+" "+u($.lastname),1),s("div",{class:te(["flex text-xs",{"text-gray-500":!F($)}])},u($.email),3)])]),c(r,{value:$.roles,"onUpdate:value":T=>$.roles=T,class:"flex !rounded-md p-0.5 !bg-white capitalize nc-dropdown-user-role-container !min-w-26","dropdown-class-name":"nc-dropdown-user-role !rounded-md",placeholder:"Select role",options:O},{option:g(T=>[s("div",{class:"flex flex-row items-center gap-x-2","data-testid":`nc-manage-users-role-${T.id!=="None"?T.name:"Remove"}`},[T.id!=="None"?(n(),d("div",Pa,u(T.name),1)):(n(),d("div",Ia,"Remove"))],8,La)]),_:2},1032,["value","onUpdate:value"])],8,Ua))),128)),c(a(rt),Je(i.$attrs,{onInfinite:j}),{spinner:g(()=>[s("div",Aa,[c(h)])]),complete:g(()=>[ja]),_:1},16)]),s("div",Ta,[s("div",{class:"flex flex-row items-center gap-x-2 px-2 rounded-md cursor-pointer hover:bg-gray-50",onClick:t},[c(V),Ea]),c(k,{type:"primary",class:"!rounded-md",disabled:a(C).length===0,loading:a(w),"data-testid":"nc-manage-users-submit",onClick:_[0]||(_[0]=()=>a(m)())},{default:g(()=>[R(" Save Changes ")]),_:1},8,["disabled","loading"])])])}}}),Ra=de(Ba,[["__scopeId","data-v-17ab8da9"]]),za=Qe(()=>Xe(()=>import("./DmMYhVBH.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]),import.meta.url).then(p=>p.default||p)),Ne=p=>(Se("data-v-3459860e"),p=p(),Ce(),p),Oa={key:0,class:"flex flex-row w-full px-5 justify-between items-center py-1"},Da=Ne(()=>s("div",{class:"flex text-base font-bold"},"Adding Members",-1)),Wa={key:1,class:"flex flex-col py-1.5"},Ha={class:"flex flex-row w-full px-5 justify-between items-center py-0.5"},Ja=Ne(()=>s("div",{class:"flex text-base font-medium"},"Members added",-1)),Ga={class:"flex"},qa={class:"flex flex-row mx-3 mt-2.5 pt-3.5 border-t-1 border-gray-100 justify-end gap-x-2"},Ka={key:0,class:"flex flex-row items-center gap-x-1"},Ya={key:1,class:"flex flex-row items-center gap-x-1"},Za={key:2},Qa={key:3,class:"flex flex-col px-1"},Xa={class:"flex flex-row justify-between items-center pb-1 mx-4 mt-3"},es={class:"flex text-base font-medium"},ts={key:0,class:"share-view"},as={class:"flex flex-row items-center gap-x-2 px-4 pt-3 pb-3 select-none"},ss={class:"max-w-79/100 ml-2 px-2 py-0.5 rounded-md bg-gray-100 capitalize text-ellipsis overflow-hidden",style:{wordBreak:"keep-all",whiteSpace:"nowrap"}},os={key:0},ls={key:1},ns={class:"share-base"},is={class:"flex flex-row items-center gap-x-2 px-4 pt-3 pb-3 select-none"},rs={class:"max-w-79/100 ml-2 px-2 py-0.5 rounded-md bg-gray-100 capitalize text-ellipsis overflow-hidden",style:{wordBreak:"keep-all",whiteSpace:"nowrap"}},cs={class:"flex flex-row justify-end mx-3 mt-1 mb-2 pt-4 gap-x-2"},ds=ae({__name:"View",props:{isViewToolbar:{type:Boolean}},setup(p){const{copy:v}=he(),{dashboardUrl:z}=Ue(),b=xe(),{base:M}=Q(b),{navigateToProjectPage:C}=b,{activeView:L}=Q(ye());let U;if(p.isViewToolbar)try{U=Me().view}catch(l){console.error(l)}const{formStatus:m,showShareModal:w,invitationUsersData:x,isInvitationLinkCopied:f}=Q(ce()),{resetData:t}=ce(),F=A(!1),j=N(()=>x.value.invitationToken?`${z.value}#/signup/${x.value.invitationToken}`:null),O=Ge(qe,{style:{fontSize:"24px"},spin:!0}),i=async()=>{await v(j.value),f.value=!0},_=async()=>{F.value=!0;try{await C({page:"collaborator"}),w.value=!1}catch(l){console.error(l),W.error("Failed to open manage access")}finally{F.value=!1}};return Ke(w,l=>{l||setTimeout(()=>{t()},500)}),(l,r)=>{const h=$e,V=Ve,k=ke,$=ia,T=Fe,se=aa,oe=et,le=za,X=tt,ne=at;return n(),D(ne,{visible:a(w),"onUpdate:visible":r[3]||(r[3]=H=>q(w)?w.value=H:null),class:te(["!top-[1%]",{active:a(w)}]),"wrap-class-name":"nc-modal-share-collaborate",closable:!1,"mask-closable":a(m)!=="base-collaborateSaving","ok-button-props":{hidden:!0},"cancel-button-props":{hidden:!0},footer:null,width:a(m)==="manageCollaborators"?"60rem":"40rem"},{default:g(()=>{var H,E,ee,e;return[a(m)==="base-collaborateSaving"?(n(),d("div",Oa,[Da,c(h,{indicator:a(O)},null,8,["indicator"])])):a(m)==="base-collaborateSaved"?(n(),d("div",Wa,[s("div",Ha,[Ja,s("div",Ga,[c(V)])]),s("div",qa,[c(k,{type:"text",class:"!border-1 !border-gray-200 !rounded-md",onClick:r[0]||(r[0]=o=>w.value=!1)},{default:g(()=>[R("Close ")]),_:1}),c(k,{type:"text",class:"!border-1 !border-gray-200 !rounded-md","data-testid":"docs-share-invitation-copy","data-invite-link":a(j),onClick:i},{default:g(()=>[a(f)?(n(),d("div",Ka,[c($,{class:"h-3.5"}),R(" "+u(l.$t("activity.copiedInviteLink")),1)])):(n(),d("div",Ya,[c(T,{class:"h-3.3"}),R(" "+u(l.$t("activity.copyInviteLink")),1)]))]),_:1},8,["data-invite-link"])])])):a(m)==="manageCollaborators"?(n(),d("div",Za,[a(m)==="manageCollaborators"?(n(),D(Ra,{key:0,onClose:r[1]||(r[1]=o=>m.value="collaborate")})):B("",!0)])):(n(),d("div",Qa,[s("div",Xa,[s("div",es,u(l.$t("activity.share")),1)]),l.isViewToolbar&&a(L)?(n(),d("div",ts,[s("div",as,[(n(),D(Ye((E=("viewIcons"in l?l.viewIcons:a(fe))[(H=a(U))==null?void 0:H.type])==null?void 0:E.icon),{class:"nc-view-icon group-hover",style:Ze({color:(e=("viewIcons"in l?l.viewIcons:a(fe))[(ee=a(U))==null?void 0:ee.type])==null?void 0:e.color})},null,8,["style"])),s("div",null,u(l.$t("activity.shareView")),1),s("div",ss,[a(L).is_default?(n(),d("span",os,u(l.$t("labels.defaultView")),1)):(n(),d("span",ls,u(a(L).title),1))])]),c(se)])):B("",!0),s("div",ns,[s("div",is,[c(oe,{color:("parseProp"in l?l.parseProp:a(re))(a(M).meta).iconColor,type:a(M).type,class:"nc-view-icon group-hover"},null,8,["color","type"]),s("div",null,u(l.$t("activity.shareBase.label")),1),s("div",rs,u(a(M).title),1)]),c(le)]),s("div",cs,[c(X,{type:"secondary","data-testid":"docs-cancel-btn",onClick:r[2]||(r[2]=o=>w.value=!1)},{default:g(()=>[R(u(l.$t("general.close")),1)]),_:1}),c(X,{"data-testid":"docs-share-manage-access",type:"secondary",loading:a(F),onClick:_},{default:g(()=>[R(u(l.$t("activity.manageProjectAccess")),1)]),_:1},8,["loading"])])]))]}),_:1},8,["visible","class","mask-closable","width"])}}}),us=de(ds,[["__scopeId","data-v-3459860e"]]),$s=Object.freeze(Object.defineProperty({__proto__:null,default:us},Symbol.toStringTag,{value:"Module"}));export{$s as V,It as _};
