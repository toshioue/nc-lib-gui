const __vite__fileDeps=["./B2_HDijx.js","./DZZ6t_j4.js","./entry.DIDWwc7m.css","./BmNyaTYf.js","./Cy50pBgZ.js","./DKN1hQ6S.js","./BQuyMdA-.js","./BQQOEPN4.js","./vll-Pnjv.js","./B5RRVMt5.js","./DGj1ycqW.js","./DyDFI6NE.js","./links.C8uCzV-l.css","./C4K5fdHe.js","./Dwil3It4.js","./RichText.M7uMQ9pA.css","./BVHyv0aP.js","./BIhr-Z4C.js","./ByVBARmO.js","./VirtualCell.BYk4C8Tn.css","./DG2ZH8TR.js","./CA74dF2b.js","./GMLocJHP.js","./qW2V2r_p.js","./boyBAVNN.js","./BDAIZopQ.js","./Cell.DUBzJZSm.css","./B9n4-CGo.js","./DivDataCell.1yCNpUg3.css","./Bs2dQa0Z.js","./T8gL-mZl.js","./CvFIzJau.js","./DgixBgIx.js","./DeleteModal.SEMJ_gSK.css","./YB9ISZhn.js","./BVrX6sNU.js","./hZgTYrdl.js","./37hePIet.js","./d-K880gs.js","./vK-WmZ7a.js","./C3jLTHF4.js","./BYINaHrJ.js","./dfem9Uc_.js","./BCJFTkwv.js","./D9tFZoTQ.js","./3mkq4YHx.js","./Dg0-TbNo.js","./t0mbNaqp.js","./9ZvwAtsX.js","./SelectOptions.JaHDUZhn.css","./CwK0k4WN.js","./toggleHighContrast.wojAGmRG.css","./amsYJsUh.js","./DLDZbX8i.js","./oyD85nwD.js","./D_MsYLkT.js","./CB1aB6F1.js","./B8iX-Tu_.js","./Cz_1GoV3.js","./CJNscGy3.js","./CDWovrGB.js","./Switch.CEh6YzqD.css","./CFvUUxCy.js","./eX8_g88K.js","./Ck-cgwga.js","./Tabs.DaLSLYpn.css","./i4aLU0Nw.js","./C9Sjn86N.js","./CXD-Dj4T.js","./CynerQ2m.js","./DnSVh-oD.js","./Select.C8Fy0-eI.css","./CR5b0rlC.js","./ListWithSearch.PmKyjXoQ.css","./B4ZLG6hR.js","./CyRMlOXW.js","./Bdv7ru7D.js","./index.E0_BHHK8.css","./0azk-b-q.js","./BJrIHEse.js","./C3XbZq4f.js","./EditOrAddProvider.4Uf-_8RE.css","./DV-O7oV5.js","./DqAHSrWO.js","./sz1d3zjm.js","./MenuItem.C7h59s4s.css","./BLgccLvp.js","./Menu.CQ8GNWeI.css","./BtLb9F6G.js","./FieldListAutoCompleteDropdown.B9RfDcmT.css","./BC4FfNUJ.js","./EqBqqo9-.js","./DKoVb009.js","./SingleSelect.B3VFmHbU.css","./BfEabL6Z.js","./DO2z7KR_.js","./DNgdBwTe.js","./MultiSelect.CPGlWfel.css","./_UtSxoDP.js","./CdfAcTJv.js","./CToWLgER.js","./DateWeekSelector.Cg_ptNCJ.css","./jD721dGr.js","./DatePicker.CPnQAVbd.css","./8CPSAnYl.js","./YearPicker.D3GFQXjv.css","./wnVheyFD.js","./CbkSs5Gy.js","./TimePicker.D71nJvtX.css","./B_hXH8Ph.js","./Rating.Bbd6kC9Q.css","./CwCOKBa8.js","./Duration.qRuog1CR.css","./ZFfr47_V.js","./CmWcz5yS.js","./Percent.CRLQxj2f.css","./Dw0oE3Jr.js","./Currency.B3r8b999.css","./Cj0Ygd-o.js","./Decimal.B3q8Nk6V.css","./DXGe1EHQ.js","./Integer.B2TNnrsi.css","./BL8INA0H.js","./Float.BKKVtNnp.css","./bWYzyg0p.js","./BGrG97ky.js","./DnwRMKX3.js","./UserIcon.DEVmGavY.css","./User.Cb8PWh8F.css","./B05h-4V9.js","./ColumnFilter.Nvete9xV.css","./CEmZpw8Z.js","./RXURfzjs.js","./DQfemegE.js","./8DEek4Fb.js","./xByXWphG.js","./BqKQ8afS.js","./B89oU1M4.js","./Badge.D0-UrqG9.css","./CMIIcM5i.js","./B0udi9ji.js","./splitpanes.Ckqx9aWT.css","./Bvfp7LPc.js","./BCU2uY6p.js","./field-settings.Boy3gwDK.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{o as v,Q as R,a6 as Ie,n as Fe,b as _,w as C,ao as Ve,at as Hi,T as Ce,P as Ge,aF as rn,a7 as $t,W as ue,R as D,e as It,cV as yo,ab as ln,ap as _o,r as L,F as Xe,a as g,N as l,c as W,d as oe,O as Ue,Z as li,Y as cn,ah as et,ai as ci,_ as di,ba as xo,bL as Ee,gT as dn,d7 as un,d6 as hn,d8 as mn,az as Kt,g2 as zo,ag as ui,cW as hi,f as de,U as tt,t as M,c$ as N,a$ as St,ae as fn,y as mi,hD as Co,ax as Jt,a8 as ei,cL as pn,dc as We,dJ as gn,da as ti,fE as Mt,g3 as ut,aD as Ro,i3 as Ao,h$ as dt,L as ko,J as So,dz as Mo,cO as Eo,gt as $o,iG as Fo,f$ as Ye,g as Io,gV as Do,d4 as To,aE as Ni,aK as Oo,M as Lo,V as qi,S as Se,ce as Bo,aJ as Po,cm as Wo,gf as jo,X as De,a4 as Te,dg as Vo,g$ as Uo,aL as Ho,$ as No,fF as qo}from"./DZZ6t_j4.js";import{_ as Yo,a as Xo}from"./CEmZpw8Z.js";import{_ as Go}from"./Bdv7ru7D.js";import Zo from"./hZgTYrdl.js";import Qo from"./37hePIet.js";import{_ as Ko}from"./sz1d3zjm.js";import{_ as Jo}from"./BLgccLvp.js";import{_ as es,a as ts}from"./xByXWphG.js";import{a as is}from"./B05h-4V9.js";import{l as ns,i as Yi,e as os}from"./BDAIZopQ.js";import{_ as vn}from"./0azk-b-q.js";import{_ as ss}from"./B89oU1M4.js";import{u as as}from"./CMIIcM5i.js";import{g as Ft,M as bn}from"./B0udi9ji.js";import{u as rs}from"./RXURfzjs.js";import{a as ls}from"./Bvfp7LPc.js";import{u as cs}from"./GMLocJHP.js";import{F as Xi,g as ds,e as us,r as hs}from"./BCU2uY6p.js";import{F as wn}from"./BYINaHrJ.js";import{a as ms}from"./i4aLU0Nw.js";import{u as fs}from"./CA74dF2b.js";import{i as ps}from"./C4K5fdHe.js";import{D as Gi}from"./Dg0-TbNo.js";import"./DKN1hQ6S.js";import{I as gs}from"./BQuyMdA-.js";import{_ as vs}from"./CXD-Dj4T.js";import{_ as bs}from"./DGj1ycqW.js";import{_ as ws}from"./dfem9Uc_.js";import{_ as ys}from"./CDWovrGB.js";function Zi(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),i.push.apply(i,o)}return i}function P(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Zi(Object(i),!0).forEach(function(o){ve(e,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Zi(Object(i)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(i,o))})}return e}function ve(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _s(e,t){if(e==null)return{};var i,o,s=function(r,d){if(r==null)return{};var a,h,m={},f=Object.keys(r);for(h=0;h<f.length;h++)a=f[h],d.indexOf(a)>=0||(m[a]=r[a]);return m}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(o=0;o<n.length;o++)i=n[o],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(s[i]=e[i])}return s}function Ze(e){return function(t){if(Array.isArray(t))return qt(t)}(e)||function(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}(e)||function(t,i){if(t){if(typeof t=="string")return qt(t,i);var o=Object.prototype.toString.call(t).slice(8,-1);if(o==="Object"&&t.constructor&&(o=t.constructor.name),o==="Map"||o==="Set")return Array.from(t);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return qt(t,i)}}(e)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function qt(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,o=new Array(t);i<t;i++)o[i]=e[i];return o}var Qi,xs,zt,K=(Qi=function(e){/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(){var t={}.hasOwnProperty;function i(){for(var o=[],s=0;s<arguments.length;s++){var n=arguments[s];if(n){var r=typeof n;if(r==="string"||r==="number")o.push(n);else if(Array.isArray(n)){if(n.length){var d=i.apply(null,n);d&&o.push(d)}}else if(r==="object")if(n.toString===Object.prototype.toString)for(var a in n)t.call(n,a)&&n[a]&&o.push(a);else o.push(n.toString())}}return o.join(" ")}e.exports?(i.default=i,e.exports=i):window.classNames=i})()},Qi(zt={path:xs,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(t==null&&zt.path)}},zt.exports),zt.exports),_e=function(e){return function(t,i){if(!t)return e;var o;typeof t=="string"?o=t:i=t;var s=e;return o&&(s+="__"+o),s+(i?Object.keys(i).reduce(function(n,r){var d=i[r];return d&&(n+=" "+(typeof d=="boolean"?s+"--"+r:s+"--"+r+"_"+d)),n},""):"")}};function ii(e,t,i){var o,s,n,r,d;function a(){var m=Date.now()-r;m<t&&m>=0?o=setTimeout(a,t-m):(o=null,i||(d=e.apply(n,s),n=s=null))}t==null&&(t=100);var h=function(){n=this,s=arguments,r=Date.now();var m=i&&!o;return o||(o=setTimeout(a,t)),m&&(d=e.apply(n,s),n=s=null),d};return h.clear=function(){o&&(clearTimeout(o),o=null)},h.flush=function(){o&&(d=e.apply(n,s),n=s=null,clearTimeout(o),o=null)},h}ii.debounce=ii;var ni=ii,k=function(){return k=Object.assign||function(e){for(var t,i=1,o=arguments.length;i<o;i++)for(var s in t=arguments[i])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},k.apply(this,arguments)};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function yn(e,t){var i,o;return e&&t?(i=""+e+t[0].toUpperCase()+t.slice(1),o=e+"-"+t):(i=e||t,o=e||t),{name:i,classname:o}}function _n(e){return/^blob:/.test(e)}function Ki(e){return _n(e)||function(t){return/^data:/.test(t)}(e)}function Je(e){return!!(e&&e.constructor&&e.call&&e.apply)}function te(e){return e===void 0}function Et(e){return typeof e=="object"&&e!==null}function oi(e,t,i){var o={};return Et(e)?(Object.keys(t).forEach(function(s){te(e[s])?o[s]=t[s]:Et(t[s])?Et(e[s])?o[s]=oi(e[s],t[s],i[s]):o[s]=e[s]?t[s]:i[s]:t[s]===!0||t[s]===!1?o[s]=!!e[s]:o[s]=e[s]}),o):e?t:i}function Ct(e){var t=Number(e);return Number.isNaN(t)?e:t}function Ji(e){return typeof(e=="number"||function(t){return typeof t=="object"&&t!==null}(e)&&toString.call(e)=="[object Number]")&&!xn(e)}function xn(e){return e!=e}function zn(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}var ht=function(e,t){e===void 0&&(e={}),t===void 0&&(t={}),this.type="manipulateImage",this.move=e,this.scale=t},zs=function(e,t){t===void 0&&(t={}),this.type="resize",this.directions=e,this.params=t},fi=function(e){this.type="move",this.directions=e},Cs=function(){function e(t,i,o,s,n){this.type="drag",this.nativeEvent=t,this.position=o,this.previousPosition=s,this.element=i,this.anchor=n}return e.prototype.shift=function(){var t=this,i=t.element,o=t.anchor,s=t.position;if(i){var n=i.getBoundingClientRect(),r=n.left,d=n.top;return{left:s.left-r-o.left,top:s.top-d-o.top}}return{left:0,top:0}},e}(),pi={name:"DraggableElement",props:{classname:{type:String}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},mounted:function(){if(!this.$refs.draggable)throw new Error('You should add ref "draggable" to your root element to use draggable mixin');this.touches=[],this.hovered=!1},methods:{onMouseOver:function(){this.hovered||(this.hovered=!0,this.$emit("enter"))},onMouseLeave:function(){this.hovered&&!this.touches.length&&(this.hovered=!1,this.$emit("leave"))},onTouchStart:function(e){e.cancelable&&!this.disabled&&e.touches.length===1&&(this.touches=Ze(e.touches),this.hovered||(this.$emit("enter"),this.hovered=!0),e.touches.length&&this.initAnchor(this.touches.reduce(function(t,i){return{clientX:t.clientX+i.clientX/e.touches.length,clientY:t.clientY+i.clientY/e.touches.length}},{clientX:0,clientY:0})),e.preventDefault&&e.preventDefault(),e.stopPropagation())},onTouchEnd:function(){this.processEnd()},onTouchMove:function(e){this.touches.length&&(this.processMove(e,e.touches),e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation())},onMouseDown:function(e){if(!this.disabled){var t={fake:!0,clientX:e.clientX,clientY:e.clientY};this.touches=[t],this.initAnchor(t),e.stopPropagation()}},onMouseMove:function(e){this.touches.length&&(this.processMove(e,[{fake:!0,clientX:e.clientX,clientY:e.clientY}]),e.preventDefault&&e.preventDefault())},onMouseUp:function(){this.processEnd()},initAnchor:function(e){var t=this.$refs.draggable.getBoundingClientRect(),i=t.left,o=t.right,s=t.bottom,n=t.top;this.anchor={left:e.clientX-i,top:e.clientY-n,bottom:s-e.clientY,right:o-e.clientX}},processMove:function(e,t){var i=Ze(t);if(this.touches.length){if(this.touches.length===1&&i.length===1){var o=this.$refs.draggable;this.$emit("drag",new Cs(e,o,{left:i[0].clientX,top:i[0].clientY},{left:this.touches[0].clientX,top:this.touches[0].clientY},this.anchor))}this.touches=i}},processEnd:function(){this.touches.length&&this.$emit("drag-end"),this.hovered&&(this.$emit("leave"),this.hovered=!1),this.touches=[]}},emits:["drag","drag-end","leave","enter"]};pi.render=function(e,t,i,o,s,n){return v(),R("div",{ref:"draggable",class:i.classname,onTouchstart:t[1]||(t[1]=function(){return n.onTouchStart&&n.onTouchStart.apply(n,arguments)}),onMousedown:t[2]||(t[2]=function(){return n.onMouseDown&&n.onMouseDown.apply(n,arguments)}),onMouseover:t[3]||(t[3]=function(){return n.onMouseOver&&n.onMouseOver.apply(n,arguments)}),onMouseleave:t[4]||(t[4]=function(){return n.onMouseLeave&&n.onMouseLeave.apply(n,arguments)})},[Ie(e.$slots,"default")],34)};var Yt=_e("vue-handler-wrapper"),Cn={name:"HandlerWrapper",components:{DraggableElement:pi},props:{horizontalPosition:{type:String},verticalPosition:{type:String},disabled:{type:Boolean,default:!1}},computed:{classes:function(){var e;if(this.horizontalPosition||this.verticalPosition){var t,i=yn(this.horizontalPosition,this.verticalPosition);e=Yt((ve(t={},i.classname,!0),ve(t,"disabled",this.disabled),t))}else e=Yt({disabled:this.disabled});return{root:e,draggable:Yt("draggable")}}},emits:["leave","enter","drag","drag-end"]};Cn.render=function(e,t,i,o,s,n){var r=Fe("DraggableElement");return v(),R("div",{class:n.classes.root},[_(r,{class:n.classes.draggable,onDrag:t[1]||(t[1]=function(d){return e.$emit("drag",d)}),onDragEnd:t[2]||(t[2]=function(d){return e.$emit("drag-end")}),onLeave:t[3]||(t[3]=function(d){return e.$emit("leave")}),onEnter:t[4]||(t[4]=function(d){return e.$emit("enter")})},{default:C(function(){return[Ie(e.$slots,"default")]}),_:3},8,["class"])],2)};var Rs=_e("vue-line-wrapper"),Rn={name:"LineWrapper",components:{DraggableElement:pi},props:{position:{type:String,required:!0},disabled:{type:Boolean,default:!1}},computed:{classname:function(){var e;return Rs((ve(e={},this.position,!0),ve(e,"disabled",this.disabled),e))}},emits:["leave","enter","drag","drag-end"]};Rn.render=function(e,t,i,o,s,n){var r=Fe("DraggableElement");return v(),R(r,{class:n.classname,onDrag:t[1]||(t[1]=function(d){return e.$emit("drag",d)}),onDragEnd:t[2]||(t[2]=function(d){return e.$emit("drag-end")}),onLeave:t[3]||(t[3]=function(d){return e.$emit("leave")}),onEnter:t[4]||(t[4]=function(d){return e.$emit("enter")})},{default:C(function(){return[Ie(e.$slots,"default")]}),_:3},8,["class"])};var ze=["left","right","top","bottom"],As=["left","right"],ks=["top","bottom"],Ss=["left","top"],Ms=["fill-area","fit-area","stencil","none"],en={left:0,top:0,width:0,height:0};function tn(e,t,i){return!(i=i||["width","height","left","top"]).some(function(o){return e[o]!==t[o]})}function Re(e){return{left:e.left,top:e.top,right:e.left+e.width,bottom:e.top+e.height}}function it(e,t){return{left:e.left-t.left,top:e.top-t.top}}function se(e){return{left:e.left+e.width/2,top:e.top+e.height/2}}function mt(e,t){var i={left:0,top:0,right:0,bottom:0};return ze.forEach(function(o){var s=t[o],n=Re(e)[o];i[o]=s!==void 0&&n!==void 0?o==="left"||o==="top"?Math.max(0,s-n):Math.max(0,n-s):0}),i}function xe(e,t){return{left:e.left-t.left,top:e.top-t.top,width:e.width+t.left+t.right,height:e.height+t.top+t.bottom}}function Dt(e){return{left:-e.left,top:-e.top}}function he(e,t){return k(k({},e),{left:e.left+t.left,top:e.top+t.top})}function be(e,t,i,o){if(t!==1){if(i){var s=se(e);return{width:e.width*t,height:e.height*t,left:e.left+e.width*(1-t)/2+(i.left-s.left)*(1-t),top:e.top+e.height*(1-t)/2+(i.top-s.top)*(1-t)}}return{width:e.width*t,height:e.height*t,left:e.left+e.width*(1-t)/2,top:e.top+e.height*(1-t)/2}}return e}function j(e){return e.width/e.height}function nt(e,t){return Math.min(t.right!==void 0&&t.left!==void 0?(t.right-t.left)/e.width:1/0,t.bottom!==void 0&&t.top!==void 0?(t.bottom-t.top)/e.height:1/0)}function ot(e,t){var i={left:0,top:0},o=mt(e,t);return o.left&&o.left>0?i.left=o.left:o.right&&o.right>0&&(i.left=-o.right),o.top&&o.top>0?i.top=o.top:o.bottom&&o.bottom>0&&(i.top=-o.bottom),i}function Xt(e,t){var i;return t.minimum&&e<t.minimum?i=t.minimum:t.maximum&&e>t.maximum&&(i=t.maximum),i}function An(e,t){var i=j(e),o=j(t);return t.width<1/0&&t.height<1/0?i>o?{width:t.width,height:t.width/i}:{width:t.height*i,height:t.height}:t.width<1/0?{width:t.width,height:t.width/i}:t.height<1/0?{width:t.height*i,height:t.height}:e}function kn(e,t){var i=t*Math.PI/180;return{width:Math.abs(e.width*Math.cos(i))+Math.abs(e.height*Math.sin(i)),height:Math.abs(e.width*Math.sin(i))+Math.abs(e.height*Math.cos(i))}}function je(e,t){var i=t*Math.PI/180;return{left:e.left*Math.cos(i)-e.top*Math.sin(i),top:e.left*Math.sin(i)+e.top*Math.cos(i)}}function Tt(e,t){var i=mt(ae(e,t),t);return i.left+i.right+i.top+i.bottom?i.left+i.right>i.top+i.bottom?Math.min((e.width+i.left+i.right)/e.width,nt(e,t)):Math.min((e.height+i.top+i.bottom)/e.height,nt(e,t)):1}function ae(e,t,i){i===void 0&&(i=!1);var o=ot(e,t);return he(e,i?Dt(o):o)}function si(e){return{width:e.right!==void 0&&e.left!==void 0?e.right-e.left:1/0,height:e.bottom!==void 0&&e.top!==void 0?e.bottom-e.top:1/0}}function Es(e,t){return k(k({},e),{minWidth:Math.min(t.width,e.minWidth),minHeight:Math.min(t.height,e.minHeight),maxWidth:Math.min(t.width,e.maxWidth),maxHeight:Math.min(t.height,e.maxHeight)})}function Sn(e,t,i){i===void 0&&(i=!0);var o={};return ze.forEach(function(s){var n=e[s],r=t[s];n!==void 0&&r!==void 0?o[s]=s==="left"||s==="top"?i?Math.max(n,r):Math.min(n,r):i?Math.min(n,r):Math.max(n,r):r!==void 0?o[s]=r:n!==void 0&&(o[s]=n)}),o}function Ot(e,t){return Sn(e,t,!0)}function nn(e){var t=e.size,i=e.aspectRatio,o=e.ignoreMinimum,s=e.sizeRestrictions;return!!((t.correctRatio||j(t)>=i.minimum&&j(t)<=i.maximum)&&t.height<=s.maxHeight&&t.width<=s.maxWidth&&t.width&&t.height&&(o||t.height>=s.minHeight&&t.width>=s.minWidth))}function on(e,t){return Math.pow(e.width-t.width,2)+Math.pow(e.height-t.height,2)}function $e(e){var t=e.width,i=e.height,o=e.sizeRestrictions,s={minimum:e.aspectRatio&&e.aspectRatio.minimum||0,maximum:e.aspectRatio&&e.aspectRatio.maximum||1/0},n={width:Math.max(o.minWidth,Math.min(o.maxWidth,t)),height:Math.max(o.minHeight,Math.min(o.maxHeight,i))};function r(h,m){return m===void 0&&(m=!1),h.reduce(function(f,p){return nn({size:p,aspectRatio:s,sizeRestrictions:o,ignoreMinimum:m})&&(!f||on(p,{width:t,height:i})<on(f,{width:t,height:i}))?p:f},null)}var d=[];s&&[s.minimum,s.maximum].forEach(function(h){h&&d.push({width:n.width,height:n.width/h,correctRatio:!0},{width:n.height*h,height:n.height,correctRatio:!0})}),nn({size:n,aspectRatio:s,sizeRestrictions:o})&&d.push(n);var a=r(d)||r(d,!0);return a&&{width:a.width,height:a.height}}function ai(e){var t=e.event,i=e.coordinates,o=e.positionRestrictions,s=o===void 0?{}:o,n=he(i,t.directions);return he(n,ot(n,s))}function $s(e){var t=e.coordinates,i=e.transform,o=e.imageSize,s=e.sizeRestrictions,n=e.positionRestrictions,r=e.aspectRatio,d=e.visibleArea,a=function(m,f){return ai({coordinates:m,positionRestrictions:n,event:new fi({left:f.left-m.left,top:f.top-m.top})})},h=k({},t);return(Array.isArray(i)?i:[i]).forEach(function(m){var f={};te((f=typeof m=="function"?m({coordinates:h,imageSize:o,visibleArea:d}):m).width)&&te(f.height)||(h=function(p,w){var y=k(k(k({},p),$e({width:w.width,height:w.height,sizeRestrictions:s,aspectRatio:r})),{left:0,top:0});return a(y,{left:p.left,top:p.top})}(h,k(k({},h),f))),te(f.left)&&te(f.top)||(h=a(h,k(k({},h),f)))}),h}function Fs(e){e.event;var t=e.getAreaRestrictions,i=e.boundaries,o=e.coordinates,s=e.visibleArea;e.aspectRatio;var n=e.stencilSize,r=e.sizeRestrictions,d=e.positionRestrictions;e.stencilReference;var a,h,m,f=k({},o),p=k({},s),w=k({},n);a=j(w),h=j(f),m===void 0&&(m=.001),(a===0||h===0?Math.abs(h-a)<m:Math.abs(h/a)<1+m&&Math.abs(h/a)>1-m)||(f=k(k({},f),$e({sizeRestrictions:r,width:f.width,height:f.height,aspectRatio:{minimum:j(w),maximum:j(w)}})));var y=Tt(p=be(p,f.width*i.width/(p.width*w.width)),t({visibleArea:p,type:"resize"}));return y!==1&&(p=be(p,y),f=be(f,y)),p=ae(p=he(p,it(se(f),se(p))),t({visibleArea:p,type:"move"})),{coordinates:f=ae(f,Ot(Re(p),d)),visibleArea:p}}function Is(e){var t=e.event,i=e.getAreaRestrictions,o=e.boundaries,s=e.coordinates,n=e.visibleArea;e.aspectRatio,e.stencilSize,e.sizeRestrictions;var r=e.positionRestrictions;e.stencilReference;var d=k({},s),a=k({},n);if(s&&n&&t.type!=="manipulateImage"){var h={width:0,height:0};a.width,o.width,j(o)>j(d)?(h.height=.8*o.height,h.width=h.height*j(d)):(h.width=.8*o.width,h.height=h.width*j(d));var m=Tt(a=be(a,d.width*o.width/(a.width*h.width)),i({visibleArea:a,type:"resize"}));a=be(a,m),m!==1&&(h.height/=m,h.width/=m),a=ae(a=he(a,it(se(d),se(a))),i({visibleArea:a,type:"move"})),d=ae(d,Ot(Re(a),r))}return{coordinates:d,visibleArea:a}}function Ds(e){var t=e.event,i=e.coordinates,o=e.visibleArea,s=e.getAreaRestrictions,n=k({},o),r=k({},i);if(t.type==="setCoordinates"){var d=Math.max(0,r.width-n.width),a=Math.max(0,r.height-n.height);d>a?n=be(n,Math.min(r.width/n.width,nt(n,s({visibleArea:n,type:"resize"})))):a>d&&(n=be(n,Math.min(r.height/n.height,nt(n,s({visibleArea:n,type:"resize"}))))),n=ae(n=he(n,Dt(ot(r,Re(n)))),s({visibleArea:n,type:"move"}))}return{visibleArea:n,coordinates:r}}function Ts(e){var t=e.imageSize,i=e.visibleArea,o=e.coordinates,s=i||t;return{left:(i?i.left:0)+s.width/2-o.width/2,top:(i?i.top:0)+s.height/2-o.height/2}}function Os(e){var t=e.imageSize,i=e.visibleArea,o=e.aspectRatio,s=e.sizeRestrictions,n=i||t,r=Math.min(o.maximum||1/0,Math.max(o.minimum||0,j(n))),d=n.width<n.height?{width:.8*n.width,height:.8*n.width/r}:{height:.8*n.height,width:.8*n.height*r};return $e(k(k({},d),{aspectRatio:o,sizeRestrictions:s}))}function Ls(e){var t,i,o=e.imageSize,s=e.visibleArea,n=e.boundaries,r=e.aspectRatio,d=e.sizeRestrictions,a=e.stencilSize,h=s||o;return j(h)>j(n)?i=(t=a.height*h.height/n.height)*j(a):t=(i=a.width*h.width/n.width)/j(a),$e({width:i,height:t,aspectRatio:r,sizeRestrictions:d})}function Bs(e){var t=e.getAreaRestrictions,i=e.coordinates,o=e.imageSize,s=j(e.boundaries);if(i){var n={height:Math.max(i.height,o.height),width:Math.max(i.width,o.width)},r=An({width:j(n)>s?n.width:n.height*s,height:j(n)>s?n.width/s:n.height},si(t())),d={left:i.left+i.width/2-r.width/2,top:i.top+i.height/2-r.height/2,width:r.width,height:r.height},a=mt(i,Re(k({left:0,top:0},o))),h={};return!a.left&&!a.right&&d.width<=o.width&&(h.left=0,h.right=o.width),!a.top&&!a.bottom&&d.height<=o.height&&(h.top=0,h.bottom=o.height),ae(d,h)}var m=j(o);return r={height:m>s?o.height:o.width/s,width:m>s?o.height*s:o.width},{left:o.width/2-r.width/2,top:o.height/2-r.height/2,width:r.width,height:r.height}}function Rt(e,t){return Sn(e,Re(t))}function Ps(e){var t=e.event,i=e.coordinates,o=e.visibleArea,s=e.sizeRestrictions,n=e.getAreaRestrictions,r=e.positionRestrictions,d=e.adjustStencil,a=t.scale,h=t.move,m=k({},o),f=k({},i),p=1,w=1,y=a.factor&&Math.abs(a.factor-1)>.001;m=he(m,{left:h.left||0,top:h.top||0});var b={stencil:{minimum:Math.max(s.minWidth?s.minWidth/f.width:0,s.minHeight?s.minHeight/f.height:0),maximum:Math.min(s.maxWidth?s.maxWidth/f.width:1/0,s.maxHeight?s.maxHeight/f.height:1/0,nt(f,r))},area:{maximum:nt(m,n({visibleArea:m,type:"resize"}))}};a.factor&&y&&(a.factor<1?(w=Math.max(a.factor,b.stencil.minimum))>1&&(w=1):a.factor>1&&(w=Math.min(a.factor,Math.min(b.area.maximum,b.stencil.maximum)))<1&&(w=1)),w&&(m=be(m,w,a.center));var B=i.left-o.left,H=o.width+o.left-(i.width+i.left),ie=i.top-o.top,Y=o.height+o.top-(i.height+i.top);return m=ae(m=he(m,ot(m,{left:r.left!==void 0?r.left-B*w:void 0,top:r.top!==void 0?r.top-ie*w:void 0,bottom:r.bottom!==void 0?r.bottom+Y*w:void 0,right:r.right!==void 0?r.right+H*w:void 0})),n({visibleArea:m,type:"move"})),f.width=f.width*w,f.height=f.height*w,f.left=m.left+B*w,f.top=m.top+ie*w,f=ae(f,Ot(Re(m),r)),a.factor&&y&&d&&(a.factor>1?p=Math.min(b.area.maximum,a.factor)/w:a.factor<1&&(p=Math.max(f.height/m.height,f.width/m.width,a.factor/w)),p!==1&&(m=he(m=ae(m=be(m,p,a.factor>1?a.center:se(f)),n({visibleArea:m,type:"move"})),Dt(ot(f,Re(m)))))),{coordinates:f,visibleArea:m}}function Ws(e){var t=e.aspectRatio,i=e.getAreaRestrictions,o=e.coordinates,s=e.visibleArea,n=e.sizeRestrictions,r=e.positionRestrictions,d=e.imageSize,a=e.previousImageSize,h=e.angle,m=k({},o),f=k({},s),p=je(se(k({left:0,top:0},a)),h);return(m=k(k({},$e({sizeRestrictions:n,aspectRatio:t,width:m.width,height:m.height})),je(se(m),h))).left-=p.left-d.width/2+m.width/2,m.top-=p.top-d.height/2+m.height/2,f=be(f,Tt(f,i({visibleArea:f,type:"resize"}))),{coordinates:m=ae(m,r),visibleArea:f=ae(f=he(f,it(se(m),se(o))),i({visibleArea:f,type:"move"}))}}function js(e){var t=e.flip,i=e.previousFlip,o=e.rotate,s=e.getAreaRestrictions,n=e.coordinates,r=e.visibleArea,d=e.imageSize,a=k({},n),h=k({},r),m=i.horizontal!==t.horizontal,f=i.vertical!==t.vertical;if(m||f){var p=je({left:d.width/2,top:d.height/2},-o),w=je(se(a),-o),y=je({left:m?p.left-(w.left-p.left):w.left,top:f?p.top-(w.top-p.top):w.top},o);a=he(a,it(y,se(a))),w=je(se(h),-o),h=ae(h=he(h,it(y=je({left:m?p.left-(w.left-p.left):w.left,top:f?p.top-(w.top-p.top):w.top},o),se(h))),s({visibleArea:h,type:"move"}))}return{coordinates:a,visibleArea:h}}function sn(e){var t=e.directions,i=e.coordinates,o=e.positionRestrictions,s=o===void 0?{}:o,n=e.sizeRestrictions,r=e.preserveRatio,d=e.compensate,a=k({},t),h=xe(i,a).width,m=xe(i,a).height;h<0&&(a.left<0&&a.right<0?(a.left=-(i.width-n.minWidth)/(a.left/a.right),a.right=-(i.width-n.minWidth)/(a.right/a.left)):a.left<0?a.left=-(i.width-n.minWidth):a.right<0&&(a.right=-(i.width-n.minWidth))),m<0&&(a.top<0&&a.bottom<0?(a.top=-(i.height-n.minHeight)/(a.top/a.bottom),a.bottom=-(i.height-n.minHeight)/(a.bottom/a.top)):a.top<0?a.top=-(i.height-n.minHeight):a.bottom<0&&(a.bottom=-(i.height-n.minHeight)));var f=mt(xe(i,a),s);d&&(f.left&&f.left>0&&f.right===0?(a.right+=f.left,a.left-=f.left):f.right&&f.right>0&&f.left===0&&(a.left+=f.right,a.right-=f.right),f.top&&f.top>0&&f.bottom===0?(a.bottom+=f.top,a.top-=f.top):f.bottom&&f.bottom>0&&f.top===0&&(a.top+=f.bottom,a.bottom-=f.bottom),f=mt(xe(i,a),s));var p={width:1/0,height:1/0,left:1/0,right:1/0,top:1/0,bottom:1/0};if(ze.forEach(function(b){var B=f[b];B&&a[b]&&(p[b]=Math.max(0,1-B/a[b]))}),r){var w=Math.min.apply(null,ze.map(function(b){return p[b]}));w!==1/0&&ze.forEach(function(b){a[b]*=w})}else ze.forEach(function(b){p[b]!==1/0&&(a[b]*=p[b])});if(h=xe(i,a).width,m=xe(i,a).height,a.right+a.left&&(h>n.maxWidth?p.width=(n.maxWidth-i.width)/(a.right+a.left):h<n.minWidth&&(p.width=(n.minWidth-i.width)/(a.right+a.left))),a.bottom+a.top&&(m>n.maxHeight?p.height=(n.maxHeight-i.height)/(a.bottom+a.top):m<n.minHeight&&(p.height=(n.minHeight-i.height)/(a.bottom+a.top))),r){var y=Math.min(p.width,p.height);y!==1/0&&ze.forEach(function(b){a[b]*=y})}else p.width!==1/0&&As.forEach(function(b){a[b]*=p.width}),p.height!==1/0&&ks.forEach(function(b){a[b]*=p.height});return a}function At(e,t,i){return t==0&&i==0?e/2:t==0?0:i==0?e:e*Math.abs(t/(t+i))}var Vs=_e("vue-simple-handler"),Us=_e("vue-simple-handler-wrapper"),gi={name:"SimpleHandler",components:{HandlerWrapper:Cn},props:{defaultClass:{type:String},hoverClass:{type:String},wrapperClass:{type:String},horizontalPosition:{type:String},verticalPosition:{type:String},disabled:{type:Boolean,default:!1}},data:function(){return{hover:!1}},computed:{classes:function(){var e,t=(ve(e={},this.horizontalPosition,!!this.horizontalPosition),ve(e,this.verticalPosition,!!this.verticalPosition),ve(e,"".concat(this.horizontalPosition,"-").concat(this.verticalPosition),!!(this.verticalPosition&&this.horizontalPosition)),ve(e,"hover",this.hover),e);return{default:K(Vs(t),this.defaultClass,this.hover&&this.hoverClass),wrapper:K(Us(t),this.wrapperClass)}}},methods:{onDrag:function(e){this.$emit("drag",e)},onEnter:function(){this.hover=!0},onLeave:function(){this.hover=!1},onDragEnd:function(){this.$emit("drag-end")}},emits:["drag","drag-end"]};gi.render=function(e,t,i,o,s,n){var r=Fe("HandlerWrapper");return v(),R(r,{class:n.classes.wrapper,"vertical-position":i.verticalPosition,"horizontal-position":i.horizontalPosition,disabled:i.disabled,onDrag:n.onDrag,onDragEnd:n.onDragEnd,onEnter:n.onEnter,onLeave:n.onLeave},{default:C(function(){return[_("div",{class:n.classes.default},null,2)]}),_:1},8,["class","vertical-position","horizontal-position","disabled","onDrag","onDragEnd","onEnter","onLeave"])};var Hs=_e("vue-simple-line"),Ns=_e("vue-simple-line-wrapper"),vi={name:"SimpleLine",components:{LineWrapper:Rn},props:{defaultClass:{type:String},hoverClass:{type:String},wrapperClass:{type:String},position:{type:String},disabled:{type:Boolean,default:!1}},data:function(){return{hover:!1}},computed:{classes:function(){return{root:K(Hs(ve({},this.position,!0)),this.defaultClass,this.hover&&this.hoverClass),wrapper:K(Ns(ve({},this.position,!0)),this.wrapperClass)}}},methods:{onDrag:function(e){this.$emit("drag",e)},onEnter:function(){this.hover=!0},onLeave:function(){this.hover=!1},onDragEnd:function(){this.$emit("drag-end")}},emits:["drag","drag-end"]};vi.render=function(e,t,i,o,s,n){var r=Fe("LineWrapper");return v(),R(r,{class:n.classes.wrapper,position:i.position,disabled:i.disabled,onDrag:n.onDrag,onDragEnd:n.onDragEnd,onEnter:n.onEnter,onLeave:n.onLeave},{default:C(function(){return[_("div",{class:n.classes.root},null,2)]}),_:1},8,["class","position","disabled","onDrag","onDragEnd","onEnter","onLeave"])};var Gt=_e("vue-bounding-box"),qs=["east","west",null],Ys=["south","north",null],Mn={name:"BoundingBox",props:{width:{type:Number},height:{type:Number},transitions:{type:Object},handlers:{type:Object,default:function(){return{eastNorth:!0,north:!0,westNorth:!0,west:!0,westSouth:!0,south:!0,eastSouth:!0,east:!0}}},handlersComponent:{type:[Object,String],default:function(){return gi}},handlersClasses:{type:Object,default:function(){return{}}},handlersWrappersClasses:{type:Object,default:function(){return{}}},lines:{type:Object,default:function(){return{west:!0,north:!0,east:!0,south:!0}}},linesComponent:{type:[Object,String],default:function(){return vi}},linesClasses:{type:Object,default:function(){return{}}},linesWrappersClasses:{type:Object,default:function(){return{}}},resizable:{type:Boolean,default:!0}},data:function(){var e=[];return qs.forEach(function(t){Ys.forEach(function(i){if(t!==i){var o=yn(t,i),s=o.name,n=o.classname;e.push({name:s,classname:n,verticalDirection:i,horizontalDirection:t})}})}),{points:e}},computed:{style:function(){var e={};return this.width&&this.height&&(e.width="".concat(this.width,"px"),e.height="".concat(this.height,"px"),this.transitions&&this.transitions.enabled&&(e.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction))),e},classes:function(){var e=this.handlersClasses,t=this.handlersWrappersClasses,i=this.linesClasses,o=this.linesWrappersClasses;return{root:Gt(),handlers:e,handlersWrappers:t,lines:i,linesWrappers:o}},lineNodes:function(){var e=this,t=[];return this.points.forEach(function(i){i.horizontalDirection&&i.verticalDirection||!e.lines[i.name]||t.push({name:i.name,component:e.linesComponent,class:K(e.classes.lines.default,e.classes.lines[i.name],!e.resizable&&e.classes.lines.disabled),wrapperClass:K(e.classes.linesWrappers.default,e.classes.linesWrappers[i.name],!e.resizable&&e.classes.linesWrappers.disabled),hoverClass:e.classes.lines.hover,verticalDirection:i.verticalDirection,horizontalDirection:i.horizontalDirection,disabled:!e.resizable})}),t},handlerNodes:function(){var e=this,t=[],i=this.width,o=this.height;return this.points.forEach(function(s){if(e.handlers[s.name]){var n={name:s.name,component:e.handlersComponent,class:K(e.classes.handlers.default,e.classes.handlers[s.name]),wrapperClass:K(e.classes.handlersWrappers.default,e.classes.handlersWrappers[s.name]),hoverClass:e.classes.handlers.hover,verticalDirection:s.verticalDirection,horizontalDirection:s.horizontalDirection,disabled:!e.resizable};if(i&&o){var r=s.horizontalDirection,d=s.verticalDirection,a=r==="east"?i:r==="west"?0:i/2,h=d==="south"?o:d==="north"?0:o/2;n.wrapperClass=Gt("handler"),n.wrapperStyle={transform:"translate(".concat(a,"px, ").concat(h,"px)")},e.transitions&&e.transitions.enabled&&(n.wrapperStyle.transition="".concat(e.transitions.time,"ms ").concat(e.transitions.timingFunction))}else n.wrapperClass=Gt("handler",ve({},s.classname,!0));t.push(n)}}),t}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},mounted:function(){this.touches=[]},methods:{onEnd:function(){this.$emit("resize-end")},onHandlerDrag:function(e,t,i){var o,s=e.shift(),n=s.left,r=s.top,d={left:0,right:0,top:0,bottom:0};t==="west"?d.left-=n:t==="east"&&(d.right+=n),i==="north"?d.top-=r:i==="south"&&(d.bottom+=r),!i&&t?o="width":i&&!t&&(o="height"),this.resizable&&this.$emit("resize",new zs(d,{allowedDirections:{left:t==="west"||!t,right:t==="east"||!t,bottom:i==="south"||!i,top:i==="north"||!i},preserveAspectRatio:e.nativeEvent&&e.nativeEvent.shiftKey,respectDirection:o}))}},emits:["resize","resize-end"]};Mn.render=function(e,t,i,o,s,n){return v(),R("div",{ref:"box",class:n.classes.root,style:n.style},[Ie(e.$slots,"default"),_("div",null,[(v(!0),R(Ve,null,Hi(n.lineNodes,function(r){return v(),R(Ce(r.component),{key:r.name,"default-class":r.class,"hover-class":r.hoverClass,"wrapper-class":r.wrapperClass,position:r.name,disabled:r.disabled,onDrag:function(d){return n.onHandlerDrag(d,r.horizontalDirection,r.verticalDirection)},onDragEnd:t[1]||(t[1]=function(d){return n.onEnd()})},null,8,["default-class","hover-class","wrapper-class","position","disabled","onDrag"])}),128))]),(v(!0),R(Ve,null,Hi(n.handlerNodes,function(r){return v(),R("div",{key:r.name,style:r.wrapperStyle,class:r.wrapperClass},[(v(),R(Ce(r.component),{"default-class":r.class,"hover-class":r.hoverClass,"wrapper-class":r.wrapperClass,"horizontal-position":r.horizontalDirection,"vertical-position":r.verticalDirection,disabled:r.disabled,onDrag:function(d){return n.onHandlerDrag(d,r.horizontalDirection,r.verticalDirection)},onDragEnd:t[2]||(t[2]=function(d){return n.onEnd()})},null,8,["default-class","hover-class","wrapper-class","horizontal-position","vertical-position","disabled","onDrag"]))],6)}),128))],6)};var Xs=_e("vue-draggable-area"),En={name:"DraggableArea",props:{movable:{type:Boolean,default:!0},activationDistance:{type:Number,default:20}},computed:{classnames:function(){return{default:Xs()}}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},mounted:function(){this.touches=[],this.touchStarted=!1},methods:{onTouchStart:function(e){if(e.cancelable){var t=this.movable&&e.touches.length===1;t&&(this.touches=Ze(e.touches)),(this.touchStarted||t)&&(e.preventDefault(),e.stopPropagation())}},onTouchEnd:function(){this.touchStarted=!1,this.processEnd()},onTouchMove:function(e){this.touches.length>=1&&(this.touchStarted?(this.processMove(e,e.touches),e.preventDefault(),e.stopPropagation()):zn({x:this.touches[0].clientX,y:this.touches[0].clientY},{x:e.touches[0].clientX,y:e.touches[0].clientY})>this.activationDistance&&(this.initAnchor({clientX:e.touches[0].clientX,clientY:e.touches[0].clientY}),this.touchStarted=!0))},onMouseDown:function(e){if(this.movable&&e.button===0){var t={fake:!0,clientX:e.clientX,clientY:e.clientY};this.touches=[t],this.initAnchor(t),e.stopPropagation()}},onMouseMove:function(e){this.touches.length&&(this.processMove(e,[{fake:!0,clientX:e.clientX,clientY:e.clientY}]),e.preventDefault&&e.cancelable&&e.preventDefault(),e.stopPropagation())},onMouseUp:function(){this.processEnd()},initAnchor:function(e){var t=this.$refs.container.getBoundingClientRect(),i=t.left,o=t.top;this.anchor={x:e.clientX-i,y:e.clientY-o}},processMove:function(e,t){var i=Ze(t);if(this.touches.length){var o=this.$refs.container.getBoundingClientRect(),s=o.left,n=o.top;this.touches.length===1&&i.length===1&&this.$emit("move",new fi({left:i[0].clientX-(s+this.anchor.x),top:i[0].clientY-(n+this.anchor.y)}))}},processEnd:function(){this.touches.length&&this.$emit("move-end"),this.touches=[]}},emits:["move","move-end"]};En.render=function(e,t,i,o,s,n){return v(),R("div",{ref:"container",onTouchstart:t[1]||(t[1]=function(){return n.onTouchStart&&n.onTouchStart.apply(n,arguments)}),onMousedown:t[2]||(t[2]=function(){return n.onMouseDown&&n.onMouseDown.apply(n,arguments)})},[Ie(e.$slots,"default")],544)};function Zt(e){var t,i;return{rotate:e.rotate||0,flip:{horizontal:((t=e==null?void 0:e.flip)===null||t===void 0?void 0:t.horizontal)||!1,vertical:((i=e==null?void 0:e.flip)===null||i===void 0?void 0:i.vertical)||!1}}}function Gs(e){return new Promise(function(t,i){try{if(e)if(/^data:/i.test(e))t(function(a){a=a.replace(/^data:([^;]+);base64,/gim,"");for(var h=atob(a),m=h.length,f=new ArrayBuffer(m),p=new Uint8Array(f),w=0;w<m;w++)p[w]=h.charCodeAt(w);return f}(e));else if(/^blob:/i.test(e)){var o=new FileReader;o.onload=function(a){t(a.target.result)},n=e,r=function(a){o.readAsArrayBuffer(a)},(d=new XMLHttpRequest).open("GET",n,!0),d.responseType="blob",d.onload=function(){this.status!=200&&this.status!==0||r(this.response)},d.send()}else{var s=new XMLHttpRequest;s.onreadystatechange=function(){s.readyState===4&&(s.status===200||s.status===0?t(s.response):i("Warning: could not load an image to parse its orientation"),s=null)},s.onprogress=function(){s.getResponseHeader("content-type")!=="image/jpeg"&&s.abort()},s.withCredentials=!1,s.open("GET",e,!0),s.responseType="arraybuffer",s.send(null)}else i("Error: the image is empty")}catch(a){i(a)}var n,r,d})}function $n(e){var t=e.rotate,i=e.flip,o=e.scaleX,s=e.scaleY,n="";return n+=" rotate("+t+"deg) ",n+=" scaleX("+o*(i.horizontal?-1:1)+") ",n+=" scaleY("+s*(i.vertical?-1:1)+") "}function Zs(e){try{var t,i=new DataView(e),o=void 0,s=void 0,n=void 0,r=void 0;if(i.getUint8(0)===255&&i.getUint8(1)===216)for(var d=i.byteLength,a=2;a+1<d;){if(i.getUint8(a)===255&&i.getUint8(a+1)===225){n=a;break}a++}if(n&&(o=n+10,function(w,y,b){var B,H="";for(B=y,b+=y;B<b;B++)H+=String.fromCharCode(w.getUint8(B));return H}(i,n+4,4)==="Exif")){var h=i.getUint16(o);if(((s=h===18761)||h===19789)&&i.getUint16(o+2,s)===42){var m=i.getUint32(o+4,s);m>=8&&(r=o+m)}}if(r){for(var f=i.getUint16(r,s),p=0;p<f;p++)if(a=r+12*p+2,i.getUint16(a,s)===274){a+=8,t=i.getUint16(a,s),i.setUint16(a,1,s);break}}return t}catch{return null}}function an(e,t){var i=t.getBoundingClientRect(),o=i.left,s=i.top,n={left:0,top:0},r=0;return e.forEach(function(d){n.left+=(d.clientX-o)/e.length,n.top+=(d.clientY-s)/e.length}),e.forEach(function(d){r+=zn({x:n.left,y:n.top},{x:d.clientX-o,y:d.clientY-s})}),{centerMass:n,spread:r,count:e.length}}var Fn={props:{touchMove:{type:Boolean,required:!0},mouseMove:{type:Boolean,required:!0},touchResize:{type:Boolean,required:!0},wheelResize:{type:[Boolean,Object],required:!0},eventsFilter:{type:Function,required:!1}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},created:function(){this.transforming=!1,this.debouncedProcessEnd=ni(this.processEnd),this.touches=[]},methods:{processMove:function(e,t){if(this.touches.length){if(this.touches.length===1&&t.length===1)this.$emit("move",new ht({left:this.touches[0].clientX-t[0].clientX,top:this.touches[0].clientY-t[0].clientY}));else if(this.touches.length>1&&this.touchResize){var i=an(t,this.$refs.container),o=this.oldGeometricProperties;o.count===i.count&&o.count>1&&this.$emit("resize",new ht({left:o.centerMass.left-i.centerMass.left,top:o.centerMass.top-i.centerMass.top},{factor:o.spread/i.spread,center:i.centerMass})),this.oldGeometricProperties=i}this.touches=t}},processEnd:function(){this.transforming&&(this.transforming=!1,this.$emit("transform-end"))},processStart:function(){this.transforming=!0,this.debouncedProcessEnd.clear()},processEvent:function(e){return this.eventsFilter?this.eventsFilter(e,this.transforming)!==!1:(e.preventDefault(),e.stopPropagation(),!0)},onTouchStart:function(e){if(e.cancelable&&(this.touchMove||this.touchResize&&e.touches.length>1)&&this.processEvent(e)){var t=this.$refs.container,i=t.getBoundingClientRect(),o=i.left,s=i.top,n=i.bottom,r=i.right;this.touches=Ze(e.touches).filter(function(d){return d.clientX>o&&d.clientX<r&&d.clientY>s&&d.clientY<n}),this.oldGeometricProperties=an(this.touches,t)}},onTouchEnd:function(e){e.touches.length===0&&(this.touches=[],this.processEnd())},onTouchMove:function(e){var t=this;if(this.touches.length){var i=Ze(e.touches).filter(function(o){return!o.identifier||t.touches.find(function(s){return s.identifier===o.identifier})});this.processEvent(e)&&(this.processMove(e,i),this.processStart())}},onMouseDown:function(e){if(this.mouseMove&&"buttons"in e&&e.buttons===1&&this.processEvent(e)){var t={fake:!0,clientX:e.clientX,clientY:e.clientY};this.touches=[t],this.processStart()}},onMouseMove:function(e){this.touches.length&&this.processEvent(e)&&this.processMove(e,[{clientX:e.clientX,clientY:e.clientY}])},onMouseUp:function(){this.touches=[],this.processEnd()},onWheel:function(e){if(this.wheelResize&&this.processEvent(e)){var t=this.$refs.container.getBoundingClientRect(),i=t.left,o=t.top,s=1+this.wheelResize.ratio*(r=e.deltaY||e.detail||e.wheelDelta,(d=+r)==0||xn(d)?d:d>0?1:-1),n={left:e.clientX-i,top:e.clientY-o};this.$emit("resize",new ht({},{factor:s,center:n})),this.touches.length||this.debouncedProcessEnd()}var r,d}},emits:["resize","move","transform-end"]};Fn.render=function(e,t,i,o,s,n){return v(),R("div",{ref:"container",onTouchstart:t[1]||(t[1]=function(){return n.onTouchStart&&n.onTouchStart.apply(n,arguments)}),onMousedown:t[2]||(t[2]=function(){return n.onMouseDown&&n.onMouseDown.apply(n,arguments)}),onWheel:t[3]||(t[3]=function(){return n.onWheel&&n.onWheel.apply(n,arguments)})},[Ie(e.$slots,"default")],544)};var ri={components:{TransformableImage:Fn},props:{touchMove:{type:Boolean,required:!0},mouseMove:{type:Boolean,required:!0},touchResize:{type:Boolean,required:!0},wheelResize:{type:[Boolean,Object],required:!0}},emits:["resize","move"]};ri.render=function(e,t,i,o,s,n){var r=Fe("transformable-image");return v(),R(r,{"touch-move":i.touchMove,"touch-resize":i.touchResize,"mouse-move":i.mouseMove,"wheel-resize":i.wheelResize,onMove:t[1]||(t[1]=function(d){return e.$emit("move",d)}),onResize:t[2]||(t[2]=function(d){return e.$emit("resize",d)})},{default:C(function(){return[Ie(e.$slots,"default")]}),_:3},8,["touch-move","touch-resize","mouse-move","wheel-resize"])};var kt=_e("vue-preview"),In={props:{coordinates:{type:Object},transitions:{type:Object},image:{type:Object,default:function(){return{}}},imageClass:{type:String},width:{type:Number},height:{type:Number},fill:{type:Boolean}},data:function(){return{calculatedImageSize:{width:0,height:0},calculatedSize:{width:0,height:0}}},computed:{classes:function(){return{root:kt({fill:this.fill}),wrapper:kt("wrapper"),imageWrapper:kt("image-wrapper"),image:K(kt("image"),this.imageClass)}},style:function(){if(this.fill)return{};var e={};return this.width&&(e.width="".concat(this.size.width,"px")),this.height&&(e.height="".concat(this.size.height,"px")),this.transitions&&this.transitions.enabled&&(e.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),e},wrapperStyle:function(){var e={width:"".concat(this.size.width,"px"),height:"".concat(this.size.height,"px"),left:"calc(50% - ".concat(this.size.width/2,"px)"),top:"calc(50% - ".concat(this.size.height/2,"px)")};return this.transitions&&this.transitions.enabled&&(e.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),e},imageStyle:function(){if(this.coordinates&&this.image){var e=this.coordinates.width/this.size.width,t=P(P({rotate:0,flip:{horizontal:!1,vertical:!1}},this.image.transforms),{},{scaleX:1/e,scaleY:1/e}),i=this.imageSize.width,o=this.imageSize.height,s=kn({width:i,height:o},t.rotate),n={width:"".concat(i,"px"),height:"".concat(o,"px"),left:"0px",top:"0px"},r={rotate:{left:(i-s.width)*t.scaleX/2,top:(o-s.height)*t.scaleY/2},scale:{left:(1-t.scaleX)*i/2,top:(1-t.scaleY)*o/2}};return n.transform=`translate(
				`.concat(-this.coordinates.left/e-r.rotate.left-r.scale.left,"px,").concat(-this.coordinates.top/e-r.rotate.top-r.scale.top,"px) ")+$n(t),this.transitions&&this.transitions.enabled&&(n.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),n}return{}},size:function(){return{width:this.width||this.calculatedSize.width,height:this.height||this.calculatedSize.height}},imageSize:function(){return{width:this.image.width||this.calculatedImageSize.width,height:this.image.height||this.calculatedImageSize.height}}},watch:{image:function(e){(e.width||e.height)&&this.onChangeImage()}},mounted:function(){var e=this;this.onChangeImage(),this.$refs.image.addEventListener("load",function(){e.refreshImage()}),window.addEventListener("resize",this.refresh),window.addEventListener("orientationchange",this.refresh)},unmounted:function(){window.removeEventListener("resize",this.refresh),window.removeEventListener("orientationchange",this.refresh)},methods:{refreshImage:function(){var e=this.$refs.image;this.calculatedImageSize.height=e.naturalHeight,this.calculatedImageSize.width=e.naturalWidth},refresh:function(){var e=this.$refs.root;this.width||(this.calculatedSize.width=e.clientWidth),this.height||(this.calculatedSize.height=e.clientHeight)},onChangeImage:function(){var e=this.$refs.image;e&&e.complete&&this.refreshImage(),this.refresh()}}};In.render=function(e,t,i,o,s,n){return v(),R("div",{ref:"root",class:n.classes.root,style:n.style},[_("div",{ref:"wrapper",class:n.classes.wrapper,style:n.wrapperStyle},[Ge(_("img",{ref:"image",src:i.image&&i.image.src,class:n.classes.image,style:n.imageStyle},null,14,["src"]),[[rn,i.image&&i.image.src]])],6)],6)};var Dn={components:{Preview:In},inheritAttrs:!1};Dn.render=function(e,t,i,o,s,n){var r=Fe("preview");return v(),R(r,$t(e.$attrs,{fill:!0}),null,16)};var Qt=_e("vue-rectangle-stencil"),Tn={name:"RectangleStencil",components:{StencilPreview:Dn,BoundingBox:Mn,DraggableArea:En},props:{image:{type:Object},coordinates:{type:Object},stencilCoordinates:{type:Object},handlers:{type:Object},handlersComponent:{type:[Object,String],default:function(){return gi}},lines:{type:Object},linesComponent:{type:[Object,String],default:function(){return vi}},aspectRatio:{type:[Number,String]},minAspectRatio:{type:[Number,String]},maxAspectRatio:{type:[Number,String]},movable:{type:Boolean,default:!0},resizable:{type:Boolean,default:!0},transitions:{type:Object},movingClass:{type:String},resizingClass:{type:String},previewClass:{type:String},boundingBoxClass:{type:String},linesClasses:{type:Object,default:function(){return{}}},linesWrappersClasses:{type:Object,default:function(){return{}}},handlersClasses:{type:Object,default:function(){return{}}},handlersWrappersClasses:{type:Object,default:function(){return{}}}},data:function(){return{moving:!1,resizing:!1}},computed:{classes:function(){return{stencil:K(Qt({movable:this.movable,moving:this.moving,resizing:this.resizing}),this.moving&&this.movingClass,this.resizing&&this.resizingClass),preview:K(Qt("preview"),this.previewClass),boundingBox:K(Qt("bounding-box"),this.boundingBoxClass)}},style:function(){var e=this.stencilCoordinates,t=e.height,i=e.width,o=e.left,s=e.top,n={width:"".concat(i,"px"),height:"".concat(t,"px"),transform:"translate(".concat(o,"px, ").concat(s,"px)")};return this.transitions&&this.transitions.enabled&&(n.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),n}},methods:{onMove:function(e){this.$emit("move",e),this.moving=!0},onMoveEnd:function(){this.$emit("move-end"),this.moving=!1},onResize:function(e){this.$emit("resize",e),this.resizing=!0},onResizeEnd:function(){this.$emit("resize-end"),this.resizing=!1},aspectRatios:function(){return{minimum:this.aspectRatio||this.minAspectRatio,maximum:this.aspectRatio||this.maxAspectRatio}}},emits:["resize","resize-end","move","move-end"]};Tn.render=function(e,t,i,o,s,n){var r=Fe("stencil-preview"),d=Fe("draggable-area"),a=Fe("bounding-box");return v(),R("div",{class:n.classes.stencil,style:n.style},[_(a,{width:i.stencilCoordinates.width,height:i.stencilCoordinates.height,transitions:i.transitions,class:n.classes.boundingBox,handlers:i.handlers,"handlers-component":i.handlersComponent,"handlers-classes":i.handlersClasses,"handlers-wrappers-classes":i.handlersWrappersClasses,lines:i.lines,"lines-component":i.linesComponent,"lines-classes":i.linesClasses,"lines-wrappers-classes":i.linesWrappersClasses,resizable:i.resizable,onResize:n.onResize,onResizeEnd:n.onResizeEnd},{default:C(function(){return[_(d,{movable:i.movable,onMove:n.onMove,onMoveEnd:n.onMoveEnd},{default:C(function(){return[_(r,{image:i.image,coordinates:i.coordinates,width:i.stencilCoordinates.width,height:i.stencilCoordinates.height,class:n.classes.preview,transitions:i.transitions},null,8,["image","coordinates","width","height","class","transitions"])]}),_:1},8,["movable","onMove","onMoveEnd"])]}),_:1},8,["width","height","transitions","class","handlers","handlers-component","handlers-classes","handlers-wrappers-classes","lines","lines-component","lines-classes","lines-wrappers-classes","resizable","onResize","onResizeEnd"])],6)};var Qs=["transitions"],Me=_e("vue-advanced-cropper"),On={name:"Cropper",components:{BackgroundWrapper:ri},props:{src:{type:String,default:null},stencilComponent:{type:[Object,String],default:function(){return Tn}},backgroundWrapperComponent:{type:[Object,String],default:function(){return ri}},stencilProps:{type:Object,default:function(){return{}}},autoZoom:{type:Boolean,default:!1},imageClass:{type:String},boundariesClass:{type:String},backgroundClass:{type:String},foregroundClass:{type:String},minWidth:{type:[Number,String]},minHeight:{type:[Number,String]},maxWidth:{type:[Number,String]},maxHeight:{type:[Number,String]},debounce:{type:[Boolean,Number],default:500},transitions:{type:Boolean,default:!0},checkOrientation:{type:Boolean,default:!0},canvas:{type:[Object,Boolean],default:!0},crossOrigin:{type:[Boolean,String],default:void 0},transitionTime:{type:Number,default:300},imageRestriction:{type:String,default:"fit-area",validator:function(e){return Ms.indexOf(e)!==-1}},roundResult:{type:Boolean,default:!0},defaultSize:{type:[Function,Object]},defaultPosition:{type:[Function,Object]},defaultVisibleArea:{type:[Function,Object]},defaultTransforms:{type:[Function,Object]},defaultBoundaries:{type:[Function,String],validator:function(e){return!(typeof e=="string"&&e!=="fill"&&e!=="fit")}},priority:{type:String,default:"coordinates"},stencilSize:{type:[Object,Function]},resizeImage:{type:[Boolean,Object],default:!0},moveImage:{type:[Boolean,Object],default:!0},autoZoomAlgorithm:{type:Function},resizeAlgorithm:{type:Function,default:function(e){var t=e.event,i=e.coordinates,o=e.aspectRatio,s=e.positionRestrictions,n=e.sizeRestrictions,r=k(k({},i),{right:i.left+i.width,bottom:i.top+i.height}),d=t.params||{},a=k({},t.directions),h=d.allowedDirections||{left:!0,right:!0,bottom:!0,top:!0};n.widthFrozen&&(a.left=0,a.right=0),n.heightFrozen&&(a.top=0,a.bottom=0),ze.forEach(function(me){h[me]||(a[me]=0)});var m=xe(r,a=sn({coordinates:r,directions:a,sizeRestrictions:n,positionRestrictions:s})).width,f=xe(r,a).height,p=d.preserveRatio?j(r):Xt(m/f,o);if(p){var w=d.respectDirection;if(w||(w=r.width>=r.height||p===1?"width":"height"),w==="width"){var y=m/p-r.height;if(h.top&&h.bottom){var b=a.top,B=a.bottom;a.bottom=At(y,B,b),a.top=At(y,b,B)}else h.bottom?a.bottom=y:h.top?a.top=y:h.right?a.right=0:h.left&&(a.left=0)}else if(w==="height"){var H=r.width-f*p;if(h.left&&h.right){var ie=a.left,Y=a.right;a.left=-At(H,ie,Y),a.right=-At(H,Y,ie)}else h.left?a.left=-H:h.right?a.right=-H:h.top?a.top=0:h.bottom&&(a.bottom=0)}a=sn({directions:a,coordinates:r,sizeRestrictions:n,positionRestrictions:s,preserveRatio:!0,compensate:d.compensate})}return m=xe(r,a).width,f=xe(r,a).height,(p=d.preserveRatio?j(r):Xt(m/f,o))&&Math.abs(p-m/f)>.001&&ze.forEach(function(me){h[me]||(a[me]=0)}),ai({event:new fi({left:-a.left,top:-a.top}),coordinates:{width:i.width+a.right+a.left,height:i.height+a.top+a.bottom,left:i.left,top:i.top},positionRestrictions:s})}},moveAlgorithm:{type:Function,default:ai},initStretcher:{type:Function,default:function(e){var t=e.stretcher,i=e.imageSize,o=j(i);t.style.width=i.width+"px",t.style.height=t.clientWidth/o+"px",t.style.width=t.clientWidth+"px"}},fitCoordinates:{type:Function,default:function(e){var t=e.visibleArea,i=e.coordinates,o=e.aspectRatio,s=e.sizeRestrictions,n=e.positionRestrictions,r=k(k({},i),$e({width:i.width,height:i.height,aspectRatio:o,sizeRestrictions:{maxWidth:t.width,maxHeight:t.height,minHeight:Math.min(t.height,s.minHeight),minWidth:Math.min(t.width,s.minWidth)}}));return r=ae(r=he(r,it(se(i),se(r))),Ot(Re(t),n))}},fitVisibleArea:{type:Function,default:function(e){var t=e.visibleArea,i=e.boundaries,o=e.getAreaRestrictions,s=e.coordinates,n=k({},t);n.height=n.width/j(i),n.top+=(t.height-n.height)/2,(s.height-n.height>0||s.width-n.width>0)&&(n=be(n,Math.max(s.height/n.height,s.width/n.width)));var r=Dt(ot(s,Re(n=be(n,Tt(n,o({visibleArea:n,type:"resize"}))))));return n.width<s.width&&(r.left=0),n.height<s.height&&(r.top=0),n=ae(n=he(n,r),o({visibleArea:n,type:"move"}))}},areaRestrictionsAlgorithm:{type:Function,default:function(e){var t=e.visibleArea,i=e.boundaries,o=e.imageSize,s=e.imageRestriction,n=e.type,r={};return s==="fill-area"?r={left:0,top:0,right:o.width,bottom:o.height}:s==="fit-area"&&(j(i)>j(o)?(r={top:0,bottom:o.height},t&&n==="move"&&(t.width>o.width?(r.left=-(t.width-o.width)/2,r.right=o.width-r.left):(r.left=0,r.right=o.width))):(r={left:0,right:o.width},t&&n==="move"&&(t.height>o.height?(r.top=-(t.height-o.height)/2,r.bottom=o.height-r.top):(r.top=0,r.bottom=o.height)))),r}},sizeRestrictionsAlgorithm:{type:Function,default:function(e){return{minWidth:e.minWidth,minHeight:e.minHeight,maxWidth:e.maxWidth,maxHeight:e.maxHeight}}},positionRestrictionsAlgorithm:{type:Function,default:function(e){var t=e.imageSize,i={};return e.imageRestriction!=="none"&&(i={left:0,top:0,right:t.width,bottom:t.height}),i}}},data:function(){return{transitionsActive:!1,imageLoaded:!1,imageAttributes:{width:null,height:null,crossOrigin:null,src:null},defaultImageTransforms:{rotate:0,flip:{horizontal:!1,vertical:!1}},appliedImageTransforms:{rotate:0,flip:{horizontal:!1,vertical:!1}},boundaries:{width:0,height:0},visibleArea:null,coordinates:P({},en)}},computed:{image:function(){return{src:this.imageAttributes.src,width:this.imageAttributes.width,height:this.imageAttributes.height,transforms:this.imageTransforms}},imageTransforms:function(){return{rotate:this.appliedImageTransforms.rotate,flip:{horizontal:this.appliedImageTransforms.flip.horizontal,vertical:this.appliedImageTransforms.flip.vertical},translateX:this.visibleArea?this.visibleArea.left/this.coefficient:0,translateY:this.visibleArea?this.visibleArea.top/this.coefficient:0,scaleX:1/this.coefficient,scaleY:1/this.coefficient}},imageSize:function(){var e=function(t){return t*Math.PI/180}(this.imageTransforms.rotate);return{width:Math.abs(this.imageAttributes.width*Math.cos(e))+Math.abs(this.imageAttributes.height*Math.sin(e)),height:Math.abs(this.imageAttributes.width*Math.sin(e))+Math.abs(this.imageAttributes.height*Math.cos(e))}},initialized:function(){return!!(this.visibleArea&&this.imageLoaded)},settings:function(){var e=oi(this.resizeImage,{touch:!0,wheel:{ratio:.1},adjustStencil:!0},{touch:!1,wheel:!1,adjustStencil:!1});return{moveImage:oi(this.moveImage,{touch:!0,mouse:!0},{touch:!1,mouse:!1}),resizeImage:e}},coefficient:function(){return this.visibleArea?this.visibleArea.width/this.boundaries.width:0},areaRestrictions:function(){return this.imageLoaded?this.areaRestrictionsAlgorithm({imageSize:this.imageSize,imageRestriction:this.imageRestriction,boundaries:this.boundaries}):{}},transitionsOptions:function(){return{enabled:this.transitionsActive,timingFunction:"ease-in-out",time:350}},sizeRestrictions:function(){if(this.boundaries.width&&this.boundaries.height&&this.imageSize.width&&this.imageSize.height){var e=this.sizeRestrictionsAlgorithm({imageSize:this.imageSize,minWidth:te(this.minWidth)?0:Ct(this.minWidth),minHeight:te(this.minHeight)?0:Ct(this.minHeight),maxWidth:te(this.maxWidth)?1/0:Ct(this.maxWidth),maxHeight:te(this.maxHeight)?1/0:Ct(this.maxHeight)});if(e=function(o){var s=o.areaRestrictions,n=o.sizeRestrictions,r=o.boundaries,d=o.positionRestrictions,a=k(k({},n),{minWidth:n.minWidth!==void 0?n.minWidth:0,minHeight:n.minHeight!==void 0?n.minHeight:0,maxWidth:n.maxWidth!==void 0?n.maxWidth:1/0,maxHeight:n.maxHeight!==void 0?n.maxHeight:1/0});d.left!==void 0&&d.right!==void 0&&(a.maxWidth=Math.min(a.maxWidth,d.right-d.left)),d.bottom!==void 0&&d.top!==void 0&&(a.maxHeight=Math.min(a.maxHeight,d.bottom-d.top));var h=si(s),m=An(r,h);return h.width<1/0&&(!a.maxWidth||a.maxWidth>m.width)&&(a.maxWidth=Math.min(a.maxWidth,m.width)),h.height<1/0&&(!a.maxHeight||a.maxHeight>m.height)&&(a.maxHeight=Math.min(a.maxHeight,m.height)),a.minWidth>a.maxWidth&&(a.minWidth=a.maxWidth,a.widthFrozen=!0),a.minHeight>a.maxHeight&&(a.minHeight=a.maxHeight,a.heightFrozen=!0),a}({sizeRestrictions:e,areaRestrictions:this.getAreaRestrictions({visibleArea:this.visibleArea,type:"resize"}),imageSize:this.imageSize,boundaries:this.boundaries,positionRestrictions:this.positionRestrictions,imageRestriction:this.imageRestriction,visibleArea:this.visibleArea,stencilSize:this.getStencilSize()}),this.visibleArea&&this.stencilSize){var t=this.getStencilSize(),i=si(this.getAreaRestrictions({visibleArea:this.visibleArea,type:"resize"}));e.maxWidth=Math.min(e.maxWidth,i.width*t.width/this.boundaries.width),e.maxHeight=Math.min(e.maxHeight,i.height*t.height/this.boundaries.height),e.maxWidth<e.minWidth&&(e.minWidth=e.maxWidth),e.maxHeight<e.minHeight&&(e.minHeight=e.maxHeight)}return e}return{minWidth:0,minHeight:0,maxWidth:0,maxHeight:0}},positionRestrictions:function(){return this.positionRestrictionsAlgorithm({imageSize:this.imageSize,imageRestriction:this.imageRestriction})},classes:function(){return{cropper:Me(),image:K(Me("image"),this.imageClass),stencil:Me("stencil"),boundaries:K(Me("boundaries"),this.boundariesClass),stretcher:K(Me("stretcher")),background:K(Me("background"),this.backgroundClass),foreground:K(Me("foreground"),this.foregroundClass),imageWrapper:K(Me("image-wrapper")),cropperWrapper:K(Me("cropper-wrapper"))}},stencilCoordinates:function(){if(this.initialized){var e=this.coordinates,t=e.width,i=e.height,o=e.left,s=e.top;return{width:t/this.coefficient,height:i/this.coefficient,left:(o-this.visibleArea.left)/this.coefficient,top:(s-this.visibleArea.top)/this.coefficient}}return this.defaultCoordinates()},boundariesStyle:function(){var e={width:this.boundaries.width?"".concat(Math.round(this.boundaries.width),"px"):"auto",height:this.boundaries.height?"".concat(Math.round(this.boundaries.height),"px"):"auto",transition:"opacity ".concat(this.transitionTime,"ms"),pointerEvents:this.imageLoaded?"all":"none"};return this.imageLoaded||(e.opacity="0"),e},imageStyle:function(){var e=this.imageAttributes.width>this.imageAttributes.height?{width:Math.min(1024,this.imageAttributes.width),height:Math.min(1024,this.imageAttributes.width)/(this.imageAttributes.width/this.imageAttributes.height)}:{height:Math.min(1024,this.imageAttributes.height),width:Math.min(1024,this.imageAttributes.height)*(this.imageAttributes.width/this.imageAttributes.height)},t={left:(e.width-this.imageSize.width)/(2*this.coefficient),top:(e.height-this.imageSize.height)/(2*this.coefficient)},i={left:(1-1/this.coefficient)*e.width/2,top:(1-1/this.coefficient)*e.height/2},o=P(P({},this.imageTransforms),{},{scaleX:this.imageTransforms.scaleX*(this.imageAttributes.width/e.width),scaleY:this.imageTransforms.scaleY*(this.imageAttributes.height/e.height)}),s={width:"".concat(e.width,"px"),height:"".concat(e.height,"px"),left:"0px",top:"0px",transform:"translate(".concat(-t.left-i.left-this.imageTransforms.translateX,"px, ").concat(-t.top-i.top-this.imageTransforms.translateY,"px)")+$n(o)};return this.transitionsOptions.enabled&&(s.transition="".concat(this.transitionsOptions.time,"ms ").concat(this.transitionsOptions.timingFunction)),s}},watch:{src:function(){this.onChangeImage()},stencilComponent:function(){var e=this;this.$nextTick(function(){e.resetCoordinates(),e.runAutoZoom("setCoordinates"),e.onChange()})},minWidth:function(){this.onPropsChange()},maxWidth:function(){this.onPropsChange()},minHeight:function(){this.onPropsChange()},maxHeight:function(){this.onPropsChange()},imageRestriction:function(){this.reset()},stencilProps:function(e,t){["aspectRatio","minAspectRatio","maxAspectRatio"].find(function(i){return e[i]!==t[i]})&&this.$nextTick(this.onPropsChange)}},created:function(){this.debouncedUpdate=ni(this.update,this.debounce),this.debouncedDisableTransitions=ni(this.disableTransitions,this.transitionsOptions.time),this.awaiting=!1},mounted:function(){this.$refs.image.addEventListener("load",this.onSuccessLoadImage),this.$refs.image.addEventListener("error",this.onFailLoadImage),this.onChangeImage(),window.addEventListener("resize",this.refresh),window.addEventListener("orientationchange",this.refresh)},unmounted:function(){window.removeEventListener("resize",this.refresh),window.removeEventListener("orientationchange",this.refresh),this.imageAttributes.revoke&&this.imageAttributes.src&&URL.revokeObjectURL(this.imageAttributes.src),this.debouncedUpdate.clear(),this.debouncedDisableTransitions.clear()},methods:{getResult:function(){var e=this.initialized?this.prepareResult(P({},this.coordinates)):this.defaultCoordinates(),t={rotate:this.imageTransforms.rotate%360,flip:P({},this.imageTransforms.flip)};if(this.src&&this.imageLoaded){var i=this;return{image:this.image,coordinates:e,visibleArea:this.visibleArea?P({},this.visibleArea):null,imageTransforms:t,get canvas(){return i.canvas?i.getCanvas():void 0}}}return{image:this.image,coordinates:e,visibleArea:this.visibleArea?P({},this.visibleArea):null,canvas:void 0,imageTransforms:t}},zoom:function(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=i.transitions,s=o===void 0||o;this.onManipulateImage(new ht({},{factor:1/e,center:t}),{normalize:!1,transitions:s})},move:function(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=i.transitions,s=o===void 0||o;this.onManipulateImage(new ht({left:e||0,top:t||0}),{normalize:!1,transitions:s})},setCoordinates:function(e){var t=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=i.autoZoom,s=o===void 0||o,n=i.transitions,r=n===void 0||n;this.$nextTick(function(){t.imageLoaded?(t.transitionsActive||(r&&t.enableTransitions(),t.coordinates=t.applyTransform(e),s&&t.runAutoZoom("setCoordinates"),r&&t.debouncedDisableTransitions()),t.onChange()):t.delayedTransforms=e})},refresh:function(){var e=this,t=this.$refs.image;if(this.src&&t)return this.initialized?this.updateVisibleArea().then(function(){e.onChange()}):this.resetVisibleArea().then(function(){e.onChange()})},reset:function(){var e=this;return this.resetVisibleArea().then(function(){e.onChange(!1)})},awaitRender:function(e){var t=this;this.awaiting||(this.awaiting=!0,this.$nextTick(function(){e(),t.awaiting=!1}))},prepareResult:function(e){return this.roundResult?function(t){var i=t.coordinates,o=t.sizeRestrictions,s=t.positionRestrictions,n={width:Math.round(i.width),height:Math.round(i.height),left:Math.round(i.left),top:Math.round(i.top)};return n.width>o.maxWidth?n.width=Math.floor(i.width):n.width<o.minWidth&&(n.width=Math.ceil(i.width)),n.height>o.maxHeight?n.height=Math.floor(i.height):n.height<o.minHeight&&(n.height=Math.ceil(i.height)),ae(n,s)}(P(P({},this.getPublicProperties()),{},{positionRestrictions:Rt(this.positionRestrictions,this.visibleArea),coordinates:e})):e},processAutoZoom:function(e,t,i,o){var s=this.autoZoomAlgorithm;s||(s=this.stencilSize?Fs:this.autoZoom?Is:Ds);var n=s({event:{type:e,params:o},visibleArea:t,coordinates:i,boundaries:this.boundaries,aspectRatio:this.getAspectRatio(),positionRestrictions:this.positionRestrictions,getAreaRestrictions:this.getAreaRestrictions,sizeRestrictions:this.sizeRestrictions,stencilSize:this.getStencilSize()});return P(P({},n),{},{changed:!tn(n.visibleArea,t)||!tn(n.coordinates,i)})},runAutoZoom:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=t.transitions,o=i!==void 0&&i,s=_s(t,Qs),n=this.processAutoZoom(e,this.visibleArea,this.coordinates,s),r=n.visibleArea,d=n.coordinates,a=n.changed;o&&a&&this.enableTransitions(),this.visibleArea=r,this.coordinates=d,o&&a&&this.debouncedDisableTransitions()},normalizeEvent:function(e){return function(t){var i=t.event,o=t.visibleArea,s=t.coefficient;if(i.type==="manipulateImage")return k(k({},i),{move:{left:i.move&&i.move.left?s*i.move.left:0,top:i.move&&i.move.top?s*i.move.top:0},scale:{factor:i.scale&&i.scale.factor?i.scale.factor:1,center:i.scale&&i.scale.center?{left:i.scale.center.left*s+o.left,top:i.scale.center.top*s+o.top}:null}});if(i.type==="resize"){var n=k(k({},i),{directions:k({},i.directions)});return ze.forEach(function(d){n.directions[d]*=s}),n}if(i.type==="move"){var r=k(k({},i),{directions:k({},i.directions)});return Ss.forEach(function(d){r.directions[d]*=s}),r}return i}(P(P({},this.getPublicProperties()),{},{event:e}))},getCanvas:function(){if(this.$refs.canvas){var e=this.$refs.canvas,t=this.$refs.image,i=this.imageTransforms.rotate!==0||this.imageTransforms.flip.horizontal||this.imageTransforms.flip.vertical?function(d,a,h){var m=h.rotate,f=h.flip,p={width:a.naturalWidth,height:a.naturalHeight},w=kn(p,m),y=d.getContext("2d");d.height=w.height,d.width=w.width,y.save();var b=je(se(k({left:0,top:0},p)),m);return y.translate(-(b.left-w.width/2),-(b.top-w.height/2)),y.rotate(m*Math.PI/180),y.translate(f.horizontal?p.width:0,f.vertical?p.height:0),y.scale(f.horizontal?-1:1,f.vertical?-1:1),y.drawImage(a,0,0,p.width,p.height),y.restore(),d}(this.$refs.sourceCanvas,t,this.imageTransforms):t,o=P({minWidth:0,minHeight:0,maxWidth:1/0,maxHeight:1/0,maxArea:this.maxCanvasSize,imageSmoothingEnabled:!0,imageSmoothingQuality:"high",fillColor:"transparent"},this.canvas),s=function(d){return d.find(function(a){return h=a,!Number.isNaN(parseFloat(h))&&isFinite(h);var h})},n=$e({sizeRestrictions:{minWidth:s([o.width,o.minWidth])||0,minHeight:s([o.height,o.minHeight])||0,maxWidth:s([o.width,o.maxWidth])||1/0,maxHeight:s([o.height,o.maxHeight])||1/0},width:this.coordinates.width,height:this.coordinates.height,aspectRatio:{minimum:this.coordinates.width/this.coordinates.height,maximum:this.coordinates.width/this.coordinates.height}});if(o.maxArea&&n.width*n.height>o.maxArea){var r=Math.sqrt(o.maxArea/(n.width*n.height));n={width:Math.round(r*n.width),height:Math.round(r*n.height)}}return function(d,a,h,m,f){d.width=m?m.width:h.width,d.height=m?m.height:h.height;var p=d.getContext("2d");p.clearRect(0,0,d.width,d.height),f&&(f.imageSmoothingEnabled&&(p.imageSmoothingEnabled=f.imageSmoothingEnabled),f.imageSmoothingQuality&&(p.imageSmoothingQuality=f.imageSmoothingQuality),f.fillColor&&(p.fillStyle=f.fillColor,p.fillRect(0,0,d.width,d.height),p.save()));var w=h.left<0?-h.left:0,y=h.top<0?-h.top:0;p.drawImage(a,h.left+w,h.top+y,h.width,h.height,w,y,d.width,d.height)}(e,i,this.coordinates,n,o),e}},update:function(){this.$emit("change",this.getResult())},applyTransform:function(e){var t=arguments.length>1&&arguments[1]!==void 0&&arguments[1],i=this.visibleArea&&t?Es(this.sizeRestrictions,this.visibleArea):this.sizeRestrictions,o=this.visibleArea&&t?Rt(this.positionRestrictions,this.visibleArea):this.positionRestrictions;return $s({transform:e,coordinates:this.coordinates,imageSize:this.imageSize,sizeRestrictions:i,positionRestrictions:o,aspectRatio:this.getAspectRatio(),visibleArea:this.visibleArea})},resetCoordinates:function(){var e=this;if(this.$refs.image){this.$refs.cropper,this.$refs.image;var t=this.defaultSize;t||(t=this.stencilSize?Ls:Os);var i=this.sizeRestrictions;i.minWidth,i.minHeight,i.maxWidth,i.maxHeight;var o=Je(t)?t({boundaries:this.boundaries,imageSize:this.imageSize,aspectRatio:this.getAspectRatio(),sizeRestrictions:this.sizeRestrictions,stencilSize:this.getStencilSize(),visibleArea:this.visibleArea}):t,s=this.defaultPosition||Ts,n=[o,function(r){var d=r.coordinates;return P({},Je(s)?s({coordinates:d,imageSize:e.imageSize,visibleArea:e.visibleArea}):e.defaultPosition)}];this.delayedTransforms&&n.push.apply(n,Ze(Array.isArray(this.delayedTransforms)?this.delayedTransforms:[this.delayedTransforms])),this.coordinates=this.applyTransform(n,!0),this.delayedTransforms=null}},clearImage:function(){var e=this;this.imageLoaded=!1,setTimeout(function(){var t=e.$refs.stretcher;t&&(t.style.height="auto",t.style.width="auto"),e.coordinates=e.defaultCoordinates(),e.boundaries={width:0,height:0}},this.transitionTime)},enableTransitions:function(){this.transitions&&(this.transitionsActive=!0)},disableTransitions:function(){this.transitionsActive=!1},updateBoundaries:function(){var e=this,t=this.$refs.stretcher,i=this.$refs.cropper;return this.initStretcher({cropper:i,stretcher:t,imageSize:this.imageSize}),this.$nextTick().then(function(){var o={cropper:i,imageSize:e.imageSize};if(Je(e.defaultBoundaries)?e.boundaries=e.defaultBoundaries(o):e.defaultBoundaries==="fit"?e.boundaries=function(s){var n=s.cropper,r=s.imageSize,d=n.clientHeight,a=n.clientWidth,h=d,m=r.width*d/r.height;return m>a&&(m=a,h=r.height*a/r.width),{width:m,height:h}}(o):e.boundaries=function(s){var n=s.cropper;return{width:n.clientWidth,height:n.clientHeight}}(o),!e.boundaries.width||!e.boundaries.height)throw new Error("It's impossible to fit the cropper in the current container")})},resetVisibleArea:function(){var e=this;return this.appliedImageTransforms=P(P({},this.defaultImageTransforms),{},{flip:P({},this.defaultImageTransforms.flip)}),this.updateBoundaries().then(function(){e.priority!=="visible-area"&&(e.visibleArea=null,e.resetCoordinates());var t,i,o,s,n,r,d=e.defaultVisibleArea||Bs;e.visibleArea=Je(d)?d({imageSize:e.imageSize,boundaries:e.boundaries,coordinates:e.priority!=="visible-area"?e.coordinates:null,getAreaRestrictions:e.getAreaRestrictions,stencilSize:e.getStencilSize()}):e.defaultVisibleArea,e.visibleArea=(t={visibleArea:e.visibleArea,boundaries:e.boundaries,getAreaRestrictions:e.getAreaRestrictions},i=t.visibleArea,o=t.boundaries,s=t.getAreaRestrictions,n=k({},i),r=j(o),n.width/n.height!==r&&(n.height=n.width/r),ae(n,s({visibleArea:n,type:"move"}))),e.priority==="visible-area"?e.resetCoordinates():e.coordinates=e.fitCoordinates({visibleArea:e.visibleArea,coordinates:e.coordinates,aspectRatio:e.getAspectRatio(),positionRestrictions:e.positionRestrictions,sizeRestrictions:e.sizeRestrictions}),e.runAutoZoom("resetVisibleArea")}).catch(function(){e.visibleArea=null})},updateVisibleArea:function(){var e=this;return this.updateBoundaries().then(function(){e.visibleArea=e.fitVisibleArea({imageSize:e.imageSize,boundaries:e.boundaries,visibleArea:e.visibleArea,coordinates:e.coordinates,getAreaRestrictions:e.getAreaRestrictions}),e.coordinates=e.fitCoordinates({visibleArea:e.visibleArea,coordinates:e.coordinates,aspectRatio:e.getAspectRatio(),positionRestrictions:e.positionRestrictions,sizeRestrictions:e.sizeRestrictions}),e.runAutoZoom("updateVisibleArea")}).catch(function(){e.visibleArea=null})},onChange:function(){var e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];e&&this.debounce?this.debouncedUpdate():this.update()},onChangeImage:function(){var e,t=this;if(this.imageLoaded=!1,this.delayedTransforms=null,this.src){if(function(s){if(Ki(s))return!1;var n=window.location,r=/(\w+:)?(?:\/\/)([\w.-]+)?(?::(\d+))?\/?/.exec(s)||[],d={protocol:r[1]||"",host:r[2]||"",port:r[3]||""},a=function(h){return h.port||((h.protocol||n.protocol)==="http"?80:433)};return!(!d.protocol&&!d.host&&!d.port||d.protocol&&d.protocol==n.protocol&&d.host&&d.host==n.host&&d.host&&a(d)==a(n))}(this.src)){var i=te(this.crossOrigin)?this.canvas:this.crossOrigin;i===!0&&(i="anonymous"),this.imageAttributes.crossOrigin=i||null}if(this.checkOrientation){var o=(e=this.src,new Promise(function(s){Gs(e).then(function(n){var r=Zs(n);s(n?{source:e,arrayBuffer:n,orientation:r}:{source:e,arrayBuffer:null,orientation:null})}).catch(function(n){console.warn(n),s({source:e,arrayBuffer:null,orientation:null})})}));setTimeout(function(){o.then(t.onParseImage)},this.transitionTime)}else setTimeout(function(){t.onParseImage({source:t.src})},this.transitionTime)}else this.clearImage()},onFailLoadImage:function(){this.imageAttributes.src&&(this.clearImage(),this.$emit("error"))},onSuccessLoadImage:function(){var e=this,t=this.$refs.image;t&&!this.imageLoaded&&(this.imageAttributes.height=t.naturalHeight,this.imageAttributes.width=t.naturalWidth,this.imageLoaded=!0,this.resetVisibleArea().then(function(){e.$emit("ready"),e.onChange(!1)}))},onParseImage:function(e){var t=this,i=e.source,o=e.arrayBuffer,s=e.orientation;this.imageAttributes.revoke&&this.imageAttributes.src&&URL.revokeObjectURL(this.imageAttributes.src),this.imageAttributes.revoke=!1,o&&s&&s>1?_n(i)||!Ki(i)?(this.imageAttributes.src=URL.createObjectURL(new Blob([o])),this.imageAttributes.revoke=!0):this.imageAttributes.src=function(n){for(var r=[],d=new Uint8Array(n);d.length>0;){var a=d.subarray(0,8192);r.push(String.fromCharCode.apply(null,Array.from?Array.from(a):a.slice())),d=d.subarray(8192)}return"data:image/jpeg;base64,"+btoa(r.join(""))}(o):this.imageAttributes.src=i,Je(this.defaultTransforms)?this.appliedImageTransforms=Zt(this.defaultTransforms()):Et(this.defaultTransforms)?this.appliedImageTransforms=Zt(this.defaultTransforms):this.appliedImageTransforms=function(n){var r=Zt({});if(n)switch(n){case 2:r.flip.horizontal=!0;break;case 3:r.rotate=-180;break;case 4:r.flip.vertical=!0;break;case 5:r.rotate=90,r.flip.vertical=!0;break;case 6:r.rotate=90;break;case 7:r.rotate=90,r.flip.horizontal=!0;break;case 8:r.rotate=-90}return r}(s),this.defaultImageTransforms=P(P({},this.appliedImageTransforms),{},{flip:P({},this.appliedImageTransforms.flip)}),this.$nextTick(function(){var n=t.$refs.image;n&&n.complete&&(function(r){return!!r.naturalWidth}(n)?t.onSuccessLoadImage():t.onFailLoadImage())})},onResizeEnd:function(){this.runAutoZoom("resize",{transitions:!0})},onMoveEnd:function(){this.runAutoZoom("move",{transitions:!0})},onMove:function(e){var t=this;this.transitionsOptions.enabled||this.awaitRender(function(){t.coordinates=t.moveAlgorithm(P(P({},t.getPublicProperties()),{},{positionRestrictions:Rt(t.positionRestrictions,t.visibleArea),coordinates:t.coordinates,event:t.normalizeEvent(e)})),t.onChange()})},onResize:function(e){var t=this;this.transitionsOptions.enabled||this.stencilSize&&!this.autoZoom||this.awaitRender(function(){var i=t.sizeRestrictions,o=Math.min(t.coordinates.width,t.coordinates.height,20*t.coefficient);t.coordinates=t.resizeAlgorithm(P(P({},t.getPublicProperties()),{},{positionRestrictions:Rt(t.positionRestrictions,t.visibleArea),sizeRestrictions:{maxWidth:Math.min(i.maxWidth,t.visibleArea.width),maxHeight:Math.min(i.maxHeight,t.visibleArea.height),minWidth:Math.max(i.minWidth,o),minHeight:Math.max(i.minHeight,o)},event:t.normalizeEvent(e)})),t.onChange(),t.ticking=!1})},onManipulateImage:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.transitionsOptions.enabled){var i=t.transitions,o=i!==void 0&&i,s=t.normalize,n=s===void 0||s;o&&this.enableTransitions();var r=Ps(P(P({},this.getPublicProperties()),{},{event:n?this.normalizeEvent(e):e,getAreaRestrictions:this.getAreaRestrictions,imageRestriction:this.imageRestriction,adjustStencil:!this.stencilSize&&this.settings.resizeImage.adjustStencil})),d=r.visibleArea,a=r.coordinates;this.visibleArea=d,this.coordinates=a,this.runAutoZoom("manipulateImage"),this.onChange(),o&&this.debouncedDisableTransitions()}},onPropsChange:function(){this.coordinates=this.applyTransform(this.coordinates,!0),this.onChange(!1)},getAreaRestrictions:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.visibleArea,i=e.type,o=i===void 0?"move":i;return this.areaRestrictionsAlgorithm({boundaries:this.boundaries,imageSize:this.imageSize,imageRestriction:this.imageRestriction,visibleArea:t,type:o})},getAspectRatio:function(e){var t,i,o=this.stencilProps,s=o.aspectRatio,n=o.minAspectRatio,r=o.maxAspectRatio;if(this.$refs.stencil&&this.$refs.stencil.aspectRatios){var d=this.$refs.stencil.aspectRatios();t=d.minimum,i=d.maximum}if(te(t)&&(t=te(s)?n:s),te(i)&&(i=te(s)?r:s),!e&&(te(t)||te(i))){var a=this.getStencilSize(),h=a?j(a):null;te(t)&&(t=Ji(h)?h:void 0),te(i)&&(i=Ji(h)?h:void 0)}return{minimum:t,maximum:i}},getStencilSize:function(){if(this.stencilSize)return e={currentStencilSize:{width:this.stencilCoordinates.width,height:this.stencilCoordinates.height},stencilSize:this.stencilSize,boundaries:this.boundaries,coefficient:this.coefficient,coordinates:this.coordinates,aspectRatio:this.getAspectRatio(!0)},t=e.boundaries,i=e.stencilSize,o=e.aspectRatio,Xt(j(s=Je(i)?i({boundaries:t,aspectRatio:o}):i),o)&&(s=$e({sizeRestrictions:{maxWidth:t.width,maxHeight:t.height,minWidth:0,minHeight:0},width:s.width,height:s.height,aspectRatio:{minimum:o.minimum,maximum:o.maximum}})),(s.width>t.width||s.height>t.height)&&(s=$e({sizeRestrictions:{maxWidth:t.width,maxHeight:t.height,minWidth:0,minHeight:0},width:s.width,height:s.height,aspectRatio:{minimum:j(s),maximum:j(s)}})),s;var e,t,i,o,s},getPublicProperties:function(){return{coefficient:this.coefficient,visibleArea:this.visibleArea,coordinates:this.coordinates,boundaries:this.boundaries,sizeRestrictions:this.sizeRestrictions,positionRestrictions:this.positionRestrictions,aspectRatio:this.getAspectRatio(),imageRestriction:this.imageRestriction}},defaultCoordinates:function(){return P({},en)},flip:function(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=i.transitions,s=o===void 0||o;if(!this.transitionsActive){s&&this.enableTransitions();var n=P({},this.imageTransforms.flip),r=js({flip:{horizontal:e?!n.horizontal:n.horizontal,vertical:t?!n.vertical:n.vertical},previousFlip:n,rotate:this.imageTransforms.rotate,visibleArea:this.visibleArea,coordinates:this.coordinates,imageSize:this.imageSize,positionRestrictions:this.positionRestrictions,sizeRestrictions:this.sizeRestrictions,getAreaRestrictions:this.getAreaRestrictions,aspectRatio:this.getAspectRatio()}),d=r.visibleArea,a=r.coordinates;e&&(this.appliedImageTransforms.flip.horizontal=!this.appliedImageTransforms.flip.horizontal),t&&(this.appliedImageTransforms.flip.vertical=!this.appliedImageTransforms.flip.vertical),this.visibleArea=d,this.coordinates=a,this.onChange(),s&&this.debouncedDisableTransitions()}},rotate:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=t.transitions,o=i===void 0||i;if(!this.transitionsActive){o&&this.enableTransitions();var s=P({},this.imageSize);this.appliedImageTransforms.rotate+=e;var n=Ws({visibleArea:this.visibleArea,coordinates:this.coordinates,previousImageSize:s,imageSize:this.imageSize,angle:e,positionRestrictions:this.positionRestrictions,sizeRestrictions:this.sizeRestrictions,getAreaRestrictions:this.getAreaRestrictions,aspectRatio:this.getAspectRatio()}),r=n.visibleArea,d=n.coordinates,a=this.processAutoZoom("rotateImage",r,d);r=a.visibleArea,d=a.coordinates,this.visibleArea=r,this.coordinates=d,this.onChange(),o&&this.debouncedDisableTransitions()}}},emits:["change","error","ready"]},Ks={key:0,ref:"canvas",style:{display:"none"}},Js={key:1,ref:"sourceCanvas",style:{display:"none"}};On.render=function(e,t,i,o,s,n){return v(),R("div",{ref:"cropper",class:n.classes.cropper},[_("div",{ref:"stretcher",class:n.classes.stretcher},null,2),_("div",{class:n.classes.boundaries,style:n.boundariesStyle},[(v(),R(Ce(i.backgroundWrapperComponent),{class:n.classes.cropperWrapper,"wheel-resize":n.settings.resizeImage.wheel,"touch-resize":n.settings.resizeImage.touch,"touch-move":n.settings.moveImage.touch,"mouse-move":n.settings.moveImage.mouse,onMove:n.onManipulateImage,onResize:n.onManipulateImage},{default:C(function(){return[_("div",{class:n.classes.background,style:n.boundariesStyle},null,6),_("div",{class:n.classes.imageWrapper},[_("img",{ref:"image",crossorigin:s.imageAttributes.crossOrigin,src:s.imageAttributes.src,class:n.classes.image,style:n.imageStyle,onMousedown:t[1]||(t[1]=ue(function(){},["prevent"]))},null,46,["crossorigin","src"])],2),_("div",{class:n.classes.foreground,style:n.boundariesStyle},null,6),Ge((v(),R(Ce(i.stencilComponent),$t({ref:"stencil",image:n.image,coordinates:s.coordinates,"stencil-coordinates":n.stencilCoordinates,transitions:n.transitionsOptions},i.stencilProps,{onResize:n.onResize,onResizeEnd:n.onResizeEnd,onMove:n.onMove,onMoveEnd:n.onMoveEnd}),null,16,["image","coordinates","stencil-coordinates","transitions","onResize","onResizeEnd","onMove","onMoveEnd"])),[[rn,s.imageLoaded]]),i.canvas?(v(),R("canvas",Ks,null,512)):D("",!0),i.canvas?(v(),R("canvas",Js,null,512)):D("",!0)]}),_:1},8,["class","wheel-resize","touch-resize","touch-move","mouse-move","onMove","onResize"]))],6)],2)};const ea={class:"nc-image-cropper-wrapper relative"},ta={key:0,class:"result_preview"},ia=["src"],na={class:"flex justify-between items-center space-x-4 mt-4"},oa={class:"flex items-center space-x-4"},sa={class:"flex items-center space-x-4"},aa=It({__name:"ImageCropper",props:{imageConfig:{},cropperConfig:{},uploadConfig:{},showCropper:{type:Boolean}},emits:["update:showCropper","submit"],setup(e,{emit:t}){const i=yo(e,["imageConfig","cropperConfig","uploadConfig"]),o=t,s=ln(i,"showCropper",o),{api:n,isLoading:r}=_o(),d=L(),a=L({canvas:{},src:""}),h=()=>{const{canvas:p}=d.value.getResult();a.value={canvas:p,src:p.toDataURL()}},m=async p=>{var w,y;if((w=e.uploadConfig)!=null&&w.path)try{const b=await n.storage.uploadByUrl({path:(y=e.uploadConfig)==null?void 0:y.path},p);b!=null&&b[0]?o("submit",{...b[0],data:p[0].data}):o("submit",p[0])}catch(b){console.error(b),et.error(await ci(b))}else o("submit",p[0]);s.value=!1},f=async()=>{a.value.canvas&&a.value.canvas.toBlob(async p=>{await m([{title:e.imageConfig.name,fileName:e.imageConfig.name,mimetype:e.imageConfig.type,size:p.size,url:a.value.src,data:a.value.src}])},e.imageConfig.type)};return Xe(s,()=>{s.value||(a.value={canvas:{},src:""})}),(p,w)=>{const y=li,b=cn,B=Go;return v(),R(B,{visible:l(s),"onUpdate:visible":w[1]||(w[1]=H=>Ue(s)?s.value=H:null),"mask-closable":!1},{default:C(()=>{var H,ie,Y,me;return[g("div",ea,[_(l(On),{ref_key:"cropperRef",ref:d,class:"nc-cropper relative",src:p.imageConfig.src,"auto-zoom":!0,"stencil-props":((H=p.cropperConfig)==null?void 0:H.stencilProps)||{},"min-height":(ie=p.cropperConfig)==null?void 0:ie.minHeight,"min-width":(Y=p.cropperConfig)==null?void 0:Y.minWidth,"image-restriction":(me=p.cropperConfig)==null?void 0:me.imageRestriction},null,8,["src","stencil-props","min-height","min-width","image-restriction"]),l(a).src?(v(),W("div",ta,[g("img",{src:l(a).src,alt:"Preview Image"},null,8,ia)])):D("",!0)]),g("div",na,[g("div",oa,[_(y,{type:"secondary",size:"small",disabled:l(r),onClick:w[0]||(w[0]=Oe=>s.value=!1)},{default:C(()=>w[2]||(w[2]=[oe(" Cancel ")])),_:1},8,["disabled"])]),g("div",sa,[_(y,{type:"secondary",size:"small",disabled:l(r),onClick:h},{default:C(()=>[_(b,{icon:"crop"}),w[3]||(w[3]=g("span",{class:"ml-2"},"Crop",-1))]),_:1},8,["disabled"]),_(y,{size:"small",loading:l(r),disabled:!l(a).src,onClick:f},{default:C(()=>w[4]||(w[4]=[oe(" Save ")])),_:1},8,["loading","disabled"])])])]}),_:1},8,["visible"])}}}),ra=di(aa,[["__scopeId","data-v-bec7f64d"]]);const la={class:"nc-column-insert-before nc-form-header-menu-item"},ca={class:"nc-column-delete nc-form-header-menu-item text-red-600"},da=It({__name:"FieldMenu",props:{column:{},formColumn:{},isRequired:{type:Boolean},isOpen:{type:Boolean},onDelete:{type:Function}},emits:["hideField","update:isOpen","delete"],setup(e,{emit:t}){const i=e,o=t,{column:s,isRequired:n}=xo(i),r=ln(i,"isOpen",o),{eventBus:d}=is(),a=Ee(dn),h=Ee(un,L()),m=Ee(hn,L()),f=Ee(mn);Kt(zo,s);const{$api:p}=mi(),{t:w}=ui(),{getMeta:y}=hi(),b=L(!1),B=L(!1),H=L(),ie=L(),Y=async()=>{var U;let E={};const V=ns(`${s.value.title} copy`,h.value.columns);E={...s.value,...s.value.colOptions??{},title:V,column_name:V.replace(/\s/g,"_"),id:void 0,colOptions:void 0,order:void 0,system:!1};try{const S=(await p.dbViewColumn.list((U=m.value)==null?void 0:U.id)).list,Z=S.findIndex(G=>G.fk_column_id===s.value.id);let ge;Z===S.length-1?ge=S[Z].order+1:ge=(S[Z].order+S[Z+1].order)/2,await p.dbTableColumn.create(h.value.id,{...E,pv:!1,view_id:m.value.id,column_order:{order:ge,view_id:m.value.id}}),await y(h.value.id,!0),d.emit(Co.FIELD_RELOAD),a==null||a.trigger()}catch(S){et.error(await ci(S))}r.value=!1},me=async()=>{var E;if(s!=null&&s.value)if(s.value.uidt&&[N.Lookup,N.Rollup,N.CreatedTime,N.LastModifiedTime,N.CreatedBy,N.LastModifiedBy].includes(s.value.uidt))Y();else{const V=(await p.dbViewColumn.list((E=m.value)==null?void 0:E.id)).list,U=V.findIndex(Z=>Z.fk_column_id===s.value.id);let S;U===V.length-1?S=V[U].order+1:S=(V[U].order+V[U+1].order)/2,H.value={pv:!1,view_id:m.value.id,column_order:{order:S,view_id:m.value.id}},s.value.uidt===N.Formula?St(()=>{var Z;(Z=ie==null?void 0:ie.value)==null||Z.duplicate()}):B.value=!0,r.value=!1}},Oe=async()=>{n.value||(r.value=!1,o("hideField"))},x=()=>{r.value=!1,b.value=!0},st=de(()=>(s==null?void 0:s.value)&&!s.value.system),X=de(()=>(s==null?void 0:s.value)&&!s.value.system);return(E,V)=>{const U=li,S=Ko,Z=vn,ge=Jo,G=fn,I=es,T=ts;return v(),W(Ve,null,[l(f)?D("",!0):(v(),R(G,{key:0,visible:l(r),"onUpdate:visible":V[1]||(V[1]=O=>Ue(r)?r.value=O:null),trigger:["click"],placement:"bottomLeft","overlay-class-name":"nc-dropdown-form-column-operations !border-1 rounded-lg !shadow-xl",onClick:V[2]||(V[2]=ue(O=>r.value=!l(r),["stop"]))},{overlay:C(()=>[_(ge,{class:"flex flex-col gap-1 border-gray-200 nc-column-options"},{default:C(()=>{var O;return[D("",!0),_(S,{disabled:l(n),onClick:Oe},{default:C(()=>[g("div",la,[(v(),R(Ce(("iconMap"in E?E.iconMap:l(tt)).eye),{class:"!w-3.75 !h-3.75"})),oe(" "+M(E.$t("general.hideField")),1)])]),_:1},8,["disabled"]),(O=l(s))!=null&&O.pv?D("",!0):(v(),W(Ve,{key:1},[_(Z,{class:"!my-0"}),_(S,{disabled:!st.value,class:"!hover:bg-red-50",onClick:x},{default:C(()=>[g("div",ca,[(v(),R(Ce(("iconMap"in E?E.iconMap:l(tt)).delete))),oe(" "+M(E.$t("general.delete")),1)])]),_:1},8,["disabled"])],64))]}),_:1})]),default:C(()=>[_(U,{type:"secondary",size:"small",class:"nc-form-add-field","data-testid":"nc-form-add-field",onClick:V[0]||(V[0]=ue(O=>E.showAddColumnDropdown=!0,["stop"]))},{default:C(()=>[(v(),R(Ce(("iconMap"in E?E.iconMap:l(tt)).threeDotVertical),{class:"flex-none w-4 h-4"}))]),_:1})]),_:1},8,["visible"])),_(I,{visible:l(b),"onUpdate:visible":V[3]||(V[3]=O=>Ue(b)?b.value=O:null),class:"nc-form-column-delete-dropdown","on-delete-column":E.onDelete},null,8,["visible","on-delete-column"]),l(s)?(v(),R(T,{key:1,ref_key:"duplicateDialogRef",ref:ie,modelValue:l(B),"onUpdate:modelValue":V[4]||(V[4]=O=>Ue(B)?B.value=O:null),column:l(s),extra:l(H)},null,8,["modelValue","column","extra"])):D("",!0)],64)}}}),ua=di(da,[["__scopeId","data-v-4aab5ffe"]]),ha=It({__name:"Layout",setup(e){const{leftSidebarWidth:t,windowSize:i,formRightSidebarState:o,formRightSidebarWidthPercent:s}=Jt(as()),n=de(()=>100-s.value);function r(a){const h=a*(i.value-t.value)/100;h>o.value.maxWidth?o.value.width=o.value.maxWidth:h<o.value.minWidth?o.value.width=o.value.minWidth:o.value.width=h}const d=de(()=>o.value.width>o.value.maxWidth?o.value.maxWidth:o.value.width<o.value.minWidth?o.value.minWidth:o.value.width);return(a,h)=>(v(),R(l(bn),{class:"nc-form-right-sidebar-content-resizable-wrapper w-full h-full",onResize:h[0]||(h[0]=m=>r(m[1].size))},{default:C(()=>[_(l(Ft),{size:l(n),class:"flex-1 h-full"},{default:C(()=>[Ie(a.$slots,"preview")]),_:3},8,["size"]),_(l(Ft),{"min-size":"15%",class:"nc-sidebar-splitpane relative",size:l(s),style:ei({minWidth:`${l(o).minWidth}px !important`,maxWidth:`${l(d)}px !important`})},{default:C(()=>[Ie(a.$slots,"sidebar")]),_:3},8,["size","style"])]),_:3}))}}),ma=wn.useForm,[fa,pa]=cs((e,t,i,o,s)=>{const{$api:n}=mi(),{t:r}=ui(),{isMysql:d}=pn(),{getMeta:a}=hi(),h=gn(),m=L({}),f=L({}),p=L(""),w=L([]),y=de(()=>w.value.reduce((I,T)=>(I[T.fk_column_id]=T,I),{})),b=de(()=>new Xi({nestedGroupedFilters:m.value,formViewColumns:w.value,formViewColumnsMapByFkColumnId:y.value,formState:f.value,isMysql:d,getMeta:a})),B=de(()=>w.value.filter(I=>I.show).sort((I,T)=>(I.order??1/0)-(T.order??1/0))),H=de(()=>B.value.find(I=>I.id===p.value)||null),ie=de(()=>{var I;if(e.value&&H.value){if(e.value.columnsById&&e.value.columnsById[(I=H.value)==null?void 0:I.fk_column_id])return e.value.columnsById[H.value.fk_column_id];if(e.value.columns)return e.value.columns.find(T=>{var O;return T.id===((O=H.value)==null?void 0:O.fk_column_id)})??null}return null}),Y=de(()=>{const I=new Set;return B.value.reduce((T,O)=>(T[O.title]=ds(O.title,I),T),{})}),me=de(()=>{const I={};if(!B.value||!Object.keys(Y.value).length)return I;for(const T of B.value){let O=[{validator:(Ae,ke)=>new Promise((Lt,Bt)=>Z(T,T.required)&&T.visible&&(typeof ke=="string"&&(ke=ke.trim()),T.uidt===N.Checkbox&&!ke||T.uidt!==N.Checkbox&&!hs(ke))?Bt(r("msg.error.fieldRequired")):Lt())},{validator:Ae=>new Promise(ke=>(G(),ke()))}];const we=us(We(T.meta).validators??[],T);O=[...O,...we],O.length&&(I[Y.value[T.title]]=O)}return I}),Oe=de(()=>Object.keys(Y.value).length?Object.keys(f.value).reduce((I,T)=>(I[Y.value[T]]=f.value[T],I),{}):{}),{validate:x,validateInfos:st,clearValidate:X}=ma(Oe,me),E=async I=>{if(I.title){if(Y.value[I.title]===void 0){console.warn("Missing mapping field for:",I.title);return}try{await x(Y.value[I.title])}catch{}}},V=()=>{var T,O,we;if(typeof((T=i.value)==null?void 0:T.redirect_url)!="string")return{validateStatus:"",help:void 0};const I=((we=(O=i.value)==null?void 0:O.redirect_url)==null?void 0:we.trim())??"";return!I.startsWith("http://")&&!I.startsWith("https://")?{validateStatus:"error",help:"Redirect url must starts with `http://` or `https://`"}:{validateStatus:"",help:void 0}},U=ti(()=>{V().validateStatus==="error"&&(i.value={...i.value,redirect_url:""}),o(i.value)},300,{maxWait:2e3}),S=ti(async I=>{if(I.id&&s){E(I);try{await n.dbView.formColumnUpdate(I.id,I)}catch(T){et.error(await ci(T))}}},250);function Z(I,T=!1){var we;let O=I;return Mt(O.uidt)&&O.colOptions&&O.colOptions.type===ut.BELONGS_TO&&(O=(((we=e==null?void 0:e.value)==null?void 0:we.columns)||[]).find(Ae=>Ae.id===O.colOptions.fk_child_column_id)),T||O&&O.rqd&&!O.cdf}const ge=async()=>{var I;if((I=t.value)!=null&&I.id)try{const T=(await n.dbTableFilter.read(t.value.id,{includeAllFilters:!0})).list||[];if(!T.length)return;const we=new Xi({data:T}).getNestedGroupedFilters();m.value={...we}}catch(T){console.error("Error loading view filters:",T)}};async function G(){await b.value.validateVisibility()}return{onReset:h.on,formState:f,localColumns:w,visibleColumns:B,activeRow:p,activeField:H,activeColumn:ie,isRequired:Z,updateView:U,updateColMeta:S,validate:x,validateInfos:st,clearValidate:X,fieldMappings:Y,isValidRedirectUrl:V,formViewData:i,loadAllviewFilters:ge,allViewFilters:m,localColumnsMapByFkColumnId:y,checkFieldVisibility:G}},"form-view-store");function jl(){const e=pa();if(e==null)throw new Error("Please call `useProvideFormViewStore` on the appropriate parent component");return e}const ga=De(()=>Te(()=>import("./B2_HDijx.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]),import.meta.url).then(e=>e.default||e)),va=De(()=>Te(()=>import("./BVHyv0aP.js"),__vite__mapDeps([16,1,2]),import.meta.url).then(e=>e.default||e)),ba=De(()=>Te(()=>import("./BIhr-Z4C.js"),__vite__mapDeps([17,1,2,18,13,19]),import.meta.url).then(e=>e.default||e)),wa=De(()=>Te(()=>import("./DG2ZH8TR.js"),__vite__mapDeps([20,1,2,21,22,23,18,24,25,13,26]),import.meta.url).then(e=>e.default||e)),ya=De(()=>Te(()=>import("./B9n4-CGo.js"),__vite__mapDeps([27,1,2,28]),import.meta.url).then(e=>e.default||e)),_a=De(()=>Te(()=>import("./Bs2dQa0Z.js"),__vite__mapDeps([29,1,2]),import.meta.url).then(e=>e.default||e)),xa=De(()=>Te(()=>import("./T8gL-mZl.js"),__vite__mapDeps([30,31,1,2,32,33,34,35,5,6,7,8,9,10,11,36,18,37,13,38,39,40,41,42,43,44,45,46,47,48,49,25,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,22,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81]),import.meta.url).then(e=>e.default||e)),za=De(()=>Te(()=>import("./DV-O7oV5.js"),__vite__mapDeps([82,1,2,83,84,85,86,87,39,70,55,43,7,56,9,8,71,88,36,18,37,13,66,22,89,90,91,92,62,63,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,25,110,111,67,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,46,47,5,6,10,11,79,60,131,132,133,134,76,33,135,136,32,68,78,137,138,139,140,141,142,143,40,41,42,44,21,23,24,144]),import.meta.url).then(e=>e.default||e)),Ca=De(()=>Te(()=>import("./DZZ6t_j4.js").then(e=>e.jv),__vite__mapDeps([1,2]),import.meta.url).then(e=>e.default||e)),Ra={class:"h-full relative"},Aa={key:0,class:"pl-6 pr-[120px] py-6 bg-white flex-col justify-start items-start gap-2.5 inline-flex"},ka={class:"text-gray-500 text-5xl font-semibold leading-16"},Sa={class:"text-gray-500 text-base font-medium leading-normal"},Ma={class:"max-w-[max(33%,688px)] mx-auto"},Ea={class:"transition-all duration-300 ease-in relative my-6 bg-white rounded-3xl border-1 border-gray-200 px-4 py-8 lg:p-12 md:p-8 md:dark:bg-slate-700"},$a={key:0,class:"items-center justify-center text-left mt-2"},Fa={class:"text-2xl font-bold text-gray-900 mb-4"},Ia={key:0},Da={class:"flex justify-center"},Ta={class:"w-full"},Oa={key:1},La={class:"mt-16 w-full flex justify-between items-center gap-3"},Ba={key:0,class:"text-gray-400"},Pa={key:1,class:"flex-1 flex justify-end"},Wa={key:1,class:"nc-form-wrapper h-full w-full flex relative","data-testid":"nc-form-wrapper"},ja={key:0,class:"flex-1 flex items-center justify-center text-center h-full"},Va={class:"mt-2"},Ua={class:"min-w-[616px] overflow-x-auto nc-form-scrollbar"},Ha={key:1,class:"group relative max-w-[max(33%,688px)] mx-auto"};const Na={class:"flex flex-col px-4 lg:px-6"};const qa={key:1,class:"font-bold text-2xl text-gray-900"},Ya=["data-title","onClick"],Xa={key:0,class:"absolute -left-3 top-6"},Ga={class:"flex items-center gap-3"},Za={class:"text-sm font-semibold text-gray-800"},Qa={"data-testid":"nc-form-input-label"},Ka={key:0,class:"text-red-500 text-base leading-[18px]"},Ja={class:"nc-form-field-body"},er={class:"mt-2"},tr={key:0,class:"mt-4 border-dashed border-2 border-gray-400 py-3 text-gray-400 text-center"},ir={class:"flex justify-between items-center mt-6 !px-8 !lg:px-12"},nr={key:0,class:"px-8 lg:px-12"},or={class:"inline-block"},sr={class:"px-3 pt-4 pb-2 flex items-center justify-between border-b border-gray-200 font-medium"},ar={class:"flex items-center"},rr={class:"flex items-center pr-1 py-1.5 text-gray-800"},lr={class:"text-center"},cr={"data-testid":"nc-form-input-label"},dr={class:"flex items-center space-x-2"},ur={class:"nc-edit-or-add-provider-wrapper"},hr={class:"nc-form-field-text p-4 flex flex-col gap-4 border-b border-gray-200"},mr={class:"text-sm font-bold text-gray-800"},fr={class:"flex flex-wrap justify-between items-center gap-2"},pr={class:"flex items-center gap-3"},gr={class:"text-sm font-bold text-gray-800"},vr={class:"flex gap-2 items-center"},br={class:"nc-edit-or-add-provider-wrapper"},wr={autocomplete:"off"},yr={class:"nc-form-fields-list border-1 border-gray-200 rounded-lg overflow-y-auto nc-form-scrollbar"},_r={key:0,class:"px-0.5 py-2 text-gray-500 text-center"},xr={class:"flex-1 flex flex-row items-center truncate cursor-pointer"},zr={class:"flex-1 font-base my-1.5"},Cr={class:"flex items-center px-2"},Rr=["data-testid"],Ar={class:"py-1.5 flex items-center"},kr={class:"flex-1 flex items-center justify-between cursor-pointer max-w-[calc(100%_-_20px)] py-1.5"},Sr=["onClick"],Mr={class:"flex-1 flex items-center justify-start max-w-[calc(100%_-_28px)]"},Er={class:"w-full flex items-center"},$r={class:"text-center"},Fr={"data-testid":"nc-field-title"},Ir={key:0,class:"truncate inline-flex text-xs font-normal text-gray-700"},Dr={class:"text-center"},Tr={"data-testid":"nc-field-title "},Or={key:1,class:"text-red-500 text-sm align-top"},Lr={class:"flex items-center"},Br={class:"px-0.5 py-2 text-gray-500 text-center"},Pr={class:"p-4 flex flex-col space-y-4 border-b border-gray-200"},Wr={class:"text-sm font-bold text-gray-800"},jr={class:"flex flex-col space-y-3"},Vr={class:"text-gray-800"},Ur={class:"flex justify-start"};const Hr={class:"flex items-center justify-between gap-3"},Nr={class:"p-4 flex flex-col space-y-4"},qr={class:"text-sm font-bold text-gray-800"},Yr={class:"flex flex-col gap-3"},Xr={class:"flex flex-col gap-3"},Gr={class:"flex items-center justify-between gap-3"},Zr={key:0,class:"flex flex-col gap-2 max-w-[calc(100%_-_40px)]"},Qr={class:"flex items-center justify-between gap-3"},Kr={class:"flex items-center justify-between gap-3"},Jr={class:"flex items-center justify-between gap-3"},el={class:"text-bold text-gray-600 underline"},tl={key:0,class:"pb-10"},il={class:"text-gray-800 mb-2"},nl={key:2,class:"absolute inset-0 bg-black/40 z-500 grid place-items-center"},ol={class:"text-center bg-white px-6 py-8 rounded-xl max-w-lg"},sl={class:"text-2xl text-gray-800 font-bold"},al={class:"capitalize"},rl={class:"text-sm text-gray-700 pt-6"},ll=It({__name:"Form",setup(e){Kt(Ro,L(!0)),Kt(Ao,L(!1));const t=["created_at","updated_at"],i=[N.Rollup,N.Lookup,N.Formula,N.QrCode,N.Barcode,N.Button,N.SpecificDBType,N.CreatedTime,N.LastModifiedTime,N.CreatedBy,N.LastModifiedBy],o=[dt.code,dt.blockQuote,dt.bulletList,dt.numberedList,dt.taskList],{isMobileMode:s,user:n}=ko(),{$api:r,$e:d}=mi(),{isUIAllowed:a}=So(),{metas:h,getMeta:m}=hi(),{base:f}=Jt(pn()),{getPossibleAttachmentSrc:p}=rs(),w=L(0),y=Ee(mn,L(!1)),b=a("viewFieldEdit"),B=Ee(un,L()),H=Ee(hn,L()),ie=Ee(Mo,L(!1)),{loadFormView:Y,insertRow:me,formColumnData:Oe,formViewData:x,updateFormView:st}=ls(B,H),{formState:X,localColumns:E,visibleColumns:V,activeRow:U,activeField:S,activeColumn:Z,isRequired:ge,updateView:G,updateColMeta:I,validateInfos:T,validate:O,clearValidate:we,fieldMappings:Ae,isValidRedirectUrl:ke,loadAllviewFilters:Lt,allViewFilters:Bt,checkFieldVisibility:Pt}=fa(B,H,x,st,b),{preFillFormSearchParams:bi}=Jt(Eo()),He=Ee(dn,gn());He.on(async c=>{c!=null&&c.isFormFieldFilters?setTimeout(()=>{Pt()},100):(await Promise.all([Y(),Ai()]),zi())});const{fields:Qe,showAll:Ln,hideAll:Bn}=ms(),{state:Le,row:Pn}=fs(L({row:X.value,oldRow:{},rowMeta:{new:!0}})),wi=de(()=>{var c;return((c=B==null?void 0:B.value)==null?void 0:c.columns)||[]}),Wt=L(),jt=L([]),re=L({showColumnMenu:!1,showEditColumn:!1,showAddColumn:!1}),ft=L(!1),Ne=L(!1),at=L(!1),Vt=L(!1),pt=L(!1),le=L({imageConfig:{src:"",type:"",name:""},cropperConfig:{stencilProps:{},minHeight:0,minWidth:0,imageRestriction:"none"},uploadConfig:{path:""},cropFor:"banner"}),gt=L(),Be=L(""),Ut=L(!1),{t:Ht}=ui(),{open:Wn,onChange:jn}=$o({accept:"image/*",multiple:!1,reset:!0}),vt=L(),yi=c=>{var u;re.value[c]=!0,vt.value&&!((u=vt.value)!=null&&u.isWebHookModalOpen())&&(re.value[c]=!1)},dl=de(()=>{var c;return p(We((c=x.value)==null?void 0:c.logo_url))}),Vn=L(!1),Nt=L({validateStatus:"",help:void 0}),Ke=de({get:()=>{var c;return typeof((c=x.value)==null?void 0:c.redirect_url)=="string"},set:c=>{Vn.value=c,c?x.value={...x.value,redirect_url:""}:(x.value={...x.value,redirect_url:null},Nt.value={validateStatus:"",help:void 0}),G()}}),Un=()=>{const c=ke();Nt.value={...c},c.validateStatus!=="error"&&G()},Hn=(c,u)=>{var $,ce,J;let z;switch(c.uidt){case N.LinkToAnotherRecord:case N.Links:{const fe=Array.isArray(u)?u:[u],ee=($=c==null?void 0:c.colOptions)==null?void 0:$.fk_related_model_id;if(!ee)return;const pe=fe.map(q=>os(q,h.value[ee].columns||[])).filter(q=>!!q).join(",");z=pe||void 0,(((ce=c.colOptions)==null?void 0:ce.type)===ut.BELONGS_TO||((J=c.colOptions)==null?void 0:J.type)===ut.ONE_TO_ONE)&&(z=pe[0]);break}default:return u}return z},Nn=ti(()=>{if(y.value||!a("dataInsert"))return;const c={...X.value,...Le.value},u=new URLSearchParams;for(const z of V.value){if(!z.title||!Yi(c[z.title])||Ye(z)&&!Mt(z)||ps(z)||z.uidt===N.SpecificDBType)continue;const $=Hn(z,c[z.title]);$!==void 0&&u.append(z.title,$)}bi.value=u.toString()},250);async function qn(){var c;if(a("dataInsert")){for(const u of E.value)u.show&&u.title&&ge(u,u.required)&&X.value[u.title]===void 0&&(X.value[u.title]=null),(!u.visible||!u.show)&&u.title&&(delete X.value[u.title],delete Le.value[u.title]);try{await O(Object.keys(X.value).map(u=>Ae.value[u]).filter(u=>u!==void 0))}catch(u){if(console.error(u),(c=u==null?void 0:u.errorFields)!=null&&c.length){et.error(Ht("msg.error.someOfTheRequiredFieldsAreEmpty"));return}}await me({row:{...X.value,...Le.value},oldRow:{},rowMeta:{new:!0}}),at.value=!0}}async function bt(){a("dataInsert")&&(X.value={},Le.value={},we(),He.trigger())}function Yn(c){if(t.includes(c.fk_column_id))return!1;let u=!Ye(c)&&c.rqd&&!Yi(c==null?void 0:c.cdf)&&!wi.value.some(z=>{var $;return Mt(z.uidt)&&(($=z==null?void 0:z.colOptions)==null?void 0:$.type)===ut.BELONGS_TO&&c.fk_column_id===z.colOptions.fk_child_column_id})||c.pk&&!c.ai&&!c.cdf;if(c.uidt===N.LinkToAnotherRecord&&c.colOptions.type===ut.BELONGS_TO){const z=wi.value.find($=>$.id===c.colOptions.fk_child_column_id);z.rqd&&!z.default&&(u=!0)}return u}function Xn(c){if(c.from!==c.to&&wt(c.draggedContext.element))return!1}async function _i(c,u=!1){var J,fe,ee,pe;if(y.value||!b)return;let{newIndex:z,element:$}=c.moved;const ce=(J=Qe.value)==null?void 0:J.findIndex(q=>(q==null?void 0:q.fk_column_id)===$.fk_column_id);ce===-1||ce===void 0||!((fe=Qe.value)!=null&&fe[ce])||(u&&($=E.value[(ee=E.value)==null?void 0:ee.findIndex(q=>q.fk_column_id===$.fk_column_id)],z=E.value.findIndex(q=>q.fk_column_id===V.value[z].fk_column_id)),!E.value.length||E.value.length===1?$.order=1:E.value.length-1===z?$.order=Math.max(...E.value.map(q=>(q==null?void 0:q.order)??0))+1:z===0?$.order=Math.min(...E.value.map(q=>(q==null?void 0:q.order)??0))/2:$.order=((((pe=E.value[z-1])==null?void 0:pe.order)??0)+(E.value[z+1].order??0))/2,await r.dbView.formColumnUpdate($.id,$),Qe.value[ce]=$,E.value=[...E.value].sort((q,rt)=>q.order!==void 0&&rt.order!==void 0?q.order-rt.order:0),Pt(),d("a:form-view:reorder"))}async function xi(c,u,z=!1){var ce,J;if(y.value||!b)return;if(wt(c)){!z&&et.info(Ht("msg.info.requriedFieldsCantBeMoved"));return}const $=(ce=Qe.value)==null?void 0:ce.findIndex(fe=>(fe==null?void 0:fe.fk_column_id)===c.fk_column_id);$!==-1&&$!==void 0&&((J=Qe.value)!=null&&J[$])&&(c.show=u,await r.dbView.formColumnUpdate(c.id,c),Qe.value[$]=c,He.trigger(),d(u?"a:form-view:show-columns":"a:form-view:hide-columns")),!u&&!z&&U.value&&(U.value="")}function wt(c){return Yn(c)||!!c.required||!!c.rqd&&!c.cdf||c.uidt===N.QrCode||c.uidt===N.Barcode}async function Gn(c){if(!(y.value||!b))if(c){for(const u of E==null?void 0:E.value)u.show=!0;await Ln(jt.value),d("a:form-view:add-all")}else{for(const u of E==null?void 0:E.value)wt(u)||(u.show=!1);await Bn(E==null?void 0:E.value.filter(u=>wt(u)).map(u=>u.fk_column_id)),d("a:form-view:remove-all")}}async function Zn(){return Ne.value&&!qi&&!await r.plugin.status("SMTP")?(Ne.value=!1,et.info(Ht("msg.toast.formEmailSMTP")),!1):!0}function zi(){var z,$,ce,J,fe;const c=(Oe==null?void 0:Oe.value)||[];jt.value=Fo(c).map(ee=>ee.fk_column_id),x.value={banner_image_url:null,logo_url:null,...x.value,submit_another_form:!!(((z=x.value)==null?void 0:z.submit_another_form)??0),show_blank_form:!!((($=x.value)==null?void 0:$.show_blank_form)??0),meta:{hide_branding:!1,background_color:"#F9F9FA",hide_banner:!1,...We((ce=x.value)==null?void 0:ce.meta)??{}}};let u={};try{u=JSON.parse(((J=x.value)==null?void 0:J.email)||"")||{}}catch{}Ne.value=u[(fe=n.value)==null?void 0:fe.email],E.value=c.filter(ee=>!i.includes(ee.uidt)&&!jt.value.includes(ee.fk_column_id)).sort((ee,pe)=>ee.order-pe.order).map(ee=>({...ee,required:!!ee.required})),Pt()}async function Qn(){var c,u,z;try{if(!await Zn())return;const $=(c=x.value)!=null&&c.email?JSON.parse((u=x.value)==null?void 0:u.email):{};$[(z=n.value)==null?void 0:z.email]=Ne.value,x.value.email=JSON.stringify($)}catch{}}function Kn(){Qn(),G()}function Ci(){S.value&&(delete X.value[S.value.title],Ye(S.value)&&delete Le.value[S.value.title])}async function Jn(){re.value.showAddColumn=!1,He.trigger()}async function eo(){var c;re.value.showEditColumn=!1,S.value&&S.value.uidt!==((c=Z.value)==null?void 0:c.uidt)&&Ci(),He.trigger()}async function to(){Ci(),He.trigger()}const yt=(c,u=!1)=>{y.value||!b||(u&&(Ut.value=!0),U.value=c.id)},io=c=>{var z;if(y.value||!b)return;Vo(c).isValid()&&(((z=x.value)==null?void 0:z.meta).background_color=c,G())},ul=c=>{var u,z;!b||!qi||(le.value.uploadConfig={path:[Uo,f.value.id,(u=B.value)==null?void 0:u.id,(z=x.value)==null?void 0:z.id].join("/")},c?(le.value.cropperConfig={...le.value.cropperConfig,stencilProps:{aspectRatio:4/1},minHeight:100,minWidth:0},le.value.cropFor="banner"):(le.value.cropperConfig={...le.value.cropperConfig,stencilProps:{aspectRatio:void 0},minHeight:150,minWidth:150},le.value.cropFor="logo"),Wn())};jn(c=>{if(c&&c[0]){le.value.imageConfig.src&&URL.revokeObjectURL(le.value.imageConfig.src);const u=URL.createObjectURL(c[0]);le.value.imageConfig={src:u,type:c[0].type,name:c[0].name},pt.value=!0}});const no=(c=null)=>{le.value.cropFor==="banner"?x.value.banner_image_url=c:x.value.logo_url=c,G()},oo=c=>{c.target.select()},so=c=>{S.value&&(S.value.title===c?S.value.label=null:S.value.label=c)},Ri=(c,u)=>{const z=document.querySelector(`${u?".nc-form-field-item-":".nc-form-drag-"}${CSS.escape(c==null?void 0:c.replaceAll(" ",""))}`);z&&setTimeout(()=>{z==null||z.scrollIntoView({behavior:"smooth",block:"center"})},50)};async function Ai(){await Promise.all((E.value||[]).map(async c=>{var z;const u=(z=c==null?void 0:c.colOptions)==null?void 0:z.fk_related_model_id;return Ye(c)&&Mt(c)&&u&&await m(u),c}))}const ao=c=>{var u;!S.value||((u=S.value)==null?void 0:u.description)===c||(S.value.description=c,I(S.value))};return Io(async()=>{le.value.src&&URL.revokeObjectURL(le.value.imageConfig.src),bi.value="",Vt.value=!0,await Promise.all([Y(),Ai(),Lt()]),zi(),Vt.value=!1}),Xe(at,c=>{var u;if(c&&((u=x.value)!=null&&u.show_blank_form)){w.value=5;const z=Do(()=>{--w.value<0&&(at.value=!1,bt(),clearInterval(z))},1e3)}}),Xe(H,c=>{(c==null?void 0:c.type)===To.FORM&&He.trigger()}),Xe([X,Le],async()=>{for(const c in Le.value)X.value[c]=Le.value[c];Nn();try{await O(Object.keys(X.value).map(c=>Ae.value[c]).filter(c=>c!==void 0))}catch{}},{deep:!0}),Xe(S,(c,u)=>{c&&Ut.value?St(()=>{Ri(c.title,!1)}):u&&St(()=>{Ri(u.title,!0)}),Ut.value=!1,re.value={...re.value,showColumnMenu:!1,showEditColumn:!1}}),Xe(gt,()=>{S.value&&gt.value&&St(()=>{var c;(c=gt.value)==null||c.focus()})}),Xe(y,c=>{c&&(U.value=""),bt()}),Ni(document,"keydown",c=>{var z,$;const u=Oo()?c.metaKey:c.ctrlKey;switch((z=c.key)==null?void 0:z.toLowerCase()){case"s":u&&!(["input","textarea"].includes(c.target.nodeName.toLowerCase())||($=c.target)!=null&&$.getAttribute("contenteditable"))&&(c.preventDefault(),G());break}},!0),Ni(document,"mousedown",c=>{var u,z,$;(u=Wt.value)!=null&&u.targetDomElement&&((z=Wt.value)!=null&&z.targetDomElement.contains(c.target))||($=c.target)!=null&&$.closest('.nc-form-right-panel, [class*="dropdown"], .nc-form-rich-text-field, .ant-modal, .ant-modal-wrap, .nc-share-base-button, .nc-form-right-sidebar-content-resizable-wrapper .splitpanes__splitter')||(U.value="")},!0),(c,u)=>{var Ii,Di,Ti,Oi,Li,Bi,Pi,Wi,ji,Vi;const z=Yo,$=ga,ce=vs,J=li,fe=Ho,ee=ra,pe=No,q=va,rt=bs,_t=ws,xt=cn,ro=ba,lo=wa,co=ya,ki=_a,uo=wn,ho=vn,mo=Xo,fo=qo,Si=Zo,Mi=Qo,Ei=xa,$i=fn,po=ua,go=za,vo=ss,Fi=gs,qe=ys,bo=Ca,wo=ha,lt=Lo("e");return v(),W("div",Ra,[l(s)?(v(),W("div",Aa,[g("div",ka,[oe(M(c.$t("general.available")),1),u[46]||(u[46]=g("br",null,null,-1)),oe(M(c.$t("title.inDesktop")),1)]),g("div",Sa,M(c.$t("msg.formViewNotSupportedOnMobile")),1)])):(v(),W(Ve,{key:1},[l(at)?(v(),W("div",{key:0,class:"h-full p-6 overflow-auto nc-form-scrollbar",style:ei({background:((Di=("parseProp"in c?c.parseProp:l(We))((Ii=l(x))==null?void 0:Ii.meta))==null?void 0:Di.background_color)||"#F9F9FA"}),"data-testid":"nc-form-wrapper-submit"},[g("div",Ma,[("parseProp"in c?c.parseProp:l(We))((Ti=l(x))==null?void 0:Ti.meta).hide_banner?D("",!0):(v(),R(z,{key:0,"banner-image-url":(Oi=l(x))==null?void 0:Oi.banner_image_url},null,8,["banner-image-url"])),g("div",Ea,[l(x)?(v(),W("div",$a,[g("div",null,[g("h1",Fa,M(l(x).heading),1),(Li=l(x).subheading)!=null&&Li.trim()?(v(),W("div",Ia,[_($,{value:l(x).subheading,class:"font-medium text-base text-gray-500 !h-auto mb-4 -ml-1","is-form-field":"","read-only":"","sync-value-change":""},null,8,["value"])])):D("",!0)]),g("div",Da,[g("div",Ta,[_(ce,{class:"nc-form-success-msg !my-4 !py-4 text-left !rounded-lg",type:"success",outlined:""},{message:C(()=>{var Pe,Q,F;return[(Q=(Pe=l(x))==null?void 0:Pe.success_msg)!=null&&Q.trim()?(v(),R($,{key:0,value:(F=l(x))==null?void 0:F.success_msg,class:"!h-auto -ml-1","is-form-field":"","read-only":"","sync-value-change":""},null,8,["value"])):(v(),W("span",Oa,M(c.$t("msg.successfullySubmittedFormData")),1))]}),_:1}),g("div",La,[l(x).show_blank_form?(v(),W("div",Ba,M(c.$t("msg.newFormWillBeLoaded",{seconds:l(w)})),1)):D("",!0),l(x).submit_another_form||!l(ie)?(v(),W("div",Pa,[_(J,{type:"primary",size:"small",onClick:u[0]||(u[0]=()=>{at.value=!1,bt()})},{default:C(()=>[oe(M(c.$t("activity.submitAnotherForm")),1)]),_:1})])):D("",!0)])])])])):D("",!0)])])],4)):(v(),W("div",Wa,[l(Vt)?(v(),W("div",ja,[g("div",null,[_(fe,{size:"xlarge"}),g("div",Va,M(c.$t("general.loading")),1)])])):l(x)?(v(),R(wo,{key:1},{preview:C(()=>{var Pe,Q,F;return[g("div",{class:"w-full h-full overflow-auto nc-form-scrollbar p-6",style:ei({background:((Pe=l(x))==null?void 0:Pe.meta).background_color||"#F9F9FA"})},[g("div",Ua,[l(b)?(v(),R(ee,{key:0,"show-cropper":l(pt),"onUpdate:showCropper":u[1]||(u[1]=ye=>Ue(pt)?pt.value=ye:null),"image-config":l(le).imageConfig,"cropper-config":l(le).cropperConfig,"upload-config":l(le).uploadConfig,onSubmit:no},null,8,["show-cropper","image-config","cropper-config","upload-config"])):D("",!0),("parseProp"in c?c.parseProp:l(We))((Q=l(x))==null?void 0:Q.meta).hide_banner?D("",!0):(v(),W("div",Ha,[(v(),R(z,{key:(F=l(x).banner_image_url)==null?void 0:F.path,"banner-image-url":l(x).banner_image_url},null,8,["banner-image-url"])),D("",!0)])),_(fo,{class:"!py-8 !lg:py-12 !border-gray-200 !rounded-3xl !mt-6 !max-w-[max(33%,688px)] !mx-auto","body-style":{margin:"0 auto",padding:"0px !important"}},{default:C(()=>{var ye;return[_(uo,{model:l(X),class:"nc-form","no-style":""},{default:C(()=>[g("div",Na,[D("",!0),g("div",{class:Se(["border-transparent px-4 lg:px-6",[{"rounded-2xl overflow-hidden border-2 cursor-pointer mb-1 py-4 lg:py-6 focus-within:bg-gray-50":l(b)},{"mb-4 py-0 lg:py-0":!l(b)},{"hover:bg-gray-50":l(U)!=="nc-form-heading"&&l(b)},{"bg-gray-50":l(U)==="nc-form-heading"&&l(b)},{"!hover:bg-white !ring-0 !cursor-auto":l(y)}]]),onClick:u[9]||(u[9]=ue(A=>yt({id:"nc-form-heading"}),["stop"]))},[l(b)?(v(),R(_t,{key:0,class:"!my-0"},{default:C(()=>[_(rt,{value:l(x).heading,"onUpdate:value":u[6]||(u[6]=A=>l(x).heading=A),class:"nc-form-focus-element !p-0 !m-0 w-full !font-bold !text-2xl !border-0 !rounded-none !text-gray-900",style:{borderRightWidth:"0px !important",height:"70px","max-height":"250px",resize:"vertical"},"auto-size":"",size:"large","hide-details":"",disabled:l(y),placeholder:"Form Title",bordered:!1,"data-testid":"nc-form-heading","data-title":"nc-form-heading",onInput:l(G),onFocus:u[7]||(u[7]=A=>U.value="nc-form-heading"),onBlur:u[8]||(u[8]=A=>U.value="")},null,8,["value","disabled","data-testid","data-title","onInput"])]),_:1})):(v(),W("div",qa,M(l(x).heading),1))],2),g("div",{class:Se(["border-transparent px-4 lg:px-6 empty:hidden",[{"rounded-2xl border-2 cursor-pointer mb-1 py-4 lg:py-6 focus-within:bg-gray-50":l(b)},{"mb-4 py-0 lg:py-0":!l(b)},{"hover:bg-gray-50":l(U)!=="nc-form-sub-heading"&&l(b)},{"bg-gray-50":l(U)==="nc-form-sub-heading"&&l(b)},{"!hover:bg-white !ring-0 !cursor-auto":l(y)}]]),onClick:u[13]||(u[13]=ue(A=>yt({id:"nc-form-sub-heading"}),["stop"]))},[l(b)&&!l(y)?(v(),R($,{key:0,value:l(x).subheading,"onUpdate:value":[u[10]||(u[10]=A=>l(x).subheading=A),l(G)],placeholder:c.$t("msg.info.formDesc"),class:"nc-form-description nc-form-focus-element font-medium text-base !text-gray-500 -ml-1","is-form-field":"",autofocus:l(U)==="nc-form-sub-heading","data-testid":"nc-form-sub-heading","data-title":"nc-form-sub-heading",onFocus:u[11]||(u[11]=A=>U.value="nc-form-sub-heading"),onBlur:u[12]||(u[12]=A=>U.value="")},null,8,["value","placeholder","autofocus","data-testid","data-title","onUpdate:value"])):l(x).subheading?(v(),R($,{key:1,value:l(x).subheading,class:"font-medium text-base !text-gray-500 -ml-1","is-form-field":"","read-only":"","sync-value-change":""},null,8,["value"])):D("",!0)],2)]),_(l(Gi),{ref_key:"draggableRef",ref:Wt,"model-value":l(V),"item-key":"fk_column_id",draggable:".item",handle:".nc-form-field-drag-handler",group:"form-inputs","ghost-class":"nc-form-field-ghost",class:"h-full px-4 lg:px-6",move:Xn,disabled:l(y)||!l(b),onChange:u[15]||(u[15]=A=>_i(A,!0))},{item:C(({element:A})=>{var Ui;return[!l(y)||l(y)&&(A!=null&&A.visible)?(v(),W("div",{key:A.id,class:Se(["nc-editable nc-form-focus-element item relative bg-white p-4 lg:p-6",[`nc-form-drag-${A.title.replaceAll(" ","")}`,{"rounded-2xl border-2 my-1":l(b)},{"border-transparent my-0":!l(b)},{"nc-form-field-drag-handler border-transparent hover:bg-gray-50 cursor-pointer":l(U)!==A.id&&l(b)},{"border-brand-500":l(U)===A.id},{"!hover:bg-white !ring-0 !cursor-auto":l(y)}]]),"data-title":A.title,"data-testid":"nc-form-fields",onClick:ue(ct=>yt(A),["stop"])},[l(U)===A.id?(v(),W("div",Xa,[_(J,{type:"primary",size:"small",class:"nc-form-field-drag-handler !cursor-move !p-1 !min-w-6 !h-auto !rounded"},{default:C(()=>[(v(),R(Ce(("iconMap"in c?c.iconMap:l(tt)).drag),{class:"nc-form-field-drag-handler flex-none !h-4 !w-4 text-white font-bold"}))]),_:1})])):D("",!0),g("div",Ga,[(Ui=l(Bt)[A.fk_column_id])!=null&&Ui.length&&!l(y)?(v(),R(pe,{key:0,class:"relative h-3.5 w-3.5 flex cursor-pointer",placement:"topLeft"},{title:C(()=>u[47]||(u[47]=[oe(" Conditionally visible field ")])),default:C(()=>[_(Bo,{name:"icon-fade"},{default:C(()=>[A!=null&&A.visible?(v(),R(xt,{key:0,icon:"eye",class:"nc-field-visibility-icon nc-field-visible w-3.5 h-3.5 flex-none text-nc-content-gray-muted"})):(v(),R(xt,{key:1,icon:"eyeSlash",class:"nc-field-visibility-icon w-3.5 h-3.5 flex-none text-nc-content-gray-muted"}))]),_:2},1024)]),_:2},1024)):D("",!0),g("div",Za,[g("span",Qa,M(A.label||A.title),1),l(ge)(A,A.required)?(v(),W("span",Ka,"*")):D("",!0)])]),A.description?(v(),R($,{key:1,value:A.description,"is-form-field":"","read-only":"","sync-value-change":"",class:"nc-form-help-text text-gray-500 text-sm mt-2 -ml-1","data-testid":"nc-form-help-text","onUpdate:value":ct=>l(I)(A)},null,8,["value","onUpdate:value"])):D("",!0),g("div",Ja,[g("div",er,[l(Ae)[A.title]?(v(),R(_t,$t({key:0,name:l(Ae)[A.title],class:"!my-0 nc-input-required-error nc-form-input-item"},l(T)[l(Ae)[A.title]]),{default:C(()=>[_(co,{class:"relative",onClick:u[14]||(u[14]=ue(()=>{},["stop"]))},{default:C(()=>[l(Ye)(A)?(v(),R(ro,{key:0,modelValue:l(X)[A.title],"onUpdate:modelValue":ct=>l(X)[A.title]=ct,row:l(Pn),class:Se(["nc-input",`nc-form-input-${A.title.replaceAll(" ","")}`]),"data-testid":`nc-form-input-${A.title.replaceAll(" ","")}`,column:A},null,8,["modelValue","onUpdate:modelValue","row","class","data-testid","column"])):(v(),R(lo,{key:1,modelValue:l(X)[A.title],"onUpdate:modelValue":ct=>l(X)[A.title]=ct,class:Se(["nc-input truncate",[`nc-form-input-${A.title.replaceAll(" ","")}`,{"layout-list":A.meta.isList}]]),"data-testid":`nc-form-input-${A.title.replaceAll(" ","")}`,column:A,"edit-enabled":!0},null,8,["modelValue","onUpdate:modelValue","class","data-testid","column"]))]),_:2},1024)]),_:2},1040,["name"])):D("",!0),g("div",null,[_(ki,{column:A,mode:"preview"},null,8,["column"])])])])],10,Ya)):D("",!0)]}),footer:C(()=>[!l(V).length&&l(b)?(v(),W("div",tr,M(c.$t("title.selectFieldsFromRightPannelToAddHere")),1)):D("",!0)]),_:1},8,["model-value","disabled"]),g("div",ir,[_(J,{type:"secondary",size:"small",disabled:!l(a)("dataInsert")||!l(V).length,class:"nc-form-clear nc-form-focus-element","data-testid":"nc-form-clear","data-title":"nc-form-clear",onClick:bt},{default:C(()=>[oe(M(c.$t("activity.clearForm")),1)]),_:1},8,["disabled"]),_(J,{type:"primary",size:"small",disabled:!l(a)("dataInsert")||!l(V).length,class:"nc-form-submit nc-form-focus-element","data-testid":"nc-form-submit","data-title":"nc-form-submit",onClick:qn},{default:C(()=>[oe(M(c.$t("general.submit")),1)]),_:1},8,["disabled"])])]),_:1},8,["model"]),("parseProp"in c?c.parseProp:l(We))((ye=l(x))==null?void 0:ye.meta).hide_branding?D("",!0):(v(),W("div",nr,[_(ho,{class:"!my-8"}),g("div",or,[_(mo)])]))]}),_:1})])],4)]}),sidebar:C(()=>{var Pe;return[g("div",{class:Se(["nc-form-right-panel h-full flex-grow max-w-full",{"overflow-y-auto nc-form-scrollbar":l(S)}])},[l(S)&&l(Z)?(v(),W("div",{key:(Pe=l(S))==null?void 0:Pe.id,class:"nc-form-field-right-panel"},[g("div",sr,[g("div",ar,[g("div",{class:"text-gray-600 font-medium cursor-pointer select-none hover:underline",onClick:u[16]||(u[16]=Q=>U.value="")},M(c.$t("objects.viewType.form")),1),u[48]||(u[48]=g("div",{class:"px-1.75 text-gray-500 text-xl font-normal"},"/",-1)),g("div",rr,[l(Ye)(l(S))?(v(),R(Si,{key:0,"column-meta":l(S),class:"flex-none"},null,8,["column-meta"])):(v(),R(Mi,{key:1,"column-meta":l(S),class:"flex-none"},null,8,["column-meta"])),_(pe,{class:"truncate max-w-[120px] text-sm font-semibold","show-on-truncate-only":""},{title:C(()=>[g("div",lr,M(l(S).title),1)]),default:C(()=>[g("span",cr,M(l(S).title),1)]),_:1})])]),g("div",dr,[_($i,{visible:l(re).showEditColumn,"onUpdate:visible":u[20]||(u[20]=Q=>l(re).showEditColumn=Q),trigger:["click"],"overlay-class-name":"nc-dropdown-form-edit-column",disabled:!l(a)("fieldEdit")||l(y),onVisibleChange:u[21]||(u[21]=Q=>yi("showEditColumn"))},{overlay:C(()=>[g("div",ur,[l(re).showEditColumn?(v(),R(Ei,{key:0,ref_key:"editOrAddProviderRef",ref:vt,column:l(Z),onSubmit:eo,onCancel:u[17]||(u[17]=Q=>l(re).showEditColumn=!1),onClick:u[18]||(u[18]=ue(()=>{},["stop"])),onKeydown:u[19]||(u[19]=ue(()=>{},["stop"]))},null,8,["column"])):D("",!0)])]),default:C(()=>[_(J,{type:"secondary",size:"small",class:"nc-form-add-field","data-testid":"nc-form-add-field"},{default:C(()=>[oe(M(c.$t("general.edit"))+" "+M(c.$t("objects.field")),1)]),_:1})]),_:1},8,["visible","disabled"]),_(po,{"is-open":l(re).showColumnMenu,"onUpdate:isOpen":u[22]||(u[22]=Q=>l(re).showColumnMenu=Q),column:l(Z),"form-column":l(S),"is-required":l(ge)(l(S),l(S).required),"on-delete":()=>{to()},onHideField:u[23]||(u[23]=Q=>xi(l(S),!1,!1))},null,8,["is-open","column","form-column","is-required","on-delete"])])]),g("div",hr,[g("div",mr,M(c.$t("objects.field"))+" "+M(c.$t("general.text").toLowerCase()),1),_(rt,{ref_key:"focusLabel",ref:gt,value:l(S).label||l(S).title,rows:1,"auto-size":"","hide-details":"",class:"form-meta-input nc-form-input-label !max-h-7.5rem nc-form-scrollbar","data-testid":"nc-form-input-label",placeholder:c.$t("msg.info.formInput"),onFocus:oo,onKeydown:u[24]||(u[24]=Po(ue(()=>{},["prevent"]),["enter"])),onInput:u[25]||(u[25]=Q=>so(Q.target.value)),onChange:u[26]||(u[26]=Q=>l(I)(l(S)))},null,8,["value","placeholder"]),_($,{value:l(S).description,placeholder:c.$t("msg.info.formHelpText"),class:"form-meta-input nc-form-input-help-text","is-form-field":"","hidden-bubble-menu-options":o,"data-testid":"nc-form-input-help-text","onUpdate:value":ao},null,8,["value","placeholder"])]),l(S)?(v(),R(go,{key:0})):D("",!0)])):(v(),W(Ve,{key:1},[l(x)?(v(),R(l(bn),{key:0,horizontal:"",class:"nc-form-settings w-full nc-form-right-splitpane"},{default:C(()=>[_(l(Ft),{"min-size":"30",size:"50",class:"nc-form-right-splitpane-item p-4 flex flex-col space-y-4 !min-h-200px"},{default:C(()=>{var Q;return[g("div",fr,[g("div",pr,[g("div",gr,M(c.$t("objects.viewType.form"))+" "+M(c.$t("objects.fields")),1),_(vo,{color:"border-gray-200"},{default:C(()=>[oe(M(l(V).length)+"/"+M(l(E).length)+" "+M(c.$t("objects.field")),1)]),_:1})]),l(a)("fieldAdd")?(v(),R($i,{key:0,visible:l(re).showAddColumn,"onUpdate:visible":u[30]||(u[30]=F=>l(re).showAddColumn=F),trigger:["click"],disabled:l(y),"overlay-class-name":"nc-dropdown-form-add-column",onVisibleChange:u[31]||(u[31]=F=>yi("showAddColumn"))},{overlay:C(()=>[g("div",br,[l(re).showAddColumn?(v(),R(Ei,{key:0,ref_key:"editOrAddProviderRef",ref:vt,onSubmit:Jn,onCancel:u[27]||(u[27]=F=>l(re).showAddColumn=!1),onClick:u[28]||(u[28]=ue(()=>{},["stop"])),onKeydown:u[29]||(u[29]=ue(()=>{},["stop"]))},null,512)):D("",!0)])]),default:C(()=>[_(J,{type:"secondary",size:"small",class:"nc-form-add-field","data-testid":"nc-form-add-field"},{default:C(()=>[g("div",vr,[(v(),R(Ce(("iconMap"in c?c.iconMap:l(tt)).plus),{class:"w-4 h-4"})),g("span",null,M(c.$t("activity.addFieldFromFormView")),1)])]),_:1})]),_:1},8,["visible","disabled"])):D("",!0)]),g("form",wr,[_(Fi,{key:"nc-form-field-search-input",value:l(Be),"onUpdate:value":u[33]||(u[33]=F=>Ue(Be)?Be.value=F:null),type:"text",autocomplete:"off",class:"!h-9 !px-3 !py-1 !rounded-lg",placeholder:`${c.$t("placeholder.searchFields")}...`,name:"nc-form-field-search-input","data-testid":"nc-form-field-search-input"},{prefix:C(()=>[_(xt,{icon:"search",class:"mr-2 h-4 w-4 text-gray-500 group-hover:text-black"})]),suffix:C(()=>[l(Be).length>0?(v(),R(xt,{key:0,icon:"close",class:"ml-2 h-4 w-4 text-gray-500 group-hover:text-black","data-testid":"nc-form-field-clear-search",onClick:u[32]||(u[32]=F=>Be.value="")})):D("",!0)]),_:1},8,["value","placeholder"])]),g("div",yr,[l(E).length?D("",!0):(v(),W("div",_r,M(c.$t("title.noFieldsFound")),1)),l(E).length?(v(),W(Ve,{key:1},[g("div",{key:"nc-form-show-all-fields",class:"w-full flex items-center border-b-1 rounded-t-lg border-gray-200 bg-gray-50 sticky top-0 z-100","data-testid":"nc-form-show-all-fields",onClick:u[34]||(u[34]=ue(()=>{},["stop"]))},[u[49]||(u[49]=g("div",{class:"w-4 h-4 flex-none mx-2"},null,-1)),g("div",xr,[g("div",zr,M(c.$t("activity.selectAllFields")),1),g("div",Cr,[_(qe,{checked:l(V).length===l(E).length,size:"small",class:"nc-switch",disabled:l(y),onChange:Gn},null,8,["checked","disabled"])])])]),_(l(Gi),{list:l(E),"item-key":"id","ghost-class":"nc-form-field-ghost",style:{height:"calc(100% - 64px)"},disabled:l(y)||!l(b),onChange:u[35]||(u[35]=F=>_i(F)),onStart:u[36]||(u[36]=F=>ft.value=!0),onEnd:u[37]||(u[37]=F=>ft.value=!1)},Wo({item:C(({element:F})=>{var ye,ne;return[F.title.toLowerCase().includes(l(Be).toLowerCase())?(v(),W("div",{key:F.id,class:Se(["w-full px-2 flex flex-row items-center border-b-1 last:border-none border-gray-200",[`nc-form-field-item-${F.title.replaceAll(" ","")}`,`${l(U)===F.id?"bg-brand-50 font-medium":"hover:bg-gray-50"}`]]),"data-testid":`nc-form-field-item-${F.title}`},[g("div",Ar,[(v(),R(Ce(("iconMap"in c?c.iconMap:l(tt)).drag),{class:"flex-none cursor-move !h-4 !w-4 text-gray-600 mr-1"}))]),g("div",kr,[g("div",{class:"flex-1 flex items-center cursor-pointer max-w-[calc(100%_-_40px)]",onClick:ue(A=>yt(F,!0),["prevent"])},[F&&l(Ye)(F)?(v(),R(Si,{key:0,"column-meta":F,class:"!text-gray-600"},null,8,["column-meta"])):(v(),R(Mi,{key:1,"column-meta":F,class:"!text-gray-600"},null,8,["column-meta"])),g("div",Mr,[g("div",Er,[g("div",{class:Se(["ml-1 inline-flex",(ye=F.label)!=null&&ye.trim()?"max-w-1/2":"max-w-[95%]"])},[_(pe,{class:"truncate text-sm",disabled:l(ft),"show-on-truncate-only":""},{title:C(()=>[g("div",$r,M(F.title),1)]),default:C(()=>[g("span",Fr,M(F.title),1)]),_:2},1032,["disabled"])],2),(ne=F.label)!=null&&ne.trim()?(v(),W("div",Ir,[u[50]||(u[50]=g("span",null,"(",-1)),_(pe,{class:"truncate",disabled:l(ft),"show-on-truncate-only":""},{title:C(()=>[g("div",Dr,M(F.label),1)]),default:C(()=>{var A;return[g("span",Tr,M((A=F.label)==null?void 0:A.trim()),1)]}),_:2},1032,["disabled"]),u[51]||(u[51]=g("span",null,")",-1))])):D("",!0),l(ge)(F,F.required)?(v(),W("span",Or," * ")):D("",!0),g("div",Lr,[_(ki,{column:F,mode:"list"},null,8,["column"])])])])],8,Sr),_(pe,{disabled:!F.required||l(y)||!l(b),class:"flex",placement:"topRight"},{title:C(()=>u[52]||(u[52]=[oe(" You can't hide a required field.")])),default:C(()=>[_(qe,{checked:!!F.show,disabled:F.required||l(y)||!l(b),class:"flex-none nc-switch",size:"small",onChange:A=>{xi(F,A,!0)}},null,8,["checked","disabled","onChange"])]),_:2},1032,["disabled"])])],10,Rr)):D("",!0)]}),_:2},[(Q=l(E))!=null&&Q.filter(F=>F.title.toLowerCase().includes(l(Be).toLowerCase())).length?void 0:{name:"footer",fn:C(()=>[g("div",Br,M(c.$t("title.noFieldsFound"))+" with title `"+M(l(Be))+"` ",1)]),key:"0"}]),1032,["list","disabled"])],64)):D("",!0)])]}),_:1}),_(l(Ft),{"min-size":"20",size:"50",class:"nc-form-right-splitpane-item !overflow-y-auto nc-form-scrollbar"},{default:C(()=>{var F,ye;return[g("div",Pr,[g("div",Wr,M(c.$t("labels.appearanceSettings")),1),g("div",jr,[g("div",{class:Se(l(y)||!l(b)?"pointer-events-none":"")},[g("div",Vr,M(c.$t("labels.backgroundColor")),1),g("div",Ur,[_(bo,{"model-value":l(x).meta.background_color,colors:["#FFFFFF","#FFDBD9","#FEE6D6","#FFF0D1","#D4F7E0","#D7F2FF","#FED8F4","#E5D4F5","#FFCFE6"],"color-box-border":"","is-new-design":"",class:"nc-form-theme-color-picker !pb-0 !pl-0 -ml-1",onInput:io},null,8,["model-value"])])],2),D("",!0),g("div",Hr,[g("span",null,M(c.$t("general.hide"))+" "+M(c.$t("general.banner")),1),Ge(_(qe,{checked:(F=("parseProp"in c?c.parseProp:l(We))(l(x).meta))==null?void 0:F.hide_banner,size:"small",class:"nc-form-hide-banner","data-testid":"nc-form-hide-banner",disabled:l(y)||!l(b),onChange:u[39]||(u[39]=ne=>{l(y)||!l(b)||(l(x).meta.hide_banner=ne,l(G)())})},null,8,["checked","disabled"]),[[lt,["a:form-view:hide-banner"]]])])])]),g("div",Nr,[g("div",qr,M(c.$t("msg.info.postFormSubmissionSettings")),1),g("div",Yr,[g("div",Xr,[g("div",Gr,[g("span",null,M(c.$t("labels.redirectToUrl")),1),Ge(_(qe,{checked:l(Ke),"onUpdate:checked":u[40]||(u[40]=ne=>Ue(Ke)?Ke.value=ne:null),size:"small",class:"nc-form-checkbox-redirect-url","data-testid":"nc-form-checkbox-redirect-url",disabled:l(y)||!l(b),onChange:l(G)},null,8,["checked","disabled","onChange"]),[[lt,["a:form-view:redirect-url"]]])]),l(Ke)?(v(),W("div",Zr,[_(_t,$t({class:"!my-0"},l(Nt)),{default:C(()=>[_(Fi,{value:l(x).redirect_url,"onUpdate:value":u[41]||(u[41]=ne=>l(x).redirect_url=ne),type:"text",class:"!h-8 !px-3 !py-1 !rounded-lg",placeholder:"Paste redirect URL here","data-testid":"nc-form-redirect-url-input",onInput:Un},null,8,["value"])]),_:1},16),u[53]||(u[53]=g("div",{class:"text-small leading-[18px] text-gray-400 pl-3"},[oe(" Use {record_id} to get ID of the newly created record. "),g("a",{href:"https://docs.nocodb.com/views/view-types/form/#redirect-url",target:"_blank",rel:"noopener noreferrer",class:"!no-underline !hover:underline"}," Learn more ")],-1))])):D("",!0)]),l(Ke)?D("",!0):(v(),W(Ve,{key:0},[g("div",Qr,[g("span",null,M(c.$t("msg.info.submitAnotherForm")),1),Ge(_(qe,{checked:l(x).submit_another_form,"onUpdate:checked":u[42]||(u[42]=ne=>l(x).submit_another_form=ne),size:"small",class:"nc-form-checkbox-submit-another-form","data-testid":"nc-form-checkbox-submit-another-form",disabled:l(y)||!l(b),onChange:l(G)},null,8,["checked","disabled","onChange"]),[[lt,["a:form-view:submit-another-form"]]])]),g("div",Kr,[g("span",null,M(c.$t("msg.info.showBlankForm")),1),Ge(_(qe,{checked:l(x).show_blank_form,"onUpdate:checked":u[43]||(u[43]=ne=>l(x).show_blank_form=ne),size:"small",class:"nc-form-checkbox-show-blank-form","data-testid":"nc-form-checkbox-show-blank-form",disabled:l(y)||!l(b),onChange:l(G)},null,8,["checked","disabled","onChange"]),[[lt,["a:form-view:show-blank-form"]]])])],64)),g("div",Jr,[g("span",null,[oe(M(c.$t("msg.info.emailForm"))+" ",1),g("span",el,M((ye=l(n))==null?void 0:ye.email),1)]),Ge(_(qe,{checked:l(Ne),"onUpdate:checked":u[44]||(u[44]=ne=>Ue(Ne)?Ne.value=ne:null),size:"small",class:"nc-form-checkbox-send-email","data-testid":"nc-form-checkbox-send-email",disabled:l(y)||!l(b),onChange:Kn},null,8,["checked","disabled"]),[[lt,["a:form-view:email-me"]]])])]),l(Ke)?D("",!0):(v(),W("div",tl,[g("div",il,M(c.$t("msg.info.formDisplayMessage")),1),_(_t,{class:"!my-0"},{default:C(()=>[!l(y)&&l(b)?(v(),R($,{key:0,value:l(x).success_msg,"onUpdate:value":[u[45]||(u[45]=ne=>l(x).success_msg=ne),l(G)],class:"nc-form-after-submit-msg editable","is-form-field":"","hidden-bubble-menu-options":o,"data-testid":"nc-form-after-submit-msg"},null,8,["value","onUpdate:value"])):(v(),R($,{key:1,value:l(x).success_msg,class:"nc-form-after-submit-msg","is-form-field":"","read-only":"","data-testid":"nc-form-after-submit-msg"},null,8,["value"]))]),_:1})]))])]}),_:1})]),_:1})):D("",!0)],64))],2)]}),_:1})):D("",!0)]))],64)),(Pi=(Bi=l(n))==null?void 0:Bi.base_roles)!=null&&Pi.viewer||(ji=(Wi=l(n))==null?void 0:Wi.base_roles)!=null&&ji.commenter?(v(),W("div",nl,[g("div",ol,[g("div",sl,[oe(M(c.$t("msg.info.yourCurrentRoleIs"))+" '",1),g("span",al,M(((Vi=Object.keys(l(n).base_roles))==null?void 0:Vi[0])??l(jo).NO_ACCESS),1),u[54]||(u[54]=oe("'. "))]),g("div",rl,M(c.$t("msg.info.pleaseRequestAccessForView",{viewName:"form view"})),1)])])):D("",!0)])}}}),cl=di(ll,[["__scopeId","data-v-c67efa27"]]),Vl=Object.freeze(Object.defineProperty({__proto__:null,default:cl},Symbol.toStringTag,{value:"Module"}));export{Vl as F,jl as u};
