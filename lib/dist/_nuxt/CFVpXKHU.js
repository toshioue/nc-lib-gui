import{o as a,c as b,a as l,f as J,ba as oe,bL as V,r as B,hp as le,g as F,cN as X,b as r,w as i,t as f,P as e,T as M,U as A,S as w,hq as H,d as j,al as Y,a2 as ue,ap as he,$ as me,hr as ve,i as ae,cp as fe,gx as pe,hs as be,hf as _e,az as ke,ht as xe,gs as ge,hu as ye,hv as $e,cM as Le,ac as Me,H as ee,a_ as we,aA as te,ae as Te,aF as ne,Y as se}from"./nEPQs079.js";import{B as Ae,N as ce,m as re,w as Be,T as Ce,a as ie,S as He,U as ze,L as Ie,P as Ve,u as Se,E as Ee,g as Oe,_ as Fe}from"./CINLm5KA.js";import{B as Re}from"./C3R8onno.js";import"./Cy50pBgZ.js";import"./BdIpmjdG.js";import"./ByzT15Y-.js";import"./BQQOEPN4.js";import"./COktFmkf.js";import"./DKtVUO_j.js";import"./DzMAdbS0.js";import"./QHUCxglU.js";const qe={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ne=l("path",{fill:"currentColor",d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5a5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5a5 5 0 0 0-5-5"},null,-1),je=[Ne];function Ke(c,_){return a(),b("svg",qe,[...je])}const Ue={name:"mdi-link",render:Ke},De={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},We=l("path",{fill:"currentColor",d:"M5 21h14v-2H5zm7-4a6 6 0 0 0 6-6V3h-2.5v8a3.5 3.5 0 0 1-3.5 3.5A3.5 3.5 0 0 1 8.5 11V3H6v8a6 6 0 0 0 6 6"},null,-1),Pe=[We];function Ge(c,_){return a(),b("svg",De,[...Pe])}const Qe={name:"mdi-format-underline",render:Ge},Xe={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ye=l("path",{fill:"currentColor",d:"M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4z"},null,-1),Je=[Ye];function Ze(c,_){return a(),b("svg",Xe,[...Je])}const et={name:"mdi-format-italic",render:Ze},tt={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},nt=l("path",{fill:"currentColor",d:"M13.5 15.5H10v-3h3.5A1.5 1.5 0 0 1 15 14a1.5 1.5 0 0 1-1.5 1.5m-3.5-9h3A1.5 1.5 0 0 1 14.5 8A1.5 1.5 0 0 1 13 9.5h-3m5.6 1.29c.97-.68 1.65-1.79 1.65-2.79c0-2.26-1.75-4-4-4H7v14h7.04c2.1 0 3.71-1.7 3.71-3.79c0-1.52-.86-2.82-2.15-3.42"},null,-1),st=[nt];function it(c,_){return a(),b("svg",tt,[...st])}const ot={name:"mdi-format-bold",render:it},lt={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},at=l("path",{fill:"currentColor",d:"M7 5h14v2H7zm0 8v-2h14v2zM4 4.5A1.5 1.5 0 0 1 5.5 6A1.5 1.5 0 0 1 4 7.5A1.5 1.5 0 0 1 2.5 6A1.5 1.5 0 0 1 4 4.5m0 6A1.5 1.5 0 0 1 5.5 12A1.5 1.5 0 0 1 4 13.5A1.5 1.5 0 0 1 2.5 12A1.5 1.5 0 0 1 4 10.5M7 19v-2h14v2zm-3-2.5A1.5 1.5 0 0 1 5.5 18A1.5 1.5 0 0 1 4 19.5A1.5 1.5 0 0 1 2.5 18A1.5 1.5 0 0 1 4 16.5"},null,-1),ct=[at];function rt(c,_){return a(),b("svg",lt,[...ct])}const dt={name:"mdi-format-list-bulleted",render:rt},ut={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ht=l("path",{fill:"currentColor",d:"M3 14h18v-2H3m2-8v3h5v3h4V7h5V4m-9 15h4v-3h-4z"},null,-1),mt=[ht];function vt(c,_){return a(),b("svg",ut,[...mt])}const ft={name:"mdi-format-strikethrough",render:vt},pt={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},bt=l("path",{fill:"currentColor",d:"M7 13v-2h14v2zm0 6v-2h14v2zM7 7V5h14v2zM3 8V5H2V4h2v4zm-1 9v-1h3v4H2v-1h2v-.5H3v-1h1V17zm2.25-7a.75.75 0 0 1 .75.75c0 .2-.08.39-.21.52L3.12 13H5v1H2v-.92L4 11H2v-1z"},null,-1),_t=[bt];function kt(c,_){return a(),b("svg",pt,[..._t])}const xt={name:"mdi-format-list-numbered",render:kt},gt={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},yt=l("path",{fill:"currentColor",d:"M21 19v-2H8v2zm0-6v-2H8v2zM8 7h13V5H8zM4 5v2h2V5zM3 5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1zm1 6v2h2v-2zm-1 0a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1zm1 6v2h2v-2zm-1 0a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1z"},null,-1),$t=[yt];function Lt(c,_){return a(),b("svg",gt,[...$t])}const Mt={name:"mdi-format-list-checkbox",render:Lt},wt={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Tt=l("path",{fill:"currentColor",d:"M5 17V7h2v4h4V7h2v10h-2v-4H7v4zm12 0V9h-2V7h4v10z"},null,-1),At=[Tt];function Bt(c,_){return a(),b("svg",wt,[...At])}const Ct={name:"material-symbols-format-h1",render:Bt},Ht={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},zt=l("path",{fill:"currentColor",d:"M3 17V7h2v4h4V7h2v10H9v-4H5v4zm10 0v-4q0-.825.588-1.412T15 11h4V9h-6V7h6q.825 0 1.413.588T21 9v2q0 .825-.587 1.413T19 13h-4v2h6v2z"},null,-1),It=[zt];function Vt(c,_){return a(),b("svg",Ht,[...It])}const St={name:"material-symbols-format-h2",render:Vt},Et={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ot=l("path",{fill:"currentColor",d:"M3 17V7h2v4h4V7h2v10H9v-4H5v4zm10 0v-2h6v-2h-4v-2h4V9h-6V7h6q.825 0 1.413.588T21 9v6q0 .825-.587 1.413T19 17z"},null,-1),Ft=[Ot];function Rt(c,_){return a(),b("svg",Et,[...Ft])}const qt={name:"material-symbols-format-h3",render:Rt},Nt={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},jt=l("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 15h15m0 4H6m9-8h6m0-4h-6M9 9h1a1 1 0 1 1-1 1V7.5a2 2 0 0 1 2-2M3 9h1a1 1 0 1 1-1 1V7.5a2 2 0 0 1 2-2"},null,-1),Kt=[jt];function Ut(c,_){return a(),b("svg",Nt,[...Kt])}const Dt={name:"tabler-blockquote",render:Ut},Wt={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Pt=l("path",{fill:"currentColor",d:"m8 18l-6-6l6-6l1.425 1.425l-4.6 4.6L9.4 16.6zm8 0l-1.425-1.425l4.6-4.6L14.6 7.4L16 6l6 6z"},null,-1),Gt=[Pt];function Qt(c,_){return a(),b("svg",Wt,[...Gt])}const Xt={name:"material-symbols-code",render:Qt},Yt={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Jt=l("path",{fill:"currentColor",d:"M5.7 18L8 14q-1.65 0-2.825-1.175T4 10t1.175-2.825T8 6t2.825 1.175T12 10q0 .575-.137 1.063T11.45 12L8 18zm9 0l2.3-4q-1.65 0-2.825-1.175T13 10t1.175-2.825T17 6t2.825 1.175T21 10q0 .575-.137 1.063T20.45 12L17 18z"},null,-1),Zt=[Jt];function en(c,_){return a(),b("svg",Yt,[...Zt])}const tn={name:"material-symbols-format-quote",render:en},nn={class:"flex flex-col items-center"},sn={class:"text-xs"},on={class:"flex flex-col items-center"},ln={class:"flex flex-col items-center"},an={class:"flex flex-col items-center"},cn=l("div",{class:"divider"},null,-1),rn={class:"flex flex-col items-center"},dn={class:"flex flex-col items-center"},un={class:"flex flex-col items-center"},hn=l("div",{class:"divider"},null,-1),mn={key:8,class:"divider"},vn={key:1,class:"flex flex-row items-center px-0.5"},fn={class:"!text-xs !ml-1"},de=J({__name:"SelectedBubbleMenu",props:{editor:{},embedMode:{type:Boolean,default:!1},isFormField:{type:Boolean,default:!1},hiddenOptions:{default:()=>[]}},setup(c){const _=c,{editor:t,embedMode:x,isFormField:h,hiddenOptions:k}=oe(_),z=V(le,B(!1)),d=F(()=>X()?"⌘":"CTRL"),S=F(()=>X()?"⇧":"Shift"),y=F(()=>X()?"⌥":"Alt"),u=F(()=>{if(h.value)return"bottom"}),m=F(()=>h.value?-1:0),E=()=>{var $,L,I,K,R,q,g,U,v,D,G,n;const p=((K=(I=(L=($=t.value)==null?void 0:$.state)==null?void 0:L.selection)==null?void 0:I.$from)==null?void 0:K.nodeBefore)||((U=(g=(q=(R=t.value)==null?void 0:R.state)==null?void 0:q.selection)==null?void 0:g.$from)==null?void 0:U.nodeAfter),o=(G=(D=(v=t.value)==null?void 0:v.state)==null?void 0:D.storedMarks)==null?void 0:G.some(s=>s.type.name==="link");((n=p==null?void 0:p.marks)==null?void 0:n.some(s=>s.type.name==="link"))||o?t.value.chain().focus().unsetLink().run():(t.value.state.selection.empty?t.value.chain().focus().insertContent(" ").setTextSelection({from:t.value.state.selection.$from.pos,to:t.value.state.selection.$from.pos+1}).toggleLink({href:""}).setTextSelection({from:t.value.state.selection.$from.pos,to:t.value.state.selection.$from.pos+1}).deleteSelection().run():t.value.chain().focus().setLink({href:""}).selectTextblockEnd().run(),setTimeout(()=>{const s=document.querySelector(".nc-text-area-rich-link-option-input");s&&s.focus()},100))},C=p=>h.value?!k.value.includes(p):!0,Q=p=>!h.value||p.some(o=>!k.value.includes(o));return(p,o)=>{const P=ot,$=ue,L=he,I=et,K=Qe,R=me,q=Ue;return a(),b("div",{class:M(["bubble-menu flex-row gap-x-1 rounded-lg",{"nc-form-field-bubble-menu inline-flex py-0":e(h),"flex bg-gray-100 px-1 py-1":!e(h),"embed-mode":e(x),"full-mode":!e(x),"edit-column-mode":e(z)}])},[r(L,{placement:e(u),disabled:e(t).isActive("codeBlock")},{title:i(()=>[l("div",nn,[l("div",null,f(p.$t("labels.bold")),1),l("div",sn,f(e(d))+" B",1)])]),default:i(()=>[r($,{size:"small",type:"text",class:M({"is-active":e(t).isActive("bold")}),disabled:e(t).isActive("codeBlock"),tabindex:e(m),onClick:o[0]||(o[0]=g=>e(t).chain().focus().toggleBold().run())},{default:i(()=>[r(P)]),_:1},8,["class","disabled","tabindex"])]),_:1},8,["placement","disabled"]),r(L,{placement:e(u),disabled:e(t).isActive("codeBlock")},{title:i(()=>[l("div",on,[l("div",null,f(p.$t("labels.italic")),1),l("div",null,f(e(d))+" I",1)])]),default:i(()=>[r($,{size:"small",type:"text",disabled:e(t).isActive("codeBlock"),class:M({"is-active":e(t).isActive("italic")}),tabindex:e(m),onClick:o[1]||(o[1]=g=>{e(t).chain().focus().toggleItalic().run()})},{default:i(()=>[r(I)]),_:1},8,["disabled","class","tabindex"])]),_:1},8,["placement","disabled"]),r(L,{placement:e(u),disabled:e(t).isActive("codeBlock")},{title:i(()=>[l("div",ln,[l("div",null,f(p.$t("labels.underline")),1),l("div",null,f(e(d))+" U",1)])]),default:i(()=>[r($,{size:"small",type:"text",class:M({"is-active":e(t).isActive("underline")}),disabled:e(t).isActive("codeBlock"),tabindex:e(m),onClick:o[2]||(o[2]=g=>e(t).chain().focus().toggleUnderline().run())},{default:i(()=>[r(K)]),_:1},8,["class","disabled","tabindex"])]),_:1},8,["placement","disabled"]),e(x)&&!e(z)?(a(),A(L,{key:0,placement:e(u),disabled:e(t).isActive("codeBlock")},{title:i(()=>[l("div",an,[l("div",null,f(p.$t("labels.strike")),1),l("div",null,f(e(S))+" "+f(e(d))+" S",1)])]),default:i(()=>[r($,{size:"small",type:"text",class:M({"is-active":e(t).isActive("strike")}),disabled:e(t).isActive("codeBlock"),tabindex:e(m),onClick:o[3]||(o[3]=g=>e(t).chain().focus().toggleStrike().run())},{default:i(()=>[r(e(ft))]),_:1},8,["class","disabled","tabindex"])]),_:1},8,["placement","disabled"])):w("",!0),e(x)&&C(e(H).code)?(a(),A(L,{key:1,placement:e(u)},{title:i(()=>[j(f(p.$t("general.code")),1)]),default:i(()=>[r($,{size:"small",type:"text",tabindex:e(m),class:M({"is-active":e(t).isActive("codeBlock")}),onClick:o[4]||(o[4]=g=>e(t).chain().focus().toggleCodeBlock().run())},{default:i(()=>[r(e(Xt))]),_:1},8,["tabindex","class"])]),_:1},8,["placement"])):w("",!0),(e(h)?C(e(H).quote):!e(x))?(a(),A(L,{key:2,placement:e(u),disabled:e(t).isActive("codeBlock")},{title:i(()=>[j(f(p.$t("general.quote")),1)]),default:i(()=>[r($,{size:"small",type:"text",tabindex:e(m),class:M({"is-active":e(t).isActive("code")}),disabled:e(t).isActive("codeBlock"),onClick:o[5]||(o[5]=g=>e(t).chain().focus().toggleCode().run())},{default:i(()=>[r(e(tn))]),_:1},8,["tabindex","class","disabled"])]),_:1},8,["placement","disabled"])):w("",!0),cn,e(x)&&!e(h)?(a(),b(Y,{key:3},[r(L,null,{title:i(()=>[l("div",rn,[l("div",null,f(p.$t("labels.heading1")),1),l("div",null,f(e(d))+" "+f(e(y))+" 1",1)])]),default:i(()=>[r($,{size:"small",type:"text",class:M({"is-active":e(t).isActive("heading",{level:1})}),onClick:o[6]||(o[6]=g=>e(t).chain().focus().toggleHeading({level:1}).run())},{default:i(()=>[r(e(Ct))]),_:1},8,["class"])]),_:1}),r(L,null,{title:i(()=>[l("div",dn,[l("div",null,f(p.$t("labels.heading2")),1),l("div",null,f(e(d))+" "+f(e(y))+" 2",1)])]),default:i(()=>[r($,{size:"small",type:"text",class:M({"is-active":e(t).isActive("heading",{level:2})}),onClick:o[7]||(o[7]=g=>e(t).chain().focus().toggleHeading({level:2}).run())},{default:i(()=>[r(e(St))]),_:1},8,["class"])]),_:1}),r(L,null,{title:i(()=>[l("div",un,[l("div",null,f(p.$t("labels.heading3")),1),l("div",null,f(e(d))+" "+f(e(y))+" 3",1)])]),default:i(()=>[r($,{size:"small",type:"text",class:M({"is-active":e(t).isActive("heading",{level:3})}),onClick:o[8]||(o[8]=g=>e(t).chain().focus().toggleHeading({level:3}).run())},{default:i(()=>[r(e(qt))]),_:1},8,["class"])]),_:1}),hn],64)):w("",!0),e(x)&&!e(z)&&C(e(H).blockQuote)?(a(),A(L,{key:4,placement:e(u)},{title:i(()=>[j(f(p.$t("labels.blockQuote")),1)]),default:i(()=>[r($,{size:"small",type:"text",tabindex:e(m),class:M({"is-active":e(t).isActive("blockquote")}),onClick:o[9]||(o[9]=g=>e(t).chain().focus().toggleBlockquote().run())},{default:i(()=>[r(e(Dt),{class:"-mt-0.25"})]),_:1},8,["tabindex","class"])]),_:1},8,["placement"])):w("",!0),C(e(H).bulletList)?(a(),A(L,{key:5,placement:e(u)},{title:i(()=>[j(f(p.$t("labels.bulletList")),1)]),default:i(()=>[r($,{size:"small",type:"text",tabindex:e(m),class:M({"is-active":e(t).isActive("bulletList")}),onClick:o[10]||(o[10]=g=>e(t).chain().focus().toggleBulletList().run())},{default:i(()=>[r(e(dt))]),_:1},8,["tabindex","class"])]),_:1},8,["placement"])):w("",!0),C(e(H).numberedList)?(a(),A(L,{key:6,placement:e(u)},{title:i(()=>[j(f(p.$t("labels.numberedList")),1)]),default:i(()=>[r($,{size:"small",type:"text",tabindex:e(m),class:M({"is-active":e(t).isActive("orderedList")}),onClick:o[11]||(o[11]=g=>e(t).chain().focus().toggleOrderedList().run())},{default:i(()=>[r(e(xt))]),_:1},8,["tabindex","class"])]),_:1},8,["placement"])):w("",!0),C(e(H).taskList)?(a(),A(L,{key:7,placement:e(u)},{title:i(()=>[j(f(p.$t("labels.taskList")),1)]),default:i(()=>[r($,{size:"small",type:"text",tabindex:e(m),class:M({"is-active":e(t).isActive("taskList")}),onClick:o[12]||(o[12]=g=>e(t).chain().focus().toggleTaskList().run())},{default:i(()=>[r(e(Mt))]),_:1},8,["tabindex","class"])]),_:1},8,["placement"])):w("",!0),Q([e(H).blockQuote,e(H).bulletList,e(H).numberedList,e(H).taskList])?(a(),b("div",mn)):w("",!0),C(e(H).link)?(a(),A(L,{key:9,placement:e(u),disabled:e(t).isActive("codeBlock")},{title:i(()=>[j(f(p.$t("general.link")),1)]),default:i(()=>[r($,{size:"small",type:"text",class:M({"is-active":e(t).isActive("link")}),disabled:e(t).isActive("codeBlock"),tabindex:e(m),onClick:E},{default:i(()=>[e(h)?(a(),A(R,{key:0,icon:"link2"})):(a(),b("div",vn,[r(q),l("div",fn,f(p.$t("general.link")),1)]))]),_:1},8,["class","disabled","tabindex"])]),_:1},8,["placement","disabled"])):w("",!0)],2)}}}),pn=J({__name:"SelectedBubbleMenuPopup",props:{editor:{}},setup(c){const _=c,t=F(()=>_.editor),x=F(()=>t?!t.value.state.selection.empty:!1),h=B(!1);ve(()=>x.value,d=>{h.value=d},{debounce:200,maxWait:800,immediate:!0});const k=d=>{if(document.elementsFromPoint(d.clientX,d.clientY).some(m=>{var E;return(E=m==null?void 0:m.classList)==null?void 0:E.contains("bubble-menu")}))return;const u=document.querySelector(".nc-textarea-rich-editor");u==null||u.classList.add("bubble-menu-hidden")},z=d=>{document.elementsFromPoint(d.clientX,d.clientY).some(u=>{var m;return(m=u==null?void 0:u.classList)==null?void 0:m.contains("bubble-menu")})||setTimeout(()=>{const u=document.querySelector(".nc-textarea-rich-editor");u==null||u.classList.remove("bubble-menu-hidden")},100)};return ae(()=>{document.addEventListener("mouseup",z),document.addEventListener("mousedown",k)}),fe(()=>{document.removeEventListener("mouseup",z),document.removeEventListener("mousedown",k)}),(d,S)=>{const y=de;return a(),A(e(Ae),{editor:e(t),"update-delay":300,"tippy-options":{duration:100,maxWidth:600}},{default:i(()=>[e(h)?(a(),A(y,{key:0,editor:e(t)},null,8,["editor"])):w("",!0)]),_:1},8,["editor"])}}}),bn=ce.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:c}){return["ul",re(this.options.HTMLAttributes,c,{"data-type":this.name}),0]},addCommands(){return{toggleTaskList:()=>({commands:c})=>c.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}}),_n=/^\s*\[( |x)?\]\s$/i,kn=ce.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList"}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:c=>c.getAttribute("data-checked")==="true",renderHTML:c=>({"data-checked":c.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:c,HTMLAttributes:_}){return["li",re(this.options.HTMLAttributes,_,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:c.attrs.checked?"checked":null}],["span"]],["div",0]]},addKeyboardShortcuts(){const c={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...c,Tab:()=>this.editor.commands.sinkListItem(this.name)}:c},addNodeView(){return({node:c,HTMLAttributes:_,getPos:t,editor:x})=>{const h=document.createElement("li"),k=document.createElement("label"),z=document.createElement("span"),d=document.createElement("input"),S=document.createElement("div");return k.contentEditable="false",d.type="checkbox",d.addEventListener("change",y=>{if(!x.isEditable&&!this.options.onReadOnlyChecked){d.checked=!d.checked;return}const{checked:u}=y.target;x.isEditable&&typeof t=="function"&&x.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:m})=>{const E=t(),C=m.doc.nodeAt(E);return m.setNodeMarkup(E,void 0,{...C==null?void 0:C.attrs,checked:u}),!0}).run(),!x.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(c,u)||(d.checked=!d.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([y,u])=>{h.setAttribute(y,u)}),h.dataset.checked=c.attrs.checked,c.attrs.checked&&d.setAttribute("checked","checked"),k.append(d,z),h.append(k,S),Object.entries(_).forEach(([y,u])=>{h.setAttribute(y,u)}),{dom:h,contentDOM:S,update:y=>y.type!==this.type?!1:(h.dataset.checked=y.attrs.checked,y.attrs.checked?d.setAttribute("checked","checked"):d.removeAttribute("checked"),!0)}}},addInputRules(){return[Be({find:_n,type:this.type,getAttributes:c=>({checked:c[c.length-1].toLowerCase()==="x"})})]}}),xn=["tabindex"],gn={key:0,class:"truncate"},yn={key:0},$n={class:"scrollbar-thin scrollbar-thumb-gray-200 hover:scrollbar-thumb-gray-300 scrollbar-track-transparent"},Ln={key:3,class:"nc-form-field-bubble-menu-wrapper overflow-hidden"},En=J({__name:"RichText",props:{value:{},readOnly:{type:Boolean},syncValueChange:{type:Boolean},showMenu:{type:Boolean},fullMode:{type:Boolean},isFormField:{type:Boolean,default:!1},autofocus:{type:Boolean},placeholder:{},renderAsText:{type:Boolean},hiddenBubbleMenuOptions:{default:()=>[]}},emits:["update:value","focus","blur"],setup(c,{emit:_}){const t=c,x=_,{fullMode:h,isFormField:k,hiddenBubbleMenuOptions:z}=oe(t),d=V(pe,B(!1)),S=V(be,B(1)),y=V(_e,B(!1)),u=V(le,B(!1)),m=V(ke,B(!1)),E=V(xe,B(!1)),C=V(ge,B(!1)),Q=V(ye,B(!1)),p=V($e,B(!1)),o=B(!1),P=Le(),$=F(()=>y.value&&!d.value&&(Q.value||p.value)?6:S.value),L=F(()=>k.value?o.value:!0),I=new Ce({});I.addRule("lineBreak",{filter:n=>n.nodeName==="BR",replacement:()=>"<br />"}),I.addRule("taskList",{filter:n=>n.nodeName==="LI"&&!!n.getAttribute("data-checked"),replacement:(n,s)=>{const T=n.replace(/^\n\n/,"").replace(/\n\n$/,"");return`[${s.getAttribute("data-checked")==="true"?"x":" "}] ${T}

`}}),I.addRule("strikethrough",{filter:["s"],replacement:n=>`~${n}~`}),I.keep(["u","del"]);const K={name:"checkListItem",level:"block",tokenizer(n){if(n=n.split(`

`)[0],n.startsWith("[ ]")||n.startsWith("[x]")||n.startsWith("[X]")){const T=n.startsWith("[ ]");let O=n.slice(3);O[0]===" "&&(O=O.slice(1));const N={type:"checkListItem",raw:n,text:O,tokens:[],checked:!T};return this.lexer.inline(N.text,N.tokens),N}return!1},renderer(n){return`<ul data-type="taskList"><li data-checked="${n.checked?"true":"false"}" data-type="taskItem"><label><input type="checkbox" ${n.checked?'checked="checked"':""}><span></span></label><div>${this.parser.parseInline(n.tokens)}</div></li></ul>`}};ie.use({extensions:[K]});const R=B(null),q=B(null),g=Me(t,"value",x,{defaultValue:""}),U=[He.configure({heading:k.value?!1:void 0}),bn,kn.configure({nested:!0}),ze,Ie,Ve.configure({emptyEditorClass:"is-editor-empty",placeholder:t.placeholder})],v=Se({extensions:U,onUpdate:({editor:n})=>{const s=I.turndown(n.getHTML().replaceAll(/<p><\/p>/g,"<br />")).replaceAll(/\n\n<br \/>\n\n/g,`<br>

`);g.value=s==="<br />"?"":s},editable:!t.readOnly,autofocus:t.autofocus,onFocus:()=>{o.value=!0,x("focus")},onBlur:n=>{var s,T;(T=(s=n==null?void 0:n.event)==null?void 0:s.relatedTarget)!=null&&T.closest(".bubble-menu, .nc-textarea-rich-editor, .nc-rich-text")||(o.value=!1,x("blur"))}}),D=(n,s)=>{if(!v.value)return;const T=v.value.view.state.selection,O=n?ie.parse(n):"<p></p>",N=Oe(O,U);v.value.chain().setContent(N).setTextSelection(T.to).run(),setTimeout(()=>{var W;if(s){const Z=v.value.state.doc.nodeSize;(W=v.value)==null||W.chain().setTextSelection(Z-1).run()}v.value.state.history$.prevRanges=null,v.value.state.history$.done.eventCount=0},100)},G=()=>{var n;m.value&&!k.value&&!t.readOnly&&!P.shift.value&&((n=v.value)==null||n.chain().focus().run())};return t.syncValueChange&&ee([g,v],()=>{var n;D(k.value?(n=g.value||"")==null?void 0:n.replace(/(<br \/>)+$/g,""):g.value)}),k.value&&ee([t,v],()=>{var n,s;t.readOnly?(n=v.value)==null||n.setEditable(!1):(s=v.value)==null||s.setEditable(!0)}),ae(()=>{(h.value||k.value||m.value||u.value)&&(D(g.value,!0),(h.value||C.value)&&we(()=>{var n;(n=v.value)==null||n.chain().focus().run()}))}),te(R,"focusout",n=>{var T;const s=n==null?void 0:n.relatedTarget;((T=s==null?void 0:s.classList)!=null&&T.contains("tiptap")||!(s!=null&&s.closest(".bubble-menu, .tippy-content, .nc-textarea-rich-editor")))&&(o.value=!1,x("blur"))},!0),te(q,"focusout",n=>{var T;const s=n==null?void 0:n.relatedTarget;!s&&((T=n.target)!=null&&T.closest(".bubble-menu, .tippy-content, .nc-textarea-rich-editor"))||s!=null&&s.closest(".bubble-menu, .tippy-content, .nc-textarea-rich-editor")||(o.value=!1,x("blur"))},!0),Te(R,n=>{if(!o.value)return;const s=n==null?void 0:n.target;s!=null&&s.closest(".bubble-menu,.tippy-content, .nc-textarea-rich-editor")||(o.value=!1,x("blur"))}),(n,s)=>{var W;const T=de,O=pn,N=Fe;return a(),b("div",{class:M(["nc-rich-text h-full focus:outline-none",{"flex flex-col flex-grow nc-rich-text-full":e(h),"nc-rich-text-embed flex flex-col pl-1 w-full":!e(h),readonly:n.readOnly,"nc-form-rich-text-field !p-0 relative":e(k),"nc-rich-text-grid":e(E)}]),tabindex:e(y)||e(k)?-1:0,onFocus:G},[n.renderAsText?(a(),b("div",gn,[e(v)?(a(),b("span",yn,f(((W=e(v))==null?void 0:W.getText())??""),1)):w("",!0)])):(a(),b(Y,{key:1},[n.showMenu&&!n.readOnly&&!e(k)?(a(),b("div",{key:0,class:M(["absolute top-0 right-0.5",{"flex rounded-tr-2xl overflow-hidden w-full":e(h)||e(m),"max-w-[calc(100%_-_198px)]":e(h),"justify-start left-0.5":e(m),"justify-end xs:hidden":!e(m)}])},[l("div",$n,[e(v)?(a(),A(T,{key:0,editor:e(v),"embed-mode":"","is-form-field":e(k)},null,8,["editor","is-form-field"])):w("",!0)])],2)):w("",!0),e(v)&&!e(k)&&!e(m)?(a(),A(O,{key:1,editor:e(v)},null,8,["editor"])):w("",!0),e(L)?(a(),b(Y,{key:2},[e(v)?(a(),A(N,{key:0,ref_key:"richTextLinkOptionRef",ref:q,editor:e(v),"is-form-field":e(k),onBlur:s[0]||(s[0]=Z=>o.value=!1)},null,8,["editor","is-form-field"])):w("",!0)],64)):w("",!0),r(e(Ee),{ref_key:"editorDom",ref:R,editor:e(v),class:M(["flex flex-col nc-textarea-rich-editor w-full",{"mt-2.5 flex-grow":e(h),"scrollbar-thin scrollbar-thumb-gray-200 scrollbar-track-transparent":!e(h)||!e(h)&&e(d),"flex-grow":e(d),[`!overflow-hidden nc-truncate nc-line-clamp-${("rowHeightTruncateLines"in n?n.rowHeightTruncateLines:e(Re))(e($))}`]:!e(h)&&n.readOnly&&e($)&&!e(d)&&!e(m)}]),onKeydown:[s[1]||(s[1]=ne(se(()=>{},["alt","stop"]),["enter"])),s[2]||(s[2]=ne(se(()=>{},["shift","stop"]),["enter"]))]},null,8,["editor","class"]),e(k)&&!n.readOnly?(a(),b("div",Ln,[l("div",{class:M(e(o)?"max-h-[50px]":"max-h-0"),style:{transition:"max-height 0.2s ease-in-out"}},[e(v)?(a(),A(T,{key:0,editor:e(v),"embed-mode":"","is-form-field":"","hidden-options":e(z)},null,8,["editor","hidden-options"])):w("",!0)],2)])):w("",!0)],64))],42,xn)}}});export{En as default};
