const __vite__fileDeps=["./CqCTiOFJ.js","./CwyeWFQa.js","./BLdk6lRf.js","./entry.B8GgT5QA.css","./yAvBJhn8.js","./BD_L_KCX.js","./BtPl72f0.js","./DTl_5Njz.js","./CAR_5qDD.js","./C0Si9_oy.js","./ETGzLqdt.js","./DWFLnnq8.js","./BQQOEPN4.js","./Bv-5KQSe.js","./DRbVe3tA.js","./BCErSYDW.js","./KHtB3uuq.js","./wBAlULwF.js","./DCNkOWj0.js","./DIfu2TRl.js","./BrF0EXdL.js","./CBNgcPSC.js","./DTv03lbO.js","./C-Z2v8Hi.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{o as r,c as v,a as s,f as ae,ac as Ie,r as A,ah as he,t as u,P as a,b as c,w as g,d as R,T as te,U as D,al as q,ap as we,_ as de,N as Ae,cG as ye,cP as Te,as as je,bL as Be,d1 as Ee,g as V,d4 as re,gd as _e,cZ as N,an as H,ao as X,F as Re,O as ze,R as G,Q as K,S as E,cD as Oe,X as De,am as ge,A as be,$ as He,ag as We,at as Z,cB as xe,a7 as Je,dh as $e,aS as ke,p as Se,e as Ce,n as Ge,bT as Ke,H as qe,V as Xe,hX as fe,a8 as Ye,Z as Ze,a5 as Qe,aH as et,a2 as tt,ca as at}from"./BLdk6lRf.js";import{a as Me}from"./BtPl72f0.js";import{u as Ue}from"./CwyeWFQa.js";import{R as st,_ as ot}from"./CAR_5qDD.js";import{_ as lt}from"./yAvBJhn8.js";import{_ as nt}from"./ETGzLqdt.js";import{u as ce}from"./Bv-5KQSe.js";import{u as it}from"./DTl_5Njz.js";import{W as rt}from"./DRbVe3tA.js";import{A as ct}from"./BCErSYDW.js";import{_ as dt}from"./BrF0EXdL.js";const ut={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},vt=s("path",{fill:"currentColor",d:"M19 21H8V7h11m0-2H8a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2m-3-4H4a2 2 0 0 0-2 2v14h2V3h12z"},null,-1),pt=[vt];function mt(p,d){return r(),v("svg",ut,[...pt])}const Fe={name:"mdi-content-copy",render:mt},_t={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ft=s("path",{fill:"currentColor",d:"M21 7L9 19l-5.5-5.5l1.41-1.41L9 16.17L19.59 5.59z"},null,-1),ht=[ft];function wt(p,d){return r(),v("svg",_t,[...ht])}const Le={name:"mdi-check",render:wt},yt={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},gt=s("path",{fill:"currentColor",d:"m14.6 16.6l4.6-4.6l-4.6-4.6L16 6l6 6l-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6l6 6z"},null,-1),bt=[gt];function xt(p,d){return r(),v("svg",yt,[...bt])}const $t={name:"mdi-code-tags",render:xt},kt={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},St=s("path",{fill:"currentColor",d:"M10 6v2H5v11h11v-5h2v6a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1zm11-3v8h-2V6.413l-7.793 7.794l-1.414-1.414L17.585 5H13V3z"},null,-1),Ct=[St];function Mt(p,d){return r(),v("svg",kt,[...Ct])}const Ut={name:"ri-external-link-line",render:Mt},Ft={class:"flex flex-row items-center justify-end text-gray-600 gap-x-1.5 py-1.5 px-1.5 bg-gray-50 rounded-md border-1 border-gray-200"},Lt={class:"overflow-hidden whitespace-nowrap text-gray-500"},Vt={class:"flex flex-row gap-x-1"},Nt={class:"flex text-xs",style:{fontWeight:500}},Pt=ae({__name:"CopyUrl",props:{url:{}},emits:["update:url"],setup(p,{emit:d}){const M=Ie(p,"url",d),C=A({link:!1,embed:!1}),{copy:P}=he(),U=async()=>{window.open(M.value,"_blank","noopener,noreferrer")},m=async()=>{await P(`<iframe src="${M.value}" width="100%" height="100%" style="border: none;"></iframe>`),C.value.embed=!0},w=async()=>{C.value.link=!1,await P(M.value),setTimeout(()=>{C.value.link=!0},100)};return(x,f)=>{const t=Ut,F=we,T=$t,O=Le,n=Fe;return r(),v("div",Ft,[s("div",{class:"flex flex-row block flex-1 overflow-hidden pl-3 cursor-pointer",onClick:w},[s("div",Lt,u(a(M)),1)]),s("div",Vt,[c(F,null,{title:g(()=>[R(u(x.$t("activity.openInANewTab")),1)]),default:g(()=>[s("div",{class:"button",onClick:U},[c(t,{class:"h-3.75"})])]),_:1}),c(F,null,{title:g(()=>[R(u(x.$t("activity.copyIFrameCode")),1)]),default:g(()=>[s("div",{class:te(["button",{"!text-gray-300 !border-gray-200 !cursor-not-allowed":a(C).embed}]),onClick:m},[c(T,{class:"h-4"})],2)]),_:1}),s("div",{class:"button","data-testid":"docs-share-page-copy-link",onClick:w},[a(C).link?(r(),D(O,{key:0,class:"h-3.5"})):(r(),D(n,{key:1,class:"h-3.5"})),s("div",Nt,[a(C).link?(r(),v(q,{key:0},[R(u(x.$t("activity.copiedLink")),1)],64)):(r(),v(q,{key:1},[R(u(x.$t("activity.copyUrl")),1)],64))])])])])}}}),It=de(Pt,[["__scopeId","data-v-59632fef"]]),At={class:"flex flex-col py-2 px-3 mb-1"},Tt={class:"flex flex-col w-full mt-2.5 px-3 py-2.5 border-gray-200 border-1 rounded-md gap-y-2"},jt={class:"flex flex-row w-full justify-between py-0.5"},Bt={class:"text-gray-900 font-medium"},Et={class:"mt-0.5 border-t-1 border-gray-100 pt-3"},Rt={class:"flex flex-col justify-between mt-1 py-2 px-3 bg-gray-50 rounded-md"},zt={class:"flex flex-row items-center justify-between"},Ot={class:"flex text-black"},Dt={key:0,class:"flex gap-2 mt-2 w-2/3"},Ht={class:"flex flex-col justify-between gap-y-3 mt-1 py-2 px-3 bg-gray-50 rounded-md"},Wt={key:0,class:"flex flex-row items-center justify-between"},Jt={class:"flex text-black"},Gt={class:"flex flex-row items-center justify-between"},Kt={class:"text-black flex items-center space-x-1"},qt={key:0,class:"flex flex-row items-center justify-between"},Xt={class:"text-black"},Yt={key:0,class:"nc-pre-filled-mode-wrapper flex flex-col justify-between gap-y-3 mt-1 py-2 px-3 bg-gray-50 rounded-md"},Zt={class:"flex flex-row items-center justify-between"},Qt={class:"text-black flex items-center space-x-1"},ea={class:"text-center"},ta={class:"flex-1"},aa=ae({__name:"SharePage",setup(p){const{view:d,$api:z}=Me(),{$e:b}=be(),{getBaseUrl:M,appInfo:C}=Ae(),{dashboardUrl:P}=Ue(),U=ye(),{metas:m}=Te(),w=je(),x=Be(Ee,A(!1)),f=A({public:!1,password:!1,download:!1}),t=V({get:()=>{var e;return typeof((e=d.value)==null?void 0:e.meta)=="string"&&(d.value.meta=JSON.parse(d.value.meta)),d.value},set:e=>{var o;typeof((o=d.value)==null?void 0:o.meta)=="string"&&(d.value.meta=JSON.parse(d.value.meta)),typeof(e==null?void 0:e.meta)=="string"&&(e.meta=JSON.parse(e.meta)),d.value=e}}),F=V(()=>{var e;return!!((e=t.value)!=null&&e.uuid)}),T=V(()=>se()??""),O=A(!1),n=V(()=>{var e;return!!((e=t.value)!=null&&e.password)||O.value}),_=V({get:()=>{var e;return n.value?((e=t.value)==null?void 0:e.password)??"":""},set:async e=>{t.value&&(t.value={...t.value,password:n.value?e:null},B())}}),l=V({get:()=>{var e;return!!((e=t.value)!=null&&e.meta.withTheme)},set:e=>{var o;(o=t.value)!=null&&o.meta&&(t.value.meta={...t.value.meta,withTheme:e},W())}}),i=async()=>{if(O.value=!n.value,!!t.value&&!f.value.password){f.value.password=!0;try{n.value?t.value={...t.value,password:null}:t.value={...t.value,password:""},await B()}finally{f.value.password=!1}}},h=V({get:()=>{var e,o,y,I;return(e=t.value)!=null&&e.meta?(typeof((o=t.value)==null?void 0:o.meta)=="string"&&(t.value.meta=JSON.parse(t.value.meta)),!!((I=(y=t.value)==null?void 0:y.meta)!=null&&I.rtl)):!1},set:e=>{var o,y;(o=t.value)!=null&&o.meta&&(typeof((y=t.value)==null?void 0:y.meta)=="string"&&(t.value.meta=JSON.parse(t.value.meta)),t.value.meta={...t.value.meta,rtl:e},B())}}),L=V({get:()=>{var e,o;return!!((o=(e=t.value)==null?void 0:e.meta)!=null&&o.allowCSVDownload)},set:async e=>{var o;if((o=t.value)!=null&&o.meta){f.value.download=!0;try{t.value.meta={...t.value.meta,allowCSVDownload:e},await Q()}finally{f.value.download=!1}}}}),k=V({get:()=>{var e;return!!((e=t.value)!=null&&e.meta.surveyMode)},set:e=>{var o;(o=t.value)!=null&&o.meta&&(t.value.meta={...t.value.meta,surveyMode:e},ne())}}),$=V({get:()=>{var e,o,y,I;return{preFillEnabled:((o=re((e=t.value)==null?void 0:e.meta))==null?void 0:o.preFillEnabled)??!1,preFilledMode:((I=re((y=t.value)==null?void 0:y.meta))==null?void 0:I.preFilledMode)||_e.Default}},set:e=>{var o;(o=t.value)!=null&&o.meta&&($.value.preFillEnabled!==e.preFillEnabled&&b(`a:view:share:prefilled-mode-${e.preFillEnabled?"enabled":"disabled"}`),$.value.preFilledMode!==e.preFilledMode&&b(`a:view:share:${e.preFilledMode}-prefilled-mode`),t.value.meta={...t.value.meta,...e},ee())}}),j=e=>{$.value={...$.value,...e}};function se(){var I;if(!t.value)return;let e;switch(t.value.type){case N.FORM:e="form";break;case N.KANBAN:e="kanban";break;case N.GALLERY:e="gallery";break;case N.MAP:e="map";break;case N.CALENDAR:e="calendar";break;default:e="view"}const o=M(w.activeWorkspaceId);let y=P.value;return o&&(y=`${o}${(I=C.value)==null?void 0:I.dashboardPath}`),encodeURI(`${y}#/nc/${e}/${t.value.uuid}${k.value?"/survey":""}${U.preFillFormSearchParams&&$.value.preFillEnabled?`?${U.preFillFormSearchParams}`:""}`)}const oe=async()=>{var e,o;if((e=t.value)!=null&&e.id)if((o=t.value)!=null&&o.uuid)await z.dbViewShare.delete(t.value.id),t.value={...t.value,uuid:void 0,password:void 0};else{const y=await z.dbViewShare.create(t.value.id);if(t.value={...t.value,...y},t.value.type===N.KANBAN){const I=m.value[U.activeView.fk_model_id].columns.find(ie=>ie.id===U.activeView.view.fk_grp_col_id);t.value.meta={...t.value.meta,groupingFieldColumn:I},await B()}}},le=async()=>{if(!f.value.public){f.value.public=!0;try{return await oe()}catch(e){H.error(await X(e))}finally{f.value.public=!1}}};async function Q(){f.value.download=!0;try{await B(),b(`a:view:share:${L.value?"enable":"disable"}-csv-download`)}catch(e){H.error(await X(e))}f.value.download=!1}async function ne(){await B(),b(`a:view:share:${k.value?"enable":"disable"}-survey-mode`)}async function W(){await B(),b(`a:view:share:${l.value?"enable":"disable"}-theme`)}async function B(){var e;try{if(!((e=t.value)!=null&&e.meta))return;const o=t.value.meta;await z.dbViewShare.update(t.value.id,{meta:o,password:t.value.password})}catch(o){H.error(await X(o))}return!0}async function ee(){await B()}return Re(()=>{}),(e,o)=>{var pe,me;const y=lt,I=It,ie=nt,ue=He,ve=we,Ne=st,Pe=ot,J=ze("e");return r(),v("div",At,[s("div",Tt,[s("div",jt,[s("div",Bt,u(e.$t("activity.enabledPublicViewing")),1),G(c(y,{checked:a(F),disabled:a(x),loading:a(f).public,class:"share-view-toggle !mt-0.25","data-testid":"share-view-toggle",onClick:le},null,8,["checked","disabled","loading"]),[[J,["c:share:view:enable:toggle"]]])]),a(F)?(r(),v(q,{key:0},[s("div",Et,[c(I,{url:a(T),"onUpdate:url":o[0]||(o[0]=S=>K(T)?T.value=S:null)},null,8,["url"])]),s("div",Rt,[s("div",zt,[s("div",Ot,u(e.$t("activity.restrictAccessWithPassword")),1),G(c(y,{checked:a(n),loading:a(f).password,class:"share-password-toggle !mt-0.25","data-testid":"share-password-toggle",size:"small",onClick:i},null,8,["checked","loading"]),[[J,["c:share:view:password:toggle"]]])]),c(Oe,{mode:"out-in",name:"layout"},{default:g(()=>[a(n)?(r(),v("div",Dt,[c(ie,{value:a(_),"onUpdate:value":o[1]||(o[1]=S=>K(_)?_.value=S:null),placeholder:e.$t("placeholder.password.enter"),class:"!rounded-lg !py-1 !bg-white","data-testid":"nc-modal-share-view__password",size:"small",type:"password"},null,8,["value","placeholder"])])):E("",!0)]),_:1})]),s("div",Ht,[a(t)&&[a(N).GRID,a(N).KANBAN,a(N).GALLERY,a(N).MAP,a(N).CALENDAR].includes(a(t).type)?(r(),v("div",Wt,[s("div",Jt,u(e.$t("activity.allowDownload")),1),G(c(y,{checked:a(L),"onUpdate:checked":o[2]||(o[2]=S=>K(L)?L.value=S:null),loading:a(f).download,class:"public-password-toggle !mt-0.25","data-testid":"share-download-toggle",size:"small"},null,8,["checked","loading"]),[[J,["c:share:view:allow-csv-download:toggle"]]])])):E("",!0),((pe=a(t))==null?void 0:pe.type)===a(N).FORM?(r(),v(q,{key:1},[s("div",Gt,[s("div",Kt,[s("div",null,u(e.$t("activity.surveyMode")),1),c(ve,{class:"flex items-center"},{title:g(()=>[R(u(e.$t("tooltip.surveyFormInfo")),1)]),default:g(()=>[c(ue,{icon:"info",class:"flex-none text-gray-600 cursor-pointer"})]),_:1})]),G(c(y,{checked:a(k),"onUpdate:checked":o[3]||(o[3]=S=>K(k)?k.value=S:null),"data-testid":"nc-modal-share-view__surveyMode",size:"small"},null,8,["checked"]),[[J,["c:share:view:surver-mode:toggle"]]])]),("isEeUI"in e?e.isEeUI:a(De))?E("",!0):(r(),v("div",qt,[s("div",Xt,u(e.$t("activity.rtlOrientation")),1),G(c(y,{checked:a(h),"onUpdate:checked":o[4]||(o[4]=S=>K(h)?h.value=S:null),"data-testid":"nc-modal-share-view__RTL",size:"small"},null,8,["checked"]),[[J,["c:share:view:rtl-orientation:toggle"]]])]))],64)):E("",!0)]),((me=a(t))==null?void 0:me.type)===a(N).FORM?(r(),v("div",Yt,[s("div",Zt,[s("div",Qt,[s("div",null,u(e.$t("activity.preFilledFields.title")),1),c(ve,{class:"flex items-center"},{title:g(()=>[s("div",ea,u(e.$t("tooltip.preFillFormInfo")),1)]),default:g(()=>[c(ue,{icon:"info",class:"flex-none text-gray-600 cursor-pointer"})]),_:1})]),G(c(y,{checked:a($).preFillEnabled,"data-testid":"nc-modal-share-view__preFill",size:"small","onUpdate:checked":o[5]||(o[5]=S=>j({preFillEnabled:S}))},null,8,["checked"]),[[J,["c:share:view:surver-mode:toggle"]]])]),a($).preFillEnabled?(r(),D(Pe,{key:0,value:a($).preFilledMode,class:"nc-modal-share-view-preFillMode","data-testid":"nc-modal-share-view__preFillMode","onUpdate:value":o[6]||(o[6]=S=>j({preFilledMode:S}))},{default:g(()=>[(r(!0),v(q,null,ge(Object.values("PreFilledMode"in e?e.PreFilledMode:a(_e)),S=>(r(),D(Ne,{key:S,value:S},{default:g(()=>[s("div",ta,u(e.$t(`activity.preFilledFields.${S}`)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])):E("",!0)])):E("",!0)],64)):E("",!0)])])}}}),sa={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},oa=s("path",{fill:"currentColor",d:"M21 7L9 19l-5.5-5.5l1.41-1.41L9 16.17L19.59 5.59z"},null,-1),la=[oa];function na(p,d){return r(),v("svg",sa,[...la])}const ia={name:"mdi-tick",render:na},[ra,ca]=it(()=>{const{api:p}=We(),{base:d}=Z(xe()),{$e:z}=be(),{formStatus:b,invitationUsersData:M}=Z(ce()),C=A(1),P=A(10),U=A(""),m=A(null),w=A(null),x=A(0),f=A(!1),t=V(()=>!m.value||!w.value?[]:m.value.filter(n=>{var l;const _=(l=w.value)==null?void 0:l.find(i=>i.id===n.id);return _?n.roles!==_.roles:!1})),F=async(n=C.value,_=P.value)=>{var l,i;try{if(!((l=d.value)!=null&&l.id))return;const h=await p.auth.baseUserList((i=d.value)==null?void 0:i.id,{query:{limit:_,offset:(n-1)*_,query:U.value}});if(!h.users)return;const L=h.users.list.filter(k=>!k.roles);x.value=(h.users.pageInfo.totalRows??0)-Number(L==null?void 0:L.length),m.value?m.value=[...m.value,...h.users.list.filter(k=>k.roles)]:m.value=h.users.list.filter(k=>k.roles),w.value=JSON.parse(JSON.stringify(m.value))}catch(h){H.error(await X(h))}};return{loadUsers:F,inviteUser:async n=>{var l;let _;b.value="base-collaborateSaving";try{if(!((l=d.value)!=null&&l.id))return;_=await p.auth.baseUserAdd(d.value.id,{...n,base_id:d.value.id,baseName:d.value.title}),M.value.invitationToken=_.invite_token,C.value=1,m.value=[],await F()}catch(i){H.error(await X(i)),b.value="collaborate";return}return b.value="base-collaborateSaved",z("a:user:add"),_},users:m,totalUsers:x,searchText:U,currentPage:C,currentLimit:P,editedUsers:t,updateEditedUsers:async n=>{var _,l;n=n||t.value,f.value=!0;try{await Promise.all(n.filter(i=>i.roles!=="No access").map(async i=>{var L;await p.auth.baseUserUpdate(d.value.id,i.id,{email:i.email,roles:i.roles,base_id:d.value.id,baseName:d.value.title});const h=(L=m.value)==null?void 0:L.find(k=>k.id===i.id);h&&(h.roles=i.roles)})),await Promise.all(n.filter(i=>i.roles==="No access").map(async i=>{await p.auth.baseUserRemove(d.value.id,i.id)})),m.value=((_=m.value)==null?void 0:_.filter(i=>i.roles!=="No access"))??[],x.value=((l=m.value)==null?void 0:l.length)??0,w.value=JSON.parse(JSON.stringify(m.value))}catch(i){H.error(await X(i))}finally{f.value=!1}},isBatchUpdating:f}},"useManageUsers");function da(){const p=ca();return p||ra()}const ua={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},va=s("path",{fill:"currentColor",d:"M20 11v2H8l5.5 5.5l-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5L8 11z"},null,-1),pa=[va];function ma(p,d){return r(),v("svg",ua,[...pa])}const _a={name:"mdi-arrow-left",render:ma},Y=p=>(Se("data-v-17ab8da9"),p=p(),Ce(),p),fa={class:"flex flex-col mx-4 h-112"},ha=Y(()=>s("div",{class:"flex mt-2.5 mb-2.5 border-b-1 border-gray-50 pb-1.5",style:{fontWeight:500}},"Manage Members",-1)),wa=Y(()=>s("div",{class:"flex mt-2.5 mb-2.5 text-xs font-bold"},"Base Owner",-1)),ya={key:0,class:"flex flex-row px-2 py-2 items-center gap-x-2 border-1 border-gray-100 rounded-md"},ga={class:"flex flex-col justify-center"},ba={class:"flex",style:{fontWeight:500}},xa=Y(()=>s("div",{class:"flex flex-grow"},null,-1)),$a={class:"flex flex-row mt-4 mb-2 pt-3 border-gray-100 border-t-1 gap-x-3 items-center text-xs"},ka=Y(()=>s("div",{style:{fontWeight:500}},"People with access",-1)),Sa={class:"bg-gray-50 border-gray-100 border-1 py-0.5 px-1.5 rounded-md","data-testid":"nc-manage-user-user-count"},Ca={class:"flex flex-col mb-2 pr-0.5 h-96 overflow-y-auto users-list border-b-1 border-gray-100"},Ma={key:0,class:"text-xs mt-2"},Ua=["data-testid"],Fa={class:"flex flex-row items-center gap-x-2"},La={class:"flex flex-col justify-center"},Va={class:"flex",style:{fontWeight:500}},Na=["data-testid"],Pa={key:0,class:"flex"},Ia={key:1,class:"flex text-red-500",style:{fontWeight:500}},Aa={class:"flex flex-row w-full justify-center mt-2"},Ta=Y(()=>s("span",null,null,-1)),ja={class:"flex flex-row justify-between pt-3 pb-2"},Ba=Y(()=>s("div",null,"Back to Share",-1)),Ea=ae({__name:"ManageUsers",emits:["close"],setup(p,{emit:d}){const z=d,{users:b,totalUsers:M,editedUsers:C,currentPage:P,loadUsers:U,updateEditedUsers:m,isBatchUpdating:w}=da(),x=V(()=>{var n;return(n=b.value)==null?void 0:n.find(_=>{var l;return(l=_.roles)==null?void 0:l.includes("owner")})}),f=V(()=>{var n;return((n=b.value)==null?void 0:n.filter(_=>{var l;return!((l=_.roles)!=null&&l.includes("owner"))}))||[]}),t=()=>{z("close",!1)},F=n=>!n.firstname&&!n.lastname,T=async n=>{var l,i,h;const _=((l=b.value)==null?void 0:l.length)||0;if(((i=b.value)==null?void 0:i.length)===M.value){n.complete();return}if(n.loading(),await U(),P.value+=1,_===((h=b.value)==null?void 0:h.length)){n.complete();return}n.loaded()},O=[{id:"Creator",name:"Creator",value:"creator"},{id:"Editor",name:"Editor",value:"editor"},{id:"Commenter",name:"Commenter",value:"commenter"},{id:"Viewer",name:"Viewer",value:"viewer"},{id:"None",name:"Remove",value:"No access"}];return(n,_)=>{const l=ct,i=dt,h=$e,L=_a,k=ke;return r(),v("div",fa,[ha,wa,a(x)?(r(),v("div",ya,[c(l),s("div",ga,[s("div",ba,u(a(x).firstname)+" "+u(a(x).lastname),1),s("div",{class:te(["flex text-xs",{"text-gray-500":!F(a(x))}])},u(a(x).email),3)])])):E("",!0),xa,s("div",$a,[ka,s("div",Sa,u(a(M)-1)+" users ",1)]),s("div",Ca,[a(f).length===0?(r(),v("div",Ma,"No users have access to this base")):E("",!0),(r(!0),v(q,null,ge(a(f),$=>(r(),v("div",{key:$.id,class:"flex flex-row mb-1.5 px-2 py-1.5 items-center border-1 border-gray-100 rounded-md justify-between","data-testid":`nc-manage-users-${$.email}`},[s("div",Fa,[c(l),s("div",La,[s("div",Va,u($.firstname)+" "+u($.lastname),1),s("div",{class:te(["flex text-xs",{"text-gray-500":!F($)}])},u($.email),3)])]),c(i,{value:$.roles,"onUpdate:value":j=>$.roles=j,class:"flex !rounded-md p-0.5 !bg-white capitalize nc-dropdown-user-role-container !min-w-26","dropdown-class-name":"nc-dropdown-user-role !rounded-md",placeholder:"Select role",options:O},{option:g(j=>[s("div",{class:"flex flex-row items-center gap-x-2","data-testid":`nc-manage-users-role-${j.id!=="None"?j.name:"Remove"}`},[j.id!=="None"?(r(),v("div",Pa,u(j.name),1)):(r(),v("div",Ia,"Remove"))],8,Na)]),_:2},1032,["value","onUpdate:value"])],8,Ua))),128)),c(a(rt),Je(n.$attrs,{onInfinite:T}),{spinner:g(()=>[s("div",Aa,[c(h)])]),complete:g(()=>[Ta]),_:1},16)]),s("div",ja,[s("div",{class:"flex flex-row items-center gap-x-2 px-2 rounded-md cursor-pointer hover:bg-gray-50",onClick:t},[c(L),Ba]),c(k,{type:"primary",class:"!rounded-md",disabled:a(C).length===0,loading:a(w),"data-testid":"nc-manage-users-submit",onClick:_[0]||(_[0]=()=>a(m)())},{default:g(()=>[R(" Save Changes ")]),_:1},8,["disabled","loading"])])])}}}),Ra=de(Ea,[["__scopeId","data-v-17ab8da9"]]),za=Ze(()=>Qe(()=>import("./CqCTiOFJ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]),import.meta.url).then(p=>p.default||p)),Ve=p=>(Se("data-v-f058ff1d"),p=p(),Ce(),p),Oa={key:0,class:"flex flex-row w-full px-5 justify-between items-center py-1"},Da=Ve(()=>s("div",{class:"flex text-base font-bold"},"Adding Members",-1)),Ha={key:1,class:"flex flex-col py-1.5"},Wa={class:"flex flex-row w-full px-5 justify-between items-center py-0.5"},Ja=Ve(()=>s("div",{class:"flex text-base font-medium"},"Members added",-1)),Ga={class:"flex"},Ka={class:"flex flex-row mx-3 mt-2.5 pt-3.5 border-t-1 border-gray-100 justify-end gap-x-2"},qa={key:0,class:"flex flex-row items-center gap-x-1"},Xa={key:1,class:"flex flex-row items-center gap-x-1"},Ya={key:2},Za={key:3,class:"flex flex-col px-1"},Qa={class:"flex flex-row justify-between items-center pb-1 mx-4 mt-3"},es={class:"flex text-base font-medium"},ts={key:0,class:"share-view"},as={class:"flex flex-row items-center gap-x-2 px-4 pt-3 pb-3 select-none"},ss={class:"max-w-79/100 ml-2 px-2 py-0.5 rounded-md bg-gray-100 capitalize text-ellipsis overflow-hidden",style:{wordBreak:"keep-all",whiteSpace:"nowrap"}},os={class:"share-base"},ls={class:"flex flex-row items-center gap-x-2 px-4 pt-3 pb-3 select-none"},ns={class:"max-w-79/100 ml-2 px-2 py-0.5 rounded-md bg-gray-100 capitalize text-ellipsis overflow-hidden",style:{wordBreak:"keep-all",whiteSpace:"nowrap"}},is={class:"flex flex-row justify-end mx-3 mt-1 mb-2 pt-4 gap-x-2"},rs=ae({__name:"View",props:{isViewToolbar:{type:Boolean}},setup(p){const{copy:d}=he(),{dashboardUrl:z}=Ue(),b=xe(),{base:M}=Z(b),{navigateToProjectPage:C}=b,{activeView:P}=Z(ye());let U;if(p.isViewToolbar)try{U=Me().view}catch(l){console.error(l)}const{formStatus:m,showShareModal:w,invitationUsersData:x,isInvitationLinkCopied:f}=Z(ce()),{resetData:t}=ce(),F=A(!1),T=V(()=>x.value.invitationToken?`${z.value}#/signup/${x.value.invitationToken}`:null),O=Ge(Ke,{style:{fontSize:"24px"},spin:!0}),n=async()=>{await d(T.value),f.value=!0},_=async()=>{F.value=!0;try{await C({page:"collaborator"}),w.value=!1}catch(l){console.error(l),H.error("Failed to open manage access")}finally{F.value=!1}};return qe(w,l=>{l||setTimeout(()=>{t()},500)}),(l,i)=>{const h=$e,L=Le,k=ke,$=ia,j=Fe,se=aa,oe=et,le=za,Q=tt,ne=at;return r(),D(ne,{visible:a(w),"onUpdate:visible":i[3]||(i[3]=W=>K(w)?w.value=W:null),class:te(["!top-[1%]",{active:a(w)}]),"wrap-class-name":"nc-modal-share-collaborate",closable:!1,"mask-closable":a(m)!=="base-collaborateSaving","ok-button-props":{hidden:!0},"cancel-button-props":{hidden:!0},footer:null,width:a(m)==="manageCollaborators"?"60rem":"40rem"},{default:g(()=>{var W,B,ee,e;return[a(m)==="base-collaborateSaving"?(r(),v("div",Oa,[Da,c(h,{indicator:a(O)},null,8,["indicator"])])):a(m)==="base-collaborateSaved"?(r(),v("div",Ha,[s("div",Wa,[Ja,s("div",Ga,[c(L)])]),s("div",Ka,[c(k,{type:"text",class:"!border-1 !border-gray-200 !rounded-md",onClick:i[0]||(i[0]=o=>w.value=!1)},{default:g(()=>[R("Close ")]),_:1}),c(k,{type:"text",class:"!border-1 !border-gray-200 !rounded-md","data-testid":"docs-share-invitation-copy","data-invite-link":a(T),onClick:n},{default:g(()=>[a(f)?(r(),v("div",qa,[c($,{class:"h-3.5"}),R(" "+u(l.$t("activity.copiedInviteLink")),1)])):(r(),v("div",Xa,[c(j,{class:"h-3.3"}),R(" "+u(l.$t("activity.copyInviteLink")),1)]))]),_:1},8,["data-invite-link"])])])):a(m)==="manageCollaborators"?(r(),v("div",Ya,[a(m)==="manageCollaborators"?(r(),D(Ra,{key:0,onClose:i[1]||(i[1]=o=>m.value="collaborate")})):E("",!0)])):(r(),v("div",Za,[s("div",Qa,[s("div",es,u(l.$t("activity.share")),1)]),l.isViewToolbar&&a(P)?(r(),v("div",ts,[s("div",as,[(r(),D(Xe((B=("viewIcons"in l?l.viewIcons:a(fe))[(W=a(U))==null?void 0:W.type])==null?void 0:B.icon),{class:"nc-view-icon group-hover",style:Ye({color:(e=("viewIcons"in l?l.viewIcons:a(fe))[(ee=a(U))==null?void 0:ee.type])==null?void 0:e.color})},null,8,["style"])),s("div",null,u(l.$t("activity.shareView")),1),s("div",ss,u(a(P).title),1)]),c(se)])):E("",!0),s("div",os,[s("div",ls,[c(oe,{color:("parseProp"in l?l.parseProp:a(re))(a(M).meta).iconColor,type:a(M).type,class:"nc-view-icon group-hover"},null,8,["color","type"]),s("div",null,u(l.$t("activity.shareBase.label")),1),s("div",ns,u(a(M).title),1)]),c(le)]),s("div",is,[c(Q,{type:"secondary","data-testid":"docs-cancel-btn",onClick:i[2]||(i[2]=o=>w.value=!1)},{default:g(()=>[R(u(l.$t("general.close")),1)]),_:1}),c(Q,{"data-testid":"docs-share-manage-access",type:"secondary",loading:a(F),onClick:_},{default:g(()=>[R(u(l.$t("activity.manageProjectAccess")),1)]),_:1},8,["loading"])])]))]}),_:1},8,["visible","class","mask-closable","width"])}}}),cs=de(rs,[["__scopeId","data-v-f058ff1d"]]),bs=Object.freeze(Object.defineProperty({__proto__:null,default:cs},Symbol.toStringTag,{value:"Module"}));export{bs as V,It as _};
