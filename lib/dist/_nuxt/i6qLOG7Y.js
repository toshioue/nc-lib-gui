const __vite__fileDeps=["./BVggTJcD.js","./DKhUGBot.js","./entry.B8GgT5QA.css","./EmojiPicker.B3qwzTNG.css","./fumUxinc.js","./DyexLzLp.js","./C93sHH2i.js","./Overlay.xLwTZrd0.css","./BqRqK2Ui.js","./CNjr3NNT.js","./CUg8TjpL.js","./View.B2EG4bUV.css","./rHxtj-y2.js","./Da4tsjzA.js","./D1mwehxq.js","./A5pegcqf.js","./Cx8swDhG.js","./MenuItem.C7h59s4s.css","./GAfEgWrt.js","./CzWiRRCe.js","./Divider.DqtSqZhb.css","./CyGutrdy.js","./Menu.CQ8GNWeI.css","./B5mlyM8k.js","./B6xwUs71.js","./DJYXGfCo.js","./DM41s5R0.js","./C6beNF3T.js","./Tabs.DaLSLYpn.css","./B6Ky1gTN.js","./Menu.CgrqNPiu.css","./x2MrpW2k.js","./CGLN1jgb.js","./CSWf2nuO.js","./DZMsOWET.js","./u8rUVe3y.js","./DyY7ABnl.js","./BY49hpjj.js","./DEJjMRn_.js","./DgXVCOuO.js","./Cz8K5PX4.js","./GPQ-Eg6I.js","./BQQOEPN4.js","./BOlDoh1A.js","./BpnlUwoJ.js","./CxxuE4Yq.js","./Du3cTDPI.js","./BKoTI3Jv.js","./D4MBJuiu.js","./BjAi9enL.js","./DX_5E9FR.js","./BumrnQO2.js","./CX4Cv_ut.js","./BaseLogo.BjMH04Ym.css","./DOSyHa8b.js","./Clu_wjSJ.js","./DeleteModal.SEMJ_gSK.css","./DsXhLEQW.js","./DYyLu51D.js","./BtAVuBkh.js","./DNxjIm4c.js","./CnJSG7Ld.js","./__MZlZCo.js","./D_FwWME_.js","./Modal.BNzTaDgC.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{_ as Be,o as t,c as I,cF as $s,f as pe,as as st,at as ee,cG as Ae,cH as he,N as Ce,g as oe,O as je,P as e,b as a,w as o,d as q,t as _,R as Q,U as m,a as n,T as te,S as L,$ as Fe,a2 as Me,ap as Rt,cI as Qe,ai as Jt,ac as Ye,cJ as Aa,cK as yt,au as qe,r as T,cL as qt,H as ze,a_ as Ut,Q as ie,an as ue,ao as Se,aH as ra,aI as Wa,L as Ge,cB as Je,a6 as ca,cM as Qt,cN as At,cO as Is,cP as xt,cQ as qa,aj as Ja,F as Qa,cR as Ts,cS as Ds,aF as pt,A as Pe,ag as zt,ad as Yt,aB as Ya,cT as gt,cU as la,i as wt,ba as Cs,ab as We,cV as Ss,n as De,cW as js,B as mt,bL as Ue,cX as da,cY as Gt,Y as me,cZ as we,c_ as Za,aG as ua,p as Xa,e as es,av as ft,c$ as Vs,d0 as Ms,d1 as Ps,d2 as Ns,a9 as Bs,Z as ht,a5 as kt,al as ye,am as pa,d3 as Es,d4 as _t,aa as Os,M as Ls,ah as ts,d5 as as,d6 as ma,V as ss,W as Us,d7 as Rs,d8 as za,d9 as As,X as at,da as zs,bT as Gs,u as fa,db as os,dc as Fs,cd as Ks,dd as Ga,de as Fa,df as Hs,dg as Ws,dh as qs,di as Js,aS as Qs,aA as Ka,dj as Ys,a1 as Zs,dk as Xs,cp as eo,dl as to,a3 as ao,a4 as so}from"./DKhUGBot.js";import{_ as oo}from"./B8N9lW8c.js";import{u as Zt}from"./DYyLu51D.js";import{S as ns}from"./BjDxmU3z.js";import"./D2ktNk99.js";import{b as no,a as lo}from"./u8rUVe3y.js";import"./Cz8K5PX4.js";import{I as va}from"./GPQ-Eg6I.js";import{F as ia}from"./DyY7ABnl.js";import{_ as ls}from"./BY49hpjj.js";import{u as $t}from"./CSWf2nuO.js";import{_ as io,a as ro,u as Ha,b as is,c as co}from"./CGLN1jgb.js";import{_ as It}from"./Clu_wjSJ.js";import{_ as ba}from"./CzWiRRCe.js";import{C as _a}from"./BqRqK2Ui.js";import{_ as uo}from"./DyexLzLp.js";import{_ as po,u as mo}from"./L5fWsedA.js";import{_ as Ft}from"./Cx8swDhG.js";import{_ as ya}from"./GAfEgWrt.js";import{_ as fo}from"./DsZKLylN.js";import{u as Re}from"./CX32jp6d.js";import{_ as Xt}from"./CyGutrdy.js";import{_ as Kt}from"./B5mlyM8k.js";import{S as rs}from"./C0-Qcoum.js";import{_ as vo}from"./Cx8Z_l6r.js";import{_ as cs}from"./DOSyHa8b.js";import{_ as ds,a as bo,b as _o}from"./BFVZ5oux.js";import{_ as yo,C as go}from"./CBSLUY5f.js";import{I as xo}from"./B-qzO8jF.js";import{D as wo}from"./BtAVuBkh.js";import{_ as ho}from"./BxHuRoBd.js";import{_ as ko}from"./B1s-egFC.js";import{_ as $o}from"./CJgzBHGd.js";import{_ as Io}from"./C600yAEI.js";import{u as us}from"./RV3pJ8Z2.js";import"./D8UTY2yA.js";import"./Bd_WsUAk.js";import"./BOlDoh1A.js";import"./BpnlUwoJ.js";import"./BQQOEPN4.js";import"./CUg8TjpL.js";import"./CxxuE4Yq.js";import"./DgXVCOuO.js";import"./DEJjMRn_.js";import"./DZMsOWET.js";import"./Du3cTDPI.js";import"./BKoTI3Jv.js";import"./D4MBJuiu.js";import"./BjAi9enL.js";import"./DX_5E9FR.js";import"./BumrnQO2.js";import"./CX4Cv_ut.js";import"./CNjr3NNT.js";import"./C93sHH2i.js";import"./ItBATpwr.js";import"./DM41s5R0.js";import"./jbOQaGBo.js";import"./DDp3Vqr0.js";import"./lyxpGZoZ.js";import"./DL47xb_5.js";import"./DFT4Rrrq.js";const To={},Do={class:"flex flex-row flex-grow pl-0.5 pr-1 py-0.5 rounded-md w-full",style:{"max-width":"calc(100% - 2.5rem)"}},Co=$s('<div class="flex-grow min-w-20" data-v-22d00884><div data-testid="nc-workspace-menu" class="flex items-center nc-workspace-menu overflow-hidden py-1.25 pr-0.25 justify-center w-full ml-2" data-v-22d00884><a class="transition-all duration-200 transform w-24 min-w-10" href="https://github.com/nocodb/nocodb" target="_blank" rel="noopener noreferrer" data-v-22d00884><img alt="NocoDB" src="'+oo+'" data-v-22d00884></a><div class="flex flex-grow" data-v-22d00884></div></div></div>',1),So=[Co];function jo(p,j){return t(),I("div",Do,So)}const Vo=Be(To,[["render",jo],["__scopeId","data-v-22d00884"]]),Mo=["data-workspace-title"],Po={key:0,class:"flex flex-row items-center w-full"},No=n("div",{class:"flex flex-grow min-w-1"},null,-1),Bo={class:"flex items-center text-inherit"},Eo={key:1,class:"flex flex-row items-center w-full mt-0.25 ml-2.5 gap-x-3"},Oo=pe({__name:"Header",setup(p){const j=st(),{isLeftSidebarOpen:d}=ee(Zt()),{activeWorkspace:i,isWorkspaceLoading:l}=ee(j),{activeViewTitleOrId:g}=ee(Ae()),{activeTableId:E}=ee(he()),{isMobileMode:A}=Ce(),V=oe(()=>!(A.value&&!g.value&&!E.value));return(x,s)=>{var C;const k=Vo,v=Fe,b=Me,N=Rt,B=ns,c=je("e");return t(),I("div",{class:"flex items-center nc-sidebar-header w-full border-b-1 border-gray-200 group md:px-2 md:py-1.2 xs:px-1 xs:py-1","data-workspace-title":(C=e(i))==null?void 0:C.title,style:{height:"var(--topbar-height)"}},[e(l)?(t(),I("div",Eo,[a(B,{active:!0,class:"!w-6 !h-6 !rounded overflow-hidden"}),a(B,{active:!0,class:"!w-40 !h-6 !rounded overflow-hidden"})])):(t(),I("div",Po,[a(k),No,a(N,{class:te(["flex",{"!opacity-100":!e(d)}]),placement:"bottom","hide-on-click":""},{title:o(()=>[q(_(e(d)?`${x.$t("title.hideSidebar")}`:`${x.$t("title.showSidebar")}`),1)]),default:o(()=>[e(V)?Q((t(),m(b,{key:0,type:e(A)?"secondary":"text",size:e(A)?"medium":"small",class:"nc-sidebar-left-toggle-icon !text-gray-700 !hover:text-gray-800 !xs:h-10.5 !xs:max-h-10.5 !xs:max-w-10.5 !md:hover:bg-gray-200",onClick:s[0]||(s[0]=r=>d.value=!e(d))},{default:o(()=>[n("div",Bo,[e(A)?(t(),m(v,{key:0,icon:"close"})):(t(),m(v,{key:1,icon:"doubleLeftArrow",class:te(["duration-150 transition-all !text-lg -mt-0.5 !text-gray-500/75",{"transform rotate-180":!e(d)}])},null,8,["class"]))])]),_:1},8,["type","size"])),[[c,["c:leftSidebar:hideToggle"]]]):L("",!0)]),_:1},8,["class"])]))],8,Mo)}}}),Lo={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Uo=n("path",{fill:"currentColor",d:"m19.6 21l-6.3-6.3q-.75.6-1.725.95T9.5 16q-2.725 0-4.612-1.888T3 9.5t1.888-4.612T9.5 3t4.613 1.888T16 9.5q0 1.1-.35 2.075T14.7 13.3l6.3 6.3zM9.5 14q1.875 0 3.188-1.312T14 9.5t-1.312-3.187T9.5 5T6.313 6.313T5 9.5t1.313 3.188T9.5 14"},null,-1),Ro=[Uo];function Ao(p,j){return t(),I("svg",Lo,[...Ro])}const zo={name:"material-symbols-search",render:Ao},Go={class:"flex items-center gap-2"},Fo=n("div",{class:"inline-flex gap-1 justify-center text-xs px-[8px] py-[1px] uppercase border-1 border-gray-300 rounded-md bg-slate-150 text-gray-500"},[n("kbd",{class:"text-[16px] mt-[0.5px]"},"âŒ˜"),n("kbd",{class:"!leading-4"},"K")],-1),Ko=pe({__name:"Header",setup(p){const{commandPalette:j}=Qe();return(d,i)=>{const l=zo,g=Me,E=je("e");return Q((t(),m(g,{type:"text",size:"xsmall",class:"nc-sidebar-top-button w-full !hover:bg-gray-200 !rounded-md !xs:hidden !h-7 my-0.5","data-testid":"nc-sidebar-search-btn",centered:!1,onClick:i[0]||(i[0]=A=>{var V;return(V=e(j))==null?void 0:V.open()})},{default:o(()=>[n("div",Go,[a(l,{class:"!h-3.9"}),q(" Quick Actions "),Fo])]),_:1})),[[E,["c:quick-actions"]]])}}}),Ho={class:"flex flex-row items-center text-base text-gray-800"},Wo={class:"mt-1"},qo={class:"flex flex-row justify-end mt-5 gap-x-2"},Jo=pe({__name:"CreateProjectDlg",props:{modelValue:{type:Boolean},type:{}},emits:["update:modelValue"],setup(p,{emit:j}){const d=p,i=j,{t:l}=Jt(),g=Ye(d,"modelValue",i),E=Aa(()=>d.type??yt.DB),A=qe(),{createProject:V}=A,{navigateToProject:x}=Ce(),{refreshCommandPalette:s}=Qe(),k=[{required:!0,message:l("msg.info.dbNameRequired")},no],v=T(),b=T({title:"",meta:{iconColor:qt[Math.floor(Math.random()*1e3)%qt.length]}}),N=T(!1),B=async()=>{b.value.title&&(b.value.title=b.value.title.trim()),N.value=!0;try{const r=await V({type:E.value,title:b.value.title,meta:b.value.meta});x({baseId:r.id,type:E.value,workspaceId:"nc"}),g.value=!1}catch(r){ue.error(await Se(r))}finally{setTimeout(()=>{N.value=!1},500),s()}},c=T();ze(g,async(r,u)=>{r===u&&!r||setTimeout(async()=>{var w,U,$,z,P;(w=v.value)==null||w.resetFields(),b.value={title:"Base",meta:{iconColor:qt[Math.floor(Math.random()*1e3)%qt.length]}},await Ut(),($=(U=c.value)==null?void 0:U.$el)==null||$.focus(),(P=(z=c.value)==null?void 0:z.$el)==null||P.select()},5)});const C=Aa(()=>{switch(E.value){case yt.DB:default:return"Base"}});return(r,u)=>{const w=ra,U=va,$=ls,z=ia,P=Me,H=Wa,O=je("e");return t(),m(H,{visible:e(g),"onUpdate:visible":u[2]||(u[2]=h=>ie(g)?g.value=h:null),size:"small","show-separator":!1},{header:o(()=>[n("div",Ho,[a(w,{color:e(b).meta.iconColor,type:e(E),class:"mr-2.5 !text-lg !h-4"},null,8,["color","type"]),q(" "+_(r.$t("general.createEntity",{entity:e(C)})),1)])]),default:o(()=>[n("div",Wo,[a(z,{ref_key:"form",ref:v,model:e(b),name:"basic",layout:"vertical",class:"w-full !mx-auto","no-style":"",autocomplete:"off",onFinish:B},{default:o(()=>[a($,{name:"title",rules:k,class:"!mb-0"},{default:o(()=>[a(U,{ref_key:"input",ref:c,value:e(b).title,"onUpdate:value":u[0]||(u[0]=h=>e(b).title=h),name:"title",class:"nc-metadb-base-name nc-input-sm nc-input-shadow",placeholder:"Title"},null,8,["value"])]),_:1})]),_:1},8,["model"]),n("div",qo,[a(P,{type:"secondary",size:"small",onClick:u[1]||(u[1]=h=>g.value=!1)},{default:o(()=>[q(_(r.$t("general.cancel")),1)]),_:1}),Q((t(),m(P,{"data-testid":"docs-create-proj-dlg-create-btn",loading:e(N),type:"primary",size:"small",label:`${r.$t("general.create")} ${e(C)}`,"loading-label":`${r.$t("general.creating")} ${e(C)}`,onClick:B},{loading:o(()=>[q(_(r.$t("general.creatingEntity",{entity:e(C)})),1)]),default:o(()=>[q(_(r.$t("general.createEntity",{entity:e(C)}))+" ",1)]),_:1},8,["loading","label","loading-label"])),[[O,["a:base:create"]]])])])]),_:1},8,["visible"])}}}),ga=Be(Jo,[["__scopeId","data-v-8f24b62a"]]),Qo=pe({__name:"CreateProjectBtn",props:{activeWorkspaceId:{},modal:{type:Boolean},type:{},isOpen:{type:Boolean},size:{},centered:{type:Boolean}},setup(p){const j=p,{isUIAllowed:d}=Ge(),{orgRoles:i,workspaceRoles:l}=Ge(),g=Je(),{isSharedBase:E}=ee(g),A=st();ee(A);const V=T(!1),x=oe(()=>j.size||"small"),s=oe(()=>j.centered??!0);return(k,v)=>{const b=ga,N=Me,B=je("e");return e(d)("baseCreate",{roles:e(l)??e(i)})&&!e(E)?Q((t(),m(N,{key:0,type:"text",size:e(x),centered:e(s),onClick:v[1]||(v[1]=c=>V.value=!0)},{default:o(()=>[ca(k.$slots,"default"),a(b,{modelValue:e(V),"onUpdate:modelValue":v[0]||(v[0]=c=>ie(V)?V.value=c:null)},null,8,["modelValue"])]),_:3},8,["size","centered"])),[[B,["c:base:create"]]]):L("",!0)}}}),Yo={key:0,class:"flex flex-col w-full gap-y-3.75 ml-3 mt-3.75"},Zo={key:0,class:"flex flex-row items-center w-full gap-x-3"},Xo={class:"flex flex-row items-center w-full gap-x-3"},en={class:"flex flex-row items-center w-full gap-x-3"},tn={key:1,class:"xs:hidden flex flex-col p-1 mt-0.25 mb-0.5 truncate"},an={class:"gap-x-2 flex flex-row w-full items-center !font-normal"},sn={class:"flex"},on=pe({__name:"TopSection",setup(p){const j=st(),d=Je(),{isUIAllowed:i}=Ge(),{appInfo:l}=Ce(),{meta:g,control:E}=Qt(),{isWorkspaceLoading:A,isWorkspaceSettingsPageOpened:V}=ee(j),{navigateToWorkspaceSettings:x}=j,{isSharedBase:s}=ee(d),k=T(!1),v=()=>{const b=At()?g.value:E.value;x("",b)};return(b,N)=>{const B=ns,c=Ko,C=Fe,r=Me,u=Qo,w=je("e");return e(A)?(t(),I("div",Yo,[e(l).ee?(t(),I("div",Zo,[a(B,{active:!0,class:"!w-4 !h-4 !rounded overflow-hidden"}),a(B,{active:!0,class:"!w-40 !h-4 !rounded overflow-hidden"})])):L("",!0),n("div",Xo,[a(B,{active:!0,class:"!w-4 !h-4 !rounded overflow-hidden"}),a(B,{active:!0,class:"!w-40 !h-4 !rounded overflow-hidden"})]),n("div",en,[a(B,{active:!0,class:"!w-4 !h-4 !rounded overflow-hidden"}),a(B,{active:!0,class:"!w-40 !h-4 !rounded overflow-hidden"})])])):e(s)?L("",!0):(t(),I("div",tn,[a(c),e(i)("workspaceSettings")?Q((t(),m(r,{key:0,type:"text",size:"xsmall",class:te(["nc-sidebar-top-button !xs:hidden my-0.5 !h-7",{"!text-brand-600 !bg-brand-50 !hover:bg-brand-50":e(V),"!hover:bg-gray-200 !hover:text-gray-700":!e(V)}]),"data-testid":"nc-sidebar-team-settings-btn",centered:!1,onClick:v},{default:o(()=>[n("div",{class:te(["flex items-center gap-2",{"font-semibold":e(V)}])},[a(C,{icon:"settings",class:"!h-4"}),n("div",null,_(b.$t("title.teamAndSettings")),1)],2)]),_:1},8,["class"])),[[w,["c:team:settings"]]]):L("",!0),a(u,{"is-open":e(k),"onUpdate:isOpen":N[0]||(N[0]=U=>ie(k)?k.value=U:null),modal:"",type:"text",class:"nc-sidebar-top-button !hover:bg-gray-200 !hover:text-gray-700 !xs:hidden !h-7 my-0.5","data-testid":"nc-sidebar-create-base-btn"},{default:o(()=>[n("div",an,[a(C,{icon:"plus"}),n("div",sn,_(b.$t("title.createBase")),1)])]),_:1},8,["is-open"])]))}}}),nn=Be(on,[["__scopeId","data-v-dd22f8df"]]),ln={class:"flex flex-row items-center gap-x-2"},rn={class:"mt-1"},cn={class:"flex flex-row justify-end gap-x-2 mt-5"},dn=pe({__name:"TableRename",props:{modelValue:{type:Boolean},tableMeta:{},sourceId:{}},emits:["update:modelValue","updated"],setup(p,{emit:j}){const d=Is(p,["tableMeta","sourceId"]),i=j,{$e:l,$api:g}=Pe(),{setMeta:E}=xt(),A=Ye(d,"modelValue",i),{updateTab:V}=$t(),{loadProjectTables:x}=he(),s=Je(),{loadTables:k,isMysql:v,isMssql:b,isPg:N}=s,{tables:B,base:c}=ee(s),{allRecentViews:C}=ee(Ae()),{refreshCommandPalette:r}=Qe(),{addUndo:u,defineProjectScope:w}=qa(),U=T(),$=T(!1),z=ia.useForm,P=Ja({title:""}),H=oe(()=>({title:[lo,{validator:(M,D)=>new Promise((R,K)=>{var Y;let ne=255;if(v(p.sourceId)?ne=64:N(p.sourceId)?ne=63:b(p.sourceId)&&(ne=128),((((Y=c==null?void 0:c.value)==null?void 0:Y.prefix)||"")+D).length>ne)return K(new Error(`Table name exceeds ${ne} characters`));R()})},{validator:(M,D)=>new Promise((R,K)=>{if(!((B==null?void 0:B.value)||[]).every(ne=>ne.id===p.tableMeta.id||ne.title.toLowerCase()!==((D==null?void 0:D.trim())||"").toLowerCase()))return K(new Error("Duplicate table alias"));R()})}]})),{validateInfos:O}=z(P,H);Qa(()=>{var M;(M=p.tableMeta)!=null&&M.title&&(P.title=`${p.tableMeta.title}`),Ut(()=>{var R;const D=(R=U.value)==null?void 0:R.$el;D&&(D.setSelectionRange(0,P.title.length),D.focus())})},{flush:"post"});const h=async(M=!1,D)=>{if(p.tableMeta&&(P.title&&(P.title=P.title.trim()),!(P.title===p.tableMeta.title&&!D))){$.value=!0;try{await g.dbTable.update(p.tableMeta.id,{base_id:p.tableMeta.base_id,table_name:P.title,title:P.title}),A.value=!1,await x(p.tableMeta.base_id,!0),M||u({redo:{fn:K=>{P.title=K,h(!0,!0)},args:[P.title]},undo:{fn:K=>{P.title=K,h(!0,!0)},args:[p.tableMeta.title]},scope:w({model:p.tableMeta})}),await k(),C.value=C.value.map(K=>(K.tableID===p.tableMeta.id&&(K.isDefault&&(K.viewName=P.title),K.tableName=P.title),K));const R=await g.dbTable.read(p.tableMeta.id);await E(R),V({id:p.tableMeta.id},{title:R.title}),r(),l("a:table:rename"),A.value=!1}catch(R){ue.error(await Se(R))}$.value=!1}};return(M,D)=>{const R=Fe,K=va,ne=ls,F=ia,Y=Me,ce=Wa;return t(),m(ce,{visible:e(A),"onUpdate:visible":D[4]||(D[4]=ve=>ie(A)?A.value=ve:null),size:"small","show-separator":!1},{header:o(()=>[n("div",ln,[a(R,{icon:"rename"}),q(" "+_(M.$t("activity.renameTable")),1)])]),default:o(()=>{var ve;return[n("div",rn,[a(F,{model:e(P),name:"create-new-table-form"},{default:o(()=>[a(ne,Ts(Ds(e(O).title)),{default:o(()=>[a(K,{ref_key:"inputEl",ref:U,value:e(P).title,"onUpdate:value":D[0]||(D[0]=ke=>e(P).title=ke),class:"nc-input-sm nc-input-shadow","hide-details":"",size:"small",placeholder:M.$t("msg.info.enterTableName"),onKeydown:D[1]||(D[1]=pt(()=>h(),["enter"]))},null,8,["value","placeholder"])]),_:1},16)]),_:1},8,["model"]),n("div",cn,[a(Y,{type:"secondary",size:"small",onClick:D[2]||(D[2]=ke=>A.value=!1)},{default:o(()=>[q(_(M.$t("general.cancel")),1)]),_:1}),a(Y,{key:"submit",type:"primary",size:"small",disabled:e(O).title.validateStatus==="error"||((ve=e(P).title)==null?void 0:ve.trim())===M.tableMeta.title,label:"Rename Table","loading-label":"Renaming Table",loading:e($),onClick:D[3]||(D[3]=()=>h())},{loading:o(()=>[q(_(M.$t("title.renamingTable")),1)]),default:o(()=>[q(_(M.$t("title.renameTable"))+" ",1)]),_:1},8,["disabled","loading"])])])]}),_:1},8,["visible"])}}}),un={class:"mt-5"},pn={class:"prose-md self-center text-gray-500 mt-4"},mn={class:"text-xs p-2"},fn={class:"flex flex-row gap-x-2 mt-2.5 pt-2.5 justify-end"},vn=pe({__name:"TableDuplicate",props:{modelValue:{type:Boolean},table:{}},emits:["update:modelValue"],setup(p,{emit:j}){const d=p,i=j,{api:l}=zt(),g=Ye(d,"modelValue",i),{addTab:E}=$t(),{$e:A,$poller:V}=Pe();qe();const{openTable:x}=he(),s=Je(),{loadTables:k}=s,{tables:v}=ee(s),{getMeta:b}=xt(),{t:N}=Jt();ee(he());const{refreshCommandPalette:B}=Qe(),c=T({includeData:!0,includeViews:!0,includeHooks:!0}),C=oe(()=>{const{includeData:U,includeViews:$,includeHooks:z}=c.value;return{excludeData:!U,excludeViews:!$,excludeHooks:!z}}),r=T(!1),u=async()=>{try{r.value=!0;const U=await l.dbTable.duplicate(d.table.base_id,d.table.id,{options:C.value});V.subscribe({id:U.id},async $=>{var z;if($.status!=="close")if($.status===gt.COMPLETED){const P=await b(d.table.id);if(P){for(const O of P.columns||[])if([la.Links,la.LinkToAnotherRecord].includes(O.uidt)&&O&&O.colOptions){const h=(z=O.colOptions)==null?void 0:z.fk_related_model_id;h&&await b(h,!0)}}await k(),B();const H=v.value.find(O=>{var h,M;return O.id===((M=(h=$==null?void 0:$.data)==null?void 0:h.result)==null?void 0:M.id)});H&&E({title:H.title,id:H.id,type:H.type}),x(H),r.value=!1,g.value=!1}else $.status===gt.FAILED&&(ue.error(N("msg.error.failedToDuplicateTable")),await k(),r.value=!1,g.value=!1)}),A("a:table:duplicate")}catch(U){ue.error(await Se(U)),r.value=!1,g.value=!1}};Yt("Enter",()=>{g.value&&u()});const w=T(!1);return(U,$)=>{const z=ba,P=_a,H=Me,O=It,h=je("e");return t(),m(O,{visible:e(g),"onUpdate:visible":$[5]||($[5]=M=>ie(g)?g.value=M:null),class:te([{active:e(g)},"!w-[30rem]"]),"mask-closable":!e(r),keyboard:!e(r),centered:"","wrap-class-name":"nc-modal-table-duplicate",footer:null,onKeydown:$[6]||($[6]=pt(M=>g.value=!1,["esc"]))},{default:o(()=>[n("div",null,[n("div",{class:"font-medium text-lg text-gray-800 self-center",onDblclick:$[0]||($[0]=M=>w.value=!e(w))},_(U.$t("general.duplicate"))+" "+_(U.$t("objects.table")),33),n("div",un,_(U.$t("msg.warning.duplicateTable")),1),n("div",pn,_(U.$t("title.advancedSettings")),1),a(z,{class:"!m-0 !p-0 !my-2"}),n("div",mn,[a(P,{checked:e(c).includeData,"onUpdate:checked":$[1]||($[1]=M=>e(c).includeData=M),disabled:e(r)},{default:o(()=>[q(_(U.$t("labels.includeData")),1)]),_:1},8,["checked","disabled"]),a(P,{checked:e(c).includeViews,"onUpdate:checked":$[2]||($[2]=M=>e(c).includeViews=M),disabled:e(r)},{default:o(()=>[q(_(U.$t("labels.includeView")),1)]),_:1},8,["checked","disabled"]),Q(a(P,{checked:e(c).includeHooks,"onUpdate:checked":$[3]||($[3]=M=>e(c).includeHooks=M),disabled:e(r)},{default:o(()=>[q(_(U.$t("labels.includeWebhook")),1)]),_:1},8,["checked","disabled"]),[[Ya,e(w)]])])]),n("div",fn,[e(r)?L("",!0):(t(),m(H,{key:"back",type:"secondary",size:"small",onClick:$[4]||($[4]=M=>g.value=!1)},{default:o(()=>[q(_(U.$t("general.cancel")),1)]),_:1})),Q((t(),m(H,{key:"submit",type:"primary",size:"small",loading:e(r),onClick:u},{default:o(()=>[q(_(U.$t("general.confirm")),1)]),_:1},8,["loading"])),[[h,["a:table:duplicate"]]])])]),_:1},8,["visible","class","mask-closable","keyboard"])}}}),bn={class:"h-[80vh]"},_n=pe({__name:"ProjectErd",props:{baseId:{},sourceId:{},modelValue:{type:Boolean}},emits:["update:modelValue"],setup(p,{emit:j}){const d=p,l=Ye(d,"modelValue",j),g=oe(()=>d.sourceId),{openedProject:E}=ee(qe()),{baseTables:A}=ee(he()),{loadProjectTables:V}=he(),x=T(!0),{getMeta:s}=xt(),k=oe(()=>{var v;return d.baseId||((v=E.value)==null?void 0:v.id)});return wt(async()=>{if(k.value&&A.value.get(k.value))return x.value=!1;try{await V(k.value),await Promise.all(A.value.get(k.value).map(async v=>{await s(v.id,!1,!1,k.value)}))}catch(v){console.error(v)}finally{x.value=!1}}),(v,b)=>{const N=uo,B=It;return t(),m(B,{visible:e(l),"onUpdate:visible":b[0]||(b[0]=c=>ie(l)?l.value=c:null),size:"large"},{default:o(()=>[n("div",bn,[e(x)?L("",!0):(t(),m(N,{key:0,"source-id":e(g),"base-id":e(k),"show-all-columns":!1},null,8,["source-id","base-id"]))])]),_:1},8,["visible"])}}}),yn={class:"p-6 h-full"},gn=pe({__name:"ProjectAudit",props:{workspaceId:{},baseId:{},sourceId:{},modelValue:{type:Boolean},bordered:{type:Boolean}},emits:["update:modelValue"],setup(p,{emit:j}){const d=p,l=Ye(d,"modelValue",j),{workspaceId:g,sourceId:E,bordered:A}=Cs(d),{openedProject:V}=ee(qe()),{baseTables:x}=ee(he()),{loadProjectTables:s}=he(),k=T(!0),{getMeta:v}=xt(),b=oe(()=>{var N;return d.baseId||((N=V.value)==null?void 0:N.id)});return wt(async()=>{if(b.value&&x.value.get(b.value))return k.value=!1;try{await s(b.value),await Promise.all(x.value.get(b.value).map(async N=>{await v(N.id,!1,!1,b.value)}))}catch(N){ue.error("Failed to load tables/bases. Please try again later."),console.error(N)}finally{k.value=!1}}),(N,B)=>{const c=po,C=It;return t(),m(C,{visible:e(l),"onUpdate:visible":B[0]||(B[0]=r=>ie(l)?l.value=r:null),size:"xl",class:"!top-[5vh] lg:!max-w-[calc(100vw_-_64px)]",width:"96.95rem"},{default:o(()=>[n("div",yn,[e(k)?L("",!0):(t(),m(c,{key:0,"workspace-id":e(g),"source-id":e(E),"base-id":e(b),bordered:e(A)},null,8,["workspace-id","source-id","base-id","bordered"]))])]),_:1},8,["visible"])}}}),xn={class:"flex gap-2 items-center"},wn={class:"ml-0.5"},hn={class:"flex gap-2 items-center"},kn={class:"flex gap-2 items-center"},$n={class:"flex gap-2 items-center"},In=pe({__name:"BaseOptions",props:{source:{},base:{}},setup(p){const j=p,d=We(j,"source"),i=We(j,"base"),{isUIAllowed:l}=Ge(),g=oe(()=>i.value.project_role||i.value.workspace_role),{$e:E}=Pe();function A(x,s){if(!x||!s)return;E("a:actions:import-airtable");const k=T(!0),{close:v}=Re(io,{modelValue:k,baseId:x,sourceId:s,"onUpdate:modelValue":b});function b(){k.value=!1,v(1e3)}}function V(x){var b;if(!((b=d.value)!=null&&b.id)||!d.value.base_id)return;E(`a:actions:import-${x}`);const s=T(!0),{close:k}=Re(ro,{modelValue:s,importType:x,baseId:d.value.base_id,sourceId:d.value.id,"onUpdate:modelValue":v});function v(){s.value=!1,k(1e3)}}return(x,s)=>{const k=Fe,v=Ft,b=fo,N=je("e");return t(),m(b,{class:"py-0","data-testid":"nc-sidebar-base-import"},{title:o(()=>[a(k,{icon:"download"}),q(" "+_(x.$t("labels.importData")),1)]),expandIcon:o(()=>[]),default:o(()=>[e(l)("airtableImport",{roles:e(g),source:e(d)})?(t(),m(v,{key:"quick-import-airtable",onClick:s[0]||(s[0]=B=>A(e(d).base_id,e(d).id))},{default:o(()=>[Q((t(),I("div",xn,[a(k,{icon:"airtable",class:"max-w-3.75 group-hover:text-black"}),n("div",wn,_(x.$t("labels.airtable")),1)])),[[N,["c:import:airtable"]]])]),_:1})):L("",!0),e(l)("csvImport",{roles:e(g),source:e(d)})?(t(),m(v,{key:"quick-import-csv",onClick:s[1]||(s[1]=B=>V("csv"))},{default:o(()=>[Q((t(),I("div",hn,[a(k,{icon:"csv",class:"w-4 group-hover:text-black"}),q(" "+_(x.$t("labels.csvFile")),1)])),[[N,["c:import:csv"]]])]),_:1})):L("",!0),e(l)("jsonImport",{roles:e(g),source:e(d)})?(t(),m(v,{key:"quick-import-json",onClick:s[2]||(s[2]=B=>V("json"))},{default:o(()=>[Q((t(),I("div",kn,[a(k,{icon:"code",class:"w-4 group-hover:text-black"}),q(" "+_(x.$t("labels.jsonFile")),1)])),[[N,["c:import:json"]]])]),_:1})):L("",!0),e(l)("excelImport",{roles:e(g),source:e(d)})?(t(),m(v,{key:"quick-import-excel",onClick:s[3]||(s[3]=B=>V("excel"))},{default:o(()=>[Q((t(),I("div",$n,[a(k,{icon:"excel",class:"max-w-4 group-hover:text-black"}),q(" "+_(x.$t("labels.microsoftExcel")),1)])),[[N,["c:import:excel"]]])]),_:1})):L("",!0)]),_:1})}}}),Tn={key:0,class:"flex flex-row items-center py-2.25 px-2.5 bg-gray-50 rounded-lg text-gray-700"},Dn={class:"capitalize text-ellipsis overflow-hidden select-none w-full pl-1.75",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},ps=pe({__name:"TableDelete",props:{visible:{type:Boolean},tableId:{},baseId:{}},emits:["update:visible"],setup(p,{emit:j}){const d=p,l=Ye(d,"visible",j),{$e:g,$api:E}=Pe(),{closeTab:A}=$t(),{getMeta:V,removeMeta:x}=xt(),{loadTables:s,baseUrl:k,isXcdbBase:v}=Je(),{refreshCommandPalette:b}=Qe(),{removeFromRecentViews:N}=Ae(),{baseTables:B,activeTable:c}=ee(he()),{openTable:C}=he(),r=oe(()=>B.value.get(d.baseId)??[]),u=oe(()=>r.value.find($=>$.id===d.tableId)),w=T(!1),U=async()=>{var P,H;if(!u.value)return;const $=JSON.parse(JSON.stringify(u.value)),z=(P=c.value)==null?void 0:P.id;w.value=!0;try{const O=await V($.id,!0),h=(H=O==null?void 0:O.columns)==null?void 0:H.filter(D=>D.uidt===la.LinkToAnotherRecord&&!Ss(D));if(h!=null&&h.length&&!v($.source_id)){const D=await Promise.all(h.map(async(R,K)=>{var F;const ne=await V((F=R==null?void 0:R.colOptions)==null?void 0:F.fk_related_model_id);return`${K+1}. ${R.title} is a LinkToAnotherRecord of ${ne&&ne.title||R.title}`}));ue.info(De("div",{innerHTML:`<div style="padding:10px 4px">Unable to delete tables because of the following.
              <br><br>${D.join("<br>")}<br><br>
              Delete them & try again</div>`}));return}if(await E.dbTable.delete($.id),await A({type:js.TABLE,id:$.id,title:$.title}),await s(),N({baseId:d.baseId,tableId:$.id}),x($.id),b(),g("a:table:delete"),z===$.id){const D=r.value.filter(R=>R.source_id===$.source_id);D.length===0?await mt(k({id:d.baseId,type:"database"})):await C(D[0])}const M=r.value.findIndex(D=>D.id===$.id);M>-1&&r.value.splice(M,1),l.value=!1}catch(O){ue.error(await Se(O))}finally{w.value=!1}};return($,z)=>{const P=vo,H=cs;return t(),m(H,{visible:e(l),"onUpdate:visible":z[0]||(z[0]=O=>ie(l)?l.value=O:null),"entity-name":$.$t("objects.table"),"on-delete":U},{"entity-preview":o(()=>[e(u)?(t(),I("div",Tn,[a(P,{meta:e(u),class:"nc-view-icon"},null,8,["meta"]),n("div",Dn,_(e(u).title),1)])):L("",!0)]),_:1},8,["visible","entity-name"])}}}),ea=p=>(Xa("data-v-15851779"),p=p(),es(),p),Cn={class:"item","data-testid":"sidebar-view-create-grid"},Sn={class:"item-inner"},jn=ea(()=>n("div",null,"Grid",-1)),Vn={class:"item","data-testid":"sidebar-view-create-form"},Mn={class:"item-inner"},Pn=ea(()=>n("div",null,"Form",-1)),Nn={class:"item","data-testid":"sidebar-view-create-gallery"},Bn={class:"item-inner"},En=ea(()=>n("div",null,"Gallery",-1)),On={class:"item"},Ln={class:"item-inner"},Un=ea(()=>n("div",null,"Kanban",-1)),Rn={class:"item"},An={class:"item-inner"},zn=pe({__name:"CreateViewBtn",props:{alignLeftLevel:{},source:{}},setup(p){const j=p,{$e:d}=Pe(),i=We(j,"alignLeftLevel"),{refreshCommandPalette:l}=Qe(),g=Ae(),{loadViews:E,navigateToView:A}=g,V=Ue(da),x=Ue(Gt),s=T(!1),k=T(),v=T(!1),b=oe(()=>i.value===1?"nc-view-create-dropdown nc-view-create-dropdown-left-1":i.value===2?"nc-view-create-dropdown nc-view-create-dropdown-left-2":"nc-view-create-dropdown");async function N({title:B="",type:c,copyViewId:C,groupingFieldColumnId:r,calendarRange:u,coverImageColumnId:w}){if(s.value)return;k.value=c,s.value=!0,await E({tableId:V.value.id}),v.value=!1,s.value=!1;const U=T(!0),{close:$}=Re(ds,{modelValue:U,title:B,type:c,tableId:V.value.id,selectedViewId:C,calendarRange:u,groupingFieldColumnId:r,coverImageColumnId:w,"onUpdate:modelValue":z,onCreated:async P=>{z(),l(),await E({tableId:V.value.id,force:!0}),V.value.meta={...V.value.meta,hasNonDefaultViews:!0},A({view:P,tableId:V.value.id,baseId:x.value.id,doNotSwitchTab:!0}),d("a:view:create",{view:P.type})}});function z(){v.value=!1,U.value=!1,$(1e3)}}return(B,c)=>{const C=Za,r=ua,u=Fe,w=Ft,U=Xt,$=Kt;return t(),m($,{visible:e(v),"onUpdate:visible":c[5]||(c[5]=z=>ie(v)?v.value=z:null),"overlay-class-name":e(b),"destroy-popup-on-hide":"",onClick:c[6]||(c[6]=me(z=>v.value=!0,["stop"]))},{overlay:o(()=>[a(U,{class:"max-w-48"},{default:o(()=>[a(w,{onClick:c[0]||(c[0]=me(z=>N({type:e(we).GRID}),["stop"]))},{default:o(()=>[n("div",Cn,[n("div",Sn,[a(C,{meta:{type:e(we).GRID}},null,8,["meta"]),jn]),e(k)===e(we).GRID&&e(s)?(t(),m(r,{key:0})):(t(),m(u,{key:1,class:"plus",icon:"plus"}))])]),_:1}),B.source.is_schema_readonly?L("",!0):(t(),m(w,{key:0,onClick:c[1]||(c[1]=z=>N({type:e(we).FORM}))},{default:o(()=>[n("div",Vn,[n("div",Mn,[a(C,{meta:{type:e(we).FORM}},null,8,["meta"]),Pn]),e(k)===e(we).FORM&&e(s)?(t(),m(r,{key:0})):(t(),m(u,{key:1,class:"plus",icon:"plus"}))])]),_:1})),a(w,{onClick:c[2]||(c[2]=z=>N({type:e(we).GALLERY}))},{default:o(()=>[n("div",Nn,[n("div",Bn,[a(C,{meta:{type:e(we).GALLERY}},null,8,["meta"]),En]),e(k)===e(we).GALLERY&&e(s)?(t(),m(r,{key:0})):(t(),m(u,{key:1,class:"plus",icon:"plus"}))])]),_:1}),a(w,{"data-testid":"sidebar-view-create-kanban",onClick:c[3]||(c[3]=z=>N({type:e(we).KANBAN}))},{default:o(()=>[n("div",On,[n("div",Ln,[a(C,{meta:{type:e(we).KANBAN}},null,8,["meta"]),Un]),e(k)===e(we).KANBAN&&e(s)?(t(),m(r,{key:0})):(t(),m(u,{key:1,class:"plus",icon:"plus"}))])]),_:1}),a(w,{"data-testid":"sidebar-view-create-calendar",onClick:c[4]||(c[4]=z=>N({type:e(we).CALENDAR}))},{default:o(()=>[n("div",Rn,[n("div",An,[a(C,{meta:{type:e(we).CALENDAR},class:"!w-4 !h-4"},null,8,["meta"]),n("div",null,_(B.$t("objects.viewType.calendar")),1)]),e(k)===e(we).CALENDAR&&e(s)?(t(),m(r,{key:0})):(t(),m(u,{key:1,class:"plus",icon:"plus"}))])]),_:1})]),_:1})]),default:o(()=>[ca(B.$slots,"default",{},void 0,!0)]),_:3},8,["visible","overlay-class-name"])}}}),Gn=Be(zn,[["__scopeId","data-v-15851779"]]),ms=p=>p.is_meta,Fn=ht(()=>kt(()=>import("./BVggTJcD.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(p=>p.default||p)),Kn={class:"text-sm flex items-center w-full gap-1","data-testid":"view-item"},Hn=["data-testid"],Wn=pe({__name:"ViewsNode",props:{view:{},table:{},onValidate:{type:Function}},emits:["update:view","selectIcon","changeView","rename","delete","openModal"],setup(p,{emit:j}){const d=p,i=j,l=Ye(d,"view",i),{$e:g}=Pe(),{isMobileMode:E}=Ce(),{isUIAllowed:A}=Ge(),V=Ue(Gt,T()),{activeView:x}=ee(Ae()),{getMeta:s}=xt(),{meta:k,control:v}=Qt(),b=oe(()=>d.table),N=T(b.value);ft(Vs,l),ft(Ms,N);const B=Ue(Ps,T(!1)),c=oe(()=>{var Y,ce,ve,ke;if(((ce=(Y=V.value)==null?void 0:Y.sources)==null?void 0:ce.length)===1)return!0;const F=(ke=(ve=V.value)==null?void 0:ve.sources)==null?void 0:ke.find(Ve=>Ve.id===l.value.source_id);return F?ms(F):!1}),C=T(!1),r=T(!1),u=T(!1),w=T(),U=Ns(()=>{i("changeView",l.value)},250),$=()=>{if(r.value||u.value)return;(At()?k.value:v.value)?i("changeView",l.value):U()};function z(){var F;E.value||A("viewCreateOrEdit")&&(r.value||(r.value=!0,w.value=l.value.title,g("c:view:rename",{view:(F=l.value)==null?void 0:F.type})))}function P(F){F.key==="Escape"?O(F):F.key==="Enter"&&H(F)}function H(F){F.stopImmediatePropagation(),F.preventDefault(),D()}function O(F){F.stopImmediatePropagation(),F.preventDefault(),R()}Yt("Enter",F=>{r.value&&H(F)});const h=()=>{var F;E.value||!A("viewCreateOrEdit")||r.value||(r.value=!0,w.value=l.value.title,g("c:view:rename",{view:(F=l.value)==null?void 0:F.type}))},M=F=>F==null?void 0:F.focus();async function D(){if(C.value=!1,!r.value)return;w.value&&(w.value=w.value.trim());const F=d.onValidate({...l.value,title:w.value});if(F!==!0){ue.error(F),R();return}if(l.value.title===""||l.value.title===w.value){R();return}const Y=l.value.title;l.value.title=w.value||"",i("rename",l.value,Y),K()}function R(){r.value&&K()}function K(){u.value=!0,r.value=!1,w.value="",setTimeout(()=>{u.value=!1},250)}const ne=()=>{C.value=!1,i("delete",l.value)};return ze(C,async()=>{C.value&&(N.value=await s(b.value.id))}),(F,Y)=>{const ce=Za,ve=Fn,ke=va,Ve=Rt,ot=Fe,S=Me,Z=bo,ae=Kt,X=Bs,fe=je("e");return t(),m(X,{class:te(["nc-sidebar-node !min-h-7 !max-h-7 !my-0.5 select-none group text-gray-700 !flex !items-center !hover:bg-gray-200 !hover:text-gray-700 cursor-pointer",{"!pl-13.5 !xs:pl-12":e(c),"!pl-19 ":!e(c)}]),"data-testid":`view-sidebar-view-${e(l).alias||e(l).title}`,onDblclick:me(z,["stop"]),onClick:me($,["prevent"])},{default:o(()=>{var be,le,W;return[Q((t(),I("div",Kn,[Q((t(),I("div",{class:"flex min-w-6","data-testid":`view-sidebar-drag-handle-${e(l).alias||e(l).title}`},[a(ve,{class:"nc-table-icon",emoji:(le=(be=d.view)==null?void 0:be.meta)==null?void 0:le.icon,size:"small",clearable:!0,readonly:e(E)||!e(A)("viewCreateOrEdit"),onEmojiSelected:Y[0]||(Y[0]=G=>i("selectIcon",G))},{default:o(()=>[a(ce,{meta:d.view,class:"nc-view-icon w-4 !text-[16px]"},null,8,["meta"])]),_:1},8,["emoji","readonly"])],8,Hn)),[[fe,["c:view:emoji-picker"]]]),e(r)?(t(),m(ke,{key:0,ref:M,value:e(w),"onUpdate:value":Y[1]||(Y[1]=G=>ie(w)?w.value=G:null),class:te(["!bg-transparent !border-0 !ring-0 !outline-transparent !border-transparent !pl-0 !flex-1 mr-4",{"font-medium !text-brand-600":((W=e(x))==null?void 0:W.id)===e(l).id}]),onBlur:D,onKeydown:Y[2]||(Y[2]=me(G=>P(G),["stop"]))},null,8,["value","class"])):(t(),m(Ve,{key:1,class:"nc-sidebar-node-title text-ellipsis overflow-hidden select-none w-full","show-on-truncate-only":""},{title:o(()=>[q(_(e(l).alias||e(l).title),1)]),default:o(()=>{var G;return[n("div",{"data-testid":"sidebar-view-title",class:te({"font-medium text-brand-600":((G=e(x))==null?void 0:G.id)===e(l).id}),style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},_(e(l).alias||e(l).title),3)]}),_:1})),!e(r)&&!e(B)?(t(),m(ae,{key:2,visible:e(C),"onUpdate:visible":Y[6]||(Y[6]=G=>ie(C)?C.value=G:null),"overlay-class-name":"!rounded-lg"},{overlay:o(()=>[a(Z,{"data-testid":`view-sidebar-view-actions-${e(l).alias||e(l).title}`,view:e(l),table:e(b),"in-sidebar":"",onCloseModal:Y[5]||(Y[5]=G=>C.value=!1),onRename:h,onDelete:ne},null,8,["data-testid","view","table"])]),default:o(()=>[Q((t(),m(S,{type:"text",size:"xxsmall",class:te(["nc-sidebar-node-btn invisible !group-hover:visible !group-hover:opacity-100 nc-sidebar-view-node-context-btn",{"!visible !opacity-100":e(C)}]),onClick:Y[3]||(Y[3]=me(G=>C.value=!e(C),["stop"])),onDblclick:Y[4]||(Y[4]=me(()=>{},["stop"]))},{default:o(()=>[a(ot,{icon:"threeDotHorizontal",class:"text-xl w-4.75"})]),_:1},8,["class"])),[[fe,["c:view:option"]]])]),_:1},8,["visible"])):L("",!0)])),[[fe,["a:view:open",{view:e(l).type}]]])]}),_:1},8,["class","data-testid"])}}}),qn={class:"flex flex-row items-center pl-1.25 !py-1.5 text-inherit"},Jn={class:"pl-1.75"},Qn=pe({__name:"ViewsList",emits:["openModal","deleted"],setup(p,{emit:j}){const d=j,i=Ue(Gt),l=Ue(da),{isLeftSidebarOpen:g}=ee(Zt()),{activeTableId:E}=ee(he()),{isUIAllowed:A}=Ge(),{isMobileMode:V}=Ce(),{$e:x}=Pe(),{t:s}=Jt(),{viewsByTable:k,activeView:v,allRecentViews:b}=ee(Ae()),{navigateToTable:N}=he(),B=oe(()=>{var S;return((S=k.value.get(l.value.id))==null?void 0:S.filter(Z=>!Z.is_default))??[]}),{api:c}=zt(),{refreshCommandPalette:C}=Qe(),{addUndo:r,defineModelScope:u}=qa(),{navigateToView:w,loadViews:U,removeFromRecentViews:$}=Ae(),z=T([]),P=T(!1),H=T(),O=T(!1);ze(v,S=>{S&&S.id&&(z.value=[S.id])});function h(S){O.value=S,setTimeout(()=>{O.value=!1},300)}const M=oe(()=>{var S,Z;return(Z=(S=i.value)==null?void 0:S.sources)==null?void 0:Z.find(ae=>ae.id===l.value.source_id)}),D=oe(()=>{var S,Z;return((Z=(S=i.value)==null?void 0:S.sources)==null?void 0:Z.length)===1?!0:M.value?ms(M.value):!1});function R(S){return!S.title||S.title.trim().length<0?s("msg.error.viewNameRequired"):B.value.some(Z=>Z.title===S.title&&Z.id!==S.id)?s("msg.error.viewNameDuplicate"):!0}let K;function ne(S){S.stopImmediatePropagation(),S.preventDefault(),P.value=!0}async function F(S,Z=!1){if(Z||(S.stopImmediatePropagation(),S.preventDefault(),P.value=!1),B.value.length<2)return;let{newIndex:ae=0,oldIndex:X=0}=S;if(ae=ae-1,X=X-1,ae===X)return;Z||r({redo:{fn:async()=>{const ge=K.toArray(),nt=ge.splice(X,1);ge.splice(ae,0,nt[0]),K.sort(ge),await F(S,!0)},args:[]},undo:{fn:async()=>{const ge=K.toArray(),nt=ge.splice(ae,1);ge.splice(X,0,nt[0]),K.sort(ge),await F({...S,oldIndex:ae,newIndex:X},!0)},args:[]},scope:u({view:v.value})});const fe=Array.from(S.to.children);fe.shift();const be=fe[ae-1],le=fe[ae+1],W=B.value.find(ge=>ge.id===S.item.id);if(!W||!W.id)return;const G=be?B.value.find(ge=>ge.id===be.id)??{order:0}:{order:0},_e=le?B.value.find(ge=>ge.id===le.id):{};let Ne;B.value.length-1===ae?Ne=parseFloat(String(G.order))+1:ae===0?Ne=parseFloat(String(_e.order))/2:Ne=(parseFloat(String(G.order))+parseFloat(String(_e.order)))/2;const Ze=isNaN(Number(Ne))?X:Ne;W.order=Ze,await c.dbView.update(W.id,{order:Ze}),h(W.id),x("a:view:reorder")}const Y=S=>{K&&K.destroy(),!V.value&&(K=new rs(S,{ghostClass:"ghost",onStart:ne,onEnd:F}))};wt(()=>H.value&&A("viewCreateOrEdit")&&Y(H.value.$el));async function ce(S){await w({view:S,tableId:l.value.id,baseId:i.value.id,hardReload:S.type===we.FORM&&z.value[0]===S.id,doNotSwitchTab:!0}),V.value&&(g.value=!1)}async function ve(S,Z,ae=!1){try{await c.dbView.update(S.id,{title:S.title,order:S.order}),w({view:S,tableId:l.value.id,baseId:i.value.id,hardReload:S.type===we.FORM&&z.value[0]===S.id}),C(),ae||r({redo:{fn:(X,fe)=>{const be=X.title;X.title=fe,ve(X,be,!0)},args:[S,S.title]},undo:{fn:(X,fe)=>{const be=X.title;X.title=fe,ve(X,be,!0)},args:[S,Z]},scope:u({view:v.value})}),b.value=b.value.map(X=>(X.viewId===S.id&&X.tableID===S.fk_model_id&&(X.viewName=S.title),X))}catch(X){ue.error(await Se(X))}}function ke(S){const Z=T(!0),{close:ae}=Re(_o,{modelValue:Z,view:S,"onUpdate:modelValue":X,onDeleted:async()=>{var be,le;X(),d("deleted"),$({viewId:S.id,tableId:S.fk_model_id,baseId:i.value.id}),C(),((be=v.value)==null?void 0:be.id)===S.id&&N({tableId:l.value.id,baseId:i.value.id}),await U({tableId:l.value.id,force:!0});const fe=((le=k.value.get(l.value.id))==null?void 0:le.filter(W=>!W.is_default))??[];l.value.meta={...l.value.meta,hasNonDefaultViews:fe.length>1}}});function X(){Z.value=!1,ae(1e3)}}const Ve=async(S,Z)=>{try{Z.meta={..._t(Z.meta),icon:S},c.dbView.update(Z.id,{meta:Z.meta}),x("a:view:icon:sidebar",{icon:S})}catch(ae){ue.error(await Se(ae))}};function ot({title:S="",type:Z,copyViewId:ae,groupingFieldColumnId:X,calendarRange:fe,coverImageColumnId:be}){const le=T(!0),{close:W}=Re(ds,{modelValue:le,title:S,type:Z,tableId:l.value.id,selectedViewId:ae,groupingFieldColumnId:X,views:B,calendarRange:fe,coverImageColumnId:be,"onUpdate:modelValue":G,onCreated:async _e=>{G(),C(),await U({force:!0,tableId:l.value.id}),w({view:_e,tableId:l.value.id,baseId:i.value.id,hardReload:_e.type===we.FORM&&z.value[0]===_e.id}),x("a:view:create",{view:_e.type})}});function G(){le.value=!1,W(1e3)}}return(S,Z)=>{const ae=Fe,X=Gn,fe=Wn,be=Os;return t(),m(be,{ref_key:"menuRef",ref:H,class:te([{dragging:e(P)},"nc-views-menu flex flex-col w-full !border-r-0 !bg-inherit"]),"selected-keys":e(z)},{default:o(()=>[e(A)("viewCreateOrEdit")?(t(),m(X,{key:0,"align-left-level":e(D)?1:2,class:te({"!pl-13.3 !xs:pl-13.5":e(D),"!pl-18.6 !xs:pl-20":!e(D)}),source:e(M)},{default:o(()=>[n("div",{class:te([{"text-brand-500 hover:text-brand-600":e(E)===e(l).id,"text-gray-500 hover:text-brand-500":e(E)!==e(l).id},"nc-create-view-btn flex flex-row items-center cursor-pointer rounded-md w-full"]),role:"button"},[n("div",qn,[a(ae,{icon:"plus"}),n("div",Jn,_(S.$t("general.createEntity",{entity:S.$t("objects.view")})),1)])],2)]),_:1},8,["align-left-level","class","source"])):L("",!0),e(B).length?(t(!0),I(ye,{key:1},pa(e(B),le=>{var W;return t(),m(fe,{id:le.id,key:le.id,class:te([{"bg-gray-200":e(O)===le.id,active:((W=e(v))==null?void 0:W.id)===le.id,[`nc-${le.type?("viewTypeAlias"in S?S.viewTypeAlias:e(Es))[le.type]:le.type}-view-item`]:!0},"nc-view-item !rounded-md !px-0.75 !py-0.5 w-full transition-all ease-in duration-100"]),"data-view-id":le.id,"on-validate":R,table:e(l),view:le,onDelete:ke,onRename:ve,onChangeView:ce,onOpenModal:ot,onSelectIcon:G=>Ve(G,le)},null,8,["id","class","data-view-id","table","view","onSelectIcon"])}),128)):L("",!0)]),_:1},8,["class","selected-keys"])}}}),Yn={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Zn=n("path",{fill:"currentColor",d:"M12 9a3 3 0 0 0-3 3a3 3 0 0 0 3 3a3 3 0 0 0 3-3a3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5a5 5 0 0 1 5-5a5 5 0 0 1 5 5a5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5"},null,-1),Xn=[Zn];function el(p,j){return t(),I("svg",Yn,[...Xn])}const tl={name:"mdi-eye",render:el},al=ht(()=>kt(()=>import("./BVggTJcD.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(p=>p.default||p)),sl=["data-order","data-id","data-table-id","data-active"],ol={class:"flex items-center py-0.5"},nl=["data-testid"],ll={class:"flex flex-row h-full items-center"},il=["data-testid"],rl=["data-testid"],cl={class:"flex text-xs font-bold text-gray-500 ml-1"},dl={class:"flex gap-2 items-center"},ul={class:"flex gap-2 items-center"},pl={class:"flex gap-2 items-center"},ml=pe({__name:"TableNode",props:{base:{},table:{},sourceIndex:{default:0}},setup(p){const j=p,d=We(j,"base"),i=We(j,"table"),l=We(j,"sourceIndex"),{openTable:g}=Ha({baseId:d.value.id}),E=Ls(),{isUIAllowed:A}=Ge(),{isMobileMode:V}=Ce(),x=$t(),{updateTab:s}=x,{$e:k,$api:v}=Pe();Ha({baseId:d.value.id});const{meta:b,control:N}=Qt(),{copy:B}=ts(),c=Ue(as);ft(da,i);const{setMenuContext:C,openRenameTableDialog:r,duplicateTable:u}=Ue(ma),{loadViews:w}=Ae(),{activeView:U,activeViewTitleOrId:$,viewsByTable:z}=ee(Ae()),{isLeftSidebarOpen:P}=ee(Zt()),{baseTables:H}=ee(he()),O=oe(()=>H.value.get(d.value.id)??[]),h=oe(()=>E.params.viewId),M=T(!1),D=T(!1),R=async(W,G)=>{try{G.meta={...G.meta||{},icon:W},O.value.splice(O.value.indexOf(G),1,{...G}),s({id:G.id},{meta:G.meta}),await v.dbTable.update(G.id,{meta:G.meta}),k("a:table:icon:navdraw",{icon:W})}catch(_e){ue.error(await Se(_e))}},{isSharedBase:K}=Je(),ne=oe(()=>A("tableIconEdit",{roles:c==null?void 0:c.value})),F=T(!1),Y=T(!1),ce=T(!1),ve=async()=>{if(F.value){F.value=!1;return}Y.value=!0;try{await w({tableId:i.value.id,ignoreLoading:!0})}catch(W){ue.error(await Se(W))}finally{Y.value=!1,F.value=!0}},ke=async()=>{if(At()?b.value:N.value){await g(i.value,!0);return}Y.value=!0;try{await g(i.value),V.value&&(P.value=!1)}catch(W){ue.error(await Se(W))}finally{Y.value=!1,F.value=!0}};let Ve;const ot=async()=>{Ve&&clearTimeout(Ve);try{await B(i.value.id),ce.value=!0,Ve=setTimeout(()=>{ce.value=!1,clearTimeout(Ve)},5e3)}catch(W){ue.error(W.message)}};ze(()=>{var W;return(W=U.value)==null?void 0:W.id},()=>{var W,G;U.value&&((W=U.value)==null?void 0:W.fk_model_id)===((G=i.value)==null?void 0:G.id)&&(F.value=!0)},{immediate:!0});const S=oe(()=>{var W,G;return h.value===((W=i.value)==null?void 0:W.id)&&(((G=U.value)==null?void 0:G.is_default)||!$.value)});let Z;ze(h,()=>{var W;if(Z&&clearTimeout(Z),i.value.id!==h.value&&F.value){if((((W=z.value.get(i.value.id))==null?void 0:W.filter(_e=>!_e.is_default))??[]).length)return;Z=setTimeout(()=>{F.value&&(F.value=!1),clearTimeout(Z)},1e4)}});const ae=W=>{D.value=!1,u(W)},X=(W,G)=>{D.value=!1,r(W,!!G)},fe=()=>{D.value=!1,M.value=!0},be=async()=>{F.value=!1,await Ut(),F.value=!0},le=oe(()=>{var W,G;return(G=(W=d.value)==null?void 0:W.sources)==null?void 0:G[l.value]});return(W,G)=>{var Ct,St,rt,vt;const _e=ua,Ne=tl,Ze=Rt,ge=al,nt=Rs,lt=Me,Ke=Fe,Tt=ya,Dt=Ft,ta=Xt,Ht=Kt,it=ps,aa=Qn,Ee=je("e");return t(),I("div",{class:te(["nc-tree-item nc-table-node-wrapper text-sm select-none w-full",[`nc-base-tree-tbl nc-base-tree-tbl-${(Ct=e(i).title)==null?void 0:Ct.replaceAll(" ","")}`]]),"data-order":e(i).order,"data-id":e(i).id,"data-table-id":e(i).id,"data-active":e(h)===e(i).id},[n("div",ol,[Q((t(),I("div",{class:te(["flex-none flex-1 table-context flex items-center gap-1 h-full nc-tree-item-inner nc-sidebar-node pr-0.75 mb-0.25 rounded-md h-7 w-full group cursor-pointer hover:bg-gray-200",{"hover:bg-gray-200":e(h)!==e(i).id,"pl-13.5":e(l)!==0,"pl-7.5 xs:pl-6":e(l)===0,"!bg-primary-selected":e(S)}]),"data-testid":`nc-tbl-side-node-${e(i).title}`,onContextmenu:G[7]||(G[7]=Oe=>e(C)("table",e(i))),onClick:ke},[n("div",ll,[n("div",{class:"flex w-auto","data-testid":`tree-view-table-draggable-handle-${e(i).title}`},[e(i).isViewsLoading?(t(),m(_e,{key:0,class:"flex items-center w-6 h-full !text-gray-600"})):Q((t(),I("div",{key:1,class:te(["flex items-center nc-table-icon",{"pointer-events-none":!e(ne)}]),onClick:G[1]||(G[1]=me(()=>{},["stop"]))},[(t(),m(ge,{key:(St=e(i).meta)==null?void 0:St.icon,emoji:(rt=e(i).meta)==null?void 0:rt.icon,size:"small",readonly:!e(ne)||e(V),onEmojiSelected:G[0]||(G[0]=Oe=>R(Oe,e(i)))},{default:o(()=>[a(Ze,{class:"flex",placement:"topLeft","hide-on-click":"",disabled:!e(ne)},{title:o(()=>[q(_(W.$t("general.changeIcon")),1)]),default:o(()=>[e(i).type==="table"?(t(),m(ss(("iconMap"in W?W.iconMap:e(Us)).table),{key:0,class:te(["w-4 text-sm",e(S)?"!text-brand-600/85":"!text-gray-600/75"])},null,8,["class"])):(t(),m(Ne,{key:1,class:te(["flex w-5 text-sm",e(S)?"!text-brand-600":"!text-gray-600"])},null,8,["class"]))]),_:1},8,["disabled"])]),_:1},8,["emoji","readonly"]))],2)),[[Ee,["c:table:emoji-picker"]]])],8,il)]),a(Ze,{class:"nc-tbl-title nc-sidebar-node-title text-ellipsis overflow-hidden select-none !flex-1","show-on-truncate-only":""},{title:o(()=>[q(_(e(i).title),1)]),default:o(()=>[n("span",{class:te(e(S)?"text-brand-600 !font-medium":"text-gray-600"),"data-testid":`nc-tbl-title-${e(i).title}`,style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},_(e(i).title),11,rl)]),_:1}),a(Ht,{visible:e(D),"onUpdate:visible":G[5]||(G[5]=Oe=>ie(D)?D.value=Oe:null),trigger:["click"],onClick:G[6]||(G[6]=me(()=>{},["stop"]))},{overlay:o(()=>[a(ta,{class:"!min-w-62.5","data-testid":`sidebar-table-context-menu-list-${e(i).title}`},{default:o(()=>{var Oe;return[a(Ze,null,{title:o(()=>[q(_(W.$t("labels.clickToCopyTableID")),1)]),default:o(()=>{var bt;return[n("div",{class:"flex items-center justify-between p-2 mx-1.5 rounded-md cursor-pointer hover:bg-gray-100 group",onClick:me(ot,["stop"])},[n("div",cl,_(W.$t("labels.tableIdColon",{tableId:(bt=e(i))==null?void 0:bt.id})),1),a(lt,{class:"!group-hover:bg-gray-100",size:"xsmall",type:"secondary"},{default:o(()=>[e(ce)?(t(),m(Ke,{key:0,class:"max-h-4 min-w-4",icon:"check"})):(t(),m(Ke,{key:1,class:"max-h-4 min-w-4",else:"",icon:"copy"}))]),_:1})])]}),_:1}),!e(K)&&(e(A)("tableRename",{roles:e(c),source:e(le)})||e(A)("tableDelete",{roles:e(c),source:e(le)}))?(t(),I(ye,{key:0},[a(Tt),e(A)("tableRename",{roles:e(c),source:e(le)})?(t(),m(Dt,{key:0,"data-testid":`sidebar-table-rename-${e(i).title}`,class:"nc-table-rename",onClick:G[3]||(G[3]=bt=>X(e(i),e(le).id))},{default:o(()=>[Q((t(),I("div",dl,[a(Ke,{icon:"rename",class:"text-gray-700"}),q(" "+_(W.$t("general.rename"))+" "+_(W.$t("objects.table")),1)])),[[Ee,["c:table:rename"]]])]),_:1},8,["data-testid"])):L("",!0),e(A)("tableDuplicate",{source:e(le)})&&((Oe=e(d).sources)!=null&&Oe[e(l)])&&(e(le).is_meta||e(le).is_local)?(t(),m(Dt,{key:1,"data-testid":`sidebar-table-duplicate-${e(i).title}`,onClick:G[4]||(G[4]=bt=>ae(e(i)))},{default:o(()=>[Q((t(),I("div",ul,[a(Ke,{icon:"duplicate",class:"text-gray-700"}),q(" "+_(W.$t("general.duplicate"))+" "+_(W.$t("objects.table")),1)])),[[Ee,["c:table:duplicate"]]])]),_:1},8,["data-testid"])):L("",!0),a(Tt),e(A)("tableDelete",{roles:e(c),source:e(le)})?(t(),m(Dt,{key:2,"data-testid":`sidebar-table-delete-${e(i).title}`,class:"!text-red-500 !hover:bg-red-50 nc-table-delete",onClick:fe},{default:o(()=>[Q((t(),I("div",pl,[a(Ke,{icon:"delete"}),q(" "+_(W.$t("general.delete"))+" "+_(W.$t("objects.table")),1)])),[[Ee,["c:table:delete"]]])]),_:1},8,["data-testid"])):L("",!0)],64)):L("",!0)]}),_:1},8,["data-testid"])]),default:o(()=>[Q((t(),m(lt,{class:te(["nc-sidebar-node-btn nc-tbl-context-menu text-gray-700 hover:text-gray-800",{"!opacity-100 !inline-block":e(D)}]),"data-testid":"nc-sidebar-table-context-menu",type:"text",size:"xxsmall",onClick:G[2]||(G[2]=me(()=>{},["stop"]))},{default:o(()=>[a(nt,{class:"!text-current"})]),_:1},8,["class"])),[[Ee,["c:table:option"]]])]),_:1},8,["visible"]),Q((t(),m(lt,{type:"text",size:"xxsmall",class:te(["nc-sidebar-node-btn nc-sidebar-expand text-gray-700 hover:text-gray-800",{"!opacity-100 !visible":e(D)}]),onClick:me(ve,["stop"])},{default:o(()=>[a(Ke,{icon:"chevronRight",class:te(["nc-sidebar-source-node-btns cursor-pointer transform transition-transform duration-200 !text-current text-[20px]",{"!rotate-90":e(F)}])},null,8,["class"])]),_:1},8,["class"])),[[Ee,["c:table:toggle-expand"]]])],42,nl)),[[Ee,["a:table:open"]]])]),e(i).id&&((vt=e(d))!=null&&vt.id)?(t(),m(it,{key:0,visible:e(M),"onUpdate:visible":G[8]||(G[8]=Oe=>ie(M)?M.value=Oe:null),"table-id":e(i).id,"base-id":e(d).id},null,8,["visible","table-id","base-id"])):L("",!0),e(F)?(t(),m(aa,{key:1,"table-id":e(i).id,"base-id":e(d).id,onDeleted:be},null,8,["table-id","base-id"])):L("",!0)],10,sl)}}}),fl=Be(ml,[["__scopeId","data-v-33f77e34"]]),vl={class:"border-none sortable-list"},bl=["nc-source"],_l=pe({__name:"TableList",props:{base:{},sourceIndex:{default:0}},setup(p){const j=p,d=We(j,"base"),i=We(j,"sourceIndex"),l=oe(()=>{var c,C;return(C=(c=d.value)==null?void 0:c.sources)==null?void 0:C[i.value]}),{isMobileMode:g}=Ce(),{isUIAllowed:E}=Ge(),{baseTables:A}=ee(he()),V=oe(()=>A.value.get(d.value.id)??[]),{$api:x}=Pe(),s=oe(()=>V.value.reduce((c,C)=>(c[C.id]=C,c),{})),k=T({}),v=T(),b={},N=c=>{const C=c.getAttribute("nc-source");C&&(g.value||(b[C]&&b[C].destroy(),rs.create(c,{onEnd:async r=>{var D,R;const u=V.value.findIndex(K=>K.source_id===C),{newIndex:w=0,oldIndex:U=0}=r;if(w===U)return;const $=r.item,z=s.value[$.dataset.id],P=r.to.children;if(P.length<2)return;const H=P[w-1],O=P[w+1],h=H&&s.value[H.dataset.id],M=O&&s.value[O.dataset.id];P.length-1===r.newIndex?z.order=h.order+1:w===0?z.order=M.order/2:z.order=(h.order+M.order)/2,(R=V.value)==null||R.splice(w+u,0,...(D=V.value)==null?void 0:D.splice(U+u,1)),k.value[C]?k.value[C]=k.value[C]+1:k.value[C]=1,await x.dbTable.reorder(z.id,{order:z.order})},animation:150,setData(r,u){r.setData("text/json",JSON.stringify({id:u.dataset.id,title:u.dataset.title,type:u.dataset.type,sourceId:u.dataset.sourceId}))},revertOnSpill:!0})))};Qa(()=>{v.value&&E("viewCreateOrEdit")&&(v.value instanceof HTMLElement?N(v.value):v.value.forEach(c=>N(c)))});const B=oe(()=>V.value.filter(c=>{var C,r;return c.source_id===((r=(C=d.value)==null?void 0:C.sources)==null?void 0:r[i.value].id)}));return(c,C)=>{var r,u,w,U,$,z;return t(),I("div",vl,[e(d)?(t(),I(ye,{key:0},[e(B).length===0?(t(),I("div",{key:0,class:te(["py-0.5 text-gray-500",{"ml-8.5":e(i)===0,"ml-14.5 xs:ml-15.25":e(i)!==0}])},_(c.$t("general.empty")),3)):L("",!0),(r=e(d).sources)!=null&&r[e(i)]&&e(d).sources[e(i)].enabled?(t(),I("div",{ref_key:"menuRefs",ref:v,key:`sortable-${(u=e(l))==null?void 0:u.id}-${(w=e(l))!=null&&w.id&&((U=e(l))==null?void 0:U.id)in e(k)?e(k)[($=e(l))==null?void 0:$.id]:"0"}`,"nc-source":(z=e(l))==null?void 0:z.id},[(t(!0),I(ye,null,pa(e(B),P=>{var H;return t(),m(fl,{key:P.id,class:"nc-tree-item text-sm","data-order":P.order,"data-id":P.id,table:P,base:e(d),"source-index":e(i),"data-title":P.title,"data-source-id":(H=e(l))==null?void 0:H.id,"data-type":P.type},null,8,["data-order","data-id","table","base","source-index","data-title","data-source-id","data-type"])}),128))],8,bl)):L("",!0)],64)):L("",!0)])}}}),yl={key:0,class:"flex flex-row items-center py-2 px-2.25 bg-gray-50 rounded-lg text-gray-700"},gl={class:"capitalize text-ellipsis overflow-hidden select-none w-full pl-1.75",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},xl=pe({__name:"ProjectDelete",props:{visible:{type:Boolean},baseId:{}},emits:["update:visible"],setup(p,{emit:j}){const d=p,l=Ye(d,"visible",j),{closeTab:g}=$t(),E=qe(),{deleteProject:A,navigateToFirstProjectOrHome:V}=E,{bases:x}=ee(E),{removeFromRecentViews:s}=Ae(),{refreshCommandPalette:k}=Qe(),v=oe(()=>x.value.get(d.baseId)),b=T(!1),N=async()=>{if(!v.value)return;const B=JSON.parse(JSON.stringify(v.value));b.value=!0;try{await A(B.id),await g(B.id),k(),l.value=!1,B.id===E.activeProjectId&&await V()}catch(c){ue.error(await Se(c))}finally{b.value=!1,s({baseId:B.id})}};return(B,c)=>{const C=ra,r=cs;return t(),m(r,{visible:e(l),"onUpdate:visible":c[0]||(c[0]=u=>ie(l)?l.value=u:null),"entity-name":B.$t("objects.project"),"on-delete":N},{"entity-preview":o(()=>[e(v)?(t(),I("div",yl,[a(C,{color:("parseProp"in B?B.parseProp:e(_t))(e(v).meta).iconColor,type:e(v).type,class:"nc-view-icon w-6 h-6 mx-1"},null,8,["color","type"]),n("div",gl,_(e(v).title),1)])):L("",!0)]),_:1},8,["visible","entity-name"])}}}),wl={class:"mt-5"},hl={class:"prose-md self-center text-gray-500 mt-4"},kl={class:"text-xs p-2"},$l={class:"flex flex-row gap-x-2 mt-2.5 pt-2.5 justify-end"},Il=pe({__name:"ProjectDuplicate",props:{modelValue:{type:Boolean},base:{}},emits:["update:modelValue"],setup(p,{emit:j}){const d=p,i=j,{refreshCommandPalette:l}=Qe(),{api:g}=zt(),{$e:E,$poller:A}=Pe(),V=qe(),{loadProjects:x,createProject:s}=V,{bases:k}=ee(V),{navigateToProject:v}=Ce(),b=Ye(d,"modelValue",i),N=T({includeData:!0,includeViews:!0,includeHooks:!0}),B=oe(()=>{const{includeData:u,includeViews:w,includeHooks:U}=N.value;return{excludeData:!u,excludeViews:!w,excludeHooks:!U}}),c=T(!1),C=async()=>{try{c.value=!0;const u=za[Math.floor(Math.random()*1e3)%za.length],U=As(u).complement(),$=await g.base.duplicate(d.base.id,{options:B.value,base:{fk_workspace_id:d.base.fk_workspace_id,type:d.base.type,color:u,meta:JSON.stringify({theme:{primaryColor:u,accentColor:U.toHex8String()},iconColor:_t(d.base.meta).iconColor})}});A.subscribe({id:$.id},async z=>{if(z.status!=="close")if(z.status===gt.COMPLETED){await x("workspace");const P=k.value.get($.base_id);P&&await v({workspaceId:at?P.fk_workspace_id:void 0,baseId:P.id,type:P.type}),l(),c.value=!1,b.value=!1}else z.status===gt.FAILED&&(ue.error("Failed to duplicate project"),await x("workspace"),l(),c.value=!1,b.value=!1)}),E("a:base:duplicate")}catch(u){ue.error(await Se(u)),c.value=!1,b.value=!1}};Yt("Enter",()=>{b.value&&C()});const r=T(!1);return(u,w)=>{const U=ba,$=_a,z=Me,P=It,H=je("e");return u.base?(t(),m(P,{key:0,visible:e(b),"onUpdate:visible":w[5]||(w[5]=O=>ie(b)?b.value=O:null),"mask-closable":!e(c),keyboard:!e(c),class:"!w-[30rem]","wrap-class-name":"nc-modal-base-duplicate"},{default:o(()=>[n("div",null,[n("div",{class:"font-medium text-lg text-gray-800 self-center",onDblclick:w[0]||(w[0]=O=>r.value=!e(r))},_(u.$t("general.duplicate"))+" "+_(u.$t("objects.project")),33),n("div",wl,_(u.$t("msg.warning.duplicateProject")),1),n("div",hl,_(u.$t("title.advancedSettings")),1),a(U,{class:"!m-0 !p-0 !my-2"}),n("div",kl,[a($,{checked:e(N).includeData,"onUpdate:checked":w[1]||(w[1]=O=>e(N).includeData=O),disabled:e(c)},{default:o(()=>[q(_(u.$t("labels.includeData")),1)]),_:1},8,["checked","disabled"]),a($,{checked:e(N).includeViews,"onUpdate:checked":w[2]||(w[2]=O=>e(N).includeViews=O),disabled:e(c)},{default:o(()=>[q(_(u.$t("labels.includeView")),1)]),_:1},8,["checked","disabled"]),Q(a($,{checked:e(N).includeHooks,"onUpdate:checked":w[3]||(w[3]=O=>e(N).includeHooks=O),disabled:e(c)},{default:o(()=>[q(_(u.$t("labels.includeWebhook")),1)]),_:1},8,["checked","disabled"]),[[Ya,e(r)]])])]),n("div",$l,[e(c)?L("",!0):(t(),m(z,{key:"back",type:"secondary",size:"small",onClick:w[4]||(w[4]=O=>b.value=!1)},{default:o(()=>[q(_(u.$t("general.cancel")),1)]),_:1})),Q((t(),m(z,{key:"submit",size:"small",loading:e(c),onClick:C},{default:o(()=>[q(_(u.$t("general.confirm")),1)]),_:1},8,["loading"])),[[H,["a:base:duplicate"]]])])]),_:1},8,["visible","mask-closable","keyboard"])):L("",!0)}}}),Tl=p=>p.is_schema_readonly&&p.is_data_readonly?"#278bff":p.is_schema_readonly?"#df830f":"#de0062",Dl=p=>{var d,i;const j=`Connection type is ${((d=zs.find(l=>l.value===p.type))==null?void 0:d.text)||((i=p.type)==null?void 0:i.toUpperCase())}.`;return p.is_schema_readonly&&p.is_data_readonly?De("div",{className:"w-max"},[j,De("br"),"Both data and schema editing are disabled.",De("br"),"These settings are ideal for read-only use cases of your data.",De("br"),De("a",{className:"!text-current",href:"https://docs.nocodb.com/data-sources/connect-to-data-source#configuring-permissions",target:"_blank"},"Learn more")]):p.is_schema_readonly?De("div",{className:"max-w-90"},[j,De("br"),"Data editing is allowed and Schema edit is not allowed.",De("br"),"An ideal settings for administrative users who need to change data directly on database.",De("br"),De("a",{className:"!text-current",href:"https://docs.nocodb.com/data-sources/connect-to-data-source#configuring-permissions",target:"_blank"},"Learn more")]):De("div",{className:"max-w-90"},[j,De("br"),"Both Data and Schema Editing are enabled.",De("br"),"We highly recommend ",De("a",{className:"!text-current",href:"https://docs.nocodb.com/data-sources/connect-to-data-source#configuring-permissions",target:"_blank"},"disabling schema editing")," to maintain data integrity and avoid potential issues."])},Cl=ht(()=>kt(()=>import("./fumUxinc.js"),__vite__mapDeps([4,5,1,2,6,7,8,9,10,11]),import.meta.url).then(p=>p.default||p)),Sl=["data-testid","data-base-id"],jl=["data-testid"],Vl={class:"flex items-center select-none w-6 h-full"},Ml={key:1},Pl={class:"flex gap-2 items-center"},Nl={class:"flex gap-2 items-center"},Bl={class:"flex gap-2 items-center"},El={class:"flex gap-2 items-center"},Ol={class:"flex gap-2 items-center"},Ll={class:"flex gap-2 items-center"},Ul={class:"flex gap-2 items-center"},Rl={key:0,class:"flex-1"},Al={class:"transition-height duration-200"},zl={key:1,class:"transition-height duration-200"},Gl={class:"border-none sortable-list"},Fl={class:"nc-sidebar-node min-w-20 w-full h-full flex flex-row group py-0.5 pr-6.5 !mr-0"},Kl=["onContextmenu"],Hl=["onContextmenu"],Wl=["onUpdate:modelValue","data-source-rename-input-id","onKeyup","onBlur"],ql=["data-testid"],Jl={class:"flex flex-row items-center gap-x-0.25"},Ql={class:"flex gap-2 items-center"},Yl=["nc-source"],Zl={class:"flex text-xs font-bold text-gray-500 ml-1"},Xl={class:"nc-base-option-item flex gap-2 items-center"},ei={class:"nc-base-option-item flex gap-2 items-center"},ti={class:"nc-base-option-item flex gap-2 items-center text-red-600"},ai={class:"h-[80vh]"},si=pe({__name:"ProjectNode",setup(p,{expose:j}){const d=De(Gs,{class:"!text-gray-400",style:{fontSize:"0.85rem"},spin:!0}),l=fa().currentRoute,{isSharedBase:g}=ee(Je()),{setMenuContext:E,openRenameTableDialog:A,duplicateTable:V,contextMenuTarget:x}=Ue(ma),s=Ue(Gt),k=qe(),{isMobileMode:v}=Ce(),{api:b}=zt(),{auditLogsQuery:N,auditCurrentPage:B}=ee(st()),{createProject:c,updateProject:C,getProjectMetaInfo:r,loadProject:u}=k,{bases:w}=ee(k),{loadProjectTables:U}=he(),{activeTable:$}=ee(he()),{appInfo:z}=Ce(),{orgRoles:P,isUIAllowed:H}=Ge();$t();const{meta:O,control:h}=Qt(),{refreshCommandPalette:M}=Qe(),D=T(!1),R=T(""),K=T({}),ne=T(""),F=T(!1),{t:Y}=Jt(),ce=T(),ve=oe(()=>s.value.project_role||s.value.workspace_role),{activeProjectId:ke}=ee(qe()),{baseUrl:Ve}=Je(),ot=Ue(os,()=>{}),{$e:S}=Pe(),Z=T(!1),ae=T({}),X=T([]),[fe]=Fs(),be=T(""),le=T({}),W=T(!1),G=T(!1),{refreshViewTabTitle:_e}=Ae(),Ne=oe(()=>{var se;const y=String((se=l.value)==null?void 0:se.name).split("baseId-index-index");if(y.length<=1)return!1;const f=y[y.length-1];return f.split("-").length===2||f.split("-").length===1}),Ze=y=>["airtableImport","csvImport","jsonImport","excelImport"].some(f=>H(f,{source:y})),ge=()=>{D.value=!0,R.value=s.value.title,Ut(()=>{var y,f,se;(y=ce.value)==null||y.focus(),(f=ce.value)==null||f.select(),(se=ce.value)==null||se.scrollIntoView()})},nt=y=>{var se;const f=(se=s.value.sources)==null?void 0:se.find(re=>re.id===y);f!=null&&f.id&&(K.value[f.id]={editMode:!0,tempTitle:f.alias||""},Ut(()=>{const re=document.querySelector(`[data-source-rename-input-id="${y}"]`);re&&(re==null||re.focus(),re==null||re.select(),re==null||re.scrollIntoView())}))},lt=async y=>{var se;const f=(se=s.value.sources)==null?void 0:se.find(re=>re.id===y);if(!(!(f!=null&&f.id)||!K.value[f.id])&&(K.value[f.id].tempTitle&&(K.value[f.id].tempTitle=K.value[f.id].tempTitle.trim()),!!K.value[f.id].tempTitle))try{await b.source.update(f.base_id,f.id,{alias:K.value[f.id].tempTitle}),await u(f.base_id,!0),delete K.value[f.id],S("a:source:rename"),_e==null||_e()}catch(re){ue.error(await Se(re))}finally{M()}},Ke=async()=>{if(R.value&&(R.value=R.value.trim()),!!R.value)try{await C(s.value.id,{title:R.value}),D.value=!1,R.value="",S("a:base:rename"),_e==null||_e()}catch(y){ue.error(await Se(y))}},{copy:Tt}=ts(!0),Dt=async()=>{try{await Tt(Object.entries(await r(s.value.id)).map(([y,f])=>`${y}: **${f}**`).join(`
`))&&ue.info(Y("msg.info.copiedToClipboard"))}catch(y){console.error(y),ue.error(y.message)}};j({enableEditMode:ge});const ta=async(y,f)=>{try{const se={..._t(f.meta),iconColor:y};k.updateProject(f.id,{meta:JSON.stringify(se)}),S("a:base:icon:color:navdraw",{iconColor:y})}catch(se){ue.error(await Se(se))}finally{M()}};function Ht(y){var de,He,$e;const f=T(!0);let se=(de=s.value.sources)==null?void 0:de[0].id;if(typeof y=="number"&&(se=(He=s.value.sources)==null?void 0:He[y].id),!se||!(($e=s.value)!=null&&$e.id))return;const{close:re}=Re(is,{modelValue:f,sourceId:se,baseId:s.value.id,onCreate:Le,"onUpdate:modelValue":()=>Le()});function Le(Xe){f.value=!1,Xe&&(s.value.isExpanded=!0,(!X.value||!X.value.includes(`collapse-${se}`))&&X.value.push(`collapse-${se}`),setTimeout(()=>{const ct=document.querySelector(`[data-table-id="${Xe.id}"]`);ct&&(ct==null||ct.scrollIntoView({behavior:"smooth",block:"nearest"}))},1e3),re(1e3))}}const it=T(!1);async function aa(){if(it.value)return;it.value=!0,!k.isProjectPopulated(s.value.id)&&s.value.type===yt.DB&&U(s.value.id);try{Ht(),!s.value.isExpanded&&s.value.type!==yt.DB&&(s.value.isExpanded=!0)}finally{it.value=!1}}const Ee=async(y,f,se)=>{if(!y)return;const re=At()?O.value:h.value;if(!se&&!re&&S("c:base:open"),f=v.value||f,se=v.value||se,re&&!f){await mt(`${re?"#":""}${Ve({id:y.id,type:"database",isSharedBase:g.value})}`,re?{open:Ws}:void 0);return}se?y.isExpanded=!y.isExpanded:y.isExpanded=!0;const Le=k.isProjectPopulated(y.id);if(Le||(y.isLoading=!0),f||await mt(Ve({id:y.id,type:"database",isSharedBase:g.value})),Le||await U(y.id),!Le){y.isLoading=!1;const de=w.value.get(y.id);de.isLoading=!1}};function Ct(y){S("c:project:relation");const f=T(!0),{close:se}=Re(_n,{modelValue:f,sourceId:y.id,"onUpdate:modelValue":()=>re(),baseId:s.value.id});function re(){f.value=!1,se(1e3)}}const St=oe(()=>{var y,f;if(x.type==="source")return x.value;if(x.type==="table"){const se=(f=(y=s.value)==null?void 0:y.sources)==null?void 0:f.find(re=>re.id===x.value.source_id);if(se)return se}return null});ze(()=>{var y;return(y=$.value)==null?void 0:y.id},async()=>{if(!$.value)return;const y=$.value.source_id;y&&(X.value.includes(`collapse-${y}`)||X.value.push(`collapse-${y}`))},{immediate:!0}),Yt("Escape",()=>{Z.value&&(Z.value=!1);for(const y of Object.keys(ae.value))ae.value[y]=!1});const rt=T(!1),vt=T(),Oe=y=>{vt.value=y,rt.value=!0},bt=()=>{W.value=!0,S("c:table:delete")},fs=()=>{G.value=!0,S("c:project:delete")},sa=T(!1);let Wt;const vs=async()=>{Wt&&clearTimeout(Wt);try{await Tt(x.value.id),sa.value=!0,Wt=setTimeout(()=>{sa.value=!1,clearTimeout(Wt)},5e3)}catch(y){ue.error(y.message)}},jt=y=>{var f;return(f=s.value.sources)==null?void 0:f.find(se=>se.id===y)};async function bs(y){S("c:project:audit"),B.value=1,N.value={...N.value,orderBy:{created_at:"desc",user:void 0}};const f=T(!0),{close:se}=Re(gn,{modelValue:f,sourceId:y.id,"onUpdate:modelValue":()=>re(),baseId:s.value.id,bordered:!0});function re(){f.value=!1,se(1e3)}}return(y,f)=>{var ha,ka,$a,Ia,Ta;const se=qs,re=Js,Le=Rt,de=Fe,He=Me,$e=Ft,Xe=ya,ct=In,oa=Xt,na=Kt,xa=_l,wa=co,_s=yo,ys=go,gs=ps,xs=xl,ws=Il,hs=Cl,ks=It,Ie=je("e");return t(),I(ye,null,[a(na,{trigger:["contextmenu"],"overlay-class-name":"nc-dropdown-tree-view-context-menu"},Ks({default:o(()=>{var Te,Vt,Mt,Pt,Nt,Bt,Et,dt,Da,Ca,Sa,ja,Va,Ma,Pa;return[n("div",{class:te(["mx-1 nc-base-sub-menu rounded-md",{active:e(s).isExpanded}]),"data-testid":`nc-sidebar-base-${e(s).title}`,"data-base-id":e(s).id},[n("div",{class:"flex items-center gap-0.75 py-0.5 cursor-pointer",onContextmenu:f[15]||(f[15]=J=>e(E)("base",e(s)))},[n("div",{ref:"baseNodeRefs",class:te([{"bg-primary-selected active":e(ke)===e(s).id&&e(Ne)&&!e(v),"hover:bg-gray-200":!(e(ke)===e(s).id&&e(Ne))},"nc-sidebar-node base-title-node h-7 flex-grow rounded-md group flex items-center w-full pr-1 pl-1.5"]),"data-testid":`nc-sidebar-base-title-${e(s).title}`},[n("div",{class:"flex items-center mr-1",onClick:f[1]||(f[1]=J=>Ee(e(s)))},[n("div",Vl,[e(s).isLoading?(t(),m(se,{key:0,class:"!ml-1.25 !flex !flex-row !items-center !my-0.5 w-8",indicator:e(d)},null,8,["indicator"])):(t(),I("div",Ml,[(t(),m(re,{key:`${e(s).id}_${("parseProp"in y?y.parseProp:e(_t))(e(s).meta).iconColor}`,type:(Te=e(s))==null?void 0:Te.type,"model-value":("parseProp"in y?y.parseProp:e(_t))(e(s).meta).iconColor,size:"small",readonly:((Vt=e(s))==null?void 0:Vt.type)&&((Mt=e(s))==null?void 0:Mt.type)!=="database"||!e(H)("baseRename"),"onUpdate:modelValue":f[0]||(f[0]=J=>ta(J,e(s)))},null,8,["type","model-value","readonly"]))]))])]),e(D)?Q((t(),I("input",{key:0,ref_key:"input",ref:ce,"onUpdate:modelValue":f[2]||(f[2]=J=>ie(R)?R.value=J:null),class:te(["flex-grow leading-1 outline-0 ring-none capitalize !text-inherit !bg-transparent flex-1 mr-4",e(ke)===e(s).id&&e(Ne)?"!text-brand-600 !font-semibold":"!text-gray-700"]),onClick:f[3]||(f[3]=me(()=>{},["stop"])),onKeyup:[pt(Ke,["enter"]),pt(Ke,["esc"])],onBlur:Ke},null,34)),[[Ga,e(R)]]):(t(),m(Le,{key:1,class:te(["nc-sidebar-node-title capitalize text-ellipsis overflow-hidden select-none flex-1",e(ke)===e(s).id&&e(Ne)?"text-brand-600 font-semibold":"text-gray-700"]),style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"},"show-on-truncate-only":"",onClick:f[4]||(f[4]=J=>Ee(e(s)))},{title:o(()=>[q(_(e(s).title),1)]),default:o(()=>[n("span",null,_(e(s).title),1)]),_:1},8,["class"])),e(D)?L("",!0):(t(),I(ye,{key:2},[e(g)?L("",!0):(t(),m(na,{key:0,visible:e(Z),"onUpdate:visible":f[13]||(f[13]=J=>ie(Z)?Z.value=J:null),trigger:["click"]},{overlay:o(()=>[a(oa,{class:"nc-scrollbar-md",style:{maxHeight:"70vh",overflow:"overlay"},"data-testid":`nc-sidebar-base-${e(s).title}-options`,onClick:f[12]||(f[12]=J=>Z.value=!1)},{default:o(()=>{var J,ut,et,xe,Na,Ba,Ea,Oa,La,Ua,Ra;return[e(g)?L("",!0):(t(),I(ye,{key:0},[e(H)("baseRename")?(t(),m($e,{key:0,"data-testid":"nc-sidebar-project-rename",onClick:ge},{default:o(()=>[Q((t(),I("div",Pl,[a(de,{icon:"rename",class:"group-hover:text-black"}),q(" "+_(y.$t("general.rename")),1)])),[[Ie,["c:base:rename"]]])]),_:1})):L("",!0),e(H)("baseDuplicate",{roles:[e(Fa)(e(P)),e(ve)].join()})?(t(),m($e,{key:1,"data-testid":"nc-sidebar-base-duplicate",onClick:f[6]||(f[6]=tt=>Oe(e(s)))},{default:o(()=>[Q((t(),I("div",Nl,[a(de,{icon:"duplicate",class:"text-gray-700"}),q(" "+_(y.$t("general.duplicate")),1)])),[[Ie,["c:base:duplicate"]]])]),_:1})):L("",!0),["baseDuplicate","baseRename"].some(tt=>e(H)(tt))?(t(),m(Xe,{key:2})):L("",!0),("isEeUI"in y?y.isEeUI:e(at))?L("",!0):(t(),m($e,{key:"copy","data-testid":"nc-sidebar-base-copy-base-info",onClick:me(Dt,["stop"])},{default:o(()=>[Q((t(),I("div",Bl,[a(de,{icon:"copy",class:"group-hover:text-black"}),q(" "+_(y.$t("activity.account.projInfo")),1)])),[[Ie,["c:base:copy-proj-info"]]])]),_:1})),(et=(ut=(J=e(s))==null?void 0:J.sources)==null?void 0:ut[0])!=null&&et.enabled?(t(),m($e,{key:"erd","data-testid":"nc-sidebar-base-relations",onClick:f[7]||(f[7]=tt=>{var Ot,Lt;return Ct((Lt=(Ot=e(s))==null?void 0:Ot.sources)==null?void 0:Lt[0])})},{default:o(()=>[Q((t(),I("div",El,[a(de,{icon:"erd"}),q(" "+_(y.$t("title.relations")),1)])),[[Ie,["c:base:erd"]]])]),_:1})):L("",!0),e(H)("baseAuditList")&&((Ba=(Na=(xe=e(s))==null?void 0:xe.sources)==null?void 0:Na[0])!=null&&Ba.enabled)?(t(),m($e,{key:"audit","data-testid":"nc-sidebar-base-audit",onClick:f[8]||(f[8]=tt=>{var Ot,Lt;return bs((Lt=(Ot=e(s))==null?void 0:Ot.sources)==null?void 0:Lt[0])})},{default:o(()=>[a(de,{icon:"audit",class:"group-hover:text-black"}),q(" "+_(y.$t("title.audit")),1)]),_:1})):L("",!0),e(H)("apiDocs")?(t(),m($e,{key:"api","data-testid":"nc-sidebar-base-rest-apis",onClick:f[9]||(f[9]=me(()=>{e(S)("c:base:api-docs"),("openLink"in y?y.openLink:e(Hs))(`/api/v2/meta/bases/${e(s).id}/swagger`,e(z).ncSiteUrl)},["stop"]))},{default:o(()=>[Q((t(),I("div",Ol,[a(de,{icon:"snippet",class:"group-hover:text-black !max-w-3.9"}),q(" "+_(y.$t("activity.account.swagger")),1)])),[[Ie,["c:base:api-docs"]]])]),_:1})):L("",!0)],64)),(La=(Oa=(Ea=e(s))==null?void 0:Ea.sources)==null?void 0:Oa[0])!=null&&La.enabled&&Ze((Ra=(Ua=e(s))==null?void 0:Ua.sources)==null?void 0:Ra[0])?(t(),I(ye,{key:1},[a(Xe),a(ct,{base:e(s),"onUpdate:base":f[10]||(f[10]=tt=>ie(s)?s.value=tt:null),source:e(s).sources[0]},null,8,["base","source"])],64)):L("",!0),["baseMiscSettings","baseDelete"].some(tt=>e(H)(tt))?(t(),m(Xe,{key:2})):L("",!0),e(H)("baseMiscSettings")?(t(),m($e,{key:"teamAndSettings","data-testid":"nc-sidebar-base-settings",class:"nc-sidebar-base-base-settings",onClick:f[11]||(f[11]=tt=>e(ot)(!0,"teamAndAuth",void 0,e(s).id))},{default:o(()=>[Q((t(),I("div",Ll,[a(de,{icon:"settings",class:"group-hover:text-black"}),q(" "+_(y.$t("activity.settings")),1)])),[[Ie,["c:base:settings"]]])]),_:1})):L("",!0),e(H)("baseDelete",{roles:[e(Fa)(e(P)),e(ve)].join()})?(t(),m($e,{key:4,"data-testid":"nc-sidebar-base-delete",class:"!text-red-500 !hover:bg-red-50",onClick:fs},{default:o(()=>[n("div",Ul,[a(de,{icon:"delete",class:"w-4"}),q(" "+_(y.$t("general.delete")),1)])]),_:1})):L("",!0)]}),_:1},8,["data-testid"])]),default:o(()=>[Q((t(),m(He,{class:te(["nc-sidebar-node-btn",{"!text-black !opacity-100 !inline-block":e(Z)}]),"data-testid":"nc-sidebar-context-menu",type:"text",size:"xxsmall",onClick:f[5]||(f[5]=me(()=>{},["stop"]))},{default:o(()=>[a(de,{icon:"threeDotHorizontal",class:"text-xl w-4.75"})]),_:1},8,["class"])),[[Ie,["c:base:options"]]])]),_:1},8,["visible"])),e(H)("tableCreate",{roles:e(ve),source:(Nt=(Pt=e(s))==null?void 0:Pt.sources)==null?void 0:Nt[0]})?Q((t(),m(He,{key:1,disabled:!((dt=(Et=(Bt=e(s))==null?void 0:Bt.sources)==null?void 0:Et[0])!=null&&dt.enabled),class:te(["nc-sidebar-node-btn",{"!text-black !inline-block !opacity-100":e(it),"!inline-block !opacity-100":e(Z)}]),size:"xxsmall",type:"text","data-testid":"nc-sidebar-add-base-entity",loading:e(it),onClick:me(aa,["stop"])},{default:o(()=>[a(de,{icon:"plus",class:"text-xl leading-5",style:{"-webkit-text-stroke":"0.15px"}})]),_:1},8,["disabled","class","loading"])),[[Ie,["c:base:create-table"]]]):L("",!0),Q((t(),m(He,{type:"text",size:"xxsmall",class:te(["nc-sidebar-node-btn nc-sidebar-expand !xs:opacity-100 !mr-0 mt-0.5",{"!opacity-100":e(Z)}]),onClick:f[14]||(f[14]=J=>Ee(e(s),!0,!0))},{default:o(()=>[a(de,{icon:"chevronRight",class:te(["group-hover:visible cursor-pointer transform transition-transform duration-200 text-[20px]",{"!rotate-90":e(s).isExpanded}])},null,8,["class"])]),_:1},8,["class"])),[[Ie,["c:base:expand"]]])],64))],10,jl)],32),e(s).id&&!e(s).isLoading?(t(),I("div",{key:"g1",class:te(["overflow-x-hidden transition-max-height",{"max-h-0":!e(s).isExpanded}])},[e(s)&&((Da=e(s))!=null&&Da.sources)?(t(),I("div",{key:0,class:te(["flex-1 overflow-y-auto overflow-x-hidden flex flex-col",{"mb-[20px]":e(g)}])},[(ja=(Sa=(Ca=e(s))==null?void 0:Ca.sources)==null?void 0:Sa[0])!=null&&ja.enabled?(t(),I("div",Rl,[n("div",Al,[a(xa,{base:e(s),"source-index":0},null,8,["base"])])])):L("",!0),(Pa=(Ma=(Va=e(s))==null?void 0:Va.sources)==null?void 0:Ma.slice(1).filter(J=>J.enabled))!=null&&Pa.length?(t(),I("div",zl,[n("div",Gl,[(t(!0),I(ye,null,pa(e(s).sources,(J,ut)=>(t(),I("div",{key:`source-${J.id}`},[ut===0?(t(),I(ye,{key:0},[],64)):J&&J.enabled?Q((t(),m(ys,{key:1,activeKey:e(X),"onUpdate:activeKey":f[19]||(f[19]=et=>ie(X)?X.value=et:null),class:te(["!mx-0 !px-0 nc-sidebar-source-node",[{hidden:e(fe)&&!!e(be)}]]),"expand-icon-position":"left",bordered:!1,ghost:""},{expandIcon:o(({isActive:et})=>[Q((t(),m(He,{type:"text",size:"xxsmall",class:te(["nc-sidebar-node-btn nc-sidebar-expand !xs:opacity-100 !mr-0 mt-0.5",{"!opacity-100 !inline-block":e(ae)[J.id]}])},{default:o(()=>[a(de,{icon:"chevronDown",class:te(["flex-none cursor-pointer transform transition-transform duration-500 rotate-270",{"!rotate-180":et}])},null,8,["class"])]),_:2},1032,["class"])),[[Ie,["c:external:base:expand"]]])]),default:o(()=>[(t(),m(_s,{key:`collapse-${J.id}`},{header:o(()=>{var et;return[n("div",Fl,[ut===0?(t(),I("div",{key:0,class:"source-context flex items-center gap-2 text-gray-800 nc-sidebar-node-title",onContextmenu:xe=>e(E)("source",J)},[a(wa,{class:"flex-none min-w-4 !xs:min-w-4.25 !xs:w-4.25 !xs:text-sm"}),q(" "+_(y.$t("general.default")),1)],40,Kl)):(t(),I("div",{key:1,class:"source-context flex flex-grow items-center gap-1.75 text-gray-800 min-w-1/20 max-w-full",onContextmenu:xe=>e(E)("source",J)},[a(Le,{"tooltip-style":{"min-width":"max-content"},"overlay-inner-style":{"min-width":"max-content"},"mouse-leave-delay":.3,placement:"topLeft",trigger:"hover",class:"flex items-center"},{title:o(()=>[(t(),m(ss(("getSourceTooltip"in y?y.getSourceTooltip:e(Dl))(J))))]),default:o(()=>[a(wa,{color:("getSourceIconColor"in y?y.getSourceIconColor:e(Tl))(J),class:"flex-none min-w-4 !xs:min-w-4.25 !xs:w-4.25 !xs:text-sm"},null,8,["color"])]),_:2},1024),J.id&&((et=e(K)[J.id])!=null&&et.editMode)?Q((t(),I("input",{key:0,ref_for:!0,ref_key:"input",ref:ce,"onUpdate:modelValue":xe=>e(K)[J.id].tempTitle=xe,class:"flex-grow leading-1 outline-0 ring-none capitalize !text-inherit !bg-transparent flex-1 mr-4 !text-gray-700","data-source-rename-input-id":J.id,onClick:f[16]||(f[16]=me(()=>{},["stop"])),onKeydown:f[17]||(f[17]=pt(me(()=>{},["stop","prevent"]),["enter"])),onKeyup:[pt(xe=>lt(J.id),["enter"]),pt(xe=>lt(J.id),["esc"])],onBlur:xe=>lt(J.id)},null,40,Wl)),[[Ga,e(K)[J.id].tempTitle]]):(t(),m(Le,{key:1,class:"nc-sidebar-node-title capitalize text-ellipsis overflow-hidden select-none text-gray-700",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"},"show-on-truncate-only":""},{title:o(()=>[q(_(J.alias||""),1)]),default:o(()=>[n("span",{"data-testid":`nc-sidebar-base-${J.alias}`},_(J.alias||""),9,ql)]),_:2},1024))],40,Hl)),n("div",Jl,[a(na,{visible:e(ae)[J.id],trigger:["click"],"onUpdate:visible":xe=>e(ae)[J.id]=xe},{overlay:o(()=>[a(oa,{class:"nc-scrollbar-md",style:{maxHeight:"70vh",overflow:"overlay"},onClick:xe=>e(ae)[J.id]=!1},{default:o(()=>[e(H)("baseRename")?(t(),m($e,{key:0,"data-testid":"nc-sidebar-source-rename",onClick:xe=>nt(J.id)},{default:o(()=>[a(de,{icon:"rename",class:"group-hover:text-black"}),q(" "+_(y.$t("general.rename")),1)]),_:2},1032,["onClick"])):L("",!0),a(Xe),a($e,{key:"erd",onClick:xe=>Ct(J)},{default:o(()=>[Q((t(),I("div",Ql,[a(de,{icon:"erd"}),q(" "+_(y.$t("title.relations")),1)])),[[Ie,["c:source:erd"]]])]),_:2},1032,["onClick"]),Ze(J)?(t(),m(ct,{key:1,base:e(s),"onUpdate:base":f[18]||(f[18]=xe=>ie(s)?s.value=xe:null),source:J},null,8,["base","source"])):L("",!0)]),_:2},1032,["onClick"])]),default:o(()=>[Q((t(),m(He,{class:te(["nc-sidebar-node-btn",{"!text-black !opacity-100 !inline-block":e(ae)[J.id]}]),type:"text",size:"xxsmall",onClick:me(xe=>e(ae)[J.id]=!e(ae)[J.id],["stop"])},{default:o(()=>[a(de,{icon:"threeDotHorizontal",class:"text-xl w-4.75"})]),_:2},1032,["class","onClick"])),[[Ie,["c:source:options"]]])]),_:2},1032,["visible","onUpdate:visible"]),e(H)("tableCreate",{roles:e(ve),source:J})?Q((t(),m(He,{key:0,type:"text",size:"xxsmall",class:te(["nc-sidebar-node-btn",{"!opacity-100 !inline-block":e(ae)[J.id]}]),onClick:me(xe=>Ht(ut),["stop"])},{default:o(()=>[a(de,{icon:"plus",class:"text-xl leading-5",style:{"-webkit-text-stroke":"0.15px"}})]),_:2},1032,["class","onClick"])),[[Ie,["c:source:add-table"]]]):L("",!0)])])]}),default:o(()=>[(t(),I("div",{ref_for:!0,ref:"menuRefs",key:`sortable-${J.id}-${J.id&&J.id in e(le)?e(le)[J.id]:"0"}`,"nc-source":J.id},[a(xa,{base:e(s),"source-index":ut},null,8,["base","source-index"])],8,Yl))]),_:2},1024))]),_:2},1032,["activeKey","class"])),[[Ie,["c:source:toggle-expand"]]]):L("",!0)]))),128))])])):L("",!0)],2)):L("",!0)],2)):L("",!0)],10,Sl)]}),_:2},[e(g)?void 0:{name:"overlay",fn:o(()=>[a(oa,{class:te(["!py-0 rounded text-sm",{"!min-w-62.5":e(x).type==="table"}])},{default:o(()=>{var Te,Vt,Mt,Pt,Nt,Bt,Et;return[e(x).type==="base"&&e(s).type==="database"?(t(),I(ye,{key:0},[],64)):e(x).type==="source"?(t(),I(ye,{key:1},[],64)):e(x).type==="table"?(t(),I(ye,{key:2},[a(Le,null,{title:o(()=>[q(_(y.$t("labels.clickToCopyTableID")),1)]),default:o(()=>{var dt;return[n("div",{class:"flex items-center justify-between p-2 mx-1.5 rounded-md cursor-pointer hover:bg-gray-100 group",onClick:me(vs,["stop"])},[n("div",Zl,_(y.$t("labels.tableIdColon",{tableId:(dt=e(x).value)==null?void 0:dt.id})),1),a(He,{class:"!group-hover:bg-gray-100",size:"xsmall",type:"secondary"},{default:o(()=>[e(sa)?(t(),m(de,{key:0,class:"max-h-4 min-w-4",icon:"check"})):(t(),m(de,{key:1,class:"max-h-4 min-w-4",else:"",icon:"copy"}))]),_:1})])]}),_:1}),e(H)("tableRename",{source:jt((Te=e(x).value)==null?void 0:Te.source_id)})||e(H)("tableDelete",{source:jt((Vt=e(x).value)==null?void 0:Vt.source_id)})?(t(),I(ye,{key:0},[a(Xe),e(H)("tableRename",{source:jt((Mt=e(x).value)==null?void 0:Mt.source_id)})?(t(),m($e,{key:0,onClick:f[20]||(f[20]=dt=>e(A)(e(x).value,!0))},{default:o(()=>[Q((t(),I("div",Xl,[a(de,{icon:"rename",class:"text-gray-700"}),q(" "+_(y.$t("general.rename"))+" "+_(y.$t("objects.table")),1)])),[[Ie,["c:table:rename"]]])]),_:1})):L("",!0),e(H)("tableDuplicate",{source:jt((Pt=e(x).value)==null?void 0:Pt.source_id)})&&((Nt=e(St))!=null&&Nt.is_meta||(Bt=e(St))!=null&&Bt.is_local)?(t(),m($e,{key:1,onClick:f[21]||(f[21]=dt=>e(V)(e(x).value))},{default:o(()=>[Q((t(),I("div",ei,[a(de,{icon:"duplicate",class:"text-gray-700"}),q(" "+_(y.$t("general.duplicate"))+" "+_(y.$t("objects.table")),1)])),[[Ie,["c:table:duplicate"]]])]),_:1})):L("",!0),a(Xe),e(H)("tableDelete",{source:jt((Et=e(x).value)==null?void 0:Et.source_id)})?(t(),m($e,{key:2,class:"!hover:bg-red-50",onClick:bt},{default:o(()=>[n("div",ti,[a(de,{icon:"delete"}),q(" "+_(y.$t("general.delete"))+" "+_(y.$t("objects.table")),1)])]),_:1})):L("",!0)],64)):L("",!0)],64)):L("",!0)]}),_:1},8,["class"])]),key:"0"}]),1024),(ha=e(x).value)!=null&&ha.id&&((ka=e(s))!=null&&ka.id)?(t(),m(gs,{key:0,visible:e(W),"onUpdate:visible":f[22]||(f[22]=Te=>ie(W)?W.value=Te:null),"table-id":($a=e(x).value)==null?void 0:$a.id,"base-id":(Ia=e(s))==null?void 0:Ia.id},null,8,["visible","table-id","base-id"])):L("",!0),a(xs,{visible:e(G),"onUpdate:visible":f[23]||(f[23]=Te=>ie(G)?G.value=Te:null),"base-id":(Ta=e(s))==null?void 0:Ta.id},null,8,["visible","base-id"]),e(vt)?(t(),m(ws,{key:1,modelValue:e(rt),"onUpdate:modelValue":f[24]||(f[24]=Te=>ie(rt)?rt.value=Te:null),base:e(vt)},null,8,["modelValue","base"])):L("",!0),a(ks,{visible:e(F),"onUpdate:visible":f[25]||(f[25]=Te=>ie(F)?F.value=Te:null),size:"large"},{default:o(()=>{var Te;return[n("div",ai,[a(hs,{"base-id":(Te=e(s))==null?void 0:Te.id,"source-id":e(ne)},null,8,["base-id","source-id"])])]}),_:1},8,["visible"])],64)}}}),oi=Be(si,[["__scopeId","data-v-d858d216"]]),ni={class:"flex items-center justify-center mt-8"},li={class:"flex flex-col gap-4 items-center text-gray-500"},ii=n("div",{class:"font-weight-medium"},"No Projects",-1),ri=n("div",{class:"text-xs"},"Create Base",-1),ci={class:"flex gap-2 justify mt-1"},di={class:"flex gap-2 items-center justify-center text-xs"},ui=pe({__name:"EmptyPlaceholder",props:{buttons:{type:Boolean}},setup(p){const j=p,d=T(!1),i=T(),l=g=>{i.value=g,d.value=!0};return(g,E)=>{const A=xo,V=ra,x=Qs,s=ga;return t(),I("div",ni,[n("div",li,[a(A),ii,j.buttons?(t(),I(ye,{key:0},[ri,n("div",ci,[a(x,{class:"flex-1 nc-btn",onClick:E[0]||(E[0]=k=>l(("NcProjectType"in g?g.NcProjectType:e(yt)).DB))},{default:o(()=>[n("div",di,[a(V,{type:("NcProjectType"in g?g.NcProjectType:e(yt)).DB,class:"text-[#2824FB] text-lg"},null,8,["type"]),q(" New Database Base ")])]),_:1})]),a(s,{modelValue:e(d),"onUpdate:modelValue":E[1]||(E[1]=k=>ie(d)?d.value=k:null),type:e(i)},null,8,["modelValue","type"])],64)):L("",!0)])])}}}),pi=p=>!!(p.offsetWidth||p.offsetHeight||p.getClientRects().length),mi=pe({__name:"ProjectWrapper",props:{baseRole:{default:""},base:{}},setup(p){const j=p,d=We(j,"baseRole"),i=We(j,"base");return ft(as,d),ft(Gt,i),(l,g)=>ca(l.$slots,"default")}}),fi={class:"nc-treeview-container flex flex-col justify-between select-none"},vi={key:0,class:"text-gray-500 font-medium pl-3.5 mb-1"},bi={mode:"inline",class:"nc-treeview pb-0.5 flex-grow min-h-50 overflow-x-hidden"},_i={key:0},yi=pe({__name:"index",setup(p){const{isUIAllowed:j}=Ge(),{$e:d}=Pe(),i=fa(),l=i.currentRoute,g=qe(),{createProject:E,updateProject:A}=g,{bases:V,basesList:x,activeProjectId:s}=ee(g),{isWorkspaceLoading:k}=ee(st()),v=T(!1),b=Je(),{isSharedBase:N,base:B}=ee(b),{activeTable:c}=ee(he()),{isMobileMode:C}=Ce(),r=Ja({}),u=(h,M)=>{r.type=h,r.value=M};function w(h,M=!1){if(!h||!h.source_id)return;d("c:table:rename");const D=T(!0),{close:R}=Re(dn,{modelValue:D,tableMeta:h,sourceId:h.source_id,"onUpdate:modelValue":K});function K(){D.value=!1,R(1e3)}}function U(h,M){if(!h&&!(M||x.value[0].id))return;d("c:table:create:navdraw");const D=T(!0),{close:R}=Re(is,{modelValue:D,sourceId:h,baseId:M||x.value[0].id,"onUpdate:modelValue":K});function K(){D.value=!1,R(1e3)}}const $=async h=>{if(!h||!h.id||!h.base_id)return;const M=T(!0);d("c:table:duplicate");const{close:D}=Re(vn,{modelValue:M,table:h,"onUpdate:modelValue":R});function R(){M.value=!1,D(1e3)}},z=oe(()=>{var h,M,D,R;return((M=(h=B.value)==null?void 0:h.sources)==null?void 0:M[0])&&j("tableCreate",{source:(R=(D=B.value)==null?void 0:D.sources)==null?void 0:R[0]})&&l.value.name!=="index"&&l.value.name!=="index-index"&&l.value.name!=="index-index-create"&&l.value.name!=="index-index-create-external"&&l.value.name!=="index-user-index"});Ka(document,"keydown",async h=>{var D;const M=At()?h.metaKey:h.ctrlKey;if(h.altKey&&!h.shiftKey&&!M)switch(h.keyCode){case 84:{if(z.value&&!Ys()){h.preventDefault(),d("c:shortcut",{key:"ALT + T"});const R=s.value,K=R?V.value.get(R):void 0;if(!K)return;R&&U((D=K.sources)==null?void 0:D[0].id,R)}break}case 76:{l.value.params.baseId&&i.push({query:{...l.value.query,clear:l.value.query.clear==="1"?void 0:"1"}});break}case 68:{h.stopPropagation(),v.value=!0;break}}});const P=h=>{var M;(M=document.querySelector(".source-context, .table-context"))!=null&&M.contains(h.target)||u("main")};ft(ma,{setMenuContext:u,duplicateTable:$,openRenameTableDialog:w,contextMenuTarget:r}),Ka(document,"contextmenu",P,!0);const H=()=>{var M;const h=document.querySelector(`.nc-treeview [data-table-id="${(M=c.value)==null?void 0:M.id}"]`);h&&(h==null||h.scrollIntoView({behavior:"smooth",block:"nearest"}))},O=async h=>{var F,Y;const{moved:{newIndex:M=0,oldIndex:D=0,element:R}}=h;if(!(R!=null&&R.id))return;let K;x.value.length-1===M?K=Math.max(...x.value.map(ce=>(ce==null?void 0:ce.order)??0))+1:M===0?K=Math.min(...x.value.map(ce=>(ce==null?void 0:ce.order)??0))/2:K=(parseFloat(String(((F=x.value[M-1])==null?void 0:F.order)??0))+parseFloat(String(((Y=x.value[M+1])==null?void 0:Y.order)??0)))/2;const ne=isNaN(Number(K))?D:K;await A(R.id,{order:ne}),d("a:base:reorder")};return ze(()=>{var h;return(h=c.value)==null?void 0:h.id},()=>{var h;(h=c.value)!=null&&h.id&&setTimeout(()=>{H()},1e3)},{immediate:!0}),ze(s,()=>{const h=document.querySelector(`.nc-treeview [data-base-id="${s.value}"]`);h&&pi(h)&&(h==null||h.scrollIntoView({behavior:"smooth"}))},{immediate:!0}),(h,M)=>{var ne,F;const D=oi,R=ui,K=ga;return t(),I("div",fi,[e(N)?L("",!0):(t(),I("div",vi,_(h.$t("objects.projects")),1)),n("div",bi,[(ne=e(x))!=null&&ne.length?(t(),I("div",_i,[a(e(wo),{"model-value":e(x),disabled:e(C)||!e(j)("baseReorder")||((F=e(x))==null?void 0:F.length)<2,"item-key":"id",handle:".base-title-node","ghost-class":"ghost",onChange:M[0]||(M[0]=Y=>O(Y))},{item:o(({element:Y})=>[(t(),I("div",{key:Y.id},[a(mi,{"base-role":Y.project_role,base:Y},{default:o(()=>[a(D)]),_:2},1032,["base-role","base"])]))]),_:1},8,["model-value","disabled"])])):e(k)?L("",!0):(t(),m(R,{key:1}))]),a(K,{modelValue:e(v),"onUpdate:modelValue":M[1]||(M[1]=Y=>ie(v)?v.value=Y:null)},null,8,["modelValue"])])}}}),gi=Be(yi,[["__scopeId","data-v-787048f5"]]),xi={};function wi(p,j){return t(),I("span")}const hi=Be(xi,[["render",wi]]),ki={};function $i(p,j){return t(),I("span")}const Ii=Be(ki,[["render",$i]]),Ti={},Di={class:"flex flex-row items-center w-full bg-white rounded-lg border-1 border-brand-500 shadow-sm mb-0.5 overflow-hidden"},Ci={class:"flex flex-grow !no-underline items-center justify-center border-r-1 h-full hover:bg-gray-100",href:"https://app.nocodb.com/#/signin?utm_source=OSS&utm_medium=OSS&utm_campaign=OSS&utm_content=OSS"},Si=n("div",{class:"px-1 text-gray-500 prose-sm",style:{"line-height":"1.3125rem"}},"Try NocoDB Cloud",-1),ji=[Si],Vi={class:"w-72 bg-transparent overflow-hidden rounded-3xl shadow border border-zinc-100"},Mi={class:"p-6 bg-white flex-col justify-start items-center gap-4 inline-flex pb-7 w-full"},Pi=n("div",{class:"self-stretch justify-start items-center gap-3 inline-flex"},[n("div",{class:"text-slate-800 text-lg font-semibold leading-9"},"NocoDB Cloud"),n("div",{class:"px-2 py-1 bg-brand-50 rounded-lg justify-center items-center gap-2 flex"},[n("div",{class:"text-brand-500 text-sm font-medium leading-tight"},"Usage based")])],-1),Ni=n("div",{class:"self-stretch justify-start items-center gap-2 inline-flex"},[n("div",{class:"text-gray-500 text-base font-bold line-through leading-normal"},[q(" $ 99 "),n("span",{class:"font-thin text-gray-500"}," Onwards ")]),n("div",{class:"text-neutral-900 text-4xl font-bold leading-10"},"Free")],-1),Bi=n("div",{class:"self-stretch text-gray-500 text-base leading-normal"},"/ month / workspace",-1),Ei={href:"https://app.nocodb.com/#/signin",target:"_blank",class:"!no-underline",rel:"noopener"},Oi=n("div",{class:"self-stretch text-center text-gray-500 text-xs font-medium leading-none mb-4"}," No credit card required ",-1),Li={class:"flex flex-col items-start w-full"},Ui=n("div",{class:"self-stretch text-gray-500 text-base font-semibold leading-tight mb-2"},"Includes",-1),Ri={class:"self-stretch justify-between items-center inline-flex"},Ai={class:"justify-end items-center gap-3 flex"},zi=n("div",{class:"text-brand-500 text-lg font-bold leading-normal"},"20 Users",-1),Gi={class:"self-stretch justify-between items-center inline-flex"},Fi={class:"justify-start items-center gap-3 flex"},Ki=n("div",{class:"text-slate-800 text-sm font-semibold leading-tight"},"300k rows / workspace",-1),Hi={class:"self-stretch justify-between items-center inline-flex"},Wi={class:"justify-start items-center gap-3 flex"},qi=n("div",{class:"text-slate-800 text-sm font-semibold leading-tight"},"25 GB+ storage",-1),Ji={class:"self-stretch justify-between items-center inline-flex"},Qi={class:"justify-start items-center gap-3 flex"},Yi=n("div",{class:"text-slate-800 text-sm font-semibold leading-tight"},"APIs : 10+ requests / second",-1),Zi={class:"self-stretch justify-start items-center gap-3 inline-flex"},Xi=n("div",{class:"text-slate-800 text-sm font-semibold leading-tight"},"Support for External Database",-1);function er(p,j){const d=Me,i=Fe,l=Zs,g=je("e");return t(),I("div",Di,[Q((t(),I("a",Ci,ji)),[[g,["c:navbar:join-cloud"]]]),a(l,{"overlay-class-name":"nc-join-cloud-tooltip"},{title:o(()=>[n("div",Vi,[n("div",Mi,[Pi,Ni,Bi,n("a",Ei,[a(d,{class:"text-gray-700 text-base font-semibold leading-tight py-4 w-full"},{default:o(()=>[q("Start for Free")]),_:1})]),Oi,n("div",Li,[Ui,n("div",Ri,[n("div",Ai,[a(i,{icon:"check",class:"text-brand-500"}),zi])])]),n("div",Gi,[n("div",Fi,[a(i,{icon:"check",class:"text-brand-500"}),Ki])]),n("div",Hi,[n("div",Wi,[a(i,{icon:"check",class:"text-brand-500"}),qi])]),n("div",Ji,[n("div",Qi,[a(i,{icon:"check",class:"text-brand-500"}),Yi])]),n("div",Zi,[a(i,{icon:"check",class:"text-brand-500"}),Xi])])])]),default:o(()=>[a(d,{type:"text",size:"small",class:"!rounded-l-none !rounded-r-lg"},{default:o(()=>[a(i,{icon:"help",class:"!text-lg -mt-0.5 text-gray-700"})]),_:1})]),_:1})])}const tr=Be(Ti,[["render",er]]),ar=ht(()=>kt(()=>import("./rHxtj-y2.js"),__vite__mapDeps([12,13,1,2]),import.meta.url).then(p=>p.default||p)),sr=ht(()=>kt(()=>import("./D1mwehxq.js"),__vite__mapDeps([14,15,1,2,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30]),import.meta.url).then(p=>p.default||p)),or=p=>(Xa("data-v-a9b6b2ee"),p=p(),es(),p),nr={class:"flex w-full flex-col py-0.9 px-1 border-gray-200 gap-y-1"},lr={class:"flex items-center pr-2 justify-between"},ir={class:"flex flex-row py-1 px-3 gap-x-2 items-center hover:bg-gray-200 rounded-lg cursor-pointer h-8","data-testid":"nc-sidebar-userinfo"},rr={class:"flex max-w-32 truncate"},cr={class:"flex gap-2 items-center"},dr={class:"menu-btn"},ur={href:"https://discord.gg/5RgZmkW",target:"_blank",class:"!underline-transparent",rel:"noopener noreferrer"},pr={class:"menu-btn"},mr={href:"https://www.reddit.com/r/NocoDB",target:"_blank",class:"!underline-transparent",rel:"noopener noreferrer"},fr={class:"menu-btn"},vr={href:"https://twitter.com/nocodb",target:"_blank",class:"!underline-transparent",rel:"noopener noreferrer"},br={class:"menu-btn"},_r={class:"flex gap-2 items-center"},yr={class:"flex items-center text-gray-400 text-xs"},gr=or(()=>n("div",{class:"flex-1"},null,-1)),xr={class:"bg-white max-h-50vh scrollbar-thin-dull min-w-64 !overflow-auto"},wr={href:"https://community.nocodb.com",target:"_blank",class:"!underline-transparent",rel:"noopener"},hr={class:"menu-btn"},kr={href:"https://docs.nocodb.com",target:"_blank",class:"!underline-transparent",rel:"noopener"},$r={class:"menu-btn"},Ir={key:1,class:"flex flex-row w-full justify-between pt-0.5 truncate"},Tr=pe({__name:"UserInfo",setup(p){const{user:j,signOut:d,appInfo:i}=Ce();mo();const{leftSidebarState:l}=ee(Zt()),g=oe(()=>{var v,b;return(b=(v=j.value)==null?void 0:v.display_name)==null?void 0:b.trim()}),E=T(!1),A=T(!1),V=T(!1),{isMobileMode:x}=Ce(),s=async()=>{var v;V.value=!0;try{const b=!!((v=j==null?void 0:j.value)!=null&&v.sso_client_id);await d(!1),await mt(b?"/sso":"/signin")}catch(b){console.error(b)}finally{V.value=!1}};ze(E,()=>{A.value&&(A.value=!1)}),ze(l,()=>{l.value==="peekCloseEnd"&&(E.value=!1)});const k=T(!1);return wt(()=>{k.value=!0}),(v,b)=>{const N=ho,B=Rt,c=Fe,C=ua,r=Ft,u=ya,w=Xs,U=ar,$=$o,z=Ii,P=ko,H=Xt,O=Kt,h=sr,M=tr,D=je("e");return t(),I("div",nr,[n("div",lr,[a(O,{visible:e(E),"onUpdate:visible":b[0]||(b[0]=R=>ie(E)?E.value=R:null),placement:"topLeft","overlay-class-name":"!min-w-64"},{overlay:o(()=>[a(H,{"data-testid":"nc-sidebar-userinfo"},{default:o(()=>[a(r,{"data-testid":"nc-sidebar-user-logout",onClick:s},{default:o(()=>[Q((t(),I("div",cr,[e(V)?(t(),m(C,{key:0,class:"!ml-0.5 !mr-0.5 !max-h-4.5 !-mt-0.5"})):(t(),m(c,{key:1,icon:"signout",class:"menu-icon"})),n("span",dr,_(v.$t("general.logout")),1)])),[[D,["c:user:logout"]]])]),_:1}),a(u),Q((t(),I("a",ur,[a(r,{class:"social-icon-wrapper"},{default:o(()=>[a(c,{class:"social-icon",icon:"ncDiscord"}),n("span",pr,_(v.$t("labels.community.joinDiscord")),1)]),_:1})])),[[D,["c:nocodb:discord"]]]),Q((t(),I("a",mr,[a(r,{class:"social-icon-wrapper"},{default:o(()=>[a(c,{class:"social-icon",icon:"ncReddit"}),n("span",fr,_(v.$t("labels.community.joinReddit")),1)]),_:1})])),[[D,["c:nocodb:reddit"]]]),Q((t(),I("a",vr,[a(r,{class:"social-icon-wrapper group"},{default:o(()=>[a(c,{class:"social-icon text-gray-500 group-hover:text-gray-800",icon:"ncTwitter"}),n("span",br,_(v.$t("labels.twitter")),1)]),_:1})])),[[D,["c:nocodb:twitter"]]]),e(i).ee?L("",!0):(t(),I(ye,{key:0},[a(u),a($,{key:"language",class:"lang-menu !py-1.5",placement:"rightBottom"},{content:o(()=>[n("div",xr,[a(U)])]),default:o(()=>[a(r,null,{default:o(()=>[Q((t(),I("div",_r,[a(c,{icon:"translate",class:"group-hover:text-black nc-language ml-0.25 menu-icon"}),q(" "+_(v.$t("labels.language"))+" ",1),n("div",yr,_(v.$t("labels.community.communityTranslated")),1),gr,a(w,{class:"transform group-hover:scale-115 group-hover:text-accent text-xl text-gray-400"})])),[[D,["c:translate:open"]]])]),_:1})]),_:1})],64)),e(x)?L("",!0):(t(),I(ye,{key:1},[a(u),Q((t(),I("a",wr,[a(r,null,{default:o(()=>[a(c,{icon:"ncHelp",class:"menu-icon mt-0.5"}),n("span",hr,_(v.$t("title.forum")),1)]),_:1})])),[[D,["c:nocodb:forum-open"]]]),Q((t(),I("a",kr,[a(r,null,{default:o(()=>[a(c,{icon:"file",class:"menu-icon mt-0.5"}),n("span",$r,_(v.$t("title.docs")),1)]),_:1})])),[[D,["c:nocodb:docs-open"]]]),a(u),("isEeUI"in v?v.isEeUI:e(at))?(t(),m(z,{key:0})):L("",!0),Q((t(),m(P,{class:"!no-underline",to:"/account/profile"},{default:o(()=>[a(r,null,{default:o(()=>[a(c,{icon:"ncSettings",class:"menu-icon"}),q(" "+_(v.$t("title.accountSettings")),1)]),_:1})]),_:1})),[[D,["c:user:settings"]]])],64))]),_:1})]),default:o(()=>{var R,K;return[n("div",ir,[a(N,{email:(R=e(j))==null?void 0:R.email,size:"auto",name:(K=e(j))==null?void 0:K.display_name},null,8,["email","name"]),a(B,null,{title:o(()=>{var ne;return[n("span",null,_(e(g)?e(g):(ne=e(j))==null?void 0:ne.email),1)]}),default:o(()=>{var ne;return[n("div",rr,_(e(g)?e(g):(ne=e(j))==null?void 0:ne.email),1)]}),_:1}),a(c,{icon:"chevronDown",class:"flex-none !min-w-5 transform rotate-180 !text-gray-500"})])]}),_:1},8,["visible"]),a(h)]),e(x)||e(i).ee?(t(),I(ye,{key:0},[],64)):(t(),I("div",Ir,[a(M)]))])}}}),Dr=Be(Tr,[["__scopeId","data-v-a9b6b2ee"]]),Cr={class:"nc-sidebar flex flex-col bg-gray-50 outline-r-1 outline-gray-100 select-none w-full h-full",style:{outlineWidth:"1px"}},Sr={class:"flex flex-col"},jr={key:0,class:"border-t-1"},Vr=pe({__name:"Sidebar",setup(p){const j=st(),{isWorkspaceLoading:d}=ee(j),{isSharedBase:i}=ee(Je()),{isMobileMode:l}=Ce(),g=T(),E=T(!1),A=()=>{if(!l.value)return g.value&&(g.value.scrollTop>0?E.value=!0:E.value=!1),!1};return wt(()=>{var V;(V=g.value)==null||V.addEventListener("scroll",A)}),eo(()=>{var V;(V=g.value)==null||V.removeEventListener("scroll",A)}),(V,x)=>{const s=Oo,k=nn,v=gi,b=hi,N=Dr;return t(),I("div",Cr,[n("div",Sr,[a(s),e(i)?L("",!0):(t(),m(k,{key:0}))]),n("div",{ref_key:"treeViewDom",ref:g,class:te(["flex flex-col nc-scrollbar-dark-md flex-grow xs:border-transparent xs:pt-2 xs:pr-2",{"border-t-1":!e(i),"border-transparent":!e(E),"pt-0.25":e(i)}])},[e(d)?L("",!0):(t(),m(v,{key:0}))],2),e(i)?L("",!0):(t(),I("div",jr,[a(b),a(N)]))])}}}),Mr=Be(Vr,[["__scopeId","data-v-bef420bb"]]),Pr={class:"prose-xl font-bold self-center"},Nr=n("div",{class:"my-4"},"Select workspace to duplicate shared base to:",-1),Br={class:"prose-md self-center text-gray-500 mt-4"},Er={class:"text-xs p-2"},Or={class:"flex flex-row gap-x-2 mt-2.5 pt-2.5 justify-end"},Lr=pe({__name:"SharedBaseDuplicate",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(p,{emit:j}){const d=p,i=j,{api:l}=zt(),{sharedBaseId:g}=us(),E=st(),{populateWorkspace:A}=E,{workspacesList:V}=ee(E),{ncNavigateTo:x}=Ce(),s=Ye(d,"modelValue",i),k=T({includeData:!0,includeViews:!0}),v=oe(()=>{const{includeData:r,includeViews:u}=k.value;return{excludeData:!r,excludeViews:!u}}),b=T(!1),N=T(),{$e:B,$poller:c}=Pe(),C=async()=>{if(!(!N.value&&at))try{b.value=!0;const r=await l.base.duplicateShared(N.value??"nc",g.value,{options:v.value,base:at?{fk_workspace_id:N.value,type:to.DATABASE}:{}});g.value=null,c.subscribe({id:r.id},async u=>{u.status!=="close"&&(u.status===gt.COMPLETED?(console.log("job completed",r),await x({...at?{workspaceId:r.fk_workspace_id}:{},baseId:r.base_id}),b.value=!1,s.value=!1):u.status===gt.FAILED&&(ue.error("Failed to duplicate shared base"),await A(),b.value=!1,s.value=!1))}),B("a:base:duplicate-shared-base")}catch(r){ue.error(await Se(r)),b.value=!1,s.value=!1}};return(r,u)=>{const w=Io,U=ba,$=_a,z=Me,P=It,H=je("e");return t(),m(P,{visible:e(s),"onUpdate:visible":u[4]||(u[4]=O=>ie(s)?s.value=O:null),class:"!w-[30rem]","wrap-class-name":"nc-modal-project-duplicate"},{default:o(()=>[n("div",null,[n("div",Pr,_(r.$t("general.duplicate"))+" "+_(r.$t("labels.sharedBase")),1),("isEeUI"in r?r.isEeUI:e(at))?(t(),I(ye,{key:0},[Nr,a(w,{value:e(N),"onUpdate:value":u[0]||(u[0]=O=>ie(N)?N.value=O:null),class:"w-full",options:e(V).map(O=>({label:`${O.title[0].toUpperCase()}${O.title.slice(1)}`,value:O.id})),placeholder:"Select Workspace"},null,8,["value","options"])],64)):L("",!0),n("div",Br,_(r.$t("title.advancedSettings")),1),a(U,{class:"!m-0 !p-0 !my-2"}),n("div",Er,[a($,{checked:e(k).includeData,"onUpdate:checked":u[1]||(u[1]=O=>e(k).includeData=O)},{default:o(()=>[q(_(r.$t("labels.includeData")),1)]),_:1},8,["checked"]),a($,{checked:e(k).includeViews,"onUpdate:checked":u[2]||(u[2]=O=>e(k).includeViews=O)},{default:o(()=>[q(_(r.$t("labels.includeView")),1)]),_:1},8,["checked"])])]),n("div",Or,[a(z,{key:"back",type:"secondary",onClick:u[3]||(u[3]=O=>s.value=!1)},{default:o(()=>[q(_(r.$t("general.cancel")),1)]),_:1}),Q((t(),m(z,{key:"submit",loading:e(b),disabled:!e(N)&&("isEeUI"in r?r.isEeUI:e(at)),onClick:C},{default:o(()=>[q(_(r.$t("general.confirm")),1)]),_:1},8,["loading","disabled"])),[[H,["a:shared-base:duplicate"]]])])]),_:1},8,["visible"])}}}),Ur=ht(()=>kt(()=>import("./x2MrpW2k.js"),__vite__mapDeps([31,1,2,8,9,10,27,28,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,19,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64]),import.meta.url).then(p=>p.default||p)),Wc=pe({__name:"index",setup(p){const j=T(!1),d=T(""),i=T(""),l=T(),g=qe(),{populateWorkspace:E}=st(),{signedIn:A}=Ce(),{isUIAllowed:V}=Ge(),s=fa().currentRoute,{basesList:k}=ee(g),v=async()=>{const u=s.value.name;u!=="index-typeOrId"&&u!=="index"||await g.navigateToProject({baseId:k.value[0].id})},b=oe(()=>{const u=s.value.name||"";return!u.startsWith("index-typeOrId-baseId-")&&!["index","index-typeOrId"].includes(u)}),N=oe(()=>(s.value.name||"").startsWith("index-typeOrId-form-viewId")),{sharedBaseId:B}=us(),c=T(!1);async function C(){if(!b.value){if(s.value.params.typeOrId==="base"){await E();return}if(!A.value){mt("/signIn");return}await E(),!s.value.params.baseId&&k.value.length>0&&await v()}}ze(()=>s.value.params.typeOrId,()=>{C()}),wt(()=>{var u;if((u=s.value.query)!=null&&u.continueAfterSignIn)return localStorage.removeItem("continueAfterSignIn"),mt(s.value.query.continueAfterSignIn);{const w=localStorage.getItem("continueAfterSignIn");if(localStorage.removeItem("continueAfterSignIn"),w)return mt({path:w,query:s.value.query})}C().then(()=>{if(B.value){if(!V("baseDuplicate")){ue.error("You are not allowed to create base");return}c.value=!0}})});function r(u,w,U,$){j.value=u??!j.value,d.value=w||"",i.value=U||"",l.value=$||""}return ft(os,r),(u,w)=>{const U=ao,$=so,z=Mr,P=Ur,H=Lr;return t(),I("div",null,[e(N)?(t(),m($,{key:0},{default:o(()=>[a(U)]),_:1})):e(b)?(t(),m($,{key:1,name:"shared-view"},{default:o(()=>[a(U)]),_:1})):(t(),m($,{key:2,name:"dashboard"},{sidebar:o(()=>[a(z)]),content:o(()=>[a(U)]),_:1})),a(P,{"model-value":e(j),"onUpdate:modelValue":w[0]||(w[0]=O=>ie(j)?j.value=O:null),"open-key":e(d),"onUpdate:openKey":w[1]||(w[1]=O=>ie(d)?d.value=O:null),"data-sources-state":e(i),"onUpdate:dataSourcesState":w[2]||(w[2]=O=>ie(i)?i.value=O:null),"base-id":e(l)},null,8,["model-value","open-key","data-sources-state","base-id"]),e(V)("baseDuplicate")?(t(),m(H,{key:3,modelValue:e(c),"onUpdate:modelValue":w[3]||(w[3]=O=>ie(c)?c.value=O:null)},null,8,["modelValue"])):L("",!0)])}}});export{Wc as default};
