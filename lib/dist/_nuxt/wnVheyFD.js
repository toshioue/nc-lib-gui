import{e as oe,cL as re,L as ue,bL as f,r as o,hK as ie,aA as ce,aC as me,h_ as ve,i2 as fe,aD as de,h5 as pe,ha as ye,g2 as he,ag as $e,f as w,cq as u,D as ke,ad as N,F as A,d0 as ge,dc as Y,aE as He,j4 as Me,o as E,c as O,b as z,w as G,a as _,N as s,a7 as Ve,W as j,Q as Ye,R as L,S as be,ao as De,a$ as Ie,Y as Ce,_ as we}from"./DZZ6t_j4.js";import{_ as Fe}from"./CbkSs5Gy.js";import{_ as Ee}from"./vK-WmZ7a.js";const _e=["title"],je=["value","placeholder","readonly"],Pe={class:"min-w-[72px]"},Te={key:0,class:"absolute inset-0 z-90 cursor-pointer"},xe=oe({__name:"TimePicker",props:{modelValue:{},isPk:{type:Boolean}},emits:["update:modelValue"],setup($,{emit:R}){const P=R,{isMysql:U}=re(),{showNull:F,isMobileMode:q}=ue(),H=f(ie,o(!1)),b=f(ce,o(!1)),i=f(me,o(!1)),k=f(ve,o(!1)),d=f(fe,o(!1)),Q=f(de,o(!1)),W=f(pe,o(!1)),g=f(ye,o(!1)),p=f(he),Z=U(p.value.source_id)?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD HH:mm:ssZ",D=o(!1),c=o(),I=o(!1),{t:T}=$e(),t=o(!1),y=o(),n=w({get(){if(!$.modelValue||I.value)return;let e=u($.modelValue);if(e.isValid()||(e=u($.modelValue,"HH:mm:ss")),e.isValid()||(e=u(`1999-01-01 ${$.modelValue}`)),!e.isValid()){D.value=!0;return}return e},set(e){if(I.value=!1,!e){P("update:modelValue",null);return}if(e.isValid()){const a=e.format("HH:mm"),l=u(`1999-01-01 ${a}:00`);P("update:modelValue",l.format(Z))}}});ke(()=>{n.value&&(y.value=n.value)});const m=`picker_${Math.floor(Math.random()*99999)}`;N(c,e=>{var a,l,r;(a=e.target)!=null&&a.closest(`.${m}, .nc-${m}`)||((r=(l=c.value)==null?void 0:l.blur)==null||r.call(l),t.value=!1)});const J=e=>{var a,l;(a=e==null?void 0:e.relatedTarget)!=null&&a.closest(`.${m}, .nc-${m}`)||(l=e==null?void 0:e.target)!=null&&l.closest(`.${m}, .nc-${m}`)||(t.value=!1)},X=()=>{t.value=!0};A(t,e=>{var a,l;e?(i.value=!0,(l=(a=c.value)==null?void 0:a.focus)==null||l.call(a),N(document.querySelector(`.${m}`),r=>{var v;(v=r==null?void 0:r.target)!=null&&v.closest(`.nc-${m}`)||(t.value=!1)})):I.value=!1},{flush:"post"}),A(i,e=>{d.value&&e&&!t.value&&(t.value=!0)});const ee=w(()=>(Q.value||g.value)&&!D.value||d.value&&!F.value&&!D.value&&!ge(p.value)&&b.value||k.value?Y(p.value.meta).is12hrFormat?"hh:mm AM":"HH:mm":$.modelValue===null&&F.value?T("general.null").toUpperCase():D.value?T("msg.invalidTime"):""),M=w(()=>H.value||(H.value||n.value&&$.isPk)&&!b.value&&!i.value?!1:t.value),ae=()=>{H.value||t.value||(t.value=b.value||i.value)},le=(e,a)=>{var l,r,v,V,h,S,C,B;switch(e.key!=="Enter"&&e.stopPropagation(),e.key){case"Enter":e.preventDefault(),W.value&&e.stopPropagation(),n.value=y.value,t.value=!a,t.value||d.value&&!g.value&&!k.value&&(i.value=!1,(r=(l=c.value)==null?void 0:l.blur)==null||r.call(l));return;case"Tab":t.value=!1,d.value&&!g.value&&!k.value&&(i.value=!1,(V=(v=c.value)==null?void 0:v.blur)==null||V.call(v));return;case"Escape":a?(t.value=!1,d.value&&!g.value&&!k.value&&(i.value=!1,(S=(h=c.value)==null?void 0:h.blur)==null||S.call(h))):(i.value=!1,(B=(C=c.value)==null?void 0:C.blur)==null||B.call(C));return;default:if(!a&&/^[0-9a-z]$/i.test(e.key)){t.value=!0;const K=e.target,ne=K.value;Ie(()=>{K.value=ne})}}};He(document,"keydown",e=>{if(b.value&&!(e.altKey||e.shiftKey||!d.value||g.value||k.value||Me())){if(e.metaKey||e.ctrlKey)if(e.key===";")d.value&&!g.value&&!k.value&&(n.value=u(new Date),e.preventDefault());else return;!M.value&&c.value&&/^[0-9a-z]$/i.test(e.key)&&(I.value=!0,c.value.focus(),i.value=!0,t.value=!0)}});const te=e=>{let a=e.target.value;if(!a){y.value=void 0;return}a=Y(p.value.meta).is12hrFormat?a.trim().toUpperCase().replace(/(AM|PM)$/," $1").replace(/\s+/g," "):a.trim();const l=u(a,Y(p.value.meta).is12hrFormat?"hh:mm A":"HH:mm");l.isValid()&&(y.value=u(`${u().format("YYYY-MM-DD")} ${l.format("HH:mm")}`))};function x(e){if(e||(y.value=void 0,n.value=void 0),!!(e!=null&&e.isValid())){if(n.value){const a=u(`${n.value.format("YYYY-MM-DD")} ${e.format("HH:mm")}:00`);y.value=a,n.value=a}else{const a=u(`${u().format("YYYY-MM-DD")} ${e.format("HH:mm")}:00`);y.value=a,n.value=a}t.value=!1}}const se=w(()=>{var e;return((e=n.value)==null?void 0:e.format(Y(p.value.meta).is12hrFormat?"hh:mm A":"HH:mm"))??""});return(e,a)=>{const l=Ce,r=Fe,v=Ee;return E(),O(De,null,[z(v,{visible:s(M),"auto-close":!1,trigger:["click"],class:be(["nc-cell-field",[`nc-${m}`,{"nc-null":e.modelValue===null&&s(F)}]]),"overlay-class-name":`${m} nc-picker-time ${s(M)?"active":""} !min-w-[0]`},{overlay:G(()=>[_("div",Pe,[z(r,{"selected-date":s(n),"min-granularity":30,"is-min-granularity-picker":"","is12hr-format":!!("parseProp"in e?e.parseProp:s(Y))(s(p).meta).is12hrFormat,"is-open":s(M),"onUpdate:selectedDate":x},null,8,["selected-date","is12hr-format","is-open"])])]),default:G(()=>{var V;return[_("div",Ve(e.$attrs,{title:(V=s(n))==null?void 0:V.format("HH:mm"),class:"nc-time-picker h-full flex items-center justify-between ant-picker-input relative"}),[_("input",{ref_key:"datePickerRef",ref:c,type:"text",value:s(se),placeholder:s(ee),class:"nc-time-input border-none outline-none !text-current bg-transparent !focus:border-none !focus:outline-none !focus:ring-transparent",readonly:s(H)||!!s(q),onBlur:J,onFocus:X,onKeydown:a[0]||(a[0]=h=>le(h,s(M))),onMouseup:a[1]||(a[1]=j(()=>{},["stop"])),onMousedown:a[2]||(a[2]=j(()=>{},["stop"])),onClick:ae,onInput:te},null,40,je),s(n)&&!s(H)?(E(),Ye(l,{key:0,icon:"closeCircle",class:"nc-clear-time-icon nc-action-icon absolute right-0 top-[50%] transform -translate-y-1/2 invisible cursor-pointer",onClick:a[3]||(a[3]=j(h=>x(),["stop"]))})):L("",!0)],16,_e)]}),_:1},8,["visible","class","overlay-class-name"]),!s(i)&&s(d)?(E(),O("div",Te)):L("",!0)],64)}}}),Ne=we(xe,[["__scopeId","data-v-fcc85f87"]]);export{Ne as default};
