const __vite__fileDeps=["./Dionry76.js","./IkCtZ7K_.js","./BLdk6lRf.js","./entry.B8GgT5QA.css","./CfAb_ncs.js","./Overlay.xLwTZrd0.css","./C9I3jrHo.js","./C0Si9_oy.js","./BD_L_KCX.js","./View.B2EG4bUV.css","./VZhZ56n0.js","./7llLzxgh.js","./DCNkOWj0.js","./Cajlse94.js","./DZeneEWs.js","./BrF0EXdL.js","./CBNgcPSC.js","./BQQOEPN4.js","./DTv03lbO.js","./C-Z2v8Hi.js","./KHtB3uuq.js","./BEQSmtSk.js","./CAR_5qDD.js","./JimKVLH8.js","./DWFLnnq8.js","./BTh9o-aK.js","./ETGzLqdt.js","./BaseAudit.MBpv011d.css","./C6sDqFFV.js","./CNECvkUK.js","./yAvBJhn8.js","./BLwY008C.js","./SourceRestrictions.DpEG1vlF.css","./DxIF88SA.js","./y7P9C4A6.js","./boyBAVNN.js","./DD6KJAAC.js","./BNDnQ_SZ.js","./JCToPTxN.js","./wBAlULwF.js","./BHsm5GSJ.js","./QXgsgnSx.js","./9nfE2yqV.js","./EditBase.CK7KypOJ.css","./UflPNRi3.js","./CDdKupVi.js","./Checkbox.M_COpns0.css","./Df7iec88.js","./DVMqg8Nk.js","./B2oTMMt7.js","./ClgSMhxf.js","./B0-3_x1m.js","./DeleteModal.SEMJ_gSK.css","./BTZSPjiu.js","./CreateBase.Bk0G8SAm.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{f as X,aK as ke,gl as ne,aP as Be,b as l,aM as he,aO as _e,af as He,cn as Ae,c9 as Ze,aZ as Je,bD as qe,aL as Ie,aa as ge,aY as Xe,N as et,cB as tt,au as Ee,at as we,bL as at,gT as Me,g as J,ai as Pe,H as le,r as U,i as st,O as ot,o as c,c as M,a,R as ye,U as I,w as r,d as K,t as v,P as e,Q as z,an as Z,ac as re,L as Re,cI as nt,dM as j,gU as Q,S as R,V as oe,W as me,Y as ue,al as H,Z as ee,a5 as te,fP as lt,ao as pe,a2 as rt,dH as it,a1 as ct,$ as dt,ap as ut,p as pt,e as mt,A as Oe,_ as Le,ab as _t,av as vt,am as De,T as Ne,aS as ft,a9 as bt,ca as yt}from"./BLdk6lRf.js";import{C as ht}from"./C9I3jrHo.js";import{_ as gt}from"./DrufEDWe.js";import{c as wt}from"./QYPbAW4m.js";import{_ as St}from"./D1rFOljU.js";import{u as kt}from"./CT2-bEeO.js";import{D as $t}from"./DJNpGLJk.js";import{D as Ct}from"./BrF0EXdL.js";import{_ as xt}from"./yAvBJhn8.js";import{T as It}from"./CrbWcN5i.js";import{L as Dt,a as Nt,_ as Tt}from"./DxoCgYWw.js";import"./C0Si9_oy.js";import"./BD_L_KCX.js";import"./wY1y7Ha2.js";import"./BTZSPjiu.js";import"./DD6KJAAC.js";import"./JCToPTxN.js";import"./BLwY008C.js";import"./CBNgcPSC.js";import"./wBAlULwF.js";import"./JimKVLH8.js";import"./DWFLnnq8.js";import"./BQQOEPN4.js";import"./C-Z2v8Hi.js";import"./BTh9o-aK.js";import"./ETGzLqdt.js";import"./DlUxsCvA.js";import"./9nfE2yqV.js";import"./y7P9C4A6.js";import"./Cdzx44_6.js";import"./CpASSaD_.js";import"./DTv03lbO.js";import"./QXgsgnSx.js";import"./B0-3_x1m.js";import"./DDDDo8jf.js";import"./DZeneEWs.js";var Bt=["class","style"],At=function(){return{prefixCls:String,href:String,separator:_e.any,overlay:_e.any,onClick:Function}};const ie=X({compatConfig:{MODE:3},name:"ABreadcrumbItem",inheritAttrs:!1,__ANT_BREADCRUMB_ITEM:!0,props:At(),slots:["separator","overlay"],setup:function(m,h){var y=h.slots,i=h.attrs,D=ke("breadcrumb",m),w=D.prefixCls,B=function(S,k){var u=ne(y,m,"overlay");return u?l(He,{overlay:u,placement:"bottom"},{default:function(){return[l("span",{class:"".concat(k,"-overlay-link")},[S,l(Ct,null,null)])]}}):S};return function(){var A,S=(A=ne(y,m,"separator"))!==null&&A!==void 0?A:"/",k=ne(y,m),u=i.class,f=i.style,d=Be(i,Bt),p;return m.href!==void 0?p=l("a",he({class:"".concat(w.value,"-link"),onClick:m.onClick},d),[k]):p=l("span",he({class:"".concat(w.value,"-link"),onClick:m.onClick},d),[k]),p=B(p,w.value),k?l("span",{class:u,style:f},[p,S&&l("span",{class:"".concat(w.value,"-separator")},[S])]):null}}});var Et=function(){return{prefixCls:String,routes:{type:Array},params:_e.any,separator:_e.any,itemRender:{type:Function}}};function Mt(o,m){if(!o.breadcrumbName)return null;var h=Object.keys(m).join("|"),y=o.breadcrumbName.replace(new RegExp(":(".concat(h,")"),"g"),function(i,D){return m[D]||i});return y}function Te(o){var m=o.route,h=o.params,y=o.routes,i=o.paths,D=y.indexOf(m)===y.length-1,w=Mt(m,h);return D?l("span",null,[w]):l("a",{href:"#/".concat(i.join("/"))},[w])}const q=X({compatConfig:{MODE:3},name:"ABreadcrumb",props:Et(),slots:["separator","itemRender"],setup:function(m,h){var y=h.slots,i=ke("breadcrumb",m),D=i.prefixCls,w=i.direction,B=function(u,f){return u=(u||"").replace(/^\//,""),Object.keys(f).forEach(function(d){u=u.replace(":".concat(d),f[d])}),u},A=function(u,f,d){var p=Xe(u),g=B(f||"",d);return g&&p.push(g),p},S=function(u){var f=u.routes,d=f===void 0?[]:f,p=u.params,g=p===void 0?{}:p,s=u.separator,N=u.itemRender,$=N===void 0?Te:N,C=[];return d.map(function(T){var E=B(T.path,g);E&&C.push(E);var W=[].concat(C),O=null;return T.children&&T.children.length&&(O=l(ge,null,{default:function(){return[T.children.map(function(G){return l(ge.Item,{key:G.path||G.breadcrumbName},{default:function(){return[$({route:G,params:g,routes:d,paths:A(W,G.path,g)})]}})})]}})),l(ie,{overlay:O,separator:s,key:E||T.breadcrumbName},{default:function(){return[$({route:T,params:g,routes:d,paths:W})]}})})};return function(){var k,u,f,d=m.routes,p=m.params,g=p===void 0?{}:p,s=Ae(ne(y,m)),N=(k=ne(y,m,"separator"))!==null&&k!==void 0?k:"/",$=m.itemRender||y.itemRender||Te;d&&d.length>0?f=S({routes:d,params:g,separator:N,itemRender:$}):s.length&&(f=s.map(function(T,E){return Ze(Je(T.type)==="object"&&(T.type.__ANT_BREADCRUMB_ITEM||T.type.__ANT_BREADCRUMB_SEPARATOR),"Breadcrumb","Only accepts Breadcrumb.Item and Breadcrumb.Separator as it's children"),qe(T,{separator:N,key:E})}));var C=(u={},Ie(u,D.value,!0),Ie(u,"".concat(D.value,"-rtl"),w.value==="rtl"),u);return l("div",{class:C},[f])}}});var Pt=["separator","class"],Rt=function(){return{prefixCls:String}};const Se=X({compatConfig:{MODE:3},name:"ABreadcrumbSeparator",__ANT_BREADCRUMB_SEPARATOR:!0,inheritAttrs:!1,props:Rt(),setup:function(m,h){var y=h.slots,i=h.attrs,D=ke("breadcrumb",m),w=D.prefixCls;return function(){var B;i.separator;var A=i.class,S=Be(i,Pt),k=Ae((B=y.default)===null||B===void 0?void 0:B.call(y));return l("span",he({class:["".concat(w.value,"-separator"),A]},S),[k.length>0?k:"/"])}}});q.Item=ie;q.Separator=Se;q.install=function(o){return o.component(q.name,q),o.component(ie.name,ie),o.component(Se.name,Se),o};const Ot={class:"flex flex-row w-full"},Lt={class:"flex flex-col w-full"},jt={class:"flex flex-row items-center w-full mb-4 gap-2"},Ut=a("br",null,null,-1),zt={class:"text-gray-500"},Vt={class:"flex flex-row items-center w-full mb-4 gap-2"},Kt=a("br",null,null,-1),Ft={class:"text-gray-500"},Qt={class:"flex flex-row items-center w-full mb-4 gap-2"},Gt=a("br",null,null,-1),Yt={class:"text-gray-500"},Wt=X({__name:"Misc",setup(o){const{includeM2M:m,showNull:h}=et(),y=tt(),i=Ee(),{loadTables:D,hasEmptyOrNullFilters:w}=y,{base:B}=we(y),A=at(Me,void 0),S=J(()=>{var d;return(A==null?void 0:A.value)??((d=B.value)==null?void 0:d.id)}),{t:k}=Pe();le(m,async()=>await D());const u=U();st(async()=>{var d;await i.loadProject(S.value,!0),u.value=(d=i.getProjectMeta(S.value))==null?void 0:d.showNullAndEmptyInFilter});async function f(d){const p=i.bases.get(S.value);if(!p)throw new Error(`Base ${S.value} not found`);const g=i.getProjectMeta(S.value)??{};d.target.checked||await w()&&(u.value=!0,Z.warning(k("msg.error.nullFilterExists")));const s={...g,showNullAndEmptyInFilter:u.value};p.meta=s,await i.updateProject(S.value,{meta:JSON.stringify(s)})}return(d,p)=>{const g=ht,s=ot("e");return c(),M("div",Ot,[a("div",Lt,[a("div",jt,[ye((c(),I(g,{checked:e(m),"onUpdate:checked":p[0]||(p[0]=N=>z(m)?m.value=N:null),class:"nc-settings-meta-misc"},{default:r(()=>[K(v(d.$t("msg.info.showM2mTables"))+" ",1),Ut,a("span",zt,v(d.$t("msg.info.showM2mTablesDesc")),1)]),_:1},8,["checked"])),[[s,["c:themes:show-m2m-tables"]]])]),a("div",Vt,[ye((c(),I(g,{checked:e(h),"onUpdate:checked":p[1]||(p[1]=N=>z(h)?h.value=N:null),class:"nc-settings-show-null"},{default:r(()=>[K(v(d.$t("msg.info.showNullInCells"))+" ",1),Kt,a("span",Ft,v(d.$t("msg.info.showNullInCellsDesc")),1)]),_:1},8,["checked"])),[[s,["c:settings:show-null"]]])]),a("div",Qt,[ye((c(),I(g,{checked:e(u),"onUpdate:checked":p[2]||(p[2]=N=>z(u)?u.value=N:null),class:"nc-settings-show-null-and-empty-in-filter",onChange:f},{default:r(()=>[K(v(d.$t("msg.info.showNullAndEmptyInFilter"))+" ",1),Gt,a("span",Yt,v(d.$t("msg.info.showNullAndEmptyInFilterDesc")),1)]),_:1},8,["checked"])),[[s,["c:settings:show-null-and-empty-in-filter"]]])])])])}}}),Ht=ee(()=>te(()=>import("./Dionry76.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]),import.meta.url).then(o=>o.default||o)),Zt=ee(()=>te(()=>import("./VZhZ56n0.js"),__vite__mapDeps([10,2,3,11,12,13,14,15,16,17,18,19,8,20,21,6,7,22,23,24,25,26,27]),import.meta.url).then(o=>o.default||o)),Jt=ee(()=>te(()=>import("./C6sDqFFV.js"),__vite__mapDeps([28,29,2,3,30,8,31,16,32,33,34,35,36,37,38,39,23,24,17,19,25,26,40,15,18,41,42,43]),import.meta.url).then(o=>o.default||o)),qt=ee(()=>te(()=>import("./UflPNRi3.js"),__vite__mapDeps([44,2,3,45,6,7,8,46,47,23,24,17,19,25,26,11,12,13,14,15,16,18,20,21,22]),import.meta.url).then(o=>o.default||o)),Xt=ee(()=>te(()=>import("./DVMqg8Nk.js"),__vite__mapDeps([48,47,2,3,49,11,12,13,14,15,16,17,18,19,8,20,21,6,7,22,23,24,25,26]),import.meta.url).then(o=>o.default||o)),ea=ee(()=>te(()=>import("./ClgSMhxf.js"),__vite__mapDeps([50,2,3,29,30,8,31,16,32,33,34,35,51,52,36,37,53,38,39,23,24,17,19,25,26,40,15,18,41,42,54]),import.meta.url).then(o=>o.default||o)),je=o=>(pt("data-v-bd50df37"),o=o(),mt(),o),ta={class:"flex flex-col h-full","data-testid":"nc-settings-datasources-tab"},aa={class:"px-4 py-2 flex justify-between"},sa=je(()=>a("a",{class:"!no-underline"},"Data Sources",-1)),oa={class:"capitalize"},na={class:"flex flex-row items-center w-full gap-x-1"},la={class:"flex"},ra={"data-testid":"nc-settings-datasources",class:"flex flex-row w-full nc-data-sources-view flex-grow min-h-0"},ia={class:"tab","data-testid":"nc-erd-tab"},ca={class:"h-full pt-4"},da={class:"tab","data-testid":"nc-audit-tab"},ua={class:"p-4 h-full"},pa={class:"tab","data-testid":"nc-connection-tab"},ma={class:"p-6 mt-4 h-full overflow-auto"},_a={class:"tab","data-testid":"nc-acl-tab"},va={class:"pt-4 h-full"},fa={class:"tab","data-testid":"nc-meta-sync-tab"},ba={class:"pt-4 h-full"},ya={key:1,class:"flex flex-col w-full overflow-auto mt-1"},ha={class:"overflow-y-auto nc-scrollbar-md",style:{maxHeight:"calc(100vh - 200px)"}},ga={class:"ds-table-head"},wa={class:"ds-table-row"},Sa={class:"ds-table-col ds-table-enabled cursor-pointer"},ka={class:"ds-table-col ds-table-name"},$a={class:"ds-table-col ds-table-type"},Ca={class:"ds-table-col ds-table-actions"},xa={class:"ds-table-body"},Ia={class:"ds-table-col ds-table-enabled"},Da={key:0,class:"ds-table-handle"},Na={class:"ds-table-col ds-table-name font-medium"},Ta={class:"flex items-center gap-1"},Ba=je(()=>a("div",{class:"ds-table-col ds-table-type"},[a("div",{class:"flex items-center gap-1"},"-")],-1)),Aa={class:"ds-table-col ds-table-actions"},Ea=["onClick"],Ma={class:"ds-table-col ds-table-enabled"},Pa={class:"ds-table-col ds-table-name font-medium w-full"},Ra={key:0,class:"h-8 w-1"},Oa={key:1,class:"truncate"},La={class:"ds-table-col ds-table-type"},ja={class:"flex items-center gap-2"},Ua={class:"text-gray-700 capitalize"},za={class:"ds-table-col justify-end gap-x-1 ds-table-actions"},Va={key:0,class:"flex flex-row items-center py-2 px-3.25 bg-gray-50 rounded-lg text-gray-700 mb-4"},Ka={class:"capitalize text-ellipsis overflow-hidden select-none w-full pl-3",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},Fa=X({__name:"DataSources",props:{state:{},baseId:{},reload:{type:Boolean}},emits:["update:state","update:reload"],setup(o,{emit:m}){const h=o,y=m,i=re(h,"state",y),D=re(h,"reload",y),{$api:w,$e:B}=Oe(),A=Ee(),{loadProject:S}=A,{isDataSourceLimitReached:k,bases:u}=we(A),f=J(()=>u.value.get(h.baseId)??{}),{isUIAllowed:d}=Re(),{projectPageTab:p}=we(kt()),{refreshCommandPalette:g}=nt(),s=U([]),N=U(""),$=U(j.MYSQL),C=U(!1),T=U(!1),E=U();async function W(){const t=new Set;let n=!1;for(const x of s.value){if(x.order===null||t.has(x.order)){n=!0;break}t.add(x.order)}if(n){s.value=s.value.map((x,L)=>({...x,order:L+1}));try{await Promise.all(s.value.map(async x=>{await w.source.update(x.base_id,x.id,{id:x.id,base_id:x.base_id,order:x.order})}))}catch(x){Z.error(await pe(x))}}}async function O(t){try{t&&g(),await lt(()=>!!f.value.id).toBeTruthy(),C.value=!0,D.value=!0;const n=await w.source.list(f.value.id);n.list&&n.list.length&&(s.value=n.list),await W()}catch(n){console.error(n)}finally{D.value=!1,C.value=!1}}const ae=(t,n)=>{t&&(N.value=t,i.value=n||"")},G=t=>{B("c:source:delete"),T.value=!0,E.value=t},ce=async()=>{if(E.value)try{await w.source.delete(E.value.base_id,E.value.id),B("a:source:delete"),s.value.splice(s.value.indexOf(E.value),1),await S(f.value.id,!0)}catch(t){Z.error(await pe(t))}finally{g()}},de=async(t,n)=>{try{if(!n&&s.value.filter(x=>x.enabled).length<2){Z.info("There should be at least one enabled source!");return}t.enabled=n,await w.source.update(t.base_id,t.id,{id:t.id,base_id:t.base_id,enabled:t.enabled}),await S(f.value.id,!0)}catch(x){Z.error(await pe(x))}finally{g()}},P=async t=>{var n,x;try{if(t.oldIndex===t.newIndex)return;const L=s.value[t.newIndex];if(L){let Y;s.value.length-1===t.newIndex?Y=Math.max(...s.value.map(F=>(F==null?void 0:F.order)??0))+1:Y=(parseFloat(String(((n=s.value[t.newIndex-1])==null?void 0:n.order)??0))+parseFloat(String(((x=s.value[t.newIndex+1])==null?void 0:x.order)??0)))/2;const ve=isNaN(Number(Y))?t.oldIndex:Y;await w.source.update(L.base_id,L.id,{id:L.id,base_id:L.base_id,order:ve})}await S(f.value.id,!0),await O()}catch(L){Z.error(await pe(L))}finally{await g()}};le(p,()=>{p.value==="data-source"&&O()},{immediate:!0}),le(()=>h.reload,async t=>{t&&!C.value&&await O()}),le(i,async t=>{switch(s.value.length||await O(),t){case j.MYSQL:$.value=j.MYSQL,i.value=Q.New;break;case j.PG:$.value=j.PG,i.value=Q.New;break;case j.SQLITE:$.value=j.SQLITE,i.value=Q.New;break;case j.MSSQL:$.value=j.MSSQL,i.value=Q.New;break;case j.SNOWFLAKE:$.value=j.SNOWFLAKE,i.value=Q.New;break;case Q.New:k.value&&(i.value="");break}g()},{immediate:!0});const V=J({get:()=>[Q.New].includes(i.value),set:t=>{t||(i.value="")}}),b=U(null),se=U("erd");return(t,n)=>{const x=ie,L=q,Y=rt,ve=Ht,F=it,Ue=Zt,ze=Jt,Ve=qt,Ke=Xt,Fe=gt,$e=xt,Ce=ct,fe=dt,xe=wt,Qe=ut,Ge=ea,Ye=St;return c(),M("div",ta,[a("div",aa,[l(L,{separator:">",class:"w-full cursor-pointer font-weight-bold"},{default:r(()=>[l(x,{onClick:n[0]||(n[0]=_=>b.value=null)},{default:r(()=>[sa]),_:1}),e(b)?(c(),I(x,{key:0},{default:r(()=>[a("span",oa,v(e(b).alias||"Default Source"),1)]),_:1})):R("",!0)]),_:1}),!e(k)&&!e(b)&&e(d)("sourceCreate")?(c(),I(Y,{key:0,size:"large",class:"z-10 !px-2",type:"primary",onClick:n[1]||(n[1]=_=>i.value=("DataSourcesSubTab"in t?t.DataSourcesSubTab:e(Q)).New)},{default:r(()=>[a("div",na,[(c(),I(oe(("iconMap"in t?t.iconMap:e(me)).plus))),a("div",la,v(t.$t("activity.newSource")),1)])]),_:1})):R("",!0)]),a("div",ra,[e(b)?(c(),I(Fe,{key:0,activeKey:e(se),"onUpdate:activeKey":n[5]||(n[5]=_=>z(se)?se.value=_:null),class:"nc-source-tab w-full"},{default:r(()=>[l(F,{key:"erd"},{tab:r(()=>[a("div",ia,[a("div",null,v(t.$t("title.erdView")),1)])]),default:r(()=>[a("div",ca,[l(ve,{class:"h-full overflow-auto","base-id":t.baseId,"source-id":e(b).id,"show-all-columns":!1},null,8,["base-id","source-id"])])]),_:1}),e(s)&&e(b)===e(s)[0]?(c(),I(F,{key:"audit"},{tab:r(()=>[a("div",da,[a("div",null,v(t.$t("title.auditLogs")),1)])]),default:r(()=>[a("div",ua,[l(Ue,{"source-id":e(b).id},null,8,["source-id"])])]),_:1})):R("",!0),!e(b).is_meta&&!e(b).is_local?(c(),I(F,{key:"edit"},{tab:r(()=>[a("div",pa,[a("div",null,v(t.$t("labels.connectionDetails")),1)])]),default:r(()=>[a("div",ma,[l(ze,{class:"w-760px pr-5","source-id":e(b).id,onSourceUpdated:n[2]||(n[2]=_=>O(!0)),onClose:n[3]||(n[3]=_=>b.value=null)},null,8,["source-id"])])]),_:1})):R("",!0),l(F,{key:"acl"},{tab:r(()=>[a("div",_a,[a("div",null,v(t.$t("labels.uiAcl")),1)])]),default:r(()=>[a("div",va,[l(Ve,{"source-id":e(b).id},null,8,["source-id"])])]),_:1}),!e(b).is_meta&&!e(b).is_local?(c(),I(F,{key:"meta-sync"},{tab:r(()=>[a("div",fa,[a("div",null,v(t.$t("labels.metaSync")),1)])]),default:r(()=>[a("div",ba,[l(Ke,{"source-id":e(b).id,onSourceSynced:n[4]||(n[4]=_=>O(!0))},null,8,["source-id"])])]),_:1})):R("",!0)]),_:1},8,["activeKey"])):(c(),M("div",ya,[a("div",ha,[a("div",ga,[a("div",wa,[a("div",Sa,v(t.$t("general.visibility")),1),a("div",ka,v(t.$t("general.name")),1),a("div",$a,v(t.$t("general.type")),1),a("div",Ca,v(t.$t("labels.actions")),1)])]),a("div",xa,[l(e($t),{list:e(s),"item-key":"id",handle:".ds-table-handle",onEnd:P},{header:r(()=>[e(s)[0]?(c(),M("div",{key:0,class:"ds-table-row border-gray-200 cursor-pointer",onClick:n[9]||(n[9]=_=>b.value=e(s)[0])},[a("div",Ia,[a("div",{class:"flex items-center gap-1",onClick:n[7]||(n[7]=ue(()=>{},["stop"]))},[e(s).length>2?(c(),M("div",Da)):R("",!0),l(Ce,null,{title:r(()=>[e(s)[0].enabled?(c(),M(H,{key:0},[K(v(t.$t("activity.hideInUI")),1)],64)):(c(),M(H,{key:1},[K(v(t.$t("activity.showInUI")),1)],64))]),default:r(()=>[l($e,{checked:!!e(s)[0].enabled,class:"cursor-pointer",size:"small",onChange:n[6]||(n[6]=_=>de(e(s)[0],_))},null,8,["checked"])]),_:1})])]),a("div",Na,[a("div",Ta,v(t.$t("general.default")),1)]),Ba,a("div",Aa,[!e(s)[0].is_meta&&!e(s)[0].is_local?(c(),I(Y,{key:0,size:"small",class:"nc-action-btn nc-edit-base cursor-pointer outline-0 !w-8 !px-1 !rounded-lg",type:"text",onClick:n[8]||(n[8]=ue(_=>ae(e(s)[0].id,("DataSourcesSubTab"in t?t.DataSourcesSubTab:e(Q)).Edit),["stop"]))},{default:r(()=>[l(fe,{icon:"edit",class:"text-gray-600"})]),_:1})):R("",!0)])])):R("",!0)]),item:r(({element:_,index:We})=>[We!==0?(c(),M("div",{key:0,class:"ds-table-row border-gray-200 cursor-pointer",onClick:be=>b.value=_},[a("div",Ma,[a("div",{class:"flex items-center gap-1",onClick:n[10]||(n[10]=ue(()=>{},["stop"]))},[e(s).length>2?(c(),I(fe,{key:0,icon:"dragVertical",small:"",class:"ds-table-handle"})):R("",!0),l(Ce,null,{title:r(()=>[_.enabled?(c(),M(H,{key:0},[K(v(t.$t("activity.hideInUI")),1)],64)):(c(),M(H,{key:1},[K(v(t.$t("activity.showInUI")),1)],64))]),default:r(()=>[l($e,{checked:!!_.enabled,class:"cursor-pointer",size:"small",onChange:be=>de(_,be)},null,8,["checked","onChange"])]),_:2},1024)])]),a("div",Pa,[_.is_meta||_.is_local?(c(),M("div",Ra,"-")):(c(),M("span",Oa,v(_.is_meta||_.is_local?t.$t("general.base"):_.alias),1))]),a("div",La,[a("div",ja,[l(xe,{"source-type":_.type},null,8,["source-type"]),a("span",Ua,v(_.type),1)])]),a("div",za,[l(Qe,null,{title:r(()=>[K(v(t.$t("general.remove")),1)]),default:r(()=>[!_.is_meta&&!_.is_local?(c(),I(Y,{key:0,size:"small",class:"nc-action-btn nc-delete-base cursor-pointer outline-0 !w-8 !px-1 !rounded-lg",type:"text",onClick:ue(be=>G(_),["stop"])},{default:r(()=>[l(fe,{icon:"delete",class:"text-red-500"})]),_:2},1032,["onClick"])):R("",!0)]),_:2},1024)])],8,Ea)):R("",!0)]),_:1},8,["list"])])]),l(Ge,{open:e(V),"onUpdate:open":n[11]||(n[11]=_=>z(V)?V.value=_:null),"connection-type":e($),onSourceCreated:n[12]||(n[12]=_=>O(!0))},null,8,["open","connection-type"]),l(Ye,{visible:e(T),"onUpdate:visible":n[13]||(n[13]=_=>z(T)?T.value=_:null),"entity-name":t.$t("general.datasource"),"on-delete":ce,"delete-label":t.$t("general.remove")},{"entity-preview":r(()=>[e(E)?(c(),M("div",Va,[l(xe,{"source-type":e(E).type},null,8,["source-type"]),a("div",Ka,v(e(E).alias),1)])):R("",!0)]),_:1},8,["visible","entity-name","delete-label"])]))])])}}}),Qa=Le(Fa,[["__scopeId","data-v-bd50df37"]]),Ga={class:"flex flex-row justify-between w-full items-center mb-1"},Ya=["onClick"],Wa={class:"select-none"},Ha=X({__name:"Modal",props:{modelValue:{type:Boolean},openKey:{},dataSourcesState:{},baseId:{}},emits:["update:modelValue","update:openKey","update:dataSourcesState"],setup(o,{emit:m}){const h=o,y=m,i=re(h,"modelValue",y),D=re(h,"openKey",y),w=re(h,"dataSourcesState",y),B=_t(h,"baseId"),{isUIAllowed:A}=Re();vt(Me,B);const{$e:S}=Oe(),{t:k}=Pe(),u=U(!1),f={baseSettings:{title:k("labels.projectSettings"),icon:me.settings,subTabs:{misc:{key:"Misc",title:k("general.misc"),body:Wt}},onClick:()=>{S("c:settings:base-settings")}},dataSources:{title:"Data Sources",icon:me.database,subTabs:{dataSources:{title:"Data Sources",body:Qa}},onClick:()=>{w.value="",S("c:settings:data-sources")}}},d=$=>Object.keys($)[0],p=J({get:()=>[Object.keys(f).find($=>$===D.value)||d(f)],set:$=>{D.value=$[0]}}),g=J(()=>f[p.value[0]]),s=U([d(g.value.subTabs)]),N=J(()=>g.value.subTabs[s.value[0]]);return le(()=>p.value[0],$=>{s.value=[d(f[$].subTabs)]}),($,C)=>{const T=It,E=ft,W=bt,O=ge,ae=Dt,G=Nt,ce=Tt,de=yt;return c(),I(de,{visible:e(i),"onUpdate:visible":C[5]||(C[5]=P=>z(i)?i.value=P:null),class:Ne([{active:e(i)},"!top-50px !bottom-50px"]),footer:null,width:"max(90vw, 600px)",closable:!1,"wrap-class-name":"nc-modal-settings",onCancel:C[6]||(C[6]=P=>y("update:modelValue",!1))},{default:r(()=>[a("div",Ga,[l(T,{class:"ml-4 select-none",type:"secondary",level:5},{default:r(()=>[K(v($.$t("activity.settings")),1)]),_:1}),l(E,{type:"text",class:"!rounded-md border-none !px-1.5","data-testid":"settings-modal-close-button",onClick:C[0]||(C[0]=P=>i.value=!1)},{default:r(()=>[(c(),I(oe(("iconMap"in $?$.iconMap:e(me)).close),{class:"cursor-pointer nc-modal-close w-4"}))]),_:1})]),l(ce,{class:"mt-3 overflow-y-auto flex"},{default:r(()=>[l(ae,null,{default:r(()=>[l(O,{"selected-keys":e(p),"onUpdate:selectedKeys":C[1]||(C[1]=P=>z(p)?p.value=P:null),class:"tabs-menu h-full","open-keys":[]},{default:r(()=>[(c(),M(H,null,De(f,(P,V)=>(c(),M(H,{key:V},[V!=="dataSources"||e(A)("sourceCreate")?(c(),I(W,{key:V,class:"!active:ring-0 !hover:bg-primary !hover:bg-opacity-25"},{default:r(()=>[a("div",{class:"flex items-center space-x-2",onClick:P.onClick},[(c(),I(oe(P.icon))),a("div",Wa,v(P.title),1)],8,Ya)]),_:2},1024)):R("",!0)],64))),64))]),_:1},8,["selected-keys"])]),_:1}),l(G,{class:"h-auto h-80vh px-4 scrollbar-thumb-gray-500"},{default:r(()=>{var P,V;return[e(p)[0]!=="dataSources"?(c(),I(O,{key:0,selectedKeys:e(s),"onUpdate:selectedKeys":C[2]||(C[2]=b=>z(s)?s.value=b:null),"open-keys":[],mode:"horizontal"},{default:r(()=>[(c(!0),M(H,null,De(e(g).subTabs,(b,se)=>(c(),I(W,{key:se,class:"!active:ring-0 select-none",onClick:b.onClick},{default:r(()=>[K(v(b.title),1)]),_:2},1032,["onClick"]))),128))]),_:1},8,["selectedKeys"])):R("",!0),a("div",{class:Ne(["overflow-auto",{"h-full":e(s)[0]==="dataSources"}])},[e(s)[0]==="dataSources"?(c(),I(oe((P=e(N))==null?void 0:P.body),{key:0,state:e(w),"onUpdate:state":C[3]||(C[3]=b=>z(w)?w.value=b:null),reload:e(u),"onUpdate:reload":C[4]||(C[4]=b=>z(u)?u.value=b:null),class:"px-2 pb-2 h-full","data-testid":`nc-settings-subtab-${e(N).key}`,"base-id":e(B)},null,40,["state","reload","data-testid","base-id"])):(c(),I(oe((V=e(N))==null?void 0:V.body),{key:1,class:"px-2 py-6","base-id":e(B),"data-testid":`nc-settings-subtab-${e(N).key}`},null,8,["base-id","data-testid"]))],2)]}),_:1})]),_:1})]),_:1},8,["visible","class"])}}}),As=Le(Ha,[["__scopeId","data-v-cdf5498d"]]);export{As as default};
