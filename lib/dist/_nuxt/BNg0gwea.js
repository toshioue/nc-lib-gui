import{e as J,L as se,cL as te,ay as ae,ax as le,bL as oe,gi as G,f as j,ag as Q,F as Z,r as O,g as ne,M as ce,o as l,c as F,a,P as E,Q as r,w as u,d as K,t as f,N as s,O as g,ah as ie,ab as U,a5 as ue,J as de,az as re,U as L,b as M,T,ao as B,at as P,R,S as z,y as me,Z as pe,a9 as fe,aa as be,ca as ve,_ as _e}from"./DZZ6t_j4.js";import{C as ye}from"./DNgdBwTe.js";import{a as ge,L as we,_ as he}from"./DuJHisTB.js";import"./eX8_g88K.js";import"./vll-Pnjv.js";import"./oyD85nwD.js";const ke={class:"flex flex-row w-full"},xe={class:"flex flex-col w-full"},Se={class:"flex flex-row items-center w-full mb-4 gap-2"},Ce={class:"text-gray-500"},$e={class:"flex flex-row items-center w-full mb-4 gap-2"},Me={class:"text-gray-500"},Ne={class:"flex flex-row items-center w-full mb-4 gap-2"},Ie={class:"text-gray-500"},Te=J({__name:"Misc",setup(V){const{includeM2M:k,showNull:v}=se(),w=te(),d=ae(),{loadTables:N,hasEmptyOrNullFilters:S}=w,{base:C}=le(w),$=oe(G,void 0),_=j(()=>{var t;return($==null?void 0:$.value)??((t=C.value)==null?void 0:t.id)}),{t:I}=Q();Z(k,async()=>await N());const m=O();ne(async()=>{var t;await d.loadProject(_.value,!0),m.value=(t=d.getProjectMeta(_.value))==null?void 0:t.showNullAndEmptyInFilter});async function h(t){const e=d.bases.get(_.value);if(!e)throw new Error(`Base ${_.value} not found`);const b=d.getProjectMeta(_.value)??{};t.target.checked||await S()&&(m.value=!0,ie.warning(I("msg.error.nullFilterExists")));const o={...b,showNullAndEmptyInFilter:m.value};e.meta=o,await d.updateProject(_.value,{meta:JSON.stringify(o)})}return(t,e)=>{const b=ye,o=ce("e");return l(),F("div",ke,[a("div",xe,[a("div",Se,[E((l(),r(b,{checked:s(k),"onUpdate:checked":e[0]||(e[0]=p=>g(k)?k.value=p:null),class:"nc-settings-meta-misc"},{default:u(()=>[K(f(t.$t("msg.info.showM2mTables"))+" ",1),e[3]||(e[3]=a("br",null,null,-1)),a("span",Ce,f(t.$t("msg.info.showM2mTablesDesc")),1)]),_:1},8,["checked"])),[[o,["c:themes:show-m2m-tables"]]])]),a("div",$e,[E((l(),r(b,{checked:s(v),"onUpdate:checked":e[1]||(e[1]=p=>g(v)?v.value=p:null),class:"nc-settings-show-null"},{default:u(()=>[K(f(t.$t("msg.info.showNullInCells"))+" ",1),e[4]||(e[4]=a("br",null,null,-1)),a("span",Me,f(t.$t("msg.info.showNullInCellsDesc")),1)]),_:1},8,["checked"])),[[o,["c:settings:show-null"]]])]),a("div",Ne,[E((l(),r(b,{checked:s(m),"onUpdate:checked":e[2]||(e[2]=p=>g(m)?m.value=p:null),class:"nc-settings-show-null-and-empty-in-filter",onChange:h},{default:u(()=>[K(f(t.$t("msg.info.showNullAndEmptyInFilter"))+" ",1),e[5]||(e[5]=a("br",null,null,-1)),a("span",Ie,f(t.$t("msg.info.showNullAndEmptyInFilterDesc")),1)]),_:1},8,["checked"])),[[o,["c:settings:show-null-and-empty-in-filter"]]])])])])}}}),je={class:"nc-modal-settings-content"},Fe={class:"flex flex-row justify-between w-full items-center p-4 border-b-1 border-gray-200"},Ke={class:"!my-0 text-2xl font-bold"},Ee=["onClick"],Ue={class:"select-none text-sm"},Be=J({__name:"Modal",props:{modelValue:{type:Boolean},openKey:{},dataSourcesState:{},baseId:{}},emits:["update:modelValue","update:openKey","update:dataSourcesState"],setup(V,{emit:k}){const v=V,w=k,d=U(v,"modelValue",w),N=U(v,"openKey",w),S=U(v,"dataSourcesState",w),C=ue(v,"baseId"),{isUIAllowed:$}=de();re(G,C);const{$e:_}=me(),{t:I}=Q(),m=O(!1),h={baseSettings:{title:I("labels.projectSettings"),icon:L.settings,subTabs:{misc:{key:"Misc",title:I("general.misc"),body:Te}},onClick:()=>{_("c:settings:base-settings")}}},t=c=>Object.keys(c)[0],e=j({get:()=>[Object.keys(h).find(c=>c===N.value)||t(h)],set:c=>{N.value=c[0]}}),b=j(()=>h[e.value[0]]),o=O([t(b.value.subTabs)]),p=j(()=>b.value.subTabs[o.value[0]]);return Z(()=>e.value[0],c=>{o.value=[t(h[c].subTabs)]}),(c,n)=>{const q=pe,A=fe,D=be,H=ge,W=we,X=he,Y=ve;return l(),r(Y,{visible:s(d),"onUpdate:visible":n[5]||(n[5]=i=>g(d)?d.value=i:null),class:z([{active:s(d)},"!top-50px !bottom-50px"]),footer:null,width:"max(90vw, 600px)",closable:!1,"wrap-class-name":"nc-modal-settings",onCancel:n[6]||(n[6]=i=>w("update:modelValue",!1))},{default:u(()=>[a("div",je,[a("div",Fe,[a("h5",Ke,f(c.$t("objects.project"))+" "+f(c.$t("activity.settings")),1),M(q,{type:"text",size:"small","data-testid":"settings-modal-close-button",onClick:n[0]||(n[0]=i=>d.value=!1)},{default:u(()=>[(l(),r(T(("iconMap"in c?c.iconMap:s(L)).close),{class:"cursor-pointer nc-modal-close w-4"}))]),_:1})]),M(X,{class:"overflow-y-auto flex !h-[calc(100%_-_66px)]"},{default:u(()=>[M(H,{class:"!bg-white"},{default:u(()=>[M(D,{"selected-keys":s(e),"onUpdate:selectedKeys":n[1]||(n[1]=i=>g(e)?e.value=i:null),class:"tabs-menu h-full","open-keys":[]},{default:u(()=>[(l(),F(B,null,P(h,(i,x)=>(l(),F(B,{key:x},[x!=="dataSources"||s($)("sourceCreate")?(l(),r(A,{key:x,class:"!active:ring-0 !hover:bg-[#F0F3FF]"},{default:u(()=>[a("div",{class:"flex items-center space-x-3 min-h-10",onClick:i.onClick},[(l(),r(T(i.icon),{class:"flex-none"})),a("div",Ue,f(i.title),1)],8,Ee)]),_:2},1024)):R("",!0)],64))),64))]),_:1},8,["selected-keys"])]),_:1}),M(W,{class:"h-full scrollbar-thumb-gray-500"},{default:u(()=>{var i,x;return[s(e)[0]!=="dataSources"?(l(),r(D,{key:0,selectedKeys:s(o),"onUpdate:selectedKeys":n[2]||(n[2]=y=>g(o)?o.value=y:null),"open-keys":[],mode:"horizontal",class:"px-4"},{default:u(()=>[(l(!0),F(B,null,P(s(b).subTabs,(y,ee)=>(l(),r(A,{key:ee,class:"!active:ring-0 select-none",onClick:y.onClick},{default:u(()=>[K(f(y.title),1)]),_:2},1032,["onClick"]))),128))]),_:1},8,["selectedKeys"])):R("",!0),a("div",{class:z(["overflow-auto",{"h-full":s(o)[0]==="dataSources","px-4":s(e)[0]!=="dataSources"}])},[s(o)[0]==="dataSources"?(l(),r(T((i=s(p))==null?void 0:i.body),{key:0,state:s(S),"onUpdate:state":n[3]||(n[3]=y=>g(S)?S.value=y:null),reload:s(m),"onUpdate:reload":n[4]||(n[4]=y=>g(m)?m.value=y:null),class:"h-full","data-testid":`nc-settings-subtab-${s(p).key}`,"base-id":s(C)},null,40,["state","reload","data-testid","base-id"])):(l(),r(T((x=s(p))==null?void 0:x.body),{key:1,class:"px-2 py-6","base-id":s(C),"data-testid":`nc-settings-subtab-${s(p).key}`},null,8,["base-id","data-testid"]))],2)]}),_:1})]),_:1})])]),_:1},8,["visible","class"])}}}),Re=_e(Be,[["__scopeId","data-v-5b7a4b77"]]);export{Re as default};
