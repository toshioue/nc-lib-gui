const __vite__fileDeps=["./DZIQ7CST.js","./3QBYHahY.js","./entry.Ic44fwRn.css","./DRopnK1z.js","./Dg1gNFnz.js","./Ci1lK5Ee.js","./xnDaHwV-.js","./Checkbox.M_COpns0.css","./Kma333Sh.js","./C95Svpv6.js","./DeleteModal.SEMJ_gSK.css","./CWtzMcwx.js","./kHOslGNR.js","./CmN9vPg3.js","./BQQOEPN4.js","./DPgYHC40.js","./BsWDDIqE.js","./ceYq-xax.js","./CQG617t7.js","./P3kwmRxC.js","./DAKhk9t6.js","./Bk0xUMNV.js","./CGxepfeV.js","./wEQwkVjR.js","./CyuhXrst.js","./Cu_tC_Dm.js","./CdYx1kPu.js","./3ezdMRmZ.js","./QuickImport.nWfi1EI3.css","./BS24yECD.js","./Uiq3YTcq.js","./KpkGjOx_.js","./B3xChUf-.js","./C_IZzKNf.js","./DgfVJyEd.js","./TableCreate.BHMZ8BQz.css","./CTSlxRce.js","./BrEnaVC0.js","./5_MZ2zba.js","./Table.flBPdmEH.css","./CJ26qO3d.js","./BVQBF9Vn.js","./DHn6lT7K.js","./DEDKhbvL.js","./PageHeader.Cs_HHWy1.css","./DmzaAQYu.js","./UserIcon.DEVmGavY.css","./Wbpa_-L5.js","./DHsWytsD.js","./Badge.D0-UrqG9.css","./BEpKpjF5.js","./CUFZaymE.js","./DkE_qgY_.js","./2yzrrcqg.js","./Tabs.DaLSLYpn.css","./jpVQnSic.js","./S6k-HM05.js","./DiZ67kIC.js","./D7hrRKCy.js","./Select.C8Fy0-eI.css","./leimKhvx.js","./Divider.DqtSqZhb.css","./BKGO7k13.js","./boyBAVNN.js","./BHEjdcp1.js","./toggleHighContrast.wojAGmRG.css","./Editor.6PWXOFSt.css","./C726Gdw3.js","./Overlay.BGbSKdGB.css","./CSl6euFG.js","./C00NHga8.js","./G4Pt-Lbf.js","./DbU9XkQ5.js","./CPUhUHn0.js","./DD1BMgnW.js","./EditOrAdd.Da7ku77t.css","./DdUr8XSo.js","./MenuItem.C7h59s4s.css","./PcgFfkcK.js","./Menu.CQ8GNWeI.css","./BkiSZLeF.js","./CsJPQclb.js","./DsWDg2xe.js","./WrawXyJR.js","./Ddy65kPJ.js","./InviteDlg.BFj7jV5W.css","./C1JaV8Px.js","./EditBase.CaDPtYQT.css","./Cp5O2m5x.js","./CfCRYnGS.js","./View.B2EG4bUV.css","./SqkZkS6T.js","./og6cBSyd.js","./BITed4Cc.js","./B6ykf4kl.js","./Cs-k6wm5.js","./0DGTjfkJ.js","./BaseAudit.MBpv011d.css","./CstA33ur.js","./B0eDEB-B.js","./BBQrPDDS.js","./DE41lpFj.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{_ as ha,a as At}from"./CQG617t7.js";import{f as ge,am as yt,cd as Ze,aS as Mt,b as a,ao as ht,aR as lt,ag as ga,ap as Et,cb as ya,b0 as wa,bF as xa,an as It,ac as Dt,a$ as $a,a7 as Ge,ad as qe,o,S as A,w as s,a as t,t as l,P as e,Q as re,$ as Me,r as B,A as Ae,_ as Le,az as ve,cR as nt,aA as et,cM as Je,L as tt,ai as wt,g as ie,O as Bt,c as C,T as D,R as it,d as V,U as fe,a1 as Pe,aq as me,cr as ka,aN as Ut,Z as Ee,a6 as Be,p as dt,e as ut,af as Sa,X as ot,av as Qe,f_ as Tt,aP as Ca,f$ as Ia,bN as xt,g0 as Lt,g1 as zt,g2 as Oe,i as Wt,g3 as vt,aj as he,ak as Ne,at as Da,H as we,V as rt,W as $t,g4 as Ye,ds as Ta,a0 as kt,au as Na,cU as Vt,g5 as Pa,ar as Ra,fl as X,b1 as Nt,g6 as Oa,fZ as Gt,a9 as je,co as Ft,aa as Qt,Y as Fe,aL as Kt,g7 as Pt,g8 as ja,d0 as Rt,g9 as Aa,ga as Ma,gb as Ea,dD as Ba,dr as Ua,gc as Te,gd as bt,aH as La,fH as qt,ay as za,u as Wa,N as Ht,ge as Va,de as Ga,aO as Fa,fI as Qa,gf as Ka,d3 as qa}from"./3QBYHahY.js";import{_ as Ha}from"./BS24yECD.js";import{_ as Ya}from"./KpkGjOx_.js";import{_ as Za}from"./B3xChUf-.js";import{_ as Ja}from"./CTSlxRce.js";import{_ as Yt}from"./BrEnaVC0.js";import{_ as Zt}from"./5_MZ2zba.js";import{_ as Xa}from"./CJ26qO3d.js";import{u as ct}from"./BVQBF9Vn.js";import{_ as es}from"./DHn6lT7K.js";import{_ as ts}from"./DEDKhbvL.js";import{_ as as}from"./DRopnK1z.js";import{_ as ss}from"./DmzaAQYu.js";import{_ as Jt}from"./Wbpa_-L5.js";import{D as os,S as Xt,_ as ls}from"./BEpKpjF5.js";import{u as ns}from"./CUFZaymE.js";import{p as is,t as rs}from"./DkE_qgY_.js";import"./kHOslGNR.js";import{I as St}from"./CmN9vPg3.js";import{_ as cs}from"./2yzrrcqg.js";import{_ as ea}from"./C95Svpv6.js";import{u as ds,_ as us,a as _s,b as ps,v as ms,c as fs}from"./jpVQnSic.js";import{_ as vs}from"./D7hrRKCy.js";import{_ as ta}from"./DD1BMgnW.js";import{_ as aa}from"./Bk0xUMNV.js";import{_ as bs}from"./C726Gdw3.js";import{_ as sa}from"./leimKhvx.js";import{f as st,b as hs,e as gs}from"./CWtzMcwx.js";import{a as ys}from"./DgfVJyEd.js";import{F as Ot}from"./DAKhk9t6.js";import{_ as ws,C as xs}from"./CPUhUHn0.js";import{_ as $s}from"./CyuhXrst.js";import{_ as ks}from"./DHsWytsD.js";import{_ as Ss}from"./DdUr8XSo.js";import{_ as Cs}from"./PcgFfkcK.js";import{_ as Is}from"./Kma333Sh.js";import{_ as Ds}from"./BkiSZLeF.js";import{u as oa}from"./DsWDg2xe.js";import{_ as Ts}from"./WrawXyJR.js";import{D as Ns}from"./Ddy65kPJ.js";import{u as Ps}from"./C_IZzKNf.js";var Rs=["class","style"],Os=function(){return{prefixCls:String,href:String,separator:lt.any,overlay:lt.any,onClick:Function}};const Xe=ge({compatConfig:{MODE:3},name:"ABreadcrumbItem",inheritAttrs:!1,__ANT_BREADCRUMB_ITEM:!0,props:Os(),slots:["separator","overlay"],setup:function(h,I){var N=I.slots,v=I.attrs,x=yt("breadcrumb",h),k=x.prefixCls,U=function(W,g){var f=Ze(N,h,"overlay");return f?a(ga,{overlay:f,placement:"bottom"},{default:function(){return[a("span",{class:"".concat(g,"-overlay-link")},[W,a(os,null,null)])]}}):W};return function(){var Z,W=(Z=Ze(N,h,"separator"))!==null&&Z!==void 0?Z:"/",g=Ze(N,h),f=v.class,p=v.style,$=Mt(v,Rs),P;return h.href!==void 0?P=a("a",ht({class:"".concat(k.value,"-link"),onClick:h.onClick},$),[g]):P=a("span",ht({class:"".concat(k.value,"-link"),onClick:h.onClick},$),[g]),P=U(P,k.value),g?a("span",{class:f,style:p},[P,W&&a("span",{class:"".concat(k.value,"-separator")},[W])]):null}}});var js=function(){return{prefixCls:String,routes:{type:Array},params:lt.any,separator:lt.any,itemRender:{type:Function}}};function As(d,h){if(!d.breadcrumbName)return null;var I=Object.keys(h).join("|"),N=d.breadcrumbName.replace(new RegExp(":(".concat(I,")"),"g"),function(v,x){return h[x]||v});return N}function jt(d){var h=d.route,I=d.params,N=d.routes,v=d.paths,x=N.indexOf(h)===N.length-1,k=As(h,I);return x?a("span",null,[k]):a("a",{href:"#/".concat(v.join("/"))},[k])}const Ke=ge({compatConfig:{MODE:3},name:"ABreadcrumb",props:js(),slots:["separator","itemRender"],setup:function(h,I){var N=I.slots,v=yt("breadcrumb",h),x=v.prefixCls,k=v.direction,U=function(f,p){return f=(f||"").replace(/^\//,""),Object.keys(p).forEach(function($){f=f.replace(":".concat($),p[$])}),f},Z=function(f,p,$){var P=$a(f),K=U(p||"",$);return K&&P.push(K),P},W=function(f){var p=f.routes,$=p===void 0?[]:p,P=f.params,K=P===void 0?{}:P,w=f.separator,R=f.itemRender,m=R===void 0?jt:R,q=[];return $.map(function(G){var H=U(G.path,K);H&&q.push(H);var T=[].concat(q),ce=null;return G.children&&G.children.length&&(ce=a(Dt,null,{default:function(){return[G.children.map(function(L){return a(Dt.Item,{key:L.path||L.breadcrumbName},{default:function(){return[m({route:L,params:K,routes:$,paths:Z(T,L.path,K)})]}})})]}})),a(Xe,{overlay:ce,separator:w,key:H||G.breadcrumbName},{default:function(){return[m({route:G,params:K,routes:$,paths:T})]}})})};return function(){var g,f,p,$=h.routes,P=h.params,K=P===void 0?{}:P,w=Et(Ze(N,h)),R=(g=Ze(N,h,"separator"))!==null&&g!==void 0?g:"/",m=h.itemRender||N.itemRender||jt;$&&$.length>0?p=W({routes:$,params:K,separator:R,itemRender:m}):w.length&&(p=w.map(function(G,H){return ya(wa(G.type)==="object"&&(G.type.__ANT_BREADCRUMB_ITEM||G.type.__ANT_BREADCRUMB_SEPARATOR),"Breadcrumb","Only accepts Breadcrumb.Item and Breadcrumb.Separator as it's children"),xa(G,{separator:R,key:H})}));var q=(f={},It(f,x.value,!0),It(f,"".concat(x.value,"-rtl"),k.value==="rtl"),f);return a("div",{class:q},[p])}}});var Ms=["separator","class"],Es=function(){return{prefixCls:String}};const gt=ge({compatConfig:{MODE:3},name:"ABreadcrumbSeparator",__ANT_BREADCRUMB_SEPARATOR:!0,inheritAttrs:!1,props:Es(),setup:function(h,I){var N=I.slots,v=I.attrs,x=yt("breadcrumb",h),k=x.prefixCls;return function(){var U;v.separator;var Z=v.class,W=Mt(v,Ms),g=Et((U=N.default)===null||U===void 0?void 0:U.call(N));return a("span",ht({class:["".concat(k.value,"-separator"),Z]},W),[g.length>0?g:"/"])}}});Ke.Item=Xe;Ke.Separator=gt;Ke.install=function(d){return d.component(Ke.name,Ke),d.component(Xe.name,Xe),d.component(gt.name,gt),d};const Bs={class:"flex flex-col px-8 pt-6 pb-9"},Us={class:"flex items-center gap-3 mb-6"},Ls={class:"text-base font-weight-700"},zs={class:"row mb-10"},Ws={class:"label"},Vs={class:"label"},Gs={class:"row"},Fs={class:"label"},Qs={class:"label"},Ks=ge({__name:"ImportModal",props:{visible:{type:Boolean},source:{}},emits:["update:visible"],setup(d,{emit:h}){const I=d,N=h,v=Ge(I,"source"),x=qe(I,"visible",N),{$e:k}=Ae();function U(g,f){if(!g||!f)return;k("a:actions:import-airtable");const p=B(!0),{close:$}=ct(ha,{modelValue:p,baseId:g,sourceId:f,"onUpdate:modelValue":P});function P(){p.value=!1,$(1e3)}}function Z(g){if(!v.value.id||!v.value.base_id)return;k(`a:actions:import-${g}`);const f=B(!0),{close:p}=ct(At,{modelValue:f,importType:g,baseId:v.value.base_id,sourceId:v.value.id,"onUpdate:modelValue":$});function $(){f.value=!1,p(1e3)}}const W=g=>{x.value=!1,g==="airtable"?U(v.value.base_id,v.value.id):Z(g)};return(g,f)=>{const p=Me,$=Xa;return o(),A($,{visible:e(x),"onUpdate:visible":f[4]||(f[4]=P=>re(x)?x.value=P:null),width:"35rem"},{default:s(()=>[t("div",Bs,[t("div",Us,[a(p,{icon:"download",class:"flex-none !text-orange-700 !w-4 !h-4"}),t("div",Ls,l(g.$t("general.import")),1)]),t("div",zs,[t("div",{class:"nc-base-view-import-sub-btn",onClick:f[0]||(f[0]=P=>W("airtable"))},[a(p,{icon:"airtable"}),t("div",Ws,l(g.$t("labels.airtable")),1)]),t("div",{class:"nc-base-view-import-sub-btn",onClick:f[1]||(f[1]=P=>W("csv"))},[a(p,{icon:"csv"}),t("div",Vs,l(g.$t("labels.csv")),1)])]),t("div",Gs,[t("div",{class:"nc-base-view-import-sub-btn",onClick:f[2]||(f[2]=P=>W("excel"))},[a(p,{icon:"excelColored"}),t("div",Fs,l(g.$t("labels.excel")),1)]),t("div",{class:"nc-base-view-import-sub-btn",onClick:f[3]||(f[3]=P=>W("json"))},[a(p,{icon:"code"}),t("div",Qs,l(g.$t("labels.json")),1)])])])]),_:1},8,["visible"])}}}),qs=Le(Ks,[["__scopeId","data-v-86647892"]]),Hs=""+new URL("table.BosIpfXe.png",import.meta.url).href,Ys=Ee(()=>Be(()=>Promise.resolve().then(()=>Ol),void 0,import.meta.url).then(d=>d.default||d)),_t=d=>(dt("data-v-38f03b76"),d=d(),ut(),d),Zs={class:"nc-all-tables-view px-6 pt-6"},Js={class:"icon-wrapper"},Xs={class:"flex flex-col gap-1"},eo={class:"label"},to=_t(()=>t("div",{class:"subtext"},"Start from scratch.",-1)),ao={class:"icon-wrapper"},so={class:"flex flex-col gap-1"},oo={class:"label"},lo=_t(()=>t("div",{class:"subtext"},"From files & external sources",-1)),no={class:"icon-wrapper"},io={class:"flex flex-col gap-1"},ro={class:"label"},co=_t(()=>t("div",{class:"subtext"},"In realtime to external databases.",-1)),uo={key:0,class:"flex items-center justify-center text-center mt-4",style:{height:"calc(100vh - var(--topbar-height) - 15.2rem)"}},_o={class:"mt-2"},po={key:1,class:"flex mt-4",style:{height:"calc(100vh - var(--topbar-height) - 218px)"}},mo={key:0,class:"w-full flex items-center gap-3 max-w-full text-gray-800","data-testid":"proj-view-list__item-title"},fo={class:"min-w-6 flex items-center justify-center"},vo={key:1,class:"capitalize w-full flex items-center gap-3 max-w-full","data-testid":"proj-view-list__item-type"},bo={key:0,class:"ml-0.75"},ho={key:2,class:"capitalize flex items-center gap-2 max-w-full","data-testid":"proj-view-list__item-created-at"},go={key:2,class:"py-3 flex items-center gap-6 <lg:flex-col"},yo=_t(()=>t("img",{src:Hs,class:"!w-[23rem] flex-none"},null,-1)),wo={class:"text-center lg:text-left"},xo={class:"text-2xl text-gray-800 font-bold"},$o={class:"text-sm text-gray-700 pt-6"},ko=ge({__name:"AllTables",setup(d){const{activeTables:h}=ve(nt()),{openTable:I}=nt(),{openedProject:N,isDataSourceLimitReached:v}=ve(et()),{base:x}=ve(Je()),k=B(!1),{isUIAllowed:U}=tt(),{$e:Z}=Ae(),{t:W}=wt(),g=B(!1),f=ie(()=>{var R,m;return(m=(R=N.value)==null?void 0:R.sources)==null?void 0:m[0]}),p=ie(()=>{var m,q;const R=new Map;return(q=(m=N.value)==null?void 0:m.sources)==null||q.forEach(G=>{R.set(G.id,G)}),R});function $(R){var T,ce;Z("c:table:create:navdraw");const m=B(!0);let q=(T=N.value.sources)==null?void 0:T[0].id;if(!q||!((ce=N.value)!=null&&ce.id))return;const{close:G}=ct(Za,{modelValue:m,sourceId:q,baseId:N.value.id,onCreate:H,"onUpdate:modelValue":()=>H()});function H(ae){m.value=!1,ae&&(setTimeout(()=>{const L=document.querySelector(`[data-table-id="${ae.id}"]`);L&&(L==null||L.scrollIntoView({behavior:"smooth",block:"nearest"}))},1e3),G(1e3))}}const P=[{key:"tableName",title:W("objects.table"),name:"Table Name",basis:"40%",minWidth:220,padding:"0px 12px"},{key:"sourceName",title:W("general.source"),name:"View Name",basis:"25%",minWidth:220,padding:"0px 12px"},{key:"created_at",title:W("labels.createdOn"),name:"editor",minWidth:120,padding:"0px 12px"}],K=R=>({onclick:()=>{I(R)}}),w=()=>{v.value||(k.value=!0)};return(R,m)=>{var Y,ue,u,de,Q,pe,se;const q=Me,G=Ut,H=Ja,T=Yt,ce=Zt,ae=qs,L=Ys,S=Bt("e");return o(),C("div",Zs,[t("div",{class:fe(["flex flex-row gap-x-6 pb-2 overflow-x-auto nc-scrollbar-thin",{"pointer-events-none":(Y=e(x))==null?void 0:Y.isLoading}])},[e(U)("tableCreate",{source:(u=(ue=e(x))==null?void 0:ue.sources)==null?void 0:u[0]})?(o(),C("div",{key:0,role:"button",class:"nc-base-view-all-table-btn","data-testid":"proj-view-btn__add-new-table",onClick:m[0]||(m[0]=J=>$())},[t("div",Js,[a(q,{icon:"addOutlineBox",class:"!h-8 !w-8 !text-brand-500"})]),t("div",Xs,[t("div",eo,l(R.$t("general.create"))+" "+l(R.$t("general.new"))+" "+l(R.$t("objects.table")),1),to])])):D("",!0),e(U)("tableCreate",{source:(Q=(de=e(x))==null?void 0:de.sources)==null?void 0:Q[0]})?it((o(),C("div",{key:1,role:"button",class:"nc-base-view-all-table-btn","data-testid":"proj-view-btn__import-data",onClick:m[1]||(m[1]=J=>g.value=!0)},[t("div",ao,[a(q,{icon:"download",class:"!h-7.5 !w-7.5 !text-orange-700"})]),t("div",so,[t("div",oo,l(R.$t("activity.import"))+" "+l(R.$t("general.data")),1),lo])])),[[S,["c:table:import"]]]):D("",!0),e(U)("sourceCreate")?(o(),A(Pe,{key:2,placement:"bottom",disabled:!e(v),class:"flex-none flex"},{title:s(()=>[V(l(R.$t("tooltip.reachedSourceLimit")),1)]),default:s(()=>[it((o(),C("div",{role:"button",class:fe(["nc-base-view-all-table-btn",{disabled:e(v)}]),"data-testid":"proj-view-btn__create-source",onClick:w},[t("div",no,[a(q,{icon:"server1",class:"!h-7 !w-7 !text-green-700"})]),t("div",io,[t("div",ro,l(R.$t("labels.connectDataSource")),1),co])],2)),[[S,["c:table:create-source"]]])]),_:1},8,["disabled"])):D("",!0)],2),(pe=e(x))!=null&&pe.isLoading?(o(),C("div",uo,[t("div",null,[a(G,{size:"xlarge"}),t("div",_o,l(R.$t("general.loading")),1)])])):e(h).length?(o(),C("div",po,[a(ce,{"is-data-loading":(se=e(x))==null?void 0:se.isLoading,columns:P,"sticky-first-column":"",data:[...e(h)].sort((J,ee)=>J.source_id.localeCompare(ee.source_id)*20),"custom-row":K,bordered:!1,class:"nc-base-view-all-table-list flex-1"},{bodyCell:s(({column:J,record:ee})=>{var i;return[J.key==="tableName"?(o(),C("div",mo,[t("div",fo,[a(H,{meta:ee,class:"flex-none text-gray-600"},null,8,["meta"])]),a(Pe,{class:"truncate max-w-[calc(100%_-_28px)]","show-on-truncate-only":""},{title:s(()=>[V(l(ee==null?void 0:ee.title),1)]),default:s(()=>[V(" "+l(ee==null?void 0:ee.title),1)]),_:2},1024)])):D("",!0),J.key==="sourceName"?(o(),C("div",vo,[ee.source_id===((i=e(f))==null?void 0:i.id)?(o(),C("div",bo,"-")):(o(),C(me,{key:1},[a(T,{class:"flex-none w-4"}),a(Pe,{class:"truncate max-w-[calc(100%_-_28px)]","show-on-truncate-only":""},{title:s(()=>{var c;return[V(l((c=e(p).get(ee.source_id))==null?void 0:c.alias),1)]}),default:s(()=>{var c;return[V(" "+l((c=e(p).get(ee.source_id))==null?void 0:c.alias),1)]}),_:2},1024)],64))])):D("",!0),J.key==="created_at"?(o(),C("div",ho,l(e(ka)(ee==null?void 0:ee.created_at).fromNow()),1)):D("",!0)]}),_:1},8,["is-data-loading","data"])])):(o(),C("div",go,[yo,t("div",wo,[t("div",xo,l(R.$t("placeholder.createTable")),1),t("div",$o,l(R.$t("placeholder.createTableLabel")),1)])])),e(f)?(o(),A(ae,{key:3,visible:e(g),"onUpdate:visible":m[2]||(m[2]=J=>re(g)?g.value=J:null),source:e(f)},null,8,["visible","source"])):D("",!0),e(k)?(o(),A(L,{key:4,open:e(k),"onUpdate:open":m[3]||(m[3]=J=>re(k)?k.value=J:null),"is-modal":""},null,8,["open"])):D("",!0)])}}}),So=Le(ko,[["__scopeId","data-v-38f03b76"]]),Co={class:"flex items-center justify-between"},Io={key:0,class:"text-gray-500 text-xs"},Do={class:"flex items-center justify-between"},To={key:0,class:"text-gray-500 text-xs"},No=ge({__name:"Selector",props:{role:{},roles:{},disabledRoles:{},onRoleChange:{},border:{type:Boolean,default:!0},description:{type:Boolean,default:!0},inherit:{},size:{default:"sm"},showInherit:{type:Boolean,default:!1}},setup(d){const h=d,I=Ge(h,"role"),N=Ge(h,"inherit"),v=Ge(h,"showInherit"),x=Ge(h,"description"),k=B(!1),U=B(null),Z=Ge(h,"size");Sa(U,()=>k.value=!1);function W(g){h.onRoleChange(g),k.value=!1}return(g,f)=>{const p=Jt,$=Pe,P=Me,K=Xt,w=ls,R=Bt("e");return o(),C("div",{ref_key:"dropdownRef",ref:U,size:"lg",class:"nc-roles-selector relative flex items-center gap-3",onClick:f[0]||(f[0]=m=>k.value=!e(k))},[a(p,{border:!1,inherit:e(N)===g.role,role:e(I),size:e(Z),clickable:"","data-testid":"roles",class:"flex-none"},null,8,["inherit","role","size"]),e(v)&&("isEeUI"in g?g.isEeUI:e(ot))&&e(N)===g.role?(o(),A($,{key:0,class:"uppercase text-[10px] leading-4 text-gray-500",placement:"bottom"},{title:s(()=>[V(l(g.$t("tooltip.roleInheritedFromWorkspace")),1)]),default:s(()=>[V(" "+l(g.$t("objects.workspace")),1)]),_:1})):D("",!0),a(w,{value:e(I),open:e(k),"dropdown-match-select-width":!1,"dropdown-class-name":"!rounded-lg !h-fit max-w-[350px] nc-role-selector-dropdown",class:"py-1 !absolute top-0 left-0 w-20 h-full z-10 text-xs opacity-0",onChange:W},{default:s(()=>[(o(!0),C(me,null,Qe(h.disabledRoles||[],m=>(o(),A(K,{key:m,value:m,disabled:""},{default:s(()=>[t("div",{class:fe([{"w-full":e(x),"w-[200px]":!e(x)},"flex flex-col nc-role-select-dropdown gap-1"])},[t("div",Co,[a(p,{disabled:"",border:!1,inherit:e(N)===m,role:m},null,8,["inherit","role"]),m===e(I)?(o(),A(P,{key:0,icon:"check",class:"text-primary"})):D("",!0)]),e(x)?(o(),C("div",Io,l(e(Tt)[m]),1)):D("",!0)],2)]),_:2},1032,["value"]))),128)),(o(!0),C(me,null,Qe(h.roles,m=>it((o(),A(K,{key:m,value:m},{default:s(()=>[t("div",{class:fe([{"w-full":e(x),"w-[200px]":!e(x)},"flex flex-col nc-role-select-dropdown gap-1"])},[t("div",Do,[a(p,{border:!1,class:fe(`nc-role-select-${m}`),inherit:e(N)===m,role:m},null,8,["class","inherit","role"]),m===e(I)?(o(),A(P,{key:0,icon:"check",class:"text-primary"})):D("",!0)]),e(x)?(o(),C("div",To,l(e(Tt)[m]),1)):D("",!0)],2)]),_:2},1032,["value"])),[[R,["c:workspace:settings:user-role-change"]]])),128))]),_:1},8,["value","open"])],512)}}}),Po=Ca("orgStore",()=>{const d=B(),h=B(null);return{org:d,orgId:h,updateOrg:async v=>{},loadOrg:async()=>{}}}),Ro=Ee(()=>Be(()=>import("./DZIQ7CST.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85]),import.meta.url).then(d=>d.default||d)),Oo={key:0},jo={class:"nc-breadcrumb px-2"},Ao={class:"nc-breadcrumb-item"},Mo={class:"nc-breadcrumb-item"},Eo={class:"nc-breadcrumb-item active truncate capitalize"},Bo={class:"nc-page-header-icon flex justify-center items-center h-5 w-5"},Uo={"data-rec":"true",class:"capitalize"},Lo={class:"nc-content-max-w h-full flex flex-col items-center gap-6 px-6 pt-6"},zo={key:0,class:"w-full flex justify-between items-center max-w-350 gap-3"},Wo={class:"flex items-center gap-1"},Vo={key:1,class:"w-full flex gap-3 items-center users-email-grid"},Go={class:"flex flex-col flex-1 max-w-[calc(100%_-_44px)]"},Fo={class:"flex gap-3"},Qo={key:2},Ko={key:3},qo=ge({__name:"AccessSettings",props:{baseId:{}},setup(d){const h=d,I=et(),{getBaseUsers:N,createProjectUser:v,updateProjectUser:x,removeProjectUser:k}=I,{activeProjectId:U,bases:Z,basesUser:W}=ve(I),{orgRoles:g,baseRoles:f,loadRoles:p}=tt(),{sorts:$,sortDirection:P,loadSorts:K,handleGetSortedData:w,saveOrUpdate:R}=ns("Project"),m=ie(()=>{var y;return(y=g.value)==null?void 0:y[Ia.SUPER_ADMIN]}),q=Po(),{orgId:G,org:H}=ve(q),T=xt(Lt,B(!1)),{$api:ce}=Ae(),{t:ae}=wt(),L=zt(async()=>{let y;return h.baseId?(await p(h.baseId),y=Z.value.get(h.baseId),y||(y=await ce.base.read(h.baseId))):y=Z.value.get(U.value),y}),S=B(!1),Y=B([]),ue=B(0),u=B(""),de=B(!1),Q=B([]),pe=ie(()=>Y.value.filter(y=>{var z,j;return((j=(z=y.display_name)==null?void 0:z.toLowerCase())==null?void 0:j.includes(u.value.toLowerCase()))||y.email.toLowerCase().includes(u.value.toLowerCase())})),se=ie(()=>w(pe.value,$.value)),J=async()=>{try{if(!L.value)return;const{users:y,totalRows:z}=await N({baseId:L.value.id,...u.value?{searchText:u.value}:{},force:!0});ue.value=z,Y.value=[...y.filter(j=>!(j!=null&&j.deleted)).map(j=>({...j,base_roles:j.roles,roles:j.roles??(j.workspace_roles?Ye[j.workspace_roles]??Oe.NO_ACCESS:Oe.NO_ACCESS)}))]}catch(y){he.error(await Ne(y))}},ee=ie(()=>{var y,z;return((y=f.value)==null?void 0:y[Oe.OWNER])||((z=f.value)==null?void 0:z[Oe.CREATOR])}),i=async(y,z)=>{const j=Y.value.find(_e=>_e.id===y.id);try{!z||z===Oe.NO_ACCESS&&!ot?(await k(L.value.id,j),j.workspace_roles&&Ye[j.workspace_roles]===z&&ot?j.roles=Ye[j.workspace_roles]:j.roles=Oe.NO_ACCESS,j.base_roles=null):j.base_roles?(j.roles=z,await x(L.value.id,j)):(j.roles=z,j.base_roles=z,await v(L.value.id,j));let _e=W.value.get(L.value.id);_e!=null&&_e.length&&(_e=_e.map(xe=>(xe.id===j.id&&(xe.roles=j.roles),xe)),W.value.set(L.value.id,_e))}catch(_e){he.error(await Ne(_e)),J()}};Wt(async()=>{de.value=!0;try{await J();const y=vt.findIndex(z=>f.value&&Object.keys(f.value).includes(z));m.value?Q.value=vt.slice(0):y!==-1&&(Q.value=vt.slice(y)),K()}catch(y){he.error(await Ne(y))}finally{de.value=!1}});const c=Da({}),O=y=>{pe.value.forEach(z=>{c[z.id]=y})},F=ie({get:()=>Object.values(c).every(y=>y)&&Object.keys(c).length>0&&Object.values(c).length===pe.value.length,set:y=>{O(y)}});we(S,()=>{S.value||J()}),we(L,()=>{J()});const le=ie({get:()=>P.value,set:y=>{if(Object.keys(y).length===0){R({});return}const[z,j]=Object.entries(y)[0];R({field:z,direction:j})}}),oe=[{key:"select",title:"",width:70,minWidth:70},{key:"email",title:ae("objects.users"),minWidth:220,dataIndex:"email",showOrderBy:!0},{key:"role",title:ae("general.role"),basis:"30%",minWidth:272,dataIndex:"roles",showOrderBy:!0},{key:"created_at",title:ae("title.dateJoined"),basis:"25%",minWidth:200}],$e=y=>({class:`${c[y.id]?"selected":""} user-row`}),ze=ie(()=>{var y;return((y=Y.value)==null?void 0:y.filter(z=>z.roles===Oe.OWNER).length)===1}),ke=y=>!(ze.value&&y.roles===Oe.OWNER);return(y,z)=>{var te,be;const j=Me,_e=es,xe=Ta,Ue=ts,We=St,Ve=kt,Se=Na,Ce=as,He=ss,Re=Pe,Ie=No,_=Jt,r=Zt,M=Ro;return o(),C("div",{class:fe(["nc-collaborator-table-container nc-access-settings-view flex flex-col",{"h-[calc(100vh_-_100px)]":!e(T)}])},[e(T)?(o(),C("div",Oo,[t("div",jo,[t("div",Ao,l(e(H).title),1),a(j,{icon:"ncSlash1",class:"nc-breadcrumb-divider"}),a(_e,{href:`/admin/${e(G)}/bases`,class:"!hover:text-gray-800 !hover:underline-gray-600 flex items-center !text-gray-700 !underline-transparent max-w-1/4"},{default:s(()=>[t("div",Mo,l(y.$t("objects.projects")),1)]),_:1},8,["href"]),a(j,{icon:"ncSlash1",class:"nc-breadcrumb-divider"}),t("div",Eo,l((te=e(L))==null?void 0:te.title),1)]),a(Ue,null,{icon:s(()=>[t("div",Bo,[a(xe,{readonly:""})])]),title:s(()=>{var n;return[t("span",Uo,l((n=e(L))==null?void 0:n.title),1)]}),_:1})])):D("",!0),t("div",Lo,[e(T)?D("",!0):(o(),C("div",zo,[a(We,{value:e(u),"onUpdate:value":z[0]||(z[0]=n=>re(u)?u.value=n:null),placeholder:y.$t("title.searchMembers"),disabled:e(de),"allow-clear":"",class:"nc-input-border-on-value !max-w-90 !h-8 !px-3 !py-1 !rounded-lg"},{prefix:s(()=>[a(j,{icon:"search",class:"mr-2 h-4 w-4 text-gray-500 group-hover:text-black"})]),_:1},8,["value","placeholder","disabled"]),a(Ve,{disabled:e(de),size:"small",onClick:z[1]||(z[1]=n=>S.value=!0)},{default:s(()=>[t("div",Wo,[(o(),A(rt(("iconMap"in y?y.iconMap:e($t)).plus),{class:"w-4 h-4"})),V(" "+l(y.$t("activity.addMembers")),1)])]),_:1},8,["disabled"])])),a(r,{"order-by":e(le),"onUpdate:orderBy":z[3]||(z[3]=n=>re(le)?le.value=n:null),"is-data-loading":e(de),columns:oe,data:e(se),bordered:!1,"custom-row":$e,class:"flex-1 nc-collaborators-list max-w-350"},{emptyText:s(()=>[a(Se,{description:y.$t("title.noMembersFound")},null,8,["description"])]),headerCell:s(({column:n})=>[n.key==="select"?(o(),A(Ce,{key:0,checked:e(F),"onUpdate:checked":z[2]||(z[2]=E=>re(F)?F.value=E:null),disabled:!e(se).length},null,8,["checked","disabled"])):(o(),C(me,{key:1},[V(l(n.title),1)],64))]),bodyCell:s(({column:n,record:E})=>[n.key==="select"?(o(),A(Ce,{key:0,checked:e(c)[E.id],"onUpdate:checked":ne=>e(c)[E.id]=ne},null,8,["checked","onUpdate:checked"])):D("",!0),n.key==="email"?(o(),C("div",Vo,[a(He,{size:"base",email:E.email,class:"flex-none"},null,8,["email"]),t("div",Go,[t("div",Fo,[a(Re,{class:"truncate max-w-full text-gray-800 capitalize font-semibold","show-on-truncate-only":""},{title:s(()=>[V(l(E.display_name||E.email.slice(0,E.email.indexOf("@"))),1)]),default:s(()=>[V(" "+l(E.display_name||E.email.slice(0,E.email.indexOf("@"))),1)]),_:2},1024)]),a(Re,{class:"truncate max-w-full text-xs text-gray-600","show-on-truncate-only":""},{title:s(()=>[V(l(E.email),1)]),default:s(()=>[V(" "+l(E.email),1)]),_:2},1024)])])):D("",!0),n.key==="role"?(o(),C("div",Qo,[ke(E)&&e(ee)&&e(Q).includes(E.roles)?(o(),A(Ie,{key:0,role:E.roles,roles:e(Q),inherit:("isEeUI"in y?y.isEeUI:e(ot))&&E.workspace_roles&&e(Ye)[E.workspace_roles]?e(Ye)[E.workspace_roles]:null,"show-inherit":"",description:!1,"on-role-change":ne=>i(E,ne)},null,8,["role","roles","inherit","on-role-change"])):(o(),A(_,{key:1,border:!1,role:E.roles},null,8,["role"]))])):D("",!0),n.key==="created_at"?(o(),C("div",Ko,[a(Re,{class:"max-w-full"},{title:s(()=>[V(l(("parseStringDateTime"in y?y.parseStringDateTime:e(is))(E.created_at)),1)]),default:s(()=>[t("span",null,l(("timeAgo"in y?y.timeAgo:e(rs))(E.created_at)),1)]),_:2},1024)])):D("",!0)]),_:1},8,["order-by","is-data-loading","data"])]),a(M,{"model-value":e(S),"onUpdate:modelValue":z[4]||(z[4]=n=>re(S)?S.value=n:null),"base-id":(be=e(L))==null?void 0:be.id,type:"base"},null,8,["model-value","base-id"])],2)}}}),Ho=Le(qo,[["__scopeId","data-v-3908ed56"]]),Yo={class:"flex flex-col gap-1"},Zo={class:"flex items-center gap-3"},Jo={class:"ml-10 text-small leading-[18px] text-gray-500"},Xo={class:"flex flex-col gap-1"},el={class:"flex items-center gap-3"},tl=ge({__name:"SourceRestrictions",props:{allowMetaWrite:{type:Boolean},allowDataWrite:{type:Boolean}},emits:["update:allowMetaWrite","update:allowDataWrite"],setup(d,{emit:h}){const I=d,N=h,v=qe(I,"allowDataWrite",N),x=qe(I,"allowMetaWrite",N);return(k,U)=>{const Z=ta,W=Pe,g=aa;return o(),C(me,null,[a(g,{class:"nc-source-restictions-card"},{default:s(()=>[t("div",Yo,[t("div",Zo,[a(W,{disabled:!e(x),placement:"topLeft",class:"flex"},{title:s(()=>[V(l(k.$t("tooltip.dataWriteOptionDisabled")),1)]),default:s(()=>[a(Z,{checked:e(v),"onUpdate:checked":U[0]||(U[0]=f=>re(v)?v.value=f:null),disabled:e(x),"data-testid":"nc-allow-data-write",size:"small"},null,8,["checked","disabled"])]),_:1},8,["disabled"]),t("span",{class:"cursor-pointer",onClick:U[1]||(U[1]=f=>e(x)?void 0:v.value=!e(v))},l(k.$t("labels.allowDataWrite")),1)]),t("div",Jo,l(k.$t("tooltip.allowDataWrite")),1)])]),_:1}),a(g,{class:"nc-source-restictions-card"},{default:s(()=>[t("div",Xo,[t("div",el,[a(Z,{checked:e(x),"onUpdate:checked":U[2]||(U[2]=f=>re(x)?x.value=f:null),"data-testid":"nc-allow-meta-write",class:"nc-allow-meta-write",size:"small"},null,8,["checked"]),t("span",{class:"cursor-pointer",onClick:U[3]||(U[3]=f=>x.value=!e(x))},l(k.$t("labels.allowMetaWrite")),1)]),t("div",{class:fe(["ml-10 text-small leading-[18px] text-gray-500",{"nc-allow-meta-write-help":e(x)}])},l(k.$t("labels.notRecommended"))+": "+l(k.$t("tooltip.allowMetaWrite")),3)])]),_:1})],64)}}}),al=Le(tl,[["__scopeId","data-v-b77d1107"]]),sl={class:"w-full flex flex-col gap-3"},ol=t("div",{class:"text-sm text-gray-800 font-semibold"},"Supported Docs",-1),ll={class:"h-7 w-7 flex items-center justify-center"},nl=["href"],il=ge({__name:"SupportedDocs",setup(d){const h=[{title:"Integrations",href:"https://docs.nocodb.com/category/integrations"},{title:"Create new connection",href:"https://docs.nocodb.com/integrations/create-connection"},{title:"Add new Data source",href:"https://docs.nocodb.com/data-sources/connect-to-data-source"}];return(I,N)=>{const v=Me;return o(),C("div",null,[t("div",sl,[ol,t("div",null,[(o(),C(me,null,Qe(h,(x,k)=>t("div",{key:k,class:"flex items-center gap-1"},[t("div",ll,[a(v,{icon:"bookOpen",class:"flex-none w-4 h-4 text-gray-500"})]),t("a",{href:x.href,target:"_blank",rel:"noopener noreferrer",class:"!text-gray-600 text-sm !no-underline !hover:underline"},l(x.title),9,nl)])),64))])])])}}}),at=d=>(dt("data-v-62a289ff"),d=d(),ut(),d),rl={class:"flex-1 flex flex-col max-h-full"},cl={class:"px-4 py-3 w-full flex items-center gap-3 border-b-1 border-gray-200"},dl={class:"h-6 self-start flex items-center"},ul=at(()=>t("div",{class:"flex-1 text-base font-weight-700"},"Add Data Source",-1)),_l={class:"flex items-center gap-3"},pl={class:"h-[calc(100%_-_58px)] flex"},ml={class:"nc-add-source-left-panel nc-scrollbar-thin relative"},fl={class:"create-source bg-white relative flex flex-col gap-2 w-full max-w-[768px]"},vl={class:"nc-form-section"},bl={class:"nc-form-section-body"},hl=["data-testid"],gl={class:"w-full flex items-center gap-2 px-2 py-2 rounded-md hover:bg-gray-100"},yl={class:"nc-form-section"},wl={class:"nc-form-section-body"},xl={class:"nc-form-section"},$l=at(()=>t("div",{class:"nc-form-section-title"},"Permissions",-1)),kl={class:"nc-form-section-body"},Sl=at(()=>t("div",{class:"nc-form-section-title"},"Advanced options",-1)),Cl=at(()=>t("span",null,null,-1)),Il={class:"flex flex-col gap-4"},Dl={class:"flex flex-col gap-4"},Tl=at(()=>t("div",null,null,-1)),Nl={class:"flex items-center justify-center h-full w-full !bg-white !bg-opacity-85 z-1000"},Pl={class:"nc-add-source-right-panel"},Rl=ge({__name:"CreateBase",props:{open:{type:Boolean},connectionType:{}},emits:["update:open","sourceCreated"],setup(d,{emit:h}){const I=d,N=h,v=qe(I,"open",N),{loadIntegrations:x,integrations:k,eventBus:U,pageMode:Z,IntegrationsPageMode:W}=ds(),g=Je(),{loadProject:f}=et(),{base:p}=ve(g),{loadProjectTables:$}=nt(),{refreshCommandPalette:P}=Vt(),K=xt(Pa,void 0),w=ie(()=>{var _;return(K==null?void 0:K.value)??((_=p.value)==null?void 0:_.id)}),R=Ot.useForm,m=B(!1),q=B(!1),G=B(),{api:H}=Ra(),{$e:T}=Ae(),{t:ce}=wt(),{isUIAllowed:ae}=tt(),L=B(!1),S=B([]),Y=B(!1),u=B(((_=X.MYSQL)=>({title:"",dataSource:{...Pt(_)},inflection:{inflectionColumn:"none",inflectionTable:"none"},sslUse:ja.No,extraParameters:[],is_schema_readonly:!0,is_data_readonly:!1}))()),de=B(!1),Q=B(0),pe=()=>{Q.value+=1,Q.value>=2&&(de.value=!0)},se=ie(()=>u.value.fk_integration_id&&k.value.find(_=>_.id===u.value.fk_integration_id)),J=ie(()=>{var _,r,M;return(M=(r=(_=se.value)==null?void 0:_.config)==null?void 0:r.connection)==null?void 0:M.database}),ee=ie(()=>{var _,r,M;return(M=(r=(_=se.value)==null?void 0:_.config)==null?void 0:r.searchPath)==null?void 0:M[0]}),i=_=>J.value,c=ie(()=>{let _={"dataSource.connection.database":se.value&&i()?[]:[st()]};switch(u.value.dataSource.client){case X.SQLITE:_={};break;case X.SNOWFLAKE:_={"dataSource.connection.database":[st()],"dataSource.connection.schema":[st()]};break;case X.PG:case X.MSSQL:_["dataSource.searchPath.0"]=se.value?[]:[st()];break}return{title:[{required:!0,message:ce("labels.sourceNameRequired")},hs()],fk_integration_id:[{required:!0,message:"Connection is required"}],extraParameters:[gs],..._}}),{validate:O,validateInfos:F,clearValidate:le}=R(u.value,c),oe=()=>{u.value.dataSource={...Pt(u.value.dataSource.client)}},$e=["camelize","none"];function ze(){const _=Object.fromEntries(new Map(u.value.extraParameters.filter(M=>{var te;return(te=M.key)==null?void 0:te.trim()}).map(M=>[M.key,M.value]))),r={...u.value.dataSource.connection,..._};return r.ssl=ms(r,u.value.sslUse,u.value.dataSource.client),r}const ke=()=>{var _,r,M,te,be;(be=(te=(M=(r=(_=G.value)==null?void 0:_.$el.querySelector(".ant-form-item-explain-error"))==null?void 0:r.parentNode)==null?void 0:M.parentNode)==null?void 0:te.querySelector("input"))==null||be.focus()},{$poller:y}=Ae(),z=async()=>{var _,r;try{await O()}catch{ke();return}try{if(!w.value)return;L.value=!0;const M=ze(),te={...u.value.dataSource,connection:M};se.value&&(((_=te.connection)==null?void 0:_.database)===""&&(te.connection.database=void 0),((r=te.searchPath)==null?void 0:r[0])===""&&(te.searchPath=void 0));const be=await H.source.create(w.value,{fk_integration_id:u.value.fk_integration_id,alias:u.value.title,type:u.value.dataSource.client,config:te,inflection_column:u.value.inflection.inflectionColumn,inflection_table:u.value.inflection.inflectionTable,is_schema_readonly:u.value.is_schema_readonly,is_data_readonly:u.value.is_data_readonly});y.subscribe({id:be.id},async n=>{var E,ne;n.status!=="close"&&(n.status===Rt.COMPLETED?(T("a:base:create:extdb"),w.value&&(await f(w.value,!0),await $(w.value,!0)),N("sourceCreated"),v.value=!1,L.value=!1):n.status===Rt.FAILED&&(he.error(((ne=(E=n==null?void 0:n.data)==null?void 0:E.error)==null?void 0:ne.message)||"Failed to create base"),L.value=!1))})}catch(M){he.error(await Ne(M)),L.value=!1}finally{P()}},j=B(),_e=async()=>{try{await O()}catch{ke();return}T("a:source:create:extdb:test-connection",[]);try{if(q.value=!0,u.value.dataSource.client===X.SQLITE)m.value=!0;else{const _=ze();_.database=Aa(u.value.dataSource);let r=u.value.dataSource.searchPath;se.value&&(r==null?void 0:r[0])===""&&(r=void 0);const M={...u.value.dataSource,connection:_,searchPath:r,fk_integration_id:u.value.fk_integration_id},te=await H.utils.testConnection(M);te.code===0?m.value=!0:(m.value=!1,he.error(`${ce("msg.error.dbConnectionFailed")} ${te.message}`))}}catch(_){m.value=!1,j.value=await Ne(_)}q.value=!1};we(()=>u.value.dataSource,()=>{m.value=!1,j.value=null},{deep:!0}),Wt(async()=>{var _;Y.value=!0,k.value.length||await x(!0,(_=p.value)==null?void 0:_.id),u.value.title=await ys(),Nt(()=>{setTimeout(()=>{var M,te;const r=(te=(M=G.value)==null?void 0:M.$el)==null?void 0:te.querySelector("input[type=text]");r==null||r.setSelectionRange(0,u.value.title.length),r==null||r.focus()},500)}),Y.value=!1});const xe=ie({get:()=>!u.value.is_schema_readonly,set:_=>{u.value.is_schema_readonly=!_,_&&(u.value.is_data_readonly=!1),T("c:source:schema-write-toggle",{allowed:!_,edit:!0})}}),Ue=ie({get:()=>!u.value.is_data_readonly,set:_=>{u.value.is_data_readonly=!_,T("c:source:data-write-toggle",{allowed:!_})}}),We=(_=!1)=>{var r;u.value.fk_integration_id&&se.value?u.value.dataSource={client:se.value.sub_type,connection:{database:J.value},searchPath:(r=se.value.config)==null?void 0:r.searchPath}:oe(),le(),_&&setTimeout(()=>{_e()},300)},Ve=()=>{Z.value=W.LIST};U.on((_,r)=>{_===Oa.INTEGRATION_ADD&&(r!=null&&r.id)&&(u.value.fk_integration_id=r.id,Gt(()=>{var M;return((M=se.value)==null?void 0:M.id)===r.id}).toBeTruthy().then(()=>{We(!0)}))});const Se=_=>{_?(S.value=["1"],He(!0,"nc-source-advanced-options")):S.value=[]};let Ce;function He(_,r){Ce&&clearTimeout(Ce),Nt(()=>{const M=document.querySelector(`.create-source .${r}`);M&&(Ce=setTimeout(()=>{M.scrollIntoView({block:"center",behavior:"smooth"})},400))})}const Re=_=>[Ma.DATABASE].includes(_.value),Ie=(_={})=>{switch(_.sub_type){case X.SQLITE:return{isDisabled:(_==null?void 0:_.source_count)&&_.source_count>0,msg:"Sqlite support only 1 database per connection"};default:return{isDisabled:!1,msg:""}}};return(_,r)=>{const M=Me,te=kt,be=Pe,n=St,E=aa,ne=Ea,De=Ba,ye=us,mt=Xt,na=$s,ft=vs,ia=al,ra=ws,ca=xs,da=Ot,ua=_s,_a=ps,pa=Ua,ma=bs,fa=il,va=sa,ba=ea;return o(),A(ba,{visible:e(v),"onUpdate:visible":r[17]||(r[17]=b=>re(v)?v.value=b:null),closable:!1,"mask-closable":!e(L),keyboard:!e(L),centered:"",size:"large","wrap-class-name":"nc-modal-create-source",onKeydown:r[18]||(r[18]=Kt(b=>v.value=!1,["esc"]))},{default:s(()=>[t("div",rl,[t("div",cl,[t("div",dl,[a(M,{icon:"server1",class:"!text-green-700 !h-4 !w-4"})]),ul,t("div",_l,[t("div",{class:"w-[15px] h-[15px] cursor-pointer",onDblclick:pe},null,32),a(be,{disabled:!e(j)},{title:s(()=>[V(l(e(j)),1)]),default:s(()=>[a(te,{type:"secondary",size:"small",class:fe(["nc-extdb-btn-test-connection",{"pointer-events-none":e(m)}]),disabled:!e(se)||e(Y),loading:e(q),"icon-position":"right",onClick:_e},{icon:s(()=>[e(m)?(o(),A(M,{key:0,icon:"circleCheckSolid",class:"!text-green-700 w-4 h-4"})):e(j)?(o(),A(M,{key:1,icon:"alertTriangleSolid",class:"!text-red-700 w-4 h-4"})):D("",!0)]),default:s(()=>[t("span",null,l(e(m)?"Test successful":"Test connection"),1)]),_:1},8,["class","disabled","loading"])]),_:1},8,["disabled"]),a(te,{size:"small",type:"primary",disabled:!e(m)||!e(se)||e(Y),loading:e(L),class:"nc-extdb-btn-submit",onClick:z},{default:s(()=>[V(" Add Source ")]),_:1},8,["disabled","loading"]),a(te,{disabled:e(L),size:"small",type:"text",onClick:r[0]||(r[0]=b=>v.value=!1)},{default:s(()=>[a(M,{icon:"close",class:"text-gray-600"})]),_:1},8,["disabled"])])]),t("div",pl,[t("div",ml,[t("div",fl,[a(da,{ref_key:"form",ref:G,model:e(u),"hide-required-mark":"",name:"external-base-create-form",layout:"vertical","no-style":"",class:"flex flex-col gap-5.5"},{default:s(()=>[t("div",vl,[t("div",bl,[a(De,{gutter:24},{default:s(()=>[a(ne,{span:12},{default:s(()=>[a(E,je({label:"Data Source Name"},e(F).title),{default:s(()=>[a(n,{value:e(u).title,"onUpdate:value":r[1]||(r[1]=b=>e(u).title=b)},null,8,["value"])]),_:1},16)]),_:1})]),_:1}),a(De,{gutter:24},{default:s(()=>[a(ne,{span:12},{default:s(()=>[a(E,je({label:"Select connection"},e(F).fk_integration_id),{default:s(()=>[a(ft,{value:e(u).fk_integration_id,"onUpdate:value":r[3]||(r[3]=b=>e(u).fk_integration_id=b),class:"nc-extdb-db-type nc-select-shadow","dropdown-class-name":"nc-dropdown-ext-db-type",placeholder:"Select connection","allow-clear":"","show-search":"","dropdown-match-select-width":"",onChange:r[4]||(r[4]=b=>We())},Ft({default:s(()=>[(o(!0),C(me,null,Qe(e(k),b=>(o(),A(mt,{key:b.id,value:b.id,disabled:Ie(b).isDisabled},{default:s(()=>[t("div",{class:"w-full flex gap-2 items-center","data-testid":b.title},[b!=null&&b.sub_type?(o(),A(ye,{key:0,type:b.sub_type,style:Qt({filter:Ie(b).isDisabled?"grayscale(100%) brightness(115%)":void 0})},null,8,["type","style"])):D("",!0),a(be,{class:"flex-1 truncate","show-on-truncate-only":!Ie(b).isDisabled},{title:s(()=>[V(l(Ie(b).isDisabled?Ie(b).msg:b.title),1)]),default:s(()=>[V(" "+l(b.title),1)]),_:2},1032,["show-on-truncate-only"]),e(u).fk_integration_id===b.id?(o(),A(rt(("iconMap"in _?_.iconMap:e($t)).check),{key:1,id:"nc-selected-item-icon",class:"text-primary w-4 h-4"})):D("",!0)],8,hl)]),_:2},1032,["value","disabled"]))),128))]),_:2},[e(ae)("workspaceIntegrations")?{name:"dropdownRender",fn:s(({menuNode:b})=>[(o(),A(rt(b))),a(na,{style:{margin:"4px 0"}}),t("div",{class:"px-1.5 flex items-center text-brand-500 text-sm cursor-pointer",onMousedown:r[2]||(r[2]=Fe(()=>{},["prevent"])),onClick:Ve},[t("div",gl,[a(M,{icon:"plus",class:"flex-none"}),V(" "+l(_.$t("general.new"))+" "+l(_.$t("general.connection").toLowerCase()),1)])],32)]),key:"0"}:void 0]),1032,["value"])]),_:1},16)]),_:1})]),_:1})])]),e(se)?(o(),C(me,{key:0},[t("div",yl,[t("div",wl,[e(u).dataSource.client===e(X).SQLITE?(o(),C(me,{key:0},[],64)):e(u).dataSource.client===e(X).SNOWFLAKE?(o(),A(De,{key:1,gutter:24},{default:s(()=>[a(ne,{span:12},{default:s(()=>[a(E,je({label:_.$t("labels.database")},e(F)["dataSource.connection.database"]),{default:s(()=>[a(n,{value:e(u).dataSource.connection.database,"onUpdate:value":r[5]||(r[5]=b=>e(u).dataSource.connection.database=b),class:"nc-extdb-host-database"},null,8,["value"])]),_:1},16,["label"])]),_:1}),a(ne,{span:12},{default:s(()=>[a(E,je({label:"Schema"},e(F)["dataSource.connection.schema"]),{default:s(()=>[a(n,{value:e(u).dataSource.connection.schema,"onUpdate:value":r[6]||(r[6]=b=>e(u).dataSource.connection.schema=b),class:"nc-extdb-host-database"},null,8,["value"])]),_:1},16)]),_:1})]),_:1})):e(u).dataSource.client===e(X).DATABRICKS?(o(),A(De,{key:2,gutter:24},{default:s(()=>[a(ne,{span:12},{default:s(()=>[a(E,je({label:"Database"},e(F)["dataSource.connection.database"]),{default:s(()=>[a(n,{value:e(u).dataSource.connection.database,"onUpdate:value":r[7]||(r[7]=b=>e(u).dataSource.connection.database=b),class:"nc-extdb-host-database"},null,8,["value"])]),_:1},16)]),_:1}),a(ne,{span:12},{default:s(()=>[a(E,je({label:"Schema"},e(F)["dataSource.connection.schema"]),{default:s(()=>[a(n,{value:e(u).dataSource.connection.schema,"onUpdate:value":r[8]||(r[8]=b=>e(u).dataSource.connection.schema=b),class:"nc-extdb-host-schema"},null,8,["value"])]),_:1},16)]),_:1})]),_:1})):(o(),A(De,{key:3,gutter:24},{default:s(()=>[a(ne,{span:12},{default:s(()=>[a(E,je({label:_.$t("labels.database")},e(F)["dataSource.connection.database"]),{default:s(()=>[a(n,{value:e(u).dataSource.connection.database,"onUpdate:value":r[9]||(r[9]=b=>e(u).dataSource.connection.database=b),placeholder:_.$t("labels.dbCreateIfNotExists"),class:"nc-extdb-host-database"},null,8,["value","placeholder"])]),_:1},16,["label"])]),_:1}),a(ne,{span:12},{default:s(()=>{var b;return[([e(X).MSSQL,e(X).PG].includes(e(u).dataSource.client)||[e(X).MSSQL,e(X).PG].includes((b=e(se))==null?void 0:b.sub_type))&&e(u).dataSource.searchPath?(o(),A(E,je({key:0,label:_.$t("labels.schemaName")},e(F)["dataSource.searchPath.0"]),{default:s(()=>[a(n,{value:e(u).dataSource.searchPath[0],"onUpdate:value":r[10]||(r[10]=Ct=>e(u).dataSource.searchPath[0]=Ct),placeholder:e(ee)&&`${e(ee)} (default)`},null,8,["value","placeholder"])]),_:1},16,["label"])):D("",!0)]}),_:1})]),_:1}))])]),t("div",xl,[$l,t("div",kl,[a(ia,{allowMetaWrite:e(xe),"onUpdate:allowMetaWrite":r[11]||(r[11]=b=>re(xe)?xe.value=b:null),allowDataWrite:e(Ue),"onUpdate:allowDataWrite":r[12]||(r[12]=b=>re(Ue)?Ue.value=b:null)},null,8,["allowMetaWrite","allowDataWrite"])])]),[e(X).SQLITE,e(X).SNOWFLAKE,e(X).DATABRICKS].includes(e(u).dataSource.client)?D("",!0):(o(),A(ca,{key:0,"active-key":e(S),"onUpdate:activeKey":r[16]||(r[16]=b=>re(S)?S.value=b:null),ghost:"",class:"nc-source-advanced-options !mt-4"},{expandIcon:s(({isActive:b})=>[a(te,{type:"text",size:"small",class:"!-ml-1.5",onClick:r[13]||(r[13]=Ct=>Se(!e(S).length))},{default:s(()=>[Sl,a(M,{icon:"chevronDown",class:fe(["ml-2 flex-none cursor-pointer transform transition-transform duration-500",{"!rotate-180":b}])},null,8,["class"])]),_:2},1024)]),default:s(()=>[a(ra,{key:"1",collapsible:"disabled"},{header:s(()=>[Cl]),default:s(()=>[t("div",Il,[t("div",Dl,[a(De,{gutter:24},{default:s(()=>[a(ne,{span:12},{default:s(()=>[a(E,{label:_.$t("labels.inflection.tableName")},{default:s(()=>[a(ft,{value:e(u).inflection.inflectionTable,"onUpdate:value":r[14]||(r[14]=b=>e(u).inflection.inflectionTable=b),class:"nc-select-shadow","dropdown-class-name":"nc-dropdown-inflection-table-name"},{default:s(()=>[(o(),C(me,null,Qe($e,b=>a(mt,{key:b,value:b},{default:s(()=>[V(l(b),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"])]),_:1},8,["label"])]),_:1}),a(ne,{span:12},{default:s(()=>[a(E,{label:_.$t("labels.inflection.columnName")},{default:s(()=>[a(ft,{value:e(u).inflection.inflectionColumn,"onUpdate:value":r[15]||(r[15]=b=>e(u).inflection.inflectionColumn=b),class:"nc-select-shadow","dropdown-class-name":"nc-dropdown-inflection-column-name"},{default:s(()=>[(o(),C(me,null,Qe($e,b=>a(mt,{key:b,value:b},{default:s(()=>[V(l(b),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"])]),_:1},8,["label"])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["active-key"]))],64)):D("",!0),Tl]),_:1},8,["model"]),a(ua,{"is-modal":"","filter-category":Re}),a(_a,{"load-datasource-info":"","base-id":e(w)},null,8,["base-id"])]),a(ma,{"model-value":e(Y),inline:"",transition:"",class:"!bg-opacity-15"},{default:s(()=>[t("div",Nl,[a(pa,{size:"large"})])]),_:1},8,["model-value"])]),t("div",Pl,[a(fa),a(va)])])])]),_:1},8,["visible","mask-closable","keyboard"])}}}),la=Le(Rl,[["__scopeId","data-v-62a289ff"]]),Ol=Object.freeze(Object.defineProperty({__proto__:null,default:la},Symbol.toStringTag,{value:"Module"})),jl=Ee(()=>Be(()=>import("./C1JaV8Px.js"),__vite__mapDeps([86,55,1,2,48,49,9,10,12,13,14,6,15,16,17,56,57,8,58,50,22,27,59,60,24,61,62,63,64,65,66,67,68,69,37,11,70,34,71,20,21,23,72,73,74,75,18,19,4,5,25,26,28,29,30,31,32,33,35,36,38,39,40,41,42,43,44,3,7,45,46,47,51,52,53,54,76,77,78,79,80,81,82,83,84,87]),import.meta.url).then(d=>d.default||d)),Al=Ee(()=>Be(()=>import("./Cp5O2m5x.js"),__vite__mapDeps([88,89,1,2,67,68,4,5,6,90]),import.meta.url).then(d=>d.default||d)),Ml=Ee(()=>Be(()=>import("./SqkZkS6T.js"),__vite__mapDeps([91,1,2,92,93,57,50,22,14,27,15,6,94,95,4,5,96,12,13,16,17,97]),import.meta.url).then(d=>d.default||d)),El=Ee(()=>Be(()=>import("./CstA33ur.js"),__vite__mapDeps([98,1,2,3,4,5,6,7,36,38,39,12,13,14,15,16,17]),import.meta.url).then(d=>d.default||d)),Bl=Ee(()=>Be(()=>import("./B0eDEB-B.js"),__vite__mapDeps([99,36,1,2,38,39,81]),import.meta.url).then(d=>d.default||d)),pt=d=>(dt("data-v-b7710592"),d=d(),ut(),d),Ul={class:"flex flex-col h-full p-6","data-testid":"nc-settings-datasources-tab"},Ll={class:"mb-6 flex items-center justify-between gap-3"},zl={class:"flex flex-row items-center w-full gap-x-1"},Wl={class:"flex"},Vl={key:0,class:"h-full"},Gl={class:"px-4 pt-4 pb-2 flex items-center justify-between gap-3"},Fl=pt(()=>t("a",{class:"!no-underline text-base"},"Data Sources",-1)),Ql={class:"capitalize text-base"},Kl={class:"tab","data-testid":"nc-connection-tab"},ql={class:"h-full"},Hl={class:"tab","data-testid":"nc-erd-tab"},Yl={class:"h-full p-6"},Zl={class:"tab","data-testid":"nc-audit-tab"},Jl={class:"p-6 h-full"},Xl={class:"tab","data-testid":"nc-acl-tab"},en={class:"p-6 h-full"},tn={class:"tab","data-testid":"nc-meta-sync-tab"},an={class:"p-6 h-full"},sn={key:1,class:"ds-table overflow-y-auto nc-scrollbar-thin relative max-h-full mb-4"},on={class:"ds-table-head sticky top-0 bg-white z-10"},ln={class:"ds-table-row !border-0"},nn={class:"ds-table-col ds-table-enabled cursor-pointer"},rn={class:"ds-table-col ds-table-name"},cn={class:"ds-table-col ds-table-integration-name"},dn={class:"ds-table-col ds-table-type"},un={class:"ds-table-col ds-table-actions"},_n={class:"ds-table-body relative"},pn={class:"ds-table-col ds-table-enabled"},mn={key:0,class:"ds-table-handle"},fn={class:"ds-table-col ds-table-name font-medium"},vn={class:"flex items-center gap-1"},bn=pt(()=>t("div",{class:"ds-table-col ds-table-integration-name"},[t("div",{class:"flex items-center gap-1"},"-")],-1)),hn=pt(()=>t("div",{class:"ds-table-col ds-table-type"},[t("div",{class:"flex items-center gap-1"},"-")],-1)),gn={class:"ds-table-col ds-table-actions"},yn=["onClick"],wn={class:"ds-table-col ds-table-enabled"},xn={class:"ds-table-col ds-table-name font-medium w-full"},$n={key:0,class:"h-8 w-1"},kn={class:"ds-table-col ds-table-integration-name w-full"},Sn={class:"ds-table-col ds-table-type"},Cn={class:"flex justify-end"},In={key:0,class:"flex-none integration-table-empty flex items-center justify-center py-8 px-6"},Dn={class:"px-2 py-6 text-gray-500 flex flex-col items-center gap-6 text-center"},Tn=pt(()=>t("img",{src:Ts,class:"!w-[164px] flex-none",alt:"No search results found"},null,-1)),Nn={class:"flex items-center justify-center absolute left-0 top-0 w-full h-[calc(100%_-_45px)] z-10 pb-10 pointer-events-none"},Pn={class:"flex flex-col justify-center items-center gap-2"},Rn={class:"text-center"},On={key:0,class:"flex flex-row items-center py-2 px-3.25 bg-gray-50 rounded-lg text-gray-700 mb-4"},jn={class:"capitalize text-ellipsis overflow-hidden select-none w-full pl-3",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},An=ge({__name:"DataSources",props:{state:{},baseId:{},reload:{type:Boolean}},emits:["update:state","update:reload"],setup(d,{emit:h}){const I=d,N=h,v=qe(I,"state",N),x=qe(I,"reload",N),{$api:k,$e:U}=Ae(),Z=et(),{loadProject:W}=Z,{isDataSourceLimitReached:g,bases:f}=ve(Z),p=ie(()=>f.value.get(I.baseId)??{}),{isUIAllowed:$}=tt(),{projectPageTab:P}=ve(oa()),{refreshCommandPalette:K}=Vt(),w=B([]),R=B(""),m=B(X.MYSQL),q=B(!1),G=B(!1),H=B(),T=B("");async function ce(){const i=new Set;let c=!1;for(const O of w.value){if(O.order===null||i.has(O.order)){c=!0;break}i.add(O.order)}if(c){w.value=w.value.sort((O,F)=>O.is_local||O.is_meta?-1:F.is_local||F.is_meta?1:(O.order??0)-(F.order??0)),w.value=w.value.map((O,F)=>({...O,order:F+1}));try{await Promise.all(w.value.map(async O=>{await k.source.update(O.base_id,O.id,{id:O.id,base_id:O.base_id,order:O.order})})),await W(p.value.id,!0)}catch(O){he.error(await Ne(O))}}}async function ae(i){try{i&&K(),await Gt(()=>!!p.value.id).toBeTruthy(),q.value=!0,x.value=!0;const c=await k.source.list(p.value.id);c.list&&c.list.length&&(w.value=c.list),await ce()}catch(c){console.error(c)}finally{x.value=!1,q.value=!1}}const L=(i,c)=>{i&&(R.value=i,v.value=c||"")},S=i=>{U("c:source:delete"),G.value=!0,H.value=i},Y=async()=>{if(H.value)try{await k.source.delete(H.value.base_id,H.value.id),U("a:source:delete"),w.value.splice(w.value.indexOf(H.value),1),await W(p.value.id,!0)}catch(i){he.error(await Ne(i))}finally{K()}},ue=async(i,c)=>{try{if(!c&&w.value.filter(O=>O.enabled).length<2){he.info("There should be at least one enabled source!");return}i.enabled=c,await k.source.update(i.base_id,i.id,{id:i.id,base_id:i.base_id,enabled:i.enabled}),await W(p.value.id,!0)}catch(O){he.error(await Ne(O))}finally{K()}},u=async i=>{var c,O;try{if(i.oldIndex===i.newIndex)return;const F=w.value[i.newIndex];if(F){let le;w.value.length-1===i.newIndex?le=Math.max(...w.value.map($e=>($e==null?void 0:$e.order)??0))+1:le=(parseFloat(String(((c=w.value[i.newIndex-1])==null?void 0:c.order)??0))+parseFloat(String(((O=w.value[i.newIndex+1])==null?void 0:O.order)??0)))/2;const oe=isNaN(Number(le))?i.oldIndex:le;await k.source.update(F.base_id,F.id,{id:F.id,base_id:F.base_id,order:oe})}await W(p.value.id,!0),await ae()}catch(F){he.error(await Ne(F))}finally{await K()}};we(P,()=>{P.value==="data-source"&&ae()},{immediate:!0}),we(()=>I.reload,async i=>{i&&!q.value&&await ae()}),we(v,async i=>{switch(w.value.length||await ae(),i){case X.MYSQL:m.value=X.MYSQL,v.value=Te.New;break;case X.PG:m.value=X.PG,v.value=Te.New;break;case X.SQLITE:m.value=X.SQLITE,v.value=Te.New;break;case X.MSSQL:m.value=X.MSSQL,v.value=Te.New;break;case X.SNOWFLAKE:m.value=X.SNOWFLAKE,v.value=Te.New;break;case Te.New:g.value&&(v.value="");break}K()},{immediate:!0});const de=ie({get:()=>[Te.New].includes(v.value),set:i=>{i||(v.value="")}}),Q=B(null),pe=B("erd"),se=()=>{var i;return w.value.filter(c=>{var O,F,le;return(le=(O=c==null?void 0:c.alias)==null?void 0:O.toLowerCase())==null?void 0:le.includes((F=T.value)==null?void 0:F.toLowerCase())}).length||"default".includes((i=T.value)==null?void 0:i.toLowerCase())},J=ie({get:()=>!!Q.value,set:i=>{i||(Q.value=null)}}),ee=(i,c)=>{c&&c!==pe.value&&(pe.value=c),Q.value=i};return(i,c)=>{var be;const O=Me,F=St,le=kt,oe=Xe,$e=Ke,ze=jl,ke=qt,y=Al,z=Ml,j=El,_e=Bl,xe=cs,Ue=ea,We=la,Ve=ta,Se=Pe,Ce=Yt,He=ks,Re=Ss,Ie=sa,_=Cs,r=Is,M=Ut,te=Ds;return o(),C("div",Ul,[t("div",Ll,[a(F,{value:e(T),"onUpdate:value":c[0]||(c[0]=n=>re(T)?T.value=n:null),type:"text",class:"nc-search-data-source-input !max-w-90 nc-input-sm",placeholder:"Search data source","allow-clear":""},{prefix:s(()=>[a(O,{icon:"search",class:"mr-2 h-4 w-4 text-gray-500"})]),_:1},8,["value"]),!e(g)&&e($)("sourceCreate")?(o(),A(le,{key:0,size:"large",class:"z-10 !px-2",type:"primary",onClick:c[1]||(c[1]=n=>v.value=("DataSourcesSubTab"in i?i.DataSourcesSubTab:e(Te)).New)},{default:s(()=>[t("div",zl,[(o(),A(rt(("iconMap"in i?i.iconMap:e($t)).plus))),t("div",Wl,l(i.$t("activity.newSource")),1)])]),_:1})):D("",!0)]),t("div",{"data-testid":"nc-settings-datasources",class:"flex flex-row w-full nc-data-sources-view flex-grow min-h-0",style:Qt({maxHeight:e(de)?"100%":e(Q)?"calc(100% - 46px)":"calc(100% - 66px)"})},[a(Ue,{visible:e(J),"onUpdate:visible":c[8]||(c[8]=n=>re(J)?J.value=n:null),centered:"",size:"large","wrap-class-name":"nc-active-data-sources-view",onKeydown:c[9]||(c[9]=Kt(n=>Q.value=null,["esc"]))},{default:s(()=>[e(Q)?(o(),C("div",Vl,[t("div",Gl,[a($e,{separator:">",class:"flex-1 cursor-pointer font-weight-bold !ml-1"},{default:s(()=>[a(oe,{onClick:c[2]||(c[2]=n=>Q.value=null)},{default:s(()=>[Fl]),_:1}),e(Q)?(o(),A(oe,{key:0},{default:s(()=>[t("span",Ql,l(e(Q).alias||"Default Source"),1)]),_:1})):D("",!0)]),_:1}),a(le,{size:"small",type:"text",class:"nc-close-btn",onClick:c[3]||(c[3]=n=>J.value=!1)},{default:s(()=>[a(O,{icon:"close",class:"text-gray-600"})]),_:1})]),a(xe,{activeKey:e(pe),"onUpdate:activeKey":c[7]||(c[7]=n=>re(pe)?pe.value=n:null),class:"nc-source-tab w-full h-[calc(100%_-_58px)] max-h-[calc(100%_-_58px)]"},{default:s(()=>[!e(Q).is_meta&&!e(Q).is_local?(o(),A(ke,{key:"edit"},{tab:s(()=>[t("div",Kl,[t("div",null,l(i.$t("labels.connectionDetails")),1)])]),default:s(()=>[t("div",ql,[a(ze,{"source-id":e(Q).id,onSourceUpdated:c[4]||(c[4]=n=>ae(!0)),onClose:c[5]||(c[5]=n=>Q.value=null)},null,8,["source-id"])])]),_:1})):D("",!0),a(ke,{key:"erd"},{tab:s(()=>[t("div",Hl,[t("div",null,l(i.$t("title.erdView")),1)])]),default:s(()=>[t("div",Yl,[a(y,{class:"h-full overflow-auto","base-id":e(p).id,"source-id":e(Q).id,"show-all-columns":!1},null,8,["base-id","source-id"])])]),_:1}),e(w)&&e(Q)===e(w)[0]?(o(),A(ke,{key:"audit"},{tab:s(()=>[t("div",Zl,[t("div",null,l(i.$t("title.auditLogs")),1)])]),default:s(()=>[t("div",Jl,[a(z,{"source-id":e(Q).id},null,8,["source-id"])])]),_:1})):D("",!0),a(ke,{key:"acl"},{tab:s(()=>[t("div",Xl,[t("div",null,l(i.$t("labels.uiAcl")),1)])]),default:s(()=>[t("div",en,[a(j,{"source-id":e(Q).id},null,8,["source-id"])])]),_:1}),!e(Q).is_meta&&!e(Q).is_local?(o(),A(ke,{key:"meta-sync"},{tab:s(()=>[t("div",tn,[t("div",null,l(i.$t("labels.metaSync")),1)])]),default:s(()=>[t("div",an,[a(_e,{"source-id":e(Q).id,onSourceSynced:c[6]||(c[6]=n=>ae(!0))},null,8,["source-id"])])]),_:1})):D("",!0)]),_:1},8,["activeKey"])])):D("",!0)]),_:1},8,["visible"]),t("div",{class:fe(["flex flex-col w-full",{"overflow-auto":!e(de)}])},[e(de)?(o(),A(We,{key:0,open:e(de),"onUpdate:open":c[10]||(c[10]=n=>re(de)?de.value=n:null),"connection-type":e(m),"is-modal":"",onSourceCreated:c[11]||(c[11]=n=>ae(!0))},null,8,["open","connection-type"])):(o(),C("div",sn,[t("div",on,[t("div",ln,[t("div",nn,l(i.$t("general.visibility")),1),t("div",rn,l(i.$t("general.name")),1),t("div",cn,l(i.$t("general.connection"))+" "+l(i.$t("general.name")),1),t("div",dn,l(i.$t("general.type")),1),t("div",un,l(i.$t("labels.actions")),1)])]),t("div",_n,[a(e(Ns),{list:e(w),"item-key":"id",handle:".ds-table-handle",onEnd:u},Ft({item:s(({element:n,index:E})=>{var ne,De;return[E!==0?(o(),C("div",{key:0,class:fe(["ds-table-row border-gray-200 cursor-pointer",{"!hidden":!((De=(ne=n==null?void 0:n.alias)==null?void 0:ne.toLowerCase())!=null&&De.includes(e(T).toLowerCase()))}]),onClick:ye=>ee(n,"edit")},[t("div",wn,[t("div",{class:"flex items-center gap-1",onClick:c[16]||(c[16]=Fe(()=>{},["stop"]))},[e(w).length>2?(o(),A(O,{key:0,icon:"dragVertical",small:"",class:"ds-table-handle"})):D("",!0),a(Se,null,{title:s(()=>[n.enabled?(o(),C(me,{key:0},[V(l(i.$t("activity.hideInUI")),1)],64)):(o(),C(me,{key:1},[V(l(i.$t("activity.showInUI")),1)],64))]),default:s(()=>[a(Ve,{checked:!!n.enabled,class:"cursor-pointer",size:"small",onChange:ye=>ue(n,ye)},null,8,["checked","onChange"])]),_:2},1024)])]),t("div",xn,[n.is_meta||n.is_local?(o(),C("div",$n,"-")):(o(),A(Se,{key:1,class:"truncate","show-on-truncate-only":""},{title:s(()=>[V(l(n.is_meta||n.is_local?i.$t("general.base"):n.alias),1)]),default:s(()=>[V(" "+l(n.is_meta||n.is_local?i.$t("general.base"):n.alias),1)]),_:2},1024))]),t("div",kn,[a(Se,{class:"truncate","show-on-truncate-only":""},{title:s(()=>[V(l((n==null?void 0:n.integration_title)||"-"),1)]),default:s(()=>[V(" "+l((n==null?void 0:n.integration_title)||"-"),1)]),_:2},1024)]),t("div",Sn,[a(He,{rounded:"lg",class:"flex items-center gap-2 px-0 py-1 !h-7 truncate !border-transparent"},{default:s(()=>[a(Ce,{"source-type":n.type,class:"flex-none !w-4 !h-4"},null,8,["source-type"]),a(Se,{placement:"bottom","show-on-truncate-only":"",class:"text-sm truncate"},{title:s(()=>{var ye;return[V(l(((ye=("clientTypesMap"in i?i.clientTypesMap:e(bt))[n.type])==null?void 0:ye.text)||n.type),1)]}),default:s(()=>{var ye;return[V(" "+l(n.type&&("clientTypesMap"in i?i.clientTypesMap:e(bt))[n.type]?(ye=("clientTypesMap"in i?i.clientTypesMap:e(bt))[n.type])==null?void 0:ye.text:n.type),1)]}),_:2},1024)]),_:2},1024)]),t("div",{class:"ds-table-col justify-end gap-x-1 ds-table-actions",onClick:c[17]||(c[17]=Fe(()=>{},["stop"]))},[t("div",Cn,[!n.is_meta&&!n.is_local?(o(),A(r,{key:0,placement:"bottomRight"},{overlay:s(()=>[a(_,null,{default:s(()=>[a(Re,{onClick:ye=>ee(n,"edit")},{default:s(()=>[a(O,{class:"text-gray-800",icon:"edit"}),t("span",null,l(i.$t("general.edit")),1)]),_:2},1032,["onClick"]),a(Ie),a(Re,{class:"!text-red-500 !hover:bg-red-50",onClick:Fe(ye=>S(n),["stop"])},{default:s(()=>[a(O,{icon:"delete"}),V(" "+l(i.$t("general.remove")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),default:s(()=>[a(le,{size:"small",type:"secondary"},{default:s(()=>[a(O,{icon:"threeDotVertical"})]),_:1})]),_:2},1024)):D("",!0)])])],10,yn)):D("",!0)]}),_:2},["default".includes(e(T).toLowerCase())?{name:"header",fn:s(()=>[e(w)[0]?(o(),C("div",{key:0,class:"ds-table-row border-gray-200 cursor-pointer",onClick:c[15]||(c[15]=n=>ee(e(w)[0],"erd"))},[t("div",pn,[t("div",{class:"flex items-center gap-1",onClick:c[13]||(c[13]=Fe(()=>{},["stop"]))},[e(w).length>2?(o(),C("div",mn)):D("",!0),a(Se,null,{title:s(()=>[e(w)[0].enabled?(o(),C(me,{key:0},[V(l(i.$t("activity.hideInUI")),1)],64)):(o(),C(me,{key:1},[V(l(i.$t("activity.showInUI")),1)],64))]),default:s(()=>[a(Ve,{checked:!!e(w)[0].enabled,class:"cursor-pointer",size:"small",onChange:c[12]||(c[12]=n=>ue(e(w)[0],n))},null,8,["checked"])]),_:1})])]),t("div",fn,[t("div",vn,l(i.$t("general.default")),1)]),bn,hn,t("div",gn,[!e(w)[0].is_meta&&!e(w)[0].is_local?(o(),A(le,{key:0,size:"small",class:"nc-action-btn nc-edit-base cursor-pointer outline-0 !w-8 !px-1 !rounded-lg",type:"text",onClick:c[14]||(c[14]=Fe(n=>L(e(w)[0].id,("DataSourcesSubTab"in i?i.DataSourcesSubTab:e(Te)).Edit),["stop"]))},{default:s(()=>[a(O,{icon:"edit",class:"text-gray-600"})]),_:1})):D("",!0)])])):D("",!0)]),key:"0"}:void 0]),1032,["list"]),!e(q)&&((be=e(w))!=null&&be.length)&&!se()?(o(),C("div",In,[t("div",Dn,[Tn,V(" "+l(i.$t("title.noResultsMatchedYourSearch")),1)])])):D("",!0)]),it(t("div",Nn,[t("div",Pn,[a(M,{size:"xlarge"}),t("span",Rn,l(i.$t("general.loading")),1)])],512),[[La,e(q)]])])),a(te,{visible:e(G),"onUpdate:visible":c[18]||(c[18]=n=>re(G)?G.value=n:null),"entity-name":i.$t("general.datasource"),"on-delete":Y,"delete-label":i.$t("general.remove")},{"entity-preview":s(()=>[e(H)?(o(),C("div",On,[a(Ce,{"source-type":e(H).type},null,8,["source-type"]),t("div",jn,l(e(H).alias),1)])):D("",!0)]),_:1},8,["visible","entity-name","delete-label"])],2)],4)])}}}),Mn=Le(An,[["__scopeId","data-v-b7710592"]]),En={class:"nc-icon",stroke:"currentColor",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},Bn=t("path",{d:"M12.6667 2H3.33333C2.59695 2 2 2.59695 2 3.33333V12.6667C2 13.403 2.59695 14 3.33333 14H12.6667C13.403 14 14 13.403 14 12.6667V3.33333C14 2.59695 13.403 2 12.6667 2Z",stroke:"currentColor","stroke-width":"1.33333","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),Un=t("path",{d:"M6 14V6",stroke:"currentColor","stroke-width":"1.33333","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),Ln=t("path",{d:"M2 6H14",stroke:"currentColor","stroke-width":"1.33333","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),zn=[Bn,Un,Ln];function Wn(d,h){return o(),C("svg",En,[...zn])}const Vn={name:"nc-icons-layout",render:Wn},Gn=Ee(()=>Be(()=>import("./BBQrPDDS.js"),__vite__mapDeps([100,1,2,101]),import.meta.url).then(d=>d.default||d)),Fn=d=>(dt("data-v-f4e0418c"),d=d(),ut(),d),Qn={class:"h-full nc-base-view"},Kn={class:"flex-1 flex flex-row items-center gap-x-3"},qn={class:"flex flex-row items-center h-full gap-x-2 px-2"},Hn={class:"truncate"},Yn={class:"flex nc-base-view-tab",style:{height:"calc(100% - var(--topbar-height))"}},Zn=Fn(()=>t("div",{class:"w-3"},null,-1)),Jn={class:"tab-title","data-testid":"proj-view-tab__all-tables"},Xn={class:"tab-title","data-testid":"proj-view-tab__access-settings"},ei={class:"tab-title","data-testid":"proj-view-tab__data-sources"},ti=ge({__name:"View",props:{baseId:{}},setup(d){const h=d,{integrations:I}=fs(),N=et(),{openedProject:v,activeProjectId:x,basesUser:k,bases:U}=ve(N),{activeTables:Z,activeTable:W}=ve(nt()),{activeWorkspace:g}=ve(za()),{navigateToProjectPage:f,isSharedBase:p}=Je(),$=xt(Lt,B(!1)),K=Wa().currentRoute,{$e:w,$api:R}=Ae(),m=zt(async()=>{let S;return h.baseId?(S=U.value.get(h.baseId),S||(S=await R.base.read(h.baseId))):S=v.value,S}),{isUIAllowed:q,baseRoles:G}=tt(),{base:H}=ve(Je()),{projectPageTab:T}=ve(oa()),{isMobileMode:ce}=Ht(),ae=B(""),L=ie(()=>{var S,Y;return x.value?(Y=(S=k.value.get(x.value))==null?void 0:S.filter(ue=>!(ue!=null&&ue.deleted)))==null?void 0:Y.length:0});return we(()=>{var S;return(S=K.value.query)==null?void 0:S.page},(S,Y)=>{if(S&&S!==Y){S==="collaborator"?T.value="collaborator":S==="data-source"?T.value="data-source":T.value="allTable";return}$.value?T.value="collaborator":T.value="allTable"},{immediate:!0}),we(T,()=>{w(`a:project:view:tab-change:${T.value}`),T.value&&f({page:T.value})}),we(()=>{var S,Y;return[(S=m.value)==null?void 0:S.id,(Y=m.value)==null?void 0:Y.title]},()=>{var S,Y,ue;(S=W.value)!=null&&S.title||Va(`${((Y=m.value)==null?void 0:Y.title)??((ue=g.value)==null?void 0:ue.title)??"NocoDB"}`)},{immediate:!0}),we(()=>{var S;return(S=m.value)==null?void 0:S.id},()=>{I.value=[]}),(S,Y)=>{var F,le;const ue=Ha,u=Fa,de=Pe,Q=Ya,pe=Gn,se=So,J=qt,ee=Me,i=Ho,c=Mn,O=Qa;return o(),C("div",Qn,[e($)?D("",!0):(o(),C("div",{key:0,class:fe(["flex flex-row px-2 py-2 gap-3 justify-between w-full border-b-1 border-gray-200",{"nc-table-toolbar-mobile":e(ce),"h-[var(--topbar-height)]":!e(ce)}])},[t("div",Kn,[a(ue),t("div",qn,[a(u,{color:("parseProp"in S?S.parseProp:e(Ga))((F=e(m))==null?void 0:F.meta).iconColor,type:(le=e(m))==null?void 0:le.type},null,8,["color","type"]),a(de,{class:"flex font-bold text-sm capitalize truncate max-w-150 text-gray-800","show-on-truncate-only":""},{title:s(()=>{var oe;return[V(l((oe=e(m))==null?void 0:oe.title),1)]}),default:s(()=>{var oe;return[t("span",Hn,l((oe=e(m))==null?void 0:oe.title),1)]}),_:1})])]),e(p)?D("",!0):(o(),A(Q,{key:0})),a(pe)],2)),t("div",Yn,[a(O,{activeKey:e(T),"onUpdate:activeKey":Y[1]||(Y[1]=oe=>re(T)?T.value=oe:null),class:"w-full"},{leftExtra:s(()=>[Zn]),default:s(()=>[e($)?D("",!0):(o(),A(J,{key:"allTable"},{tab:s(()=>[t("div",Jn,[a(e(Vn)),t("div",null,l(S.$t("labels.allTables")),1),t("div",{class:fe(["tab-info",{"bg-primary-selected":e(T)==="allTable","bg-gray-50":e(T)!=="allTable"}])},l(e(Z).length),3)])]),default:s(()=>[a(se)]),_:1})),e(q)("newUser",{roles:e(G)})&&!e(p)?(o(),A(J,{key:"collaborator"},{tab:s(()=>[t("div",Xn,[a(ee,{icon:"users",class:"!h-3.5 !w-3.5"}),t("div",null,l(S.$t("labels.members")),1),e(L)?(o(),C("div",{key:0,class:fe(["tab-info",{"bg-primary-selected":e(T)==="collaborator","bg-gray-50":e(T)!=="collaborator"}])},l(e(L)),3)):D("",!0)])]),default:s(()=>{var oe;return[a(i,{"base-id":(oe=e(m))==null?void 0:oe.id},null,8,["base-id"])]}),_:1})):D("",!0),e(q)("sourceCreate")&&e(H).id?(o(),A(J,{key:"data-source"},{tab:s(()=>{var oe;return[t("div",ei,[a(ee,{icon:"database"}),t("div",null,l(S.$t("labels.dataSources")),1),(oe=e(H).sources)!=null&&oe.length?(o(),C("div",{key:0,class:fe(["tab-info",{"bg-primary-selected":e(T)==="data-source","bg-gray-50":e(T)!=="data-source"}])},l(e(H).sources.length),3)):D("",!0)])]}),default:s(()=>[a(c,{state:e(ae),"onUpdate:state":Y[0]||(Y[0]=oe=>re(ae)?ae.value=oe:null),"base-id":e(H).id,class:"max-h-full"},null,8,["state","base-id"])]),_:1})):D("",!0)]),_:1},8,["activeKey"])])])}}}),ai=Le(ti,[["__scopeId","data-v-f4e0418c"]]),si=ge({__name:"index",setup(d){const h=Je(),{base:I,sources:N}=ve(h),{isMobileMode:v}=Ht(),{files:x,reset:k}=Ka(),{$e:U}=Ae(),Z=["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel.sheet.macroenabled.12","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.spreadsheet-template","text/csv","application/json","text/json"];we(x,p=>p&&W(p),{flush:"post"});function W(p){if(!p)return;const $=Array.from(p).map(P=>P);g($)}function g(p){if(!p)return;if(p.length>1)return he.error({content:"Only one file can be imported at a time.",duration:2});let $=null;const P=Z.some(K=>{const w=p[0].type===K;if(w){const R=p[0].name.split(".").pop();$=R==="csv"||R==="json"?R:"excel"}return w});if(!P)return he.error({content:"Invalid file type",duration:2});$&&P&&f($,p[0])}function f(p,$){var m,q,G,H,T;if(!((m=I.value)!=null&&m.id))return;U(`a:actions:import-${p}`);const P=B(!0),{close:K,vNode:w}=ct(At,{modelValue:P,importType:p,"onUpdate:modelValue":R,baseId:I.value.id,sourceId:(q=N.value)==null?void 0:q.filter(ce=>ce.enabled)[0].id});(T=(H=(G=w.value)==null?void 0:G.component)==null?void 0:H.exposed)==null||T.handleChange({file:{uid:`${p}-${$.name}-${Math.random().toString(36).substring(2)}`,name:$.name,type:$.type,status:"done",fileName:$.name,lastModified:$.lastModified,size:$.size,originFileObj:$},event:{percent:100}});function R(){P.value=!1,K(1e3),k()}}return we(()=>{var p;return(p=I.value)==null?void 0:p.id},()=>{var p;if((p=I.value)!=null&&p.id&&I.value.type==="database"){const{addTab:$}=Ps();$({id:I.value.id,title:I.value.title,type:qa.DB,baseId:I.value.id})}}),(p,$)=>{const P=ai;return e(v)?D("",!0):(o(),A(P,{key:0}))}}}),Qi=Object.freeze(Object.defineProperty({__proto__:null,default:si},Symbol.toStringTag,{value:"Module"}));export{No as _,al as a,il as b,Qi as i,Po as u};
