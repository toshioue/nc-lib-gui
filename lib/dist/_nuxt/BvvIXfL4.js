import j from"./hZgTYrdl.js";import E from"./37hePIet.js";import{e as O,cW as R,bL as A,r as v,d7 as W,a5 as Q,ab as Y,f as Z,f$ as $,g as q,o as r,Q as f,w as u,a as l,t as c,d,T as y,N as s,U as b,b as h,O as V,c as D,ao as G,at as H,S as J,W as K,R as P,hD as X,m as ee,$ as ae,Z as se,y as te,_ as le}from"./DZZ6t_j4.js";import{_ as oe}from"./Bdv7ru7D.js";import{a as ne}from"./B05h-4V9.js";import{a as ie}from"./i4aLU0Nw.js";import"./DKN1hQ6S.js";import{I as re}from"./BQuyMdA-.js";import"./ByVBARmO.js";import"./C4K5fdHe.js";import"./GMLocJHP.js";import"./B5RRVMt5.js";import"./DGj1ycqW.js";import"./BQQOEPN4.js";import"./vll-Pnjv.js";import"./DyDFI6NE.js";const ce={class:"flex flex-col gap-3"},ue={class:"text-base text-gray-800 font-semibold"},de={class:"text-gray-600 flex items-center gap-1"},pe={class:"bg-gray-100 inline-flex items-center gap-1 px-1 rounded-md"},me={class:"flex w-full gap-2 justify-between items-center"},fe={class:"border-1 rounded-md h-[250px] nc-scrollbar-md border-gray-200"},_e=["data-testid","onClick"],ve={class:"flex flex-row items-center w-full cursor-pointer truncate ml-1 py-[5px] pr-2"},ye={class:"flex w-full gap-2 justify-end"},he=O({__name:"UpdateDisplayValue",props:{column:{},value:{type:Boolean}},setup(N){const w=N,{$api:B}=te(),{getMeta:I}=R(),{eventBus:L}=ne(),{fields:x}=ie(),n=A(W,v()),p=v(""),k=Q(w,"column"),m=Y(w,"value"),o=v(),g=v(!1),S=Z(()=>{var a;const e=((a=n.value)==null?void 0:a.columnsById)??{};return(x.value??[]).filter(i=>!$(e[i.fk_column_id])).filter(i=>i.title.toLowerCase().includes(p.value.toLowerCase()))}),T=async()=>{var e,a;g.value=!0;try{await B.dbTableColumn.primaryColumnSet((e=o==null?void 0:o.value)==null?void 0:e.fk_column_id),await I((a=n==null?void 0:n.value)==null?void 0:a.id,!0),L.emit(X.FIELD_RELOAD),m.value=!1}catch(i){console.error(i)}finally{g.value=!1}},F=e=>ee($(e)?j:E,{columnMeta:e});return q(()=>{var e;p.value="",o.value=(e=x.value)==null?void 0:e.find(a=>a.fk_column_id===k.value.id)}),(e,a)=>{const i=re,z=ae,C=se,U=oe;return r(),f(U,{visible:s(m),"onUpdate:visible":a[2]||(a[2]=_=>V(m)?m.value=_:null),size:"small"},{default:u(()=>{var _,M;return[l("div",ce,[l("div",null,[l("h1",ue,c(e.$t("labels.searchDisplayValue")),1),l("div",de,[d(c(e.$t("labels.selectYourNewTitleFor"))+" ",1),l("span",pe,[(r(),f(y(("iconMap"in e?e.iconMap:s(b)).table))),d(" "+c(((_=s(n))==null?void 0:_.title)??((M=s(n))==null?void 0:M.table_name)),1)])])]),l("div",me,[h(i,{value:s(p),"onUpdate:value":a[0]||(a[0]=t=>V(p)?p.value=t:null),class:"w-full h-8 flex-1",size:"small",placeholder:e.$t("placeholder.searchFields")},{prefix:u(()=>[(r(),f(y(("iconMap"in e?e.iconMap:s(b)).search),{class:"w-4 text-gray-500 h-4"}))]),_:1},8,["value","placeholder"])]),l("div",fe,[(r(!0),D(G,null,H(s(S),t=>(r(),D("div",{key:t.fk_column_id,class:J([{"bg-gray-100":s(o)===t},"px-3 py-1 flex flex-row items-center rounded-md hover:bg-gray-100"]),"data-testid":`nc-display-field-update-menu-${t.title}`,onClick:K(ge=>o.value=t,["stop"])},[l("div",ve,[(r(),f(y(F(s(n).columnsById[t.fk_column_id])),{class:"!w-3.5 !h-3.5 !text-gray-500"})),h(z,{class:"flex-1 pl-1 pr-2 truncate","show-on-truncate-only":""},{title:u(()=>[d(c(t.title),1)]),default:u(()=>[d(c(t.title),1)]),_:2},1024)]),a[3]||(a[3]=l("div",{class:"flex-1"},null,-1)),s(o)===t?(r(),f(y(("iconMap"in e?e.iconMap:s(b)).check),{key:0,class:"!w-4 !h-4 !text-brand-500"})):P("",!0)],10,_e))),128))]),l("div",ye,[h(C,{type:"secondary",size:"small",onClick:a[1]||(a[1]=t=>m.value=!1)},{default:u(()=>[d(c(e.$t("general.cancel")),1)]),_:1}),h(C,{disabled:!s(o)||s(o).fk_column_id===s(k).id,loading:s(g),size:"small",onClick:T},{default:u(()=>[d(c(e.$t("labels.changeDisplayValueField")),1)]),_:1},8,["disabled","loading"])])])]}),_:1},8,["visible"])}}}),ze=le(he,[["__scopeId","data-v-7c858efc"]]);export{ze as default};
