import{f as q,N as se,cM as te,aA as ae,az as le,bN as oe,g5 as G,g as T,ai as H,H as J,r as U,i as ne,O as ce,o as l,c as F,a,R as A,S as r,w as u,d as K,t as f,P as e,Q as g,aj as ie,ad as B,a7 as ue,L as de,aB as re,W as P,b as M,V as j,aq as E,av as R,T as L,U as z,A as me,a0 as pe,ab as fe,ac as be,cc as _e,_ as ve}from"./3QBYHahY.js";import{C as ye}from"./Dg1gNFnz.js";import{a as ge,L as we,_ as he}from"./S6k-HM05.js";import"./Ci1lK5Ee.js";import"./xnDaHwV-.js";import"./DiZ67kIC.js";const ke={class:"flex flex-row w-full"},xe={class:"flex flex-col w-full"},Se={class:"flex flex-row items-center w-full mb-4 gap-2"},Ce=a("br",null,null,-1),$e={class:"text-gray-500"},Me={class:"flex flex-row items-center w-full mb-4 gap-2"},Ne=a("br",null,null,-1),Ie={class:"text-gray-500"},je={class:"flex flex-row items-center w-full mb-4 gap-2"},Te=a("br",null,null,-1),Fe={class:"text-gray-500"},Ke=q({__name:"Misc",setup(V){const{includeM2M:k,showNull:_}=se(),w=te(),d=ae(),{loadTables:N,hasEmptyOrNullFilters:S}=w,{base:C}=le(w),$=oe(G,void 0),v=T(()=>{var s;return($==null?void 0:$.value)??((s=C.value)==null?void 0:s.id)}),{t:I}=H();J(k,async()=>await N());const m=U();ne(async()=>{var s;await d.loadProject(v.value,!0),m.value=(s=d.getProjectMeta(v.value))==null?void 0:s.showNullAndEmptyInFilter});async function h(s){const t=d.bases.get(v.value);if(!t)throw new Error(`Base ${v.value} not found`);const b=d.getProjectMeta(v.value)??{};s.target.checked||await S()&&(m.value=!0,ie.warning(I("msg.error.nullFilterExists")));const o={...b,showNullAndEmptyInFilter:m.value};t.meta=o,await d.updateProject(v.value,{meta:JSON.stringify(o)})}return(s,t)=>{const b=ye,o=ce("e");return l(),F("div",ke,[a("div",xe,[a("div",Se,[A((l(),r(b,{checked:e(k),"onUpdate:checked":t[0]||(t[0]=p=>g(k)?k.value=p:null),class:"nc-settings-meta-misc"},{default:u(()=>[K(f(s.$t("msg.info.showM2mTables"))+" ",1),Ce,a("span",$e,f(s.$t("msg.info.showM2mTablesDesc")),1)]),_:1},8,["checked"])),[[o,["c:themes:show-m2m-tables"]]])]),a("div",Me,[A((l(),r(b,{checked:e(_),"onUpdate:checked":t[1]||(t[1]=p=>g(_)?_.value=p:null),class:"nc-settings-show-null"},{default:u(()=>[K(f(s.$t("msg.info.showNullInCells"))+" ",1),Ne,a("span",Ie,f(s.$t("msg.info.showNullInCellsDesc")),1)]),_:1},8,["checked"])),[[o,["c:settings:show-null"]]])]),a("div",je,[A((l(),r(b,{checked:e(m),"onUpdate:checked":t[2]||(t[2]=p=>g(m)?m.value=p:null),class:"nc-settings-show-null-and-empty-in-filter",onChange:h},{default:u(()=>[K(f(s.$t("msg.info.showNullAndEmptyInFilter"))+" ",1),Te,a("span",Fe,f(s.$t("msg.info.showNullAndEmptyInFilterDesc")),1)]),_:1},8,["checked"])),[[o,["c:settings:show-null-and-empty-in-filter"]]])])])])}}}),Ae={class:"nc-modal-settings-content"},Be={class:"flex flex-row justify-between w-full items-center p-4 border-b-1 border-gray-200"},Ee={class:"!my-0 text-2xl font-bold"},Ue=["onClick"],Ve={class:"select-none text-sm"},Oe=q({__name:"Modal",props:{modelValue:{type:Boolean},openKey:{},dataSourcesState:{},baseId:{}},emits:["update:modelValue","update:openKey","update:dataSourcesState"],setup(V,{emit:k}){const _=V,w=k,d=B(_,"modelValue",w),N=B(_,"openKey",w),S=B(_,"dataSourcesState",w),C=ue(_,"baseId"),{isUIAllowed:$}=de();re(G,C);const{$e:v}=me(),{t:I}=H(),m=U(!1),h={baseSettings:{title:I("labels.projectSettings"),icon:P.settings,subTabs:{misc:{key:"Misc",title:I("general.misc"),body:Ke}},onClick:()=>{v("c:settings:base-settings")}}},s=c=>Object.keys(c)[0],t=T({get:()=>[Object.keys(h).find(c=>c===N.value)||s(h)],set:c=>{N.value=c[0]}}),b=T(()=>h[t.value[0]]),o=U([s(b.value.subTabs)]),p=T(()=>b.value.subTabs[o.value[0]]);return J(()=>t.value[0],c=>{o.value=[s(h[c].subTabs)]}),(c,n)=>{const Q=pe,O=fe,D=be,W=ge,X=we,Y=he,Z=_e;return l(),r(Z,{visible:e(d),"onUpdate:visible":n[5]||(n[5]=i=>g(d)?d.value=i:null),class:z([{active:e(d)},"!top-50px !bottom-50px"]),footer:null,width:"max(90vw, 600px)",closable:!1,"wrap-class-name":"nc-modal-settings",onCancel:n[6]||(n[6]=i=>w("update:modelValue",!1))},{default:u(()=>[a("div",Ae,[a("div",Be,[a("h5",Ee,f(c.$t("objects.project"))+" "+f(c.$t("activity.settings")),1),M(Q,{type:"text",size:"small","data-testid":"settings-modal-close-button",onClick:n[0]||(n[0]=i=>d.value=!1)},{default:u(()=>[(l(),r(j(("iconMap"in c?c.iconMap:e(P)).close),{class:"cursor-pointer nc-modal-close w-4"}))]),_:1})]),M(Y,{class:"overflow-y-auto flex !h-[calc(100%_-_66px)]"},{default:u(()=>[M(W,{class:"!bg-white"},{default:u(()=>[M(D,{"selected-keys":e(t),"onUpdate:selectedKeys":n[1]||(n[1]=i=>g(t)?t.value=i:null),class:"tabs-menu h-full","open-keys":[]},{default:u(()=>[(l(),F(E,null,R(h,(i,x)=>(l(),F(E,{key:x},[x!=="dataSources"||e($)("sourceCreate")?(l(),r(O,{key:x,class:"!active:ring-0 !hover:bg-[#F0F3FF]"},{default:u(()=>[a("div",{class:"flex items-center space-x-3 min-h-10",onClick:i.onClick},[(l(),r(j(i.icon),{class:"flex-none"})),a("div",Ve,f(i.title),1)],8,Ue)]),_:2},1024)):L("",!0)],64))),64))]),_:1},8,["selected-keys"])]),_:1}),M(X,{class:"h-full scrollbar-thumb-gray-500"},{default:u(()=>{var i,x;return[e(t)[0]!=="dataSources"?(l(),r(D,{key:0,selectedKeys:e(o),"onUpdate:selectedKeys":n[2]||(n[2]=y=>g(o)?o.value=y:null),"open-keys":[],mode:"horizontal",class:"px-4"},{default:u(()=>[(l(!0),F(E,null,R(e(b).subTabs,(y,ee)=>(l(),r(O,{key:ee,class:"!active:ring-0 select-none",onClick:y.onClick},{default:u(()=>[K(f(y.title),1)]),_:2},1032,["onClick"]))),128))]),_:1},8,["selectedKeys"])):L("",!0),a("div",{class:z(["overflow-auto",{"h-full":e(o)[0]==="dataSources","px-4":e(t)[0]!=="dataSources"}])},[e(o)[0]==="dataSources"?(l(),r(j((i=e(p))==null?void 0:i.body),{key:0,state:e(S),"onUpdate:state":n[3]||(n[3]=y=>g(S)?S.value=y:null),reload:e(m),"onUpdate:reload":n[4]||(n[4]=y=>g(m)?m.value=y:null),class:"h-full","data-testid":`nc-settings-subtab-${e(p).key}`,"base-id":e(C)},null,40,["state","reload","data-testid","base-id"])):(l(),r(j((x=e(p))==null?void 0:x.body),{key:1,class:"px-2 py-6","base-id":e(C),"data-testid":`nc-settings-subtab-${e(p).key}`},null,8,["base-id","data-testid"]))],2)]}),_:1})]),_:1})])]),_:1},8,["visible","class"])}}}),Ge=ve(Oe,[["__scopeId","data-v-5b7a4b77"]]);export{Ge as default};
