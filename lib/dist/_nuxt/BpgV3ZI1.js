import U from"./BV5EkxN-.js";import E from"./CtMydB5S.js";import{f as O,cY as A,bN as R,r as h,d9 as Y,a7 as q,ad as P,g as Q,fO as $,i as W,o as r,S as _,w as d,a as o,t as c,d as u,V as y,P as a,W as w,b as g,Q as I,c as N,aq as G,av as H,U as J,Y as K,T as X,hj as Z,n as ee,a1 as ae,a0 as se,p as te,e as oe,A as le,_ as ne}from"./3QBYHahY.js";import{_ as ie}from"./C95Svpv6.js";import{a as re}from"./BteOdwRG.js";import{a as ce}from"./CfxEkdGP.js";import"./kHOslGNR.js";import{I as de}from"./CmN9vPg3.js";import"./DPqnb67u.js";import"./D4iSzjWt.js";import"./CSl6euFG.js";import"./DPgYHC40.js";import"./BsWDDIqE.js";import"./BQQOEPN4.js";import"./xnDaHwV-.js";import"./ceYq-xax.js";const ue=p=>(te("data-v-7c858efc"),p=p(),oe(),p),pe={class:"flex flex-col gap-3"},me={class:"text-base text-gray-800 font-semibold"},fe={class:"text-gray-600 flex items-center gap-1"},_e={class:"bg-gray-100 inline-flex items-center gap-1 px-1 rounded-md"},ve={class:"flex w-full gap-2 justify-between items-center"},he={class:"border-1 rounded-md h-[250px] nc-scrollbar-md border-gray-200"},ye=["data-testid","onClick"],ge={class:"flex flex-row items-center w-full cursor-pointer truncate ml-1 py-[5px] pr-2"},be=ue(()=>o("div",{class:"flex-1"},null,-1)),we={class:"flex w-full gap-2 justify-end"},xe=O({__name:"UpdateDisplayValue",props:{column:{},value:{type:Boolean}},setup(p){const x=p,{$api:S}=le(),{getMeta:B}=A(),{eventBus:D}=re(),{fields:k}=ce(),n=R(Y,h()),m=h(""),C=q(x,"column"),f=P(x,"value"),l=h(),b=h(!1),T=Q(()=>{var s;const e=((s=n.value)==null?void 0:s.columnsById)??{};return(k.value??[]).filter(i=>!$(e[i.fk_column_id])).filter(i=>i.title.toLowerCase().includes(m.value.toLowerCase()))}),F=async()=>{var e,s;b.value=!0;try{await S.dbTableColumn.primaryColumnSet((e=l==null?void 0:l.value)==null?void 0:e.fk_column_id),await B((s=n==null?void 0:n.value)==null?void 0:s.id,!0),D.emit(Z.FIELD_RELOAD),f.value=!1}catch(i){console.error(i)}finally{b.value=!1}},L=e=>ee($(e)?U:E,{columnMeta:e});return W(()=>{var e;m.value="",l.value=(e=k.value)==null?void 0:e.find(s=>s.fk_column_id===C.value.id)}),(e,s)=>{const i=de,j=ae,M=se,z=ie;return r(),_(z,{visible:a(f),"onUpdate:visible":s[2]||(s[2]=v=>I(f)?f.value=v:null),size:"small"},{default:d(()=>{var v,V;return[o("div",pe,[o("div",null,[o("h1",me,c(e.$t("labels.searchDisplayValue")),1),o("div",fe,[u(c(e.$t("labels.selectYourNewTitleFor"))+" ",1),o("span",_e,[(r(),_(y(("iconMap"in e?e.iconMap:a(w)).table))),u(" "+c(((v=a(n))==null?void 0:v.title)??((V=a(n))==null?void 0:V.table_name)),1)])])]),o("div",ve,[g(i,{value:a(m),"onUpdate:value":s[0]||(s[0]=t=>I(m)?m.value=t:null),class:"w-full h-8 flex-1",size:"small",placeholder:e.$t("placeholder.searchFields")},{prefix:d(()=>[(r(),_(y(("iconMap"in e?e.iconMap:a(w)).search),{class:"w-4 text-gray-500 h-4"}))]),_:1},8,["value","placeholder"])]),o("div",he,[(r(!0),N(G,null,H(a(T),t=>(r(),N("div",{key:t.fk_column_id,class:J([{"bg-gray-100":a(l)===t},"px-3 py-1 flex flex-row items-center rounded-md hover:bg-gray-100"]),"data-testid":`nc-display-field-update-menu-${t.title}`,onClick:K(ke=>l.value=t,["stop"])},[o("div",ge,[(r(),_(y(L(a(n).columnsById[t.fk_column_id])),{class:"!w-3.5 !h-3.5 !text-gray-500"})),g(j,{class:"flex-1 pl-1 pr-2 truncate","show-on-truncate-only":""},{title:d(()=>[u(c(t.title),1)]),default:d(()=>[u(c(t.title),1)]),_:2},1024)]),be,a(l)===t?(r(),_(y(("iconMap"in e?e.iconMap:a(w)).check),{key:0,class:"!w-4 !h-4 !text-brand-500"})):X("",!0)],10,ye))),128))]),o("div",we,[g(M,{type:"secondary",size:"small",onClick:s[1]||(s[1]=t=>f.value=!1)},{default:d(()=>[u(c(e.$t("general.cancel")),1)]),_:1}),g(M,{disabled:!a(l)||a(l).fk_column_id===a(C).id,loading:a(b),size:"small",onClick:F},{default:d(()=>[u(c(e.$t("labels.changeDisplayValueField")),1)]),_:1},8,["disabled","loading"])])])]}),_:1},8,["visible"])}}}),Oe=ne(xe,[["__scopeId","data-v-7c858efc"]]);export{Oe as default};
