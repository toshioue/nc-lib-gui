import{u as C}from"./-Hb63wRq.js";import{gf as F,at as b,cG as I,cB as K,g as t,cZ as l,r as f,P as g,H as k,A as U,gg as H}from"./nEPQs079.js";function W(){const u={field:"",query:""},s=F("field-query-search-map",()=>({})),i=F("field-query-search",()=>({...u}));return{search:i,loadFieldQuery:o=>{o&&(o in s.value||(s.value[o]={...u}),i.value=s.value[o])}}}const[J,Y]=C((u,s,i=!1,y,o)=>{const{$api:P}=U(),{activeView:a,activeNestedFilters:B,activeSorts:G}=b(I()),N=K(),{sqlUis:m}=b(N),h=t(()=>{var e;return(e=s.value)!=null&&e.source_id?m.value[s.value.source_id]:Object.values(m.value)[0]}),{search:n}=W(),R=H(Symbol("SmartsheetStore")),V=t(()=>{var e;return((e=a.value)==null?void 0:e.lock_type)==="locked"}),_=t(()=>{var e,r;return(r=(e=s.value)==null?void 0:e.columns)==null?void 0:r.some(c=>c.pk)}),$=t(()=>{var e;return((e=a.value)==null?void 0:e.type)===l.GRID}),S=t(()=>{var e;return((e=a.value)==null?void 0:e.type)===l.FORM}),x=t(()=>{var e;return((e=a.value)==null?void 0:e.type)===l.GALLERY}),E=t(()=>{var e;return((e=a.value)==null?void 0:e.type)===l.CALENDAR}),L=t(()=>{var e;return((e=a.value)==null?void 0:e.type)===l.KANBAN}),M=t(()=>{var e;return((e=a.value)==null?void 0:e.type)===l.MAP}),O=t(()=>S.value&&i),Q=t(()=>{var e;return(e=a.value)==null?void 0:e.is_default}),T=t(()=>{var c,w,q,A;let e;const r=((w=(c=s.value)==null?void 0:c.columns)==null?void 0:w.find(({id:d})=>d===n.value.field))||((A=(q=s.value)==null?void 0:q.columns)==null?void 0:A.find(d=>d.pv));if(r&&n.value.query.trim())return["text","string"].includes(h.value.getAbstractType(r))&&r.dt!=="bigint"?e=`(${r.title},like,%${n.value.query.trim()}%)`:e=`(${r.title},eq,${n.value.query.trim()})`,e}),j=t(()=>{var e;return((e=s.value)==null?void 0:e.type)==="view"}),v=f(g(y)??[]),p=f(g(o)??[]),D=f([]);return k(v,()=>{G.value=v.value},{immediate:!0}),k(p,()=>{B.value=p.value},{immediate:!0}),{view:a,meta:s,isLocked:V,$api:P,xWhere:T,isPkAvail:_,isForm:S,isGrid:$,isGallery:x,isKanban:L,isMap:M,isCalendar:E,isSharedForm:O,sorts:v,nestedFilters:p,isSqlView:j,eventBus:R,sqlUi:h,allFilters:D,isDefaultView:Q}},"smartsheet-store");function X(){const u=Y();if(!u)throw new Error("Please call `useProvideSmartsheetStore` on the appropriate parent component");return u}export{X as a,W as b,J as u};
