const __vite__fileDeps=["./BvBAAA1q.js","./DKhUGBot.js","./entry.B8GgT5QA.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{f as pe,L as me,r as A,ix as de,fx as ue,aj as _e,aA as fe,o as n,U as i,w as s,a as l,P as e,c as k,b as c,d as f,t as r,S as u,Q as R,T as C,al as ve,am as he,V as x,W as E,Y as v,Z as ge,a5 as ke,H as ye,a2 as be,a1 as we,dt as Ce,$ as xe,ca as $e}from"./DKhUGBot.js";import{_ as Fe}from"./C93sHH2i.js";import{_ as De}from"./DOSyHa8b.js";import{a as Me}from"./D-d1Vlq3.js";import{u as Ie}from"./CXIEl1K6.js";import{i as Se}from"./BNDnQ_SZ.js";import{u as Ve,a as Ae,_ as Re,b as Ee,c as Oe}from"./A30v3T_8.js";import{C as Ue}from"./BqRqK2Ui.js";import{S as je}from"./Bd_WsUAk.js";import"./Clu_wjSJ.js";import"./DGy9VVU7.js";import"./DrSobHNn.js";import"./DO1hNe_j.js";import"./lyxpGZoZ.js";import"./boyBAVNN.js";import"./Ce4Hnuew.js";import"./BIe2oNDw.js";import"./DFT4Rrrq.js";import"./CX32jp6d.js";import"./_3l2HvaK.js";import"./Cz8K5PX4.js";import"./GPQ-Eg6I.js";import"./BQQOEPN4.js";import"./CUg8TjpL.js";import"./BOlDoh1A.js";import"./BpnlUwoJ.js";import"./CxxuE4Yq.js";import"./DyY7ABnl.js";import"./BY49hpjj.js";import"./DEJjMRn_.js";import"./DgXVCOuO.js";import"./C0-Qcoum.js";import"./CNjr3NNT.js";import"./D8UTY2yA.js";const Be=ge(()=>ke(()=>import("./BvBAAA1q.js"),__vite__mapDeps([0,1,2]),import.meta.url).then($=>$.default||$)),Le={class:"flex gap-4"},Ne={class:"flex items-center gap-2"},Pe={class:"font-semibold underline"},Te={key:1,class:"flex flex-1 items-center gap-3 justify-end mr-[30px]"},Ze={class:"text-white text-3xl"},ze={class:"nc-attachment-download group-hover:opacity-100"},Ge={class:"nc-attachment-rename group-hover:opacity-100 mr-[35px]"},He=["title"],Ke={key:0,class:"flex flex-col gap-1"},Qe={class:"nc-attachment h-full w-full flex items-center justify-center"},We={class:"flex flex-row items-center py-2.25 px-2.5 bg-gray-50 rounded-lg text-gray-700 mb-4"},Ye={class:"capitalize text-ellipsis overflow-hidden select-none w-full pl-1.75",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},Vt=pe({__name:"Modal",setup($){const{isUIAllowed:F}=me(),{open:O,isLoading:T,isPublic:D,isReadonly:h,visibleItems:U,modalVisible:m,column:Z,FileIcon:z,removeFile:G,onDrop:j,downloadFile:H,updateModelValue:K,selectedImage:B,selectedVisibleItems:y,bulkDownloadFiles:Q,renameFile:W}=Ve(),M=A(),L=A(),{dragging:I}=Ae(L,U,K,h),{isOverDropZone:b}=de(M,j),{isSharedForm:w}=Me(),{getPossibleAttachmentSrc:Y,openAttachment:N}=Ie();ue("Escape",()=>{m.value=!1,b.value=!1});function q(t){B.value=t,m.value=!1;const a=ye(B,S=>{S||(setTimeout(()=>{m.value=!0},50),a==null||a())})}const g=A(!1),_=_e({title:"",i:0});function J(t,a){g.value=!0,_.i=a,_.title=t}fe(M,"paste",t=>{var a;(a=t.clipboardData)!=null&&a.files&&j(t.clipboardData.files)});const X=t=>{G(t),g.value=!1,_.i=0,_.title=""};return(t,a)=>{const S=Re,ee=be,te=Ee,oe=Fe,ae=Ue,V=we,ne=Be,le=Oe,P=Ce,se=je,ie=xe,ce=De,re=$e;return n(),i(re,{visible:e(m),"onUpdate:visible":a[3]||(a[3]=o=>R(m)?m.value=o:null),class:C(["nc-attachment-modal",{active:e(m)}]),width:"80%",footer:null,"wrap-class-name":"nc-modal-attachment-expand-cell"},{title:s(()=>{var o;return[l("div",Le,[e(w)||!e(h)&&e(F)("dataEdit")&&!e(D)?(n(),k("div",{key:0,class:"nc-attach-file group","data-testid":"attachment-expand-file-picker-button",onClick:a[0]||(a[0]=(...p)=>e(O)&&e(O)(...p))},[c(S,{class:"transform group-hover:text-accent group-hover:scale-120"}),f(" "+r(t.$t("activity.attachFile")),1)])):u("",!0),l("div",Ne,[f(r(t.$t("labels.viewingAttachmentsOf"))+" ",1),l("div",Pe,r((o=e(Z))==null?void 0:o.title),1)]),e(y).includes(!0)?(n(),k("div",Te,[c(ee,{type:"primary",class:"nc-attachment-download-all",onClick:e(Q)},{default:s(()=>[f(r(t.$t("activity.bulkDownload")),1)]),_:1},8,["onClick"])])):u("",!0)])]}),default:s(()=>[l("div",{ref_key:"dropZoneRef",ref:M,tabindex:"0"},[e(w)||!e(h)&&!e(I)?(n(),i(oe,{key:0,modelValue:e(b),"onUpdate:modelValue":a[1]||(a[1]=o=>R(b)?b.value=o:null),inline:"",class:"text-white ring ring-accent ring-opacity-100 bg-gray-700/75 flex items-center justify-center gap-2 backdrop-blur-xl"},{default:s(()=>[c(te,{class:"text-accent",height:"35",width:"35"}),l("div",Ze,r(t.$t("labels.dropHere")),1)]),_:1},8,["modelValue"])):u("",!0),l("div",{ref_key:"sortableRef",ref:L,class:C([{dragging:e(I)},"grid grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-6 relative p-6"])},[(n(!0),k(ve,null,he(e(U),(o,p)=>(n(),k("div",{key:`${o.title}-${p}`,class:"flex flex-col gap-1"},[c(P,{class:"nc-attachment-item group"},{default:s(()=>[c(ae,{checked:e(y)[p],"onUpdate:checked":d=>e(y)[p]=d,class:C(["nc-attachment-checkbox group-hover:opacity-100",{"!opacity-100":e(y)[p]}])},null,8,["checked","onUpdate:checked","class"]),e(h)?u("",!0):(n(),i(V,{key:0},{title:s(()=>[f(r(t.$t("title.removeFile")),1)]),default:s(()=>[e(w)||e(F)("dataEdit")&&!e(D)?(n(),i(x(("iconMap"in t?t.iconMap:e(E)).closeCircle),{key:0,class:"nc-attachment-remove",onClick:v(d=>J(o.title,p),["stop"])},null,8,["onClick"])):u("",!0)]),_:2},1024)),c(V,{placement:"bottom"},{title:s(()=>[f(r(t.$t("title.downloadFile")),1)]),default:s(()=>[l("div",ze,[(n(),i(x(("iconMap"in t?t.iconMap:e(E)).download),{onClick:v(d=>e(H)(o),["stop"])},null,8,["onClick"]))])]),_:2},1024),e(w)||!e(h)&&e(F)("dataEdit")&&!e(D)?(n(),i(V,{key:1,placement:"bottom"},{title:s(()=>[f(r(t.$t("title.renameFile")),1)]),default:s(()=>[l("div",Ge,[(n(),i(x(("iconMap"in t?t.iconMap:e(E)).rename),{onClick:v(d=>e(W)(o,p),["stop"])},null,8,["onClick"]))])]),_:2},1024)):u("",!0),l("div",{class:C([[e(I)?"cursor-move":"cursor-pointer"],"nc-attachment h-full w-full flex items-center justify-center overflow-hidden"])},[("isImage"in t?t.isImage:e(Se))(o.title,o.mimetype)?(n(),i(ne,{key:0,srcs:e(Y)(o),class:"max-h-full h-64 m-auto justify-center",onClick:v(d=>q(o),["stop"])},null,8,["srcs","onClick"])):o.icon?(n(),i(x(e(z)(o.icon)),{key:1,height:"150",width:"150",onClick:v(d=>e(N)(o),["stop"])},null,8,["onClick"])):(n(),i(le,{key:2,height:"150",width:"150",onClick:v(d=>e(N)(o),["stop"])},null,8,["onClick"]))],2)]),_:2},1024),l("div",{class:"truncate",title:o.title},r(o.title),9,He)]))),128)),e(T)?(n(),k("div",Ke,[c(P,{class:"nc-attachment-item group"},{default:s(()=>[l("div",Qe,[c(se,{class:""})])]),_:1})])):u("",!0)],2)],512),c(ce,{visible:e(g),"onUpdate:visible":a[2]||(a[2]=o=>R(g)?g.value=o:null),"entity-name":"File","on-delete":()=>X(e(_).i)},{"entity-preview":s(()=>[l("span",null,[l("div",We,[c(ie,{icon:"file",class:"nc-view-icon"}),l("div",Ye,r(e(_).title),1)])])]),_:1},8,["visible","on-delete"])]),_:1},8,["visible","class"])}}});export{Vt as default};
