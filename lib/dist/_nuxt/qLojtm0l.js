import{f as T,bN as p,r,db as L,d9 as V,g as u,h$ as j,N as A,H as E,aB as $,iY as O,hk as R,O as U,o as a,S as c,w as d,b as z,P as o,Q as f,R as W,a as _,V as G,W as H,c as v,t as b,T as h,a0 as P}from"./Cgw6cdOy.js";import{u as Q,_ as Y}from"./DwKimCFu.js";import{_ as q}from"./CiTH7PYd.js";import{a as J}from"./DFiWgQ57.js";import{u as K}from"./LbdZxisI.js";import"./DBOeGHNL.js";import"./Bxm040c6.js";import"./CJBRTPd8.js";import"./D8rpj5Lr.js";import"./BcZAlRJW.js";import"./BQQOEPN4.js";import"./BohSct8s.js";import"./C8c9012h.js";import"./hvq8FVej.js";import"./xtxyOwu-.js";import"./Cj4l15BV.js";import"./DpDIhxXu.js";import"./Dqwep-0C.js";import"./BBXMuneh.js";import"./BcpeJQoi.js";import"./CO8XXsKl.js";import"./gH8vPeMd.js";import"./CnN16FGu.js";import"./BBFld1ZO.js";import"./BttyO-T4.js";import"./CitraFSq.js";import"./DU05l6X4.js";import"./yuUjrAi0.js";import"./KNudlHpk.js";import"./ahHmng0e.js";import"./odmV3s9h.js";import"./Mq7h2J0k.js";import"./BM5CMLBx.js";import"./D5zISnV5.js";import"./BF7wSEKp.js";import"./BSzBZdFZ.js";import"./CsF9MKko.js";import"./maf90uZR.js";import"./C9Sjn86N.js";import"./BHi8gM78.js";import"./Cd1fRcFb.js";import"./JQyvIjgn.js";import"./SWJcscO-.js";import"./D9QxSUdR.js";import"./CAzRlw23.js";import"./CBaQbo8T.js";import"./CgXXRQ_R.js";import"./Do1LnTan.js";const X={class:"flex items-center gap-1"},Z={class:"flex items-center gap-2"},tt={key:0,class:"text-capitalize !text-[13px] font-medium"},et={key:0,class:"bg-brand-50 text-brand-500 py-1 px-2 text-md rounded-md"},Kt=T({__name:"ColumnFilterMenu",setup(ot){const k=p(L,r(!1)),n=p(V,r()),y=p(j,u(()=>!1)),{isMobileMode:F}=A(),w=r(),{nestedFilters:g,eventBus:x}=J(),{nonDeletedFilters:C,loadFilters:I}=Q(n,void 0,u(()=>!0),()=>!1,g.value,!0),l=r(0);E(()=>{var t;return(t=n==null?void 0:n.value)==null?void 0:t.id},async t=>{t&&(await I({hookId:void 0,isWebhook:!1,loadAllFilters:!0}),l.value=C.value.length||0)},{immediate:!0});const i=r(!1),M=r({});$(O,M),K(i);const m=r({});return x.on(async(t,e)=>{e&&t===R.FILTER_ADD&&(m.value={fk_column_id:e.id},i.value=!0)}),(t,e)=>{const D=P,B=Y,N=q,S=U("e");return a(),c(N,{visible:o(i),"onUpdate:visible":e[2]||(e[2]=s=>f(i)?i.value=s:null),trigger:["click"],"overlay-class-name":"nc-dropdown-filter-menu nc-toolbar-dropdown",class:"!xs:hidden"},{overlay:d(()=>[z(B,{ref_key:"filterComp",ref:w,"draft-filter":o(m),"onUpdate:draftFilter":e[0]||(e[0]=s=>f(m)?m.value=s:null),class:"nc-table-toolbar-menu","auto-save":!0,"data-testid":"nc-filter-menu","is-open":o(i),"onUpdate:filtersLength":e[1]||(e[1]=s=>l.value=s)},null,8,["draft-filter","is-open"])]),default:d(()=>[W((a(),c(D,{disabled:o(k),class:"nc-filter-menu-btn nc-toolbar-btn !border-0 !h-7",size:"small",type:"secondary"},{default:d(()=>[_("div",X,[_("div",Z,[(a(),c(G(("iconMap"in t?t.iconMap:o(H)).filter),{class:"h-4 w-4"})),!o(F)&&!o(y)?(a(),v("span",tt,b(t.$t("activity.filter")),1)):h("",!0)]),o(l)?(a(),v("span",et,b(o(l)),1)):h("",!0)])]),_:1},8,["disabled"])),[[S,["c:filter"]]])]),_:1},8,["visible"])}}});export{Kt as default};
