import{f as T,bN as p,r,da as j,d8 as L,g as u,h_ as V,N as A,H as E,aB as O,iX as R,hj as U,O as $,o as a,S as c,w as d,b as z,P as o,Q as f,R as W,a as _,V as G,W as H,c as v,t as b,T as h,a0 as P}from"./3QBYHahY.js";import{u as Q,_ as X}from"./CWFUjbDo.js";import{_ as q}from"./Kma333Sh.js";import{a as J}from"./BteOdwRG.js";import{u as K}from"./BTE9xdWH.js";import"./DdUr8XSo.js";import"./PcgFfkcK.js";import"./D7hrRKCy.js";import"./BEpKpjF5.js";import"./CGxepfeV.js";import"./BQQOEPN4.js";import"./3ezdMRmZ.js";import"./DPgYHC40.js";import"./xnDaHwV-.js";import"./DMimqSFg.js";import"./BV5EkxN-.js";import"./DPqnb67u.js";import"./CtMydB5S.js";import"./D4iSzjWt.js";import"./CfxEkdGP.js";import"./CSl6euFG.js";import"./Bt6TDbeH.js";import"./DGM-hiY9.js";import"./CI9Dknfq.js";import"./0DGTjfkJ.js";import"./Ci1lK5Ee.js";import"./BcLlH2U_.js";import"./CNtEbMQ_.js";import"./Dg1gNFnz.js";import"./Br97zOmN.js";import"./6yFCeHM-.js";import"./CRLT1BlI.js";import"./cW5_x0lr.js";import"./CgGRcmqz.js";import"./Dq3zcGy9.js";import"./DFA1iJCE.js";import"./C4NkiKp9.js";import"./BrM32iTX.js";import"./C9Sjn86N.js";import"./xjLhZbTD.js";import"./CdYx1kPu.js";import"./BT04iVBh.js";import"./C0j1q3Yn.js";import"./ccYJAzcu.js";import"./Itk_4Ub9.js";import"./CZtdcH_f.js";import"./yhBK-xu8.js";import"./DmzaAQYu.js";const Y={class:"flex items-center gap-1"},Z={class:"flex items-center gap-2"},tt={key:0,class:"text-capitalize !text-[13px] font-medium"},et={key:0,class:"bg-brand-50 text-brand-500 py-1 px-2 text-md rounded-md"},Kt=T({__name:"ColumnFilterMenu",setup(ot){const y=p(j,r(!1)),n=p(L,r()),k=p(V,u(()=>!1)),{isMobileMode:F}=A(),w=r(),{nestedFilters:g,eventBus:x}=J(),{nonDeletedFilters:C,loadFilters:I}=Q(n,void 0,u(()=>!0),()=>!1,g.value,!0),l=r(0);E(()=>{var t;return(t=n==null?void 0:n.value)==null?void 0:t.id},async t=>{t&&(await I({hookId:void 0,isWebhook:!1,loadAllFilters:!0}),l.value=C.value.length||0)},{immediate:!0});const i=r(!1),M=r({});O(R,M),K(i);const m=r({});return x.on(async(t,e)=>{e&&t===U.FILTER_ADD&&(m.value={fk_column_id:e.id},i.value=!0)}),(t,e)=>{const D=P,B=X,N=q,S=$("e");return a(),c(N,{visible:o(i),"onUpdate:visible":e[2]||(e[2]=s=>f(i)?i.value=s:null),trigger:["click"],"overlay-class-name":"nc-dropdown-filter-menu nc-toolbar-dropdown",class:"!xs:hidden"},{overlay:d(()=>[z(B,{ref_key:"filterComp",ref:w,"draft-filter":o(m),"onUpdate:draftFilter":e[0]||(e[0]=s=>f(m)?m.value=s:null),class:"nc-table-toolbar-menu","auto-save":!0,"data-testid":"nc-filter-menu","is-open":o(i),"onUpdate:filtersLength":e[1]||(e[1]=s=>l.value=s)},null,8,["draft-filter","is-open"])]),default:d(()=>[W((a(),c(D,{disabled:o(y),class:"nc-filter-menu-btn nc-toolbar-btn !border-0 !h-7",size:"small",type:"secondary"},{default:d(()=>[_("div",Y,[_("div",Z,[(a(),c(G(("iconMap"in t?t.iconMap:o(H)).filter),{class:"h-4 w-4"})),!o(F)&&!o(k)?(a(),v("span",tt,b(t.$t("activity.filter")),1)):h("",!0)]),o(l)?(a(),v("span",et,b(o(l)),1)):h("",!0)])]),_:1},8,["disabled"])),[[S,["c:filter"]]])]),_:1},8,["visible"])}}});export{Kt as default};
